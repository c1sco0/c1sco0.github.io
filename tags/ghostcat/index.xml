<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>Ghostcat on sckull</title>
    <link>https://sckull.github.io/tags/ghostcat/</link>
    <description>Recent content in Ghostcat on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Tue, 05 May 2020 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/ghostcat/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>TryHackMe - TomGhost</title>
        <link>https://sckull.github.io/posts/tomgost/</link>
        <pubDate>Tue, 05 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 05 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/tomgost/</guid>
        <description>TomGhost es una maquina de TryHackMe. Identificamos una vulnerabilidad en Tomcat para leer las credenciales de esta misma plataforma, lo que nos permitio acceder por SSH donde luego encontramos un archivo encriptado y, que, con la ayuda de John obtuvimos la contraseña para un segundo usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;TomGhost es una maquina de TryHackMe. Identificamos una vulnerabilidad en Tomcat para leer las credenciales de esta misma plataforma, lo que nos permitio acceder por SSH donde luego encontramos un archivo encriptado y, que, con la ayuda de John obtuvimos la contraseña para un segundo usuario. Escalamos privilegios utilizando Sudo con Zp e informacion de GTFOBins.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/tomghost&#34;&gt;tomghost&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIAD/AQAAJgAAABgYAAAAACAA0wIAACUCAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIAgAAAJCRaDYAAAHGSURBVHicY/z//z8DKYAJlwTcoP///yMbyohmA4TLyMgI4/5jZEQxFN0GRkZGRkbGP3/+3Lhx5/dfBkZGpqfP3j5//hJuFgvcYIipX79+YWfnYGD4u2Fpi5KanoKS+tF96w3M3CUlQyFqWOAG//79+969e7dv33r06FFEZKKHnczfr6c+PToZYMf5V0iAgYEB4kwmuF1Pnz5lYWby8PZVVddfPKP65Mmzvxj4nz5nuH7324dv7Ch+gDiGl5fn91+m4zumPzyYoMo0h+XH7Y+ff1sYibz7Ic0voghxB0oo/f3P0FYZ+fvJCk01OVW5//9/vfn8S/jxH3v3yKkS4vz//v1jYmKCO+nfv3//tq3qMTLQ4zPoXn/ZlE1n/l+5ZgYu5V8vdl0+sej/f6hqBgYGFojW16+evnx2zy243E5I1MLCkktQVkbF6tevZN7rO0/unfnq5QvvsFIBAYH///9DnfT375+fP/+eP3/m9etX3759u37tmomJCQsr69//rOJioqKCzBLSKlxc3AwM/1Fi+s/v31++fv358+f////Z2Nj+/v3LzMzIz8fPzMKKJWnA4w5Luvr3jxHmB+xpCTmloKcdUpM3AGEu6T115oEUAAAAAElFTkSuQmCCiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAIAAABvFaqvAAACmklEQVR4nGP8//8/AzUAE1VMGTWI4djRY58/fYZznzx5fu3adZwG4Yq+v3//rls2KTMj7crlC+cvXDp+7FhaUuTpI1vRlDFi6v////+LFy/evn37588fHR2dHz9/Xdrf8uPj/a8/WW/efWtvJc78789PdmtLt3R8Xvvz58++ffuePn16/vz5vLy8zZs383BzPXz628xAXJCHOcpfhYedVVKU6/tvdIejG3T//n1+fn4TE5PY2NhDhw6pqmmvWTLp2PEjDEysj5593n/8xYlzr7/+ZPjNKErAoF+/fvHz8TEwMLx89XpyX0Njke+Lc80iLC/WbH+kqiz45NlXOzPpJWtv//nPSSCMPn78cPnKdR4OxrVzy3WlrstLsbEwMr36wHDunmBSvBsT4+9373/svaIYEpkoIS5GILCnTZ388lx3pOv/i7dZVGS/crIxMTMzff7KdOWpJL+kMiOvk19oGhNGskEXuHnj6vu7i9/+ksru+bxoD9uDH56XnirefcbCwPDTSOHxrQsH3374g2kKukGfP3/auqRC0yC4ffq+wMTOxx+5eZWTHGK3SNutfMKad/21mqkGw5dbLVvXz8NMciheW76w597ZBVmNRwQFBRgYGK5evXrz5k0/f38WZmYGBoYPH79eOr3r1Y0lb59fYhf3MHdO1NA2ZGRgxDTo//Vrl/79+ffq3UdmJqZ///7x8vK+e/fu27dvkpKSf//+FRMT+/Xrz9Nnr25dOSrC84mZVzUoNJGREXdgnzlz5tOnT0+fPmVgYDh58uSPHz9sbGzk5eVv3rz59esXW1tbbh5ebS0tfF6DgO/fvzMxMb1584adnZ2BgeHfv3/s7OyfPn3i4eFhZGRkZmZmY2ODSBEwiDwwRAs2uhoEAHOcPyVZZCdTAAAAAElFTkSuQmCC&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;810&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/stuxnet.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon May  4 21:55:03 2020 as: nmap -sV -o nmap_scan_mini tomgost.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; tomgost.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.190.132&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.22s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
53/tcp   open  tcpwrapped
8009/tcp open  ajp13      Apache Jserv &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Protocol v1.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8080/tcp open  http       Apache Tomcat 9.0.30
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon May  4 21:55:31 2020 -- 1 IP address (1 host up) scanned in 28.22 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tomghost# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://tomgost.thm:8080/ -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/docs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/examples &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/host-manager &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manager &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/tomghost#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http-puerto-8080&#34;&gt;HTTP Puerto 8080&lt;/h2&gt;
&lt;p&gt;Encontramos Apache Tompact en el puerto 8080.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.23.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;ajp---ghostcat-file-readinclusion&#34;&gt;AJP - Ghostcat File Read/Inclusion&lt;/h1&gt;
&lt;p&gt;Para el servicio en el puerto 8009 (Apache Jserv) encontramos un exploit que permite lectura de archivos, utilizamos el exploit  &lt;a href=&#34;https://www.exploit-db.com/exploits/48143&#34;&gt;&lt;strong&gt;CVE-2020-1938&lt;/strong&gt;&lt;/a&gt;. Intentamos leer el archivo &lt;code&gt;index.jsp&lt;/code&gt; y logramos obtener el codigo fuente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.48.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que logramos obtener el codigo fuente de &lt;code&gt;index.jsp&lt;/code&gt;, intentamos obtener el archivo de configuracion &lt;code&gt;web.xml&lt;/code&gt;, logramos obtener el codigo fuente y logramos ver lo que parecen credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.51.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---skyfuck&#34;&gt;USER - SKYFUCK&lt;/h1&gt;
&lt;p&gt;Intentamos ingresar en el panel de tomcat (&lt;code&gt;/manager/html&lt;/code&gt;) pero no esta autorizado el acceso. Utilizamos el servicio SSH con las credenciales encontradas y logramos obtener una shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.55.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la carpeta principal de Skyfuck encontramos dos arhivos una clave y un archivo encriptado, intentamos importar la key y desencriptar el archivo gpg pero al parecer la clave esta protegida por una frase.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.00.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;strong&gt;gpg2john&lt;/strong&gt; para generar el hash y utilizar john para encontrar la frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.06.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez encontrada la frase utilizamos esta para desencriptar el archivo &lt;code&gt;credentials.gpg&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.07.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---merlin&#34;&gt;USER - MERLIN&lt;/h1&gt;
&lt;p&gt;Utilizamos las credenciales encontradas y obtenemos una shell con el usuario merlin y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.09.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;zip&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/zip/&#34;&gt;&lt;strong&gt;zip&lt;/strong&gt;&lt;/a&gt; para obtener una shell root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.12.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.12.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/tomghost/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/tomghost/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>Ghostcat</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>