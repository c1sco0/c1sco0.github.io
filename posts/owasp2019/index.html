<!DOCTYPE html>
<html lang="en">
<head>
  <a name="top"></a>
  
    <title>OWASP CTF 2019 Guatemala - Writeup :: sckull — HackTheBox Writeups, CTF</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.
SCOREBOARD TRIVIA Dark Army whiterose
Friends angela_moss
E-corp flag{fsociety00.dat}
Fsociety mr robot
CRYPTO BASE Decodificamos el mensaje en base32.
Comando:
echo MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q====|base32 -d  flag{base32_is_very_bored!}
PI PI PI Utilizando google buscamos una de las strings (&amp;ldquo;di-dah-dah&amp;rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.
dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit  Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse)."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://sckull.github.io/posts/owasp2019/" />


<link rel="stylesheet" href="https://sckull.github.io/assets/style.css">


<link rel="stylesheet" href="https://sckull.github.io/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://sckull.github.io/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://sckull.github.io/img/favicon.png">

<script src="https://use.fontawesome.com/63acf4d7a3.js"></script>



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="OWASP CTF 2019 Guatemala - Writeup :: sckull — HackTheBox Writeups, CTF" />
<meta name="twitter:description" content="Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.
SCOREBOARD TRIVIA Dark Army whiterose
Friends angela_moss
E-corp flag{fsociety00.dat}
Fsociety mr robot
CRYPTO BASE Decodificamos el mensaje en base32.
Comando:
echo MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q====|base32 -d  flag{base32_is_very_bored!}
PI PI PI Utilizando google buscamos una de las strings (&amp;ldquo;di-dah-dah&amp;rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.
dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit  Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse)." />
<meta name="twitter:site" content="https://sckull.github.io" />
<meta name="twitter:creator" content="sckull" />
<meta name="twitter:image" content="https://sckull.github.io/../../image/owasp/cover.jpg">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OWASP CTF 2019 Guatemala - Writeup :: sckull — HackTheBox Writeups, CTF">
<meta property="og:description" content="Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.
SCOREBOARD TRIVIA Dark Army whiterose
Friends angela_moss
E-corp flag{fsociety00.dat}
Fsociety mr robot
CRYPTO BASE Decodificamos el mensaje en base32.
Comando:
echo MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q====|base32 -d  flag{base32_is_very_bored!}
PI PI PI Utilizando google buscamos una de las strings (&amp;ldquo;di-dah-dah&amp;rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.
dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit  Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse)." />
<meta property="og:url" content="https://sckull.github.io/posts/owasp2019/" />
<meta property="og:site_name" content="OWASP CTF 2019 Guatemala - Writeup" />
<meta property="og:image" content="https://sckull.github.io/../../image/owasp/cover.jpg">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />


<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://sckull.github.io"
        },
        "articleSection" : "posts",
        "name" : "OWASP CTF 2019 Guatemala - Writeup",
        "headline" : "OWASP CTF 2019 Guatemala - Writeup",
        "description" : "Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.
SCOREBOARD TRIVIA Dark Army whiterose
Friends angela_moss
E-corp flag{fsociety00.dat}
Fsociety mr robot
CRYPTO BASE Decodificamos el mensaje en base32.
Comando:
echo MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q====|base32 -d  flag{base32_is_very_bored!}
PI PI PI Utilizando google buscamos una de las strings (&ldquo;di-dah-dah&rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.
dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit  Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse).",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2019",
        "datePublished": "2019-05-19 00:00:00 &#43;0000 UTC",
        "dateModified" : "2019-05-19 00:00:00 &#43;0000 UTC",
        "url" : "https://sckull.github.io/posts/owasp2019/",
        "wordCount" : "2020",
        "keywords" : [ "CTF","OWASP","Forensics","brainfuck-language","sheikah-language","piet","writeup","Blog" ]
    }
    </script>


<meta property="article:published_time" content="2019-05-19 00:00:00 &#43;0000 UTC" />





</head>
<body class="">
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="https://sckull.github.io/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#000" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://sckull.github.io/about">About</a></li>
        
      
        
          <li><a href="https://sckull.github.io/tags/">Tags</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://sckull.github.io/about">About</a></li>
      
    
      
        <li><a href="https://sckull.github.io/tags/">Tags</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
  <link rel="shortcut icon" href="https://sckullbock.blogspot.com/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</header>

  
  <div class="content">    
    

  <div class="post">
    <h2 class="post-title"><a href="https://sckull.github.io/posts/owasp2019/">OWASP CTF 2019 Guatemala - Writeup</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            Sunday, May 19, 2019
        </span>
      
      <span class="post-author">— Written by sckull</span>
      
    </div>
        
    
      <span class="post-tags">
        
         <a class="button-tag" href="https://sckull.github.io/tags/ctf/"><li class="fa fa-tag"></li> CTF</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/owasp/"><li class="fa fa-tag"></li> OWASP</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/forensics/"><li class="fa fa-tag"></li> Forensics</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/brainfuck-language/"><li class="fa fa-tag"></li> brainfuck-language</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/sheikah-language/"><li class="fa fa-tag"></li> sheikah-language</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/piet/"><li class="fa fa-tag"></li> piet</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/writeup/"><li class="fa fa-tag"></li> writeup</a>&nbsp;
        
      </span>
    

    
      
        <img src="https://sckull.github.io/posts/owasp2019/../../image/owasp/cover.jpg" class="post-cover center" />
      
      <hr />
     
    
    <div class="post-content">      
      

<hr />

<p>Aqui se listan algunas soluciones de los diferentes retos del CTF realizado en el OWASP Guatemala.</p>

<h1 id="scoreboard">SCOREBOARD</h1>

<p><img src="../../image/owasp/1.png" alt="image" />
<img src="../../image/owasp/2.png" alt="image" /></p>

<h1 id="trivia">TRIVIA</h1>

<h2 id="dark-army">Dark Army</h2>

<p><code>whiterose</code></p>

<h2 id="friends">Friends</h2>

<p><code>angela_moss</code></p>

<h2 id="e-corp">E-corp</h2>

<p><code>flag{fsociety00.dat}</code></p>

<h2 id="fsociety">Fsociety</h2>

<p><code>mr robot</code></p>

<h1 id="crypto">CRYPTO</h1>

<h2 id="base">BASE</h2>

<p>Decodificamos el mensaje en base32.</p>

<p>Comando:</p>

<pre><code class="language-bash">echo MZWGCZ33MJQXGZJTGJPWS427OZSXE6K7MJXXEZLEEF6Q====|base32 -d
</code></pre>

<p><code>flag{base32_is_very_bored!}</code></p>

<h2 id="pi-pi-pi">PI PI PI</h2>

<p>Utilizando google buscamos una de las strings (&ldquo;di-dah-dah&rdquo;) y encontramos que es codigo morse utilizando di y dah que representan los sonidos. Codigo morse.</p>

<pre><code class="language-bash">dah-dah-dah di-dah-dah di-dah di-di-dit di-dah-dah-dit dah-dah-dah-dah-dah di-dah-dah-dah-dah di-di-dah-dah-dah di-di-di-dah-dah di-di-di-di-dah di-di-di-di-dit dah-di-di-di-dit dah-dah-di-di-dit dah-dah-dah-di-dit dah-dah-dah-dah-dit
</code></pre>

<p>Escribí un pequeño script en python utilizando la tabla de valores descritos en la pagina(Codigo morse).</p>

<p><img src="../../image/owasp/pipi.png" alt="image" /></p>

<p>Codigo: <a href="https://github.com/sckull/ctf-stuff/blob/master/morse_leng.py"><strong>Morse_lang.py</strong></a></p>

<p><code>flag: OWASP0123456789</code></p>

<h2 id="brain">BRAIN</h2>

<p>Brainfuck es un lenguaje que se representa por medio de los caracteres <code>&gt;&lt;+-.,[]</code> para obtener la flag se utilizo un decoder online. <a href="https://www.dcode.fr/brainfuck-language"><strong>dcode.fr/brainfuck-language</strong></a></p>

<pre><code class="language-text">++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.++++++++++++++++++++.-------------------------.++++++++++++++++.-----------------.&lt;&lt;+++++++++++++++++++.&gt;&gt;+++++++++++++.--------.+++++++++++++++.------------------.++++++++.------------.++++++++++++++++++++++++.----------------------.++++++++++++++++++.--------------------.+++++++++.&lt;&lt;++.&gt;&gt;++++++++++.&lt;&lt;.&gt;&gt;+++++++++++.
</code></pre>

<p><img src="../../image/owasp/brainfuck.png" alt="image" /></p>

<p><code>flag{bra1nfuck_was_h3r3}</code></p>

<h2 id="htp">HTP</h2>

<p>Nos dan lo que parece una contraseña para poder obtener que tipo de hash es utilizamos hashcat, de igual forma para desencriptar la contraseña la misma herramienta.</p>

<pre><code class="language-text">Grecie:$apr1$9zQh77LH$cbQwfDnON90qz0mhYg1Yv.
</code></pre>

<p><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a> [1600]</p>

<p><img src="../../image/owasp/htp_1.png" alt="image" />
<img src="../../image/owasp/htp_2.png" alt="image" /></p>

<p>Decrypted:</p>

<pre><code class="language-text">$apr1$9zQh77LH$cbQwfDnON90qz0mhYg1Yv.:classof08
</code></pre>

<p><code>flag{classof08}</code></p>

<h2 id="turin">TURIN</h2>

<p>En este reto nos dan un string y una imagen, con el titulo se puede concluir que pertenece a la maquina de turing y la imagen pertenece a la configuracion que debe de tener la maquina para poder obtener el mensaje oculto en el string. Utilizamos la pagina de cryptii.com para obtener nuestra flag.</p>

<pre><code class="language-text">text:ixqajtrjaq
</code></pre>

<p><img src="../../image/owasp/turin.png" alt="image" /></p>

<p><code>flag{heilhitler}</code></p>

<h2 id="impa">IMPA</h2>

<p>Para este reto nos dan una pista, al investigar acerca del personaje nos encontramos en la wiki de zelda el lenguaje Sheikah, utilizamos imagenes de google para poder obtener nuestra bandera tambien existe un traductor en dcode.fr/sheikah-language</p>

<p>Wiki de Zelda: <a href="https://zelda.gamepedia.com/Sheikah_Language"><strong>Sheikah_Language</strong></a></p>

<p>Reto:
<img src="../../image/owasp/zelda_impa.png" alt="image" />
Impa:
<img src="../../image/owasp/zelda.jpg" alt="image" /></p>

<p><code>flag{ZELDALOVEU}</code></p>

<h2 id="batman">BATMAN</h2>

<p>Utilizamos <a href="https://mothereff.in/bacon"><strong>motherreff.in</strong></a> para decodificar la flag.</p>

<pre><code class="language-text">AABABABABAAAAAAAABBA{AAAABAAAAABAABAABABBAAAAAABBAAAAABAAABBBABAAAABBBAAABAABAAAAABAAABAAABAABAAAAAAABAAABBABBA}
</code></pre>

<p><img src="../../image/owasp/batman.png" alt="image" /></p>

<p><code>FLAG{BATMANCHIPERISEASY}</code></p>

<h2 id="king">KING</h2>

<p>Un poco de informacion de este reto, la NSA mostro un mensaje parecido a este en un twitt, segun un <a href="https://news.ycombinator.com/item?id=7711800"><strong>post</strong></a> es un tipo de rompecabezas que vienen en los periodicos. Existen difrentes paginas que pueden decodificar mensajes de este tipo.</p>

<ul>
<li><a href="https://www.boxentriq.com/code-breaking/cryptogram">https://www.boxentriq.com/code-breaking/cryptogram</a></li>
<li><a href="http://www.oneacross.com/">http://www.oneacross.com/</a></li>
<li><a href="https://quipqiup.com/">https://quipqiup.com/</a></li>
</ul>

<p>Para resolver este reto utilizamos una pagina de las listadas anteriormente.</p>

<p><img src="../../image/owasp/kng.png" alt="image" /></p>

<pre><code class="language-text">izu gjweft yifgx izji tjluy wf yuwyu yijgiy frr vkiz jw kdu dgujt igadl j dzur jwe j hkudu fr hpaif.
izu maxy izji fvwue izu kdu dgujt igadl yifpu izu hkudu fr hpaif rgft izu hjyigx dzur vzf fnijkwue ki rgft izu rpxkwm upuhzjwi.
izu rpxkwm upuhzjwi mfi ki rgft j yatf vguyipug vzf fnijkwue ki kw izu yatf dzjthkfwyzkh fw yjiagw.
izux vuwi if yjiagw nudjayu qahkiug vjy rapp fr taijwi nujsdffwy.
izu nujsdffwy vugu rgft tjgy vzugu izu nannpx nannpuy, jw jwdkuwi rjwm izji vjy nagkue kw djtupfi pksue.
izu nannpx nannpuy djtu njdl jiug izu dpfvwy guyaggudiue zkt kw jw jwdkuwi nagkjp yhupp fr tjmkdjpwuyy.
izuw izu dfgwefm rgft suway puje jw jiijdl fr djwfuy fwif izu gayykjwy vzf guyhfweue nx ijlkwm tdefwjpey jvjx rgft dzkwj.
ykwdu dzkwj ekew'i zjsu jwxtfgu tdefwjpey izux eudkeue if nax j hkccj zai.
izu hkccj zai vjy izuw yifpuw nx j ijplkwm upuhzjwi rgft kwekj.
izu upuhzjwi vjy izu maga'y jwe zu pksue ji izu jyzgjt kw pfy jwmupuy.
izu upuhzjwi zje j hkm rgkuwe vzf ijamzi tjiz.
izu hkm ubhpfeue fwu ejx jwe puri izu vzfpu vfgpe vfweugkwm.
ykwdu izu hkm ubhpfeue izu lkwm hkm npjtue izu mkjwiy.
ykwdu izu mkjwiy zjiue nukwm npjtue izux pue jw jiijdl fw izu lkwm jwe ykwdu izux vugu fr dfagyu tadz nkmmug izux vugu skdifgkfay.
jriug izu mkjwiy iffl dfwigfp fr mguuwpjwe izux yijgiue rkmzikwm izu sklkwmy rgft kdupjwe.
izu fhhfwuwiy vugu uouwpx tjidzue yf izux uweue ah euyigfxkwm ujdz fizug jwe izux nudjtu ubikwdi.
izuw izu mfgkppjy yifpu izu zfwej igjkp 70'y rgft ifwx yfhgjwf izu puje mjwmyiug rgft kijpx.
ifwx yfhgjwf jdiajppx mfi izu zfwej'y rgft kwekj jwxzfv njdl if izu mfgkppjy.
izu mfgkppjy yijgiue djaykwm j galay kw izu nkm jhhpu, jdiajppx j nkm jhhpu, vzugu izux gjw fsug nkppx qfu jwe ukpuuw.
ykwdu izu rffinjpp hpjxugy vugu dzjykwm izut izu mfgkppjy zfhhue kwif izu mkjwi hujdz vkiz qjtuy vzf vjy uydjhkwm zky uskp hjguwiy.
izu yifgx uwey izugu k't yfggx if yjx nai fz vupp zux, zux, zux.
izu rpjm ky &quot;izux jpp pksue zjhhkpx uoug jriug&quot;.
</code></pre>

<pre><code class="language-text">the random story that makes no sense starts off with an ice cream truck a chef and a piece of pluto the guys that owned the ice cream truck stole the piece of pluto from the pastry chef who obtained it from the flying elephant the flying elephant got it from a sumo wrestler who obtained it in the sumo championship on saturn they went to saturn because jupiter was full of mutant beavcoons the beavcoons were from mars where the bubbly bubbles an ancient fang that was buried in camelot lived the bubbly bubbles came back ater the clowns resurrected him in an ancient burial spell of magicalness then the corndog from venus lead an attack of canoes onto the russians who responded by taking mcdonalds away from china since china didn t have anymore mcdonalds they decided to buy a pizza hut the pizza hut was then stolen by a talking elephant from india the elephant was the guru s and he lived at the ashram in los angeles the elephant had a pig friend who taught math the pig exploded one day and left the whole world wondering since the pig exploded the king pig blamed the giants since the giants hated being blamed they led an attack on the king and since they were of course much bigger they were victorious after the giants took control of greenland they started fighting the vikings from iceland the opponents were eqenly matched so they ended up destroying each other and they became extinct then the gorillas stole the honda trail s from tony soprano the lead gangster from italy tony soprano actually got the honda s from india anyhow back to the gorillas the gorillas started causing a rukus in the big apple actually a big apple where they ran over billy joe and eileen since the football players were chasing them the gorillas hopped into the giant peach with james who was escaping his evil parents the story ends there i m sorry to say but oh well hey hey hey the flag is they all lived happily eqer after
</code></pre>

<p>Se cambio la <code>q</code> por una <code>v</code>.
<code>they all lived happily eqer after</code></p>

<p><code>flag: they all lived happily ever after</code></p>

<h2 id="save-me">SAVE ME!</h2>

<p>Archivos <code>.fun</code>, Investigamos sobre la extension de estos archivos y encontramos que es un virus de tipo ransomware, el cual encripta los archivos con esa extension.</p>

<ul>
<li><a href="https://www.pcrisk.es/guias-de-desinfeccion/8248-fun-ransomware">https://www.pcrisk.es/guias-de-desinfeccion/8248-fun-ransomware</a></li>
</ul>

<p>Para obtener los archivos encriptados en el archivo del reto utilizamos jigsaw.exe el cual nos permite desencriptar este tipo de archivos.</p>

<p><img src="../../image/owasp/fun_fa.png" alt="image" /></p>

<p><code>flag{Jigsaw_ransomware_in_house}</code></p>

<h1 id="esteganografia">ESTEGANOGRAFIA</h1>

<h2 id="data">DATA</h2>

<p>Utilizamos exif para ver los metadatos de la imagen y encontramos la flag.</p>

<p><img src="../../image/owasp/data.jpg" alt="image" />
<img src="../../image/owasp/data_stega.png" alt="image" /></p>

<p><code>flag{metadata_in_the_dark}</code></p>

<h2 id="matrix">MATRIX</h2>

<p>Utilizamos inlite para decodificar la imagen <a href="https://online-barcode-reader.inliteresearch.com"><strong>online-barcode-reader</strong></a>/</p>

<p><img src="../../image/owasp/matrix_flag.png" alt="image" /></p>

<p><code>flag{matr1x_qr}</code></p>

<h2 id="mondrian">MONDRIAN</h2>

<p>Una imagen que tiene un mensaje oculto, este lenguaje se llama <code>piet</code> y se encuentra en imagenes que parecen estilo abstractas. <a href="http://www.dangermouse.net/esoteric/piet.html"><strong>Piet Decode</strong></a></p>

<p>Decodificamos la imagen aqui:</p>

<p><a href="https://www.bertnase.de/npiet/npiet-execute.php">https://www.bertnase.de/npiet/npiet-execute.php</a></p>

<p><img src="../../image/owasp/Mondrian.png" alt="image" /></p>

<p><img src="../../image/owasp/modrian_flag.png" alt="image" /></p>

<p><code>flag{p1et_programm1ng!}</code></p>

<h2 id="hide">HIDE</h2>

<p>Utilizamos binwalk para extraer lo que esta en el interior de la imagen, al extraer el archivo descomprimimos de nuevo y obtenemos un archivo txt, este nos indica que esta en diferentes bases, decodificamos el mensaje en <code>base64</code> y <code>base32</code> para obtener la flag.</p>

<p><img src="../../image/owasp/walk_stego.png" alt="image" /></p>

<p><code>tryhackme{b1nw4lk_0r_f0r3mo5t}</code></p>

<h1 id="reversing">REVERSING</h1>

<h2 id="crackme1">CRACKME1</h2>

<p>Para hacer una compilacion inversa al archivo crackme.pyc existe una herramienta llamada uncompyle2 para obtener el codigo fuente equivalente al archivo.</p>

<p>Comando:</p>

<pre><code class="language-bash">uncompyle2 crackme.pyc -o crackme.py
</code></pre>

<p>Codigo fuente (Ordenado manualmente para obtener la flag):</p>

<pre><code class="language-python">import random

lr = '2'
db = 'w'
ef = 's'
ty = '3'
gh = '!'
aa = 'O'
rr = 'p'
nn = 'a'

chains = [116,104,105,115,32,105,115,32,97,32,116,114,111,108,108]
chars = []
lock_pick = random.randint(0, 1000)
lock = lock_pick * 2
password = [105,116,115,32,110,111,116,32,116,104,97,116,32,101,97,115,121]
lock = lock + 10
lock = lock / 2
auth = [107,101,101,112,32,116,114,121,105,110,103]
lock = lock - lock_pick
print lock
slither = aa + db + nn + ef + rr + gh + lr + ty
print slither
keys = [112,97,115,115,119,111,114,100,33,33]
print 'Authentication required'
print ''
user_input = raw_input('Enter your username\n')
if user_input == slither:
  print 'yeeeea! correct user!'
else:
  print 'Wrong username try harder'
  exit()
</code></pre>

<p><code>flag: Owasp!23</code></p>

<h2 id="crackme2">CRACKME2</h2>

<p>Utilizamos rabin2 para obtener las strings dentro del archivo bin y obtuvimos el usuario correcto.</p>

<p><img src="../../image/owasp/crackme2.png" alt="image" /></p>

<p><code>flag: hax0r</code></p>

<h1 id="misc">MISC</h1>

<h2 id="shadow">SHADOW</h2>

<p>Un archivo que contiene la contraseña del usuario root, usamos john the ripper para obtener la ocnttraseña.</p>

<p><img src="../../image/owasp/shadow_john.png" alt="image" /></p>

<p><code>flag{toor}</code></p>

<h2 id="register">REGISTER</h2>

<p>La bandera de este reto pertenece al reto de registrarse en la plataforma. <a href="http://ctf.develsecurity.com/0x1">http://ctf.develsecurity.com/0x1</a> En hora buena por tu registro , tu premio es la flag para el reto register en la categoria misc.</p>

<p><code>flag{00010!}</code></p>

<h2 id="pdf">PDF</h2>

<p>Utilizamos pdfcrack y el diccionario Ashley Madison. Diccionario: <a href="https://raw.githubusercontent.com/dustyfresh/dictionaries/master/AshleyMadisonCracked.txt">https://raw.githubusercontent.com/dustyfresh/dictionaries/master/AshleyMadisonCracked.txt</a></p>

<p>Comando:</p>

<pre><code class="language-bash">pdfcrack -f flag-protected.pdf -w AshleyMadisonCracked.txt 
</code></pre>

<p>Contraseña: <code>zerkalo1974</code></p>

<p><img src="../../image/owasp/pdf_ashley.png" alt="image" /></p>

<p><code>flag{pdfcrack_was_here!}</code></p>

<h2 id="keep">KEEP</h2>

<p>Utilizamos <code>keepass2john</code> para obtener el hash y hashcat para obtener la contraseña del archivo.</p>

<pre><code class="language-text">$keepass$*2*60000*0*cc74b5166afe1df0757d8d208078d4d2f9fe3e331ff730b9cb5cfb94064eea50*b6d616ca2c797d4a942df786640acc92749f8005fc2b31114c0ba5b2aced9a5e*459b7fe3b1200a8b48ad9663925465c4*72cdc691f0f93f79476c83f8b1f1db44ab23ca6217048cd67bbde5e8ff76b402*1acb7f5538987791204995bc3c1ba96a254b3be85051946058b07ee6ef1b4d45
</code></pre>

<p>Comando hashcat:</p>

<pre><code class="language-bash">hashcat64.bin -m 13400 keepas.txt ../rockyou.txt -o keepas_owasp.txt
</code></pre>

<p>Contraseña: <code>zaq1zaq1</code></p>

<p>Utilizamos <code>keepassx</code> para abrir el archivo <code>Database.kdbx</code>.</p>

<p><img src="../../image/owasp/keepas_.png" alt="image" /></p>

<p>Vemos un mensaje de flag pero no aparece nuestra flag como cadena normal, el texto que aparece en el campo de password parece ser base64 invertida, invertimos el mensaje y decodificamos.</p>

<p>Comando:</p>

<pre><code class="language-bash">echo =0HZy92dzNXYw9VZyV3YlNnbx8Fa0FzdfNXYwVWZr91ZuFzahVmcit3ZhxmZ |rev|base64 -d
</code></pre>

<p><code>flag{break1ng_keepas_w1th_1nsecure_password}</code></p>

<h2 id="zero">ZERO</h2>

<p>Para este reto escribí un script en python y con el codigo ascii que aparece en el archivo leeme.txt generamos un codigo de barras para luego obtener la bandera en <a href="https://online-barcode-reader.inliteresearch.com/">https://online-barcode-reader.inliteresearch.com/</a>.</p>

<p>Codigo: <a href="https://github.com/sckull/ctf-stuff/blob/master/stego_zero.py">https://github.com/sckull/ctf-stuff/blob/master/stego_zero.py</a></p>

<p><img src="../../image/owasp/stego_zero.png" alt="image" /></p>

<p><code>flag{qr_to_ascii_art}</code></p>

<h2 id="port">PORT</h2>

<p>Para este reto hicimos un escaneo de puertos con nmap a la plataforma del ctf, encontramos el <code>puerto 1337</code> al visitarlo nos muestra un error con nuestra flag.</p>

<p>Comando:</p>

<pre><code class="language-bash">nmap -p1-65535 ctf.develsecurity.com
</code></pre>

<pre><code class="language-vim">PORT     STATE    SERVICE VERSION
22/tcp   open     ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
25/tcp   filtered smtp
80/tcp   open     http
81/tcp   open     http    Apache httpd 2.4.18 ((Ubuntu))
82/tcp   open     http    Apache httpd 2.4.18 ((Ubuntu))
83/tcp   open     http    Apache httpd 2.4.18 ((Ubuntu))
84/tcp   open     http    Apache httpd 2.4.18 ((Ubuntu))
111/tcp  open     rpcbind 2-4 (RPC #100000)
1337/tcp open     waste?
</code></pre>

<p>Mensaje al visitar la pagina.</p>

<pre><code class="language-vim">xmp&amp;gt;perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
 LANGUAGE = (unset),
 LC_ALL = (unset),
 LANG = &quot;es_GT.UTF-8&quot;
    are supported and installed on your system.
perl: warning: Falling back to the standard locale (&quot;C&quot;).
Unescaped left brace in regex is deprecated, passed through in regex; marked by &lt;!-- HERE in m/%{ --&gt; HERE (.*?)}/ at /usr/bin/print line 528.
Error: no such file &quot;flag{secret_in_the_port_is_null}&quot;
</code></pre>

<p><code>flag{secret_in_the_port_is_null}</code></p>

<h1 id="mobile">MOBILE</h1>

<h2 id="mobile-1">MOBILE</h2>

<p>Utilizamos <code>apktool</code> para poder decompilar el archivo <code>Mobile1.apk</code> y ver el codigo que tiene dentro. Tambien podemos utilizar <a href="http://www.javadecompilers.com/">http://www.javadecompilers.com/</a> para el mismo fin.</p>

<p><img src="../../image/owasp/mobile1.png" alt="image" /></p>

<p>La flag se encuentra en <code>HelloWorldActivity</code>.</p>

<p>Codigo generado por javadecompilers.</p>

<pre><code class="language-java">package com.example.helloworld;

import android.os.Bundle;
import com.phonegap.DroidGap;

public class HelloWorldActivity extends DroidGap {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.loadUrl(&quot;flag{de0fuscate_code}&quot;);
    }
}
</code></pre>

<p><code>flag{de0fuscate_code}</code></p>

<h1 id="web">WEB</h1>

<h2 id="hide-1">HIDE</h2>

<p>Para este reto buscamos directorios comunes, tambien buscamos en el codigo fuente de las paginas. <a href="http://ctf.develsecurity.com:81/admin/flag.txt">http://ctf.develsecurity.com:81/admin/flag.txt</a></p>

<p><code>flag{http_directory_indexing}</code></p>

<h2 id="default">DEFAULT</h2>

<p>De igual forma, algunos directorios comunes. <a href="http://ctf.develsecurity.com:82/install/">http://ctf.develsecurity.com:82/install/</a></p>

<p><code>flag{default_files_installation_fake_cms}</code></p>

<h2 id="inject">INJECT</h2>

<h4 id="xpath-injection">XPATH INJECTION</h4>

<p>Probamos con alguno de los payloads aqui descritos y obtuvimos la flag.</p>

<p>Payloads: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection"><strong>XPATH_INJECTION</strong></a>
Payload: <code>x' or 1=1 or 'x'='y</code></p>

<p><code>flag{XPATH_1NJ3CT10N}</code></p>

<h2 id="bypass">BYPASS</h2>

<p>Utilizamos el siguiente payload en metodo POST para obtener la bandera.</p>

<p>Payload: <code>?password[]=&quot;&quot;</code></p>

<p><a href="http://ctf.develsecurity.com:84/login.php?password[]=%22%22">http://ctf.develsecurity.com:84/login.php?password[]=%22%22</a></p>

<p><code>flag{bypass_strcmp_function}</code></p>

<h1 id="forensics">FORENSICS</h1>

<p>Para este reto revisamos todas las conexiones que se hicieron durante el volcado de memoria de este archivo, no enocontramos alguna ip que se ejecutara bajo un proceso en especifico. Asumiendo que al realizar este volcado de memoria se identifico a algun tipo de intruso en la computadora revisamos el &ldquo;historial&rdquo; de comandos y encontramos que antes de realizar el volcado de memoria el usuario hizo ping a una direccion que no aparece por ningun lado (sockets,socketscan,connscan,etc).</p>

<p><img src="../../image/owasp/forense_ip.png" alt="image" /></p>

<p><code>flag: 192.168.21.161</code></p>

<h2 id="nsa-zip-raw">NSA.ZIP[raw]</h2>

<p>Para este reto utilizamos volatility y algunos de sus comandos para obtener las flags.</p>

<p><img src="../../image/owasp/forense_profile_nsa.png" alt="image" /></p>

<p>Profile: <code>Win7SP1x64</code></p>

<h2 id="hash-ntlm">HASH NTLM</h2>

<p><img src="../../image/owasp/forense_hash_nsa.png" alt="image" /></p>

<p><code>flag:31d6cfe0d16ae931b73c59d7e0c089c0</code></p>

<h2 id="user">USER</h2>

<p><code>flag: victim</code></p>

<h2 id="pid">PID</h2>

<p>Pid del proceso <code>wmpnetwk.exe</code>.</p>

<p><img src="../../image/owasp/forense_pid_nsa.png" alt="image" /></p>

<p><code>flag: 2464</code></p>

<h2 id="sids">SIDs</h2>

<p><img src="../../image/owasp/forense_sid_nsa.png" alt="image" /></p>

<p><code>flag: S-1-5-21-3480093824-3207195214-1800084707-1001</code></p>

<h2 id="computer-name">COMPUTER NAME</h2>

<p><img src="../../image/owasp/forense_computer_nsa.png" alt="image" /></p>

<p><code>flag:VICTIM-PC</code></p>

<h1 id="osint">OSINT</h1>

<h2 id="ip-nsa">IP NSA</h2>

<p>Utilizamos algunas paginas para obtener informacion del historial de IPs de nsa.gov.</p>

<p><a href="https://myip.ms/">https://myip.ms/</a></p>

<p>Nuestra flag: <code>flag{23.196.119.211}</code></p>

<pre><code class="language-vim">23.196.119.211 United States Akamai Technologies, Inc.  2016-08-25
</code></pre>

<h2 id="sexy">SEXY</h2>

<p>Utilizamos Google Images para hacer una busqueda de la imagen e informacion.</p>

<p><img src="../../image/owasp/sexy.png" alt="image" />
<img src="../../image/owasp/sexy2.png" alt="image" /></p>

<p><code>flag: tiffanytrump</code></p>

<h2 id="stux">STUX</h2>

<p><img src="../../image/owasp/stux.png" alt="image" /></p>

<p><code>flag: 1096100</code></p>

<h1 id="networking">Networking</h1>

<h2 id="networking1">NETWORKING1</h2>

<p>Utilizamos Wireshark y un filtro para el puerto 21 FTP.</p>

<ul>
<li>tcp.port==21</li>
<li>ftp</li>
</ul>

<p><img src="../../image/owasp/networking1.png" alt="image" /></p>

<p><code>flag{sn1ff1ng_ftp_cr3dent1als}</code></p>

<h2 id="networking2">NETWORKING2</h2>

<ul>
<li>http.request.method == &ldquo;POST&rdquo;</li>
</ul>

<p><img src="../../image/owasp/networking2.png" alt="image" /></p>

<p><code>flag{http_1nsecure_commun1cat1on}</code></p>

    </div>    
    <hr />
    <div >
      
        
<div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://sckull.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      
      
      
    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://sckull.github.io/posts/conceal/">
                <span class="button__icon">←</span>
                <span class="button__text">Hack The Box - Conceal</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://sckull.github.io/posts/owaspinfra/">
                <span class="button__text">OWASP CTF 2019 Guatemala - Infraestructura</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
      
    
    
    
    </div>
    
  </div>
  
  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="https://sckull.github.io/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#000" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        
      </div>
    
  </div>
</footer>

<script src="https://sckull.github.io/assets/main.js"></script>
<script src="https://sckull.github.io/assets/prism.js"></script>


  
  
  
  <a class="float" id="myBtn" href="#top"><i class="fa fa-arrow-up" aria-hidden="true"></i></a>

</div>






</body>
</html>
