<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>TryHackMe - TomGhost :: sckull — TryHackMe, HackTheBox, CTF Writeups</title>    
  
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Titulo Tomghost     Room Tomghost   Info Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.   Puntos 810   Dificultad Media   Maker stuxnet    NMAP Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.
# Nmap 7."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://sckull.github.io/posts/tomgost/" />


<link rel="stylesheet" href="https://sckull.github.io/assets/style.css">


<link rel="stylesheet" href="https://sckull.github.io/style.css">


<link rel="shortcut icon" href="https://sckull.github.io/img/favicon.png">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/57784fec54.js" crossorigin="anonymous"></script>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="TryHackMe - TomGhost :: sckull — TryHackMe, HackTheBox, CTF Writeups" />
<meta name="twitter:description" content="Titulo Tomghost     Room Tomghost   Info Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.   Puntos 810   Dificultad Media   Maker stuxnet    NMAP Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.
# Nmap 7." />
<meta name="twitter:site" content="https://sckull.github.io/" />
<meta name="twitter:creator" content="sckull" />
<meta name="twitter:image" content="https://sckull.github.io/image/tryhackme/tomghost/cover.png">





<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TryHackMe - TomGhost :: sckull — TryHackMe, HackTheBox, CTF Writeups">
<meta property="og:description" content="Titulo Tomghost     Room Tomghost   Info Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.   Puntos 810   Dificultad Media   Maker stuxnet    NMAP Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.
# Nmap 7." />
<meta property="og:url" content="https://sckull.github.io/posts/tomgost/" />
<meta property="og:site_name" content="TryHackMe - TomGhost" />
<meta property="og:image" content="https://sckull.github.io/image/tryhackme/tomghost/cover.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />


<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://sckull.github.io/"
        },
        "articleSection" : "posts",
        "name" : "TryHackMe - TomGhost",
        "headline" : "TryHackMe - TomGhost",
        "description" : "Titulo Tomghost     Room Tomghost   Info Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.   Puntos 810   Dificultad Media   Maker stuxnet    NMAP Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.
# Nmap 7.",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-05-05 00:00:00 &#43;0000 UTC",
        "dateModified" : "2020-05-05 00:00:00 &#43;0000 UTC",
        "url" : "https://sckull.github.io/posts/tomgost/",
        "wordCount" : "412",
        "keywords" : [ "tryhackme","linux","Blog" ]
    }
    </script>


<meta property="article:published_time" content="2020-05-05 00:00:00 &#43;0000 UTC" />




<a name="top"></a>
</head>

<body class="dark-theme">
  
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
    
      
        
                   

          

          

          
            <li><a href="/about">About</a></li>
          

        
      
        
                   

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

        
      
        
                   

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        

          

          

          
            <li><a href="/about">About</a></li>
          

      
    
      
        

          
            <li><a href="/tags/hackthebox/"><img class="icon" src="/hackthebox.ico" width="32" title="HackTheBox"></a></li>
          

          

          

      
    
      
        

          

          
            <li><a href="/tags/tryhackme/"><img class="icon" src="/thm.ico" width="32" title="TryHackMe"></a></li>
          

          

      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      
    </span>
  </span>
  <link rel="shortcut icon" href="https://sckullbock.blogspot.com/favicon.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</header>

  
  <div class="content">    
    

  <div class="post">
    <h2 class="post-title">TryHackMe - TomGhost</h2>
    <div class="post-meta">
      
        <span class="post-date">
          <i class="fas fa-calendar-week"></i>
            Tuesday, May 5, 2020
        </span>
      
      <span class="post-author">— Written by sckull</span>
      
        <span class="post-read-time">— 2 min read</span>
      
    </div>
        
    
      <span class="post-tags">
        
         <a class="button-tag" href="https://sckull.github.io/tags/tryhackme/"><li class="fa fa-tag"></li> tryhackme</a>&nbsp;
        
         <a class="button-tag" href="https://sckull.github.io/tags/linux/"><li class="fa fa-tag"></li> linux</a>&nbsp;
        
      </span>
    

    
      
        <img src="https://sckull.github.io/posts/tomgost/../../image/tryhackme/tomghost/cover.png" class="post-cover center" />
      
      <hr />
     
    

    <div class="contenido">
      <h2>Contenido</h2>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#nmap">NMAP</a></li>
<li><a href="#gobuster">GOBUSTER</a>
<ul>
<li><a href="#http-puerto-8080">HTTP Puerto 8080</a></li>
</ul></li>
<li><a href="#ajp-ghostcat-file-read-inclusion-puerto-8009">AJP &lsquo;Ghostcat File Read/Inclusion&rsquo; - Puerto 8009</a></li>
<li><a href="#user-skyfuck">USER - SKYFUCK</a></li>
<li><a href="#user-merlin">USER - MERLIN</a></li>
<li><a href="#privilege-escalation">PRIVILEGE ESCALATION</a></li>
</ul></li>
</ul>
</nav>
    </div>

    <div class="post-content">      
      

<table>
<thead>
<tr>
<th>Titulo</th>
<th>Tomghost</th>
</tr>
</thead>

<tbody>
<tr>
<td>Room</td>
<td>Tomghost</td>
</tr>

<tr>
<td>Info</td>
<td>Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.</td>
</tr>

<tr>
<td>Puntos</td>
<td>810</td>
</tr>

<tr>
<td>Dificultad</td>
<td>Media</td>
</tr>

<tr>
<td>Maker</td>
<td><a href="https://tryhackme.com/p/stuxnet">stuxnet</a></td>
</tr>
</tbody>
</table>

<h2 id="nmap">NMAP</h2>

<p>Escaneo de puertos tcp, nmap nos muestra el puerto http (8080), ajp13 (8009) y el puerto ssh (22) abiertos.</p>

<pre><code class="language-bash"># Nmap 7.80 scan initiated Mon May  4 21:55:03 2020 as: nmap -sV -o nmap_scan_mini tomgost.thm
Nmap scan report for tomgost.thm (10.10.190.132)
Host is up (0.22s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
53/tcp   open  tcpwrapped
8009/tcp open  ajp13      Apache Jserv (Protocol v1.3)
8080/tcp open  http       Apache Tomcat 9.0.30
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon May  4 21:55:31 2020 -- 1 IP address (1 host up) scanned in 28.22 seconds
</code></pre>

<h2 id="gobuster">GOBUSTER</h2>

<p>Utilizamos gobuster para busqueda de directorios y archivos.</p>

<pre><code class="language-bash">root@upset:~/thm/tomghost# gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://tomgost.thm:8080/ -q -t 25 -x php,html,txt
/docs (Status: 302)
/examples (Status: 302)
/favicon.ico (Status: 200)
/host-manager (Status: 302)
/manager (Status: 302)
root@upset:~/thm/tomghost#
</code></pre>

<h3 id="http-puerto-8080">HTTP Puerto 8080</h3>

<p>Encontramos Apache Tompact en el puerto 8080.
<img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 21.23.42.png" alt="image" /></p>

<h2 id="ajp-ghostcat-file-read-inclusion-puerto-8009">AJP &lsquo;Ghostcat File Read/Inclusion&rsquo; - Puerto 8009</h2>

<p>Para el servicio en el puerto 8009 (Apache Jserv) encontramos un exploit que permite lectura de archivos, utilizamos el exploit  <a href="https://www.exploit-db.com/exploits/48143"><strong>CVE-2020-1938</strong></a>. Intentamos leer el archivo <code>index.jsp</code> y logramos obtener el codigo fuente.</p>

<p><img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 21.48.46.png" alt="image" /></p>

<p>Ya que logramos obtener el codigo fuente de <code>index.jsp</code>, intentamos obtener el archivo de configuracion <code>web.xml</code>, logramos obtener el codigo fuente y logramos ver lo que parecen credenciales.
<img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 21.51.47.png" alt="image" /></p>

<h2 id="user-skyfuck">USER - SKYFUCK</h2>

<p>Intentamos ingresar en el panel de tomcat (<code>/manager/html</code>) pero no esta autorizado el acceso. Utilizamos el servicio SSH con las credenciales encontradas y logramos obtener una shell.</p>

<p><img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 21.55.26.png" alt="image" /></p>

<p>Dentro de la carpeta principal de Skyfuck encontramos dos arhivos una clave y un archivo encriptado, intentamos importar la key y desencriptar el archivo gpg pero al parecer la clave esta protegida por una frase.</p>

<p><img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.00.58.png" alt="image" /></p>

<p>Utilizamos <strong>gpg2john</strong> para generar el hash y utilizar john para encontrar la frase.
<img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.06.12.png" alt="image" /></p>

<p>Una vez encontrada la frase utilizamos esta para desencriptar el archivo <code>credentials.gpg</code>.
<img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.07.37.png" alt="image" /></p>

<h2 id="user-merlin">USER - MERLIN</h2>

<p>Utilizamos las credenciales encontradas y obtenemos una shell con el usuario merlin y nuestra flag <strong>user.txt</strong>.
<img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.09.14.png" alt="image" /></p>

<h2 id="privilege-escalation">PRIVILEGE ESCALATION</h2>

<p>Hacemos una pequeña enumeracion con <code>sudo -l -l</code> y vemos que tenemos permisos root (sudo) para ejecutar el comando <code>zip</code>. Utilizamos <a href="https://gtfobins.github.io/gtfobins/zip/"><strong>zip</strong></a> para obtener una shell root.</p>

<p><img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.12.06.png" alt="image" /></p>

<p>Logramos obtener una shell con usuario root y nuestra flag <strong>root.txt</strong>.</p>

<p><img src="../../image/tryhackme/tomghost/Screenshot from 2020-05-04 22.12.47.png" alt="image" /></p>

    </div>    
    <hr />
    
    <div>
      
        
<div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://sckull.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      
      
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://sckull.github.io/posts/nax/">
                <span class="button__icon">←</span>
                <span class="button__text">TryHackMe - Nax</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://sckull.github.io/posts/openadmin/">
                <span class="button__text">Hack The Box - OpenAdmin</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
      
    
    
    
  </div>
  
    
  </div>
  
  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" width="44" height="44" viewBox="0 0 44 44">
  <polyline fill="none" stroke="#fff" stroke-width="2" points="15 8 29.729 22.382 15 35.367"/>
</svg>
</span>
    <span class="logo__text">sckull | blog</span>
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span style="font-size: 0.85em;">© 2020 sckull</span>
        
      
      </div>
    
  </div>
</footer>

<script src="https://sckull.github.io/assets/main.js"></script>
<script src="https://sckull.github.io/assets/prism.js"></script>


<script src="https://sckull.github.io/assets/zooming.js"></script>
<script>  
  new Zooming({
   bgColor: '#000',
   bgOpacity: 0.5,
   customSize: '100%'
 }).listen('img')
</script>


  
  
  
  <a class="float" id="myBtn" href="#top"><i class="fa fa-arrow-up" aria-hidden="true"></i></a>
  
</div>



</body>
</html>
